(function(wa,Sa){typeof exports=="object"&&typeof module!="undefined"?Sa(exports):typeof define=="function"&&define.amd?define(["exports"],Sa):(wa=typeof globalThis!="undefined"?globalThis:wa||self,Sa(wa["vue-advanced-chat"]={}))})(this,function(wa){"use strict";function Sa(e,t){const s=Object.create(null),a=e.split(",");for(let n=0;n<a.length;n++)s[a[n]]=!0;return t?n=>!!s[n.toLowerCase()]:n=>!!s[n]}const fd=Sa("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function Dl(e){return!!e||e===""}function xt(e){if(Qe(e)){const t={};for(let s=0;s<e.length;s++){const a=e[s],n=jt(a)?vd(a):xt(a);if(n)for(const r in n)t[r]=n[r]}return t}else{if(jt(e))return e;if(Ht(e))return e}}const md=/;(?![^(]*\))/g,hd=/:(.+)/;function vd(e){const t={};return e.split(md).forEach(s=>{if(s){const a=s.split(hd);a.length>1&&(t[a[0].trim()]=a[1].trim())}}),t}function st(e){let t="";if(jt(e))t=e;else if(Qe(e))for(let s=0;s<e.length;s++){const a=st(e[s]);a&&(t+=a+" ")}else if(Ht(e))for(const s in e)e[s]&&(t+=s+" ");return t.trim()}function pt(e){if(!e)return null;let{class:t,style:s}=e;return t&&!jt(t)&&(e.class=st(t)),s&&(e.style=xt(s)),e}const $e=e=>jt(e)?e:e==null?"":Qe(e)||Ht(e)&&(e.toString===zl||!nt(e.toString))?JSON.stringify(e,Ul,2):String(e),Ul=(e,t)=>t&&t.__v_isRef?Ul(e,t.value):tr(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((s,[a,n])=>(s[`${a} =>`]=n,s),{})}:ql(t)?{[`Set(${t.size})`]:[...t.values()]}:Ht(t)&&!Qe(t)&&!Yl(t)?String(t):t,wt={},er=[],ks=()=>{},_d=()=>!1,pd=/^on[^a-z]/,An=e=>pd.test(e),Ui=e=>e.startsWith("onUpdate:"),Dt=Object.assign,qi=(e,t)=>{const s=e.indexOf(t);s>-1&&e.splice(s,1)},gd=Object.prototype.hasOwnProperty,ct=(e,t)=>gd.call(e,t),Qe=Array.isArray,tr=e=>kn(e)==="[object Map]",ql=e=>kn(e)==="[object Set]",nt=e=>typeof e=="function",jt=e=>typeof e=="string",Vi=e=>typeof e=="symbol",Ht=e=>e!==null&&typeof e=="object",Vl=e=>Ht(e)&&nt(e.then)&&nt(e.catch),zl=Object.prototype.toString,kn=e=>zl.call(e),bd=e=>kn(e).slice(8,-1),Yl=e=>kn(e)==="[object Object]",zi=e=>jt(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Rn=Sa(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),On=e=>{const t=Object.create(null);return s=>t[s]||(t[s]=e(s))},yd=/-(\w)/g,bs=On(e=>e.replace(yd,(t,s)=>s?s.toUpperCase():"")),xd=/\B([A-Z])/g,Hs=On(e=>e.replace(xd,"-$1").toLowerCase()),In=On(e=>e.charAt(0).toUpperCase()+e.slice(1)),Yi=On(e=>e?`on${In(e)}`:""),Mr=(e,t)=>!Object.is(e,t),Xi=(e,t)=>{for(let s=0;s<e.length;s++)e[s](t)},Cn=(e,t,s)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:s})},Bn=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let Xl;const wd=()=>Xl||(Xl=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});let cs;class Sd{constructor(t=!1){this.active=!0,this.effects=[],this.cleanups=[],!t&&cs&&(this.parent=cs,this.index=(cs.scopes||(cs.scopes=[])).push(this)-1)}run(t){if(this.active){const s=cs;try{return cs=this,t()}finally{cs=s}}}on(){cs=this}off(){cs=this.parent}stop(t){if(this.active){let s,a;for(s=0,a=this.effects.length;s<a;s++)this.effects[s].stop();for(s=0,a=this.cleanups.length;s<a;s++)this.cleanups[s]();if(this.scopes)for(s=0,a=this.scopes.length;s<a;s++)this.scopes[s].stop(!0);if(this.parent&&!t){const n=this.parent.scopes.pop();n&&n!==this&&(this.parent.scopes[this.index]=n,n.index=this.index)}this.active=!1}}}function Md(e,t=cs){t&&t.active&&t.effects.push(e)}function Td(){return cs}function Ed(e){cs&&cs.cleanups.push(e)}const Ki=e=>{const t=new Set(e);return t.w=0,t.n=0,t},Kl=e=>(e.w&aa)>0,Gl=e=>(e.n&aa)>0,Ad=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=aa},kd=e=>{const{deps:t}=e;if(t.length){let s=0;for(let a=0;a<t.length;a++){const n=t[a];Kl(n)&&!Gl(n)?n.delete(e):t[s++]=n,n.w&=~aa,n.n&=~aa}t.length=s}},Gi=new WeakMap;let Tr=0,aa=1;const Wi=30;let Rs;const Ma=Symbol(""),Zi=Symbol("");class Qi{constructor(t,s=null,a){this.fn=t,this.scheduler=s,this.active=!0,this.deps=[],this.parent=void 0,Md(this,a)}run(){if(!this.active)return this.fn();let t=Rs,s=ra;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=Rs,Rs=this,ra=!0,aa=1<<++Tr,Tr<=Wi?Ad(this):Wl(this),this.fn()}finally{Tr<=Wi&&kd(this),aa=1<<--Tr,Rs=this.parent,ra=s,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Rs===this?this.deferStop=!0:this.active&&(Wl(this),this.onStop&&this.onStop(),this.active=!1)}}function Wl(e){const{deps:t}=e;if(t.length){for(let s=0;s<t.length;s++)t[s].delete(e);t.length=0}}let ra=!0;const Zl=[];function sr(){Zl.push(ra),ra=!1}function ar(){const e=Zl.pop();ra=e===void 0?!0:e}function us(e,t,s){if(ra&&Rs){let a=Gi.get(e);a||Gi.set(e,a=new Map);let n=a.get(s);n||a.set(s,n=Ki()),Ql(n)}}function Ql(e,t){let s=!1;Tr<=Wi?Gl(e)||(e.n|=aa,s=!Kl(e)):s=!e.has(Rs),s&&(e.add(Rs),Rs.deps.push(e))}function Zs(e,t,s,a,n,r){const o=Gi.get(e);if(!o)return;let l=[];if(t==="clear")l=[...o.values()];else if(s==="length"&&Qe(e))o.forEach((v,c)=>{(c==="length"||c>=a)&&l.push(v)});else switch(s!==void 0&&l.push(o.get(s)),t){case"add":Qe(e)?zi(s)&&l.push(o.get("length")):(l.push(o.get(Ma)),tr(e)&&l.push(o.get(Zi)));break;case"delete":Qe(e)||(l.push(o.get(Ma)),tr(e)&&l.push(o.get(Zi)));break;case"set":tr(e)&&l.push(o.get(Ma));break}if(l.length===1)l[0]&&Ji(l[0]);else{const v=[];for(const c of l)c&&v.push(...c);Ji(Ki(v))}}function Ji(e,t){const s=Qe(e)?e:[...e];for(const a of s)a.computed&&Jl(a);for(const a of s)a.computed||Jl(a)}function Jl(e,t){(e!==Rs||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const Rd=Sa("__proto__,__v_isRef,__isVue"),$l=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Vi)),Od=$i(),Id=$i(!1,!0),Cd=$i(!0),e0=Bd();function Bd(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...s){const a=mt(this);for(let r=0,o=this.length;r<o;r++)us(a,"get",r+"");const n=a[t](...s);return n===-1||n===!1?a[t](...s.map(mt)):n}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...s){sr();const a=mt(this)[t].apply(this,s);return ar(),a}}),e}function $i(e=!1,t=!1){return function(a,n,r){if(n==="__v_isReactive")return!e;if(n==="__v_isReadonly")return e;if(n==="__v_isShallow")return t;if(n==="__v_raw"&&r===(e?t?Wd:c0:t?l0:o0).get(a))return a;const o=Qe(a);if(!e&&o&&ct(e0,n))return Reflect.get(e0,n,r);const l=Reflect.get(a,n,r);return(Vi(n)?$l.has(n):Rd(n))||(e||us(a,"get",n),t)?l:zt(l)?o&&zi(n)?l:l.value:Ht(l)?e?u0(l):rr(l):l}}const Ld=t0(),Nd=t0(!0);function t0(e=!1){return function(s,a,n,r){let o=s[a];if(Er(o)&&zt(o)&&!zt(n))return!1;if(!e&&!Er(n)&&(ao(n)||(n=mt(n),o=mt(o)),!Qe(s)&&zt(o)&&!zt(n)))return o.value=n,!0;const l=Qe(s)&&zi(a)?Number(a)<s.length:ct(s,a),v=Reflect.set(s,a,n,r);return s===mt(r)&&(l?Mr(n,o)&&Zs(s,"set",a,n):Zs(s,"add",a,n)),v}}function jd(e,t){const s=ct(e,t);e[t];const a=Reflect.deleteProperty(e,t);return a&&s&&Zs(e,"delete",t,void 0),a}function Hd(e,t){const s=Reflect.has(e,t);return(!Vi(t)||!$l.has(t))&&us(e,"has",t),s}function Pd(e){return us(e,"iterate",Qe(e)?"length":Ma),Reflect.ownKeys(e)}const s0={get:Od,set:Ld,deleteProperty:jd,has:Hd,ownKeys:Pd},Fd={get:Cd,set(e,t){return!0},deleteProperty(e,t){return!0}},Dd=Dt({},s0,{get:Id,set:Nd}),eo=e=>e,Ln=e=>Reflect.getPrototypeOf(e);function Nn(e,t,s=!1,a=!1){e=e.__v_raw;const n=mt(e),r=mt(t);s||(t!==r&&us(n,"get",t),us(n,"get",r));const{has:o}=Ln(n),l=a?eo:s?ro:Ar;if(o.call(n,t))return l(e.get(t));if(o.call(n,r))return l(e.get(r));e!==n&&e.get(t)}function jn(e,t=!1){const s=this.__v_raw,a=mt(s),n=mt(e);return t||(e!==n&&us(a,"has",e),us(a,"has",n)),e===n?s.has(e):s.has(e)||s.has(n)}function Hn(e,t=!1){return e=e.__v_raw,!t&&us(mt(e),"iterate",Ma),Reflect.get(e,"size",e)}function a0(e){e=mt(e);const t=mt(this);return Ln(t).has.call(t,e)||(t.add(e),Zs(t,"add",e,e)),this}function r0(e,t){t=mt(t);const s=mt(this),{has:a,get:n}=Ln(s);let r=a.call(s,e);r||(e=mt(e),r=a.call(s,e));const o=n.call(s,e);return s.set(e,t),r?Mr(t,o)&&Zs(s,"set",e,t):Zs(s,"add",e,t),this}function n0(e){const t=mt(this),{has:s,get:a}=Ln(t);let n=s.call(t,e);n||(e=mt(e),n=s.call(t,e)),a&&a.call(t,e);const r=t.delete(e);return n&&Zs(t,"delete",e,void 0),r}function i0(){const e=mt(this),t=e.size!==0,s=e.clear();return t&&Zs(e,"clear",void 0,void 0),s}function Pn(e,t){return function(a,n){const r=this,o=r.__v_raw,l=mt(o),v=t?eo:e?ro:Ar;return!e&&us(l,"iterate",Ma),o.forEach((c,m)=>a.call(n,v(c),v(m),r))}}function Fn(e,t,s){return function(...a){const n=this.__v_raw,r=mt(n),o=tr(r),l=e==="entries"||e===Symbol.iterator&&o,v=e==="keys"&&o,c=n[e](...a),m=s?eo:t?ro:Ar;return!t&&us(r,"iterate",v?Zi:Ma),{next(){const{value:u,done:p}=c.next();return p?{value:u,done:p}:{value:l?[m(u[0]),m(u[1])]:m(u),done:p}},[Symbol.iterator](){return this}}}}function na(e){return function(...t){return e==="delete"?!1:this}}function Ud(){const e={get(r){return Nn(this,r)},get size(){return Hn(this)},has:jn,add:a0,set:r0,delete:n0,clear:i0,forEach:Pn(!1,!1)},t={get(r){return Nn(this,r,!1,!0)},get size(){return Hn(this)},has:jn,add:a0,set:r0,delete:n0,clear:i0,forEach:Pn(!1,!0)},s={get(r){return Nn(this,r,!0)},get size(){return Hn(this,!0)},has(r){return jn.call(this,r,!0)},add:na("add"),set:na("set"),delete:na("delete"),clear:na("clear"),forEach:Pn(!0,!1)},a={get(r){return Nn(this,r,!0,!0)},get size(){return Hn(this,!0)},has(r){return jn.call(this,r,!0)},add:na("add"),set:na("set"),delete:na("delete"),clear:na("clear"),forEach:Pn(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(r=>{e[r]=Fn(r,!1,!1),s[r]=Fn(r,!0,!1),t[r]=Fn(r,!1,!0),a[r]=Fn(r,!0,!0)}),[e,s,t,a]}const[qd,Vd,zd,Yd]=Ud();function to(e,t){const s=t?e?Yd:zd:e?Vd:qd;return(a,n,r)=>n==="__v_isReactive"?!e:n==="__v_isReadonly"?e:n==="__v_raw"?a:Reflect.get(ct(s,n)&&n in a?s:a,n,r)}const Xd={get:to(!1,!1)},Kd={get:to(!1,!0)},Gd={get:to(!0,!1)},o0=new WeakMap,l0=new WeakMap,c0=new WeakMap,Wd=new WeakMap;function Zd(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Qd(e){return e.__v_skip||!Object.isExtensible(e)?0:Zd(bd(e))}function rr(e){return Er(e)?e:so(e,!1,s0,Xd,o0)}function Jd(e){return so(e,!1,Dd,Kd,l0)}function u0(e){return so(e,!0,Fd,Gd,c0)}function so(e,t,s,a,n){if(!Ht(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const r=n.get(e);if(r)return r;const o=Qd(e);if(o===0)return e;const l=new Proxy(e,o===2?a:s);return n.set(e,l),l}function nr(e){return Er(e)?nr(e.__v_raw):!!(e&&e.__v_isReactive)}function Er(e){return!!(e&&e.__v_isReadonly)}function ao(e){return!!(e&&e.__v_isShallow)}function d0(e){return nr(e)||Er(e)}function mt(e){const t=e&&e.__v_raw;return t?mt(t):e}function f0(e){return Cn(e,"__v_skip",!0),e}const Ar=e=>Ht(e)?rr(e):e,ro=e=>Ht(e)?u0(e):e;function m0(e){ra&&Rs&&(e=mt(e),Ql(e.dep||(e.dep=Ki())))}function h0(e,t){e=mt(e),e.dep&&Ji(e.dep)}function zt(e){return!!(e&&e.__v_isRef===!0)}function ys(e){return $d(e,!1)}function $d(e,t){return zt(e)?e:new ef(e,t)}class ef{constructor(t,s){this.__v_isShallow=s,this.dep=void 0,this.__v_isRef=!0,this._rawValue=s?t:mt(t),this._value=s?t:Ar(t)}get value(){return m0(this),this._value}set value(t){t=this.__v_isShallow?t:mt(t),Mr(t,this._rawValue)&&(this._rawValue=t,this._value=this.__v_isShallow?t:Ar(t),h0(this))}}function v0(e){return zt(e)?e.value:e}const tf={get:(e,t,s)=>v0(Reflect.get(e,t,s)),set:(e,t,s,a)=>{const n=e[t];return zt(n)&&!zt(s)?(n.value=s,!0):Reflect.set(e,t,s,a)}};function _0(e){return nr(e)?e:new Proxy(e,tf)}class sf{constructor(t,s,a,n){this._setter=s,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new Qi(t,()=>{this._dirty||(this._dirty=!0,h0(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!n,this.__v_isReadonly=a}get value(){const t=mt(this);return m0(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}function af(e,t,s=!1){let a,n;const r=nt(e);return r?(a=e,n=ks):(a=e.get,n=e.set),new sf(a,n,r||!n,s)}function ia(e,t,s,a){let n;try{n=a?e(...a):e()}catch(r){Dn(r,t,s)}return n}function xs(e,t,s,a){if(nt(e)){const r=ia(e,t,s,a);return r&&Vl(r)&&r.catch(o=>{Dn(o,t,s)}),r}const n=[];for(let r=0;r<e.length;r++)n.push(xs(e[r],t,s,a));return n}function Dn(e,t,s,a=!0){const n=t?t.vnode:null;if(t){let r=t.parent;const o=t.proxy,l=s;for(;r;){const c=r.ec;if(c){for(let m=0;m<c.length;m++)if(c[m](e,o,l)===!1)return}r=r.parent}const v=t.appContext.config.errorHandler;if(v){ia(v,null,10,[e,o,l]);return}}rf(e,s,n,a)}function rf(e,t,s,a=!0){console.error(e)}let Un=!1,no=!1;const ds=[];let Qs=0;const kr=[];let Rr=null,ir=0;const Or=[];let oa=null,or=0;const p0=Promise.resolve();let io=null,oo=null;function qn(e){const t=io||p0;return e?t.then(this?e.bind(this):e):t}function nf(e){let t=Qs+1,s=ds.length;for(;t<s;){const a=t+s>>>1;Ir(ds[a])<e?t=a+1:s=a}return t}function g0(e){(!ds.length||!ds.includes(e,Un&&e.allowRecurse?Qs+1:Qs))&&e!==oo&&(e.id==null?ds.push(e):ds.splice(nf(e.id),0,e),b0())}function b0(){!Un&&!no&&(no=!0,io=p0.then(w0))}function of(e){const t=ds.indexOf(e);t>Qs&&ds.splice(t,1)}function y0(e,t,s,a){Qe(e)?s.push(...e):(!t||!t.includes(e,e.allowRecurse?a+1:a))&&s.push(e),b0()}function lf(e){y0(e,Rr,kr,ir)}function cf(e){y0(e,oa,Or,or)}function Vn(e,t=null){if(kr.length){for(oo=t,Rr=[...new Set(kr)],kr.length=0,ir=0;ir<Rr.length;ir++)Rr[ir]();Rr=null,ir=0,oo=null,Vn(e,t)}}function x0(e){if(Vn(),Or.length){const t=[...new Set(Or)];if(Or.length=0,oa){oa.push(...t);return}for(oa=t,oa.sort((s,a)=>Ir(s)-Ir(a)),or=0;or<oa.length;or++)oa[or]();oa=null,or=0}}const Ir=e=>e.id==null?1/0:e.id;function w0(e){no=!1,Un=!0,Vn(e),ds.sort((s,a)=>Ir(s)-Ir(a));const t=ks;try{for(Qs=0;Qs<ds.length;Qs++){const s=ds[Qs];s&&s.active!==!1&&ia(s,null,14)}}finally{Qs=0,ds.length=0,x0(),Un=!1,io=null,(ds.length||kr.length||Or.length)&&w0(e)}}function uf(e,t,...s){if(e.isUnmounted)return;const a=e.vnode.props||wt;let n=s;const r=t.startsWith("update:"),o=r&&t.slice(7);if(o&&o in a){const m=`${o==="modelValue"?"model":o}Modifiers`,{number:u,trim:p}=a[m]||wt;p&&(n=s.map(y=>y.trim())),u&&(n=s.map(Bn))}let l,v=a[l=Yi(t)]||a[l=Yi(bs(t))];!v&&r&&(v=a[l=Yi(Hs(t))]),v&&xs(v,e,6,n);const c=a[l+"Once"];if(c){if(!e.emitted)e.emitted={};else if(e.emitted[l])return;e.emitted[l]=!0,xs(c,e,6,n)}}function S0(e,t,s=!1){const a=t.emitsCache,n=a.get(e);if(n!==void 0)return n;const r=e.emits;let o={},l=!1;if(!nt(e)){const v=c=>{const m=S0(c,t,!0);m&&(l=!0,Dt(o,m))};!s&&t.mixins.length&&t.mixins.forEach(v),e.extends&&v(e.extends),e.mixins&&e.mixins.forEach(v)}return!r&&!l?(a.set(e,null),null):(Qe(r)?r.forEach(v=>o[v]=null):Dt(o,r),a.set(e,o),o)}function zn(e,t){return!e||!An(t)?!1:(t=t.slice(2).replace(/Once$/,""),ct(e,t[0].toLowerCase()+t.slice(1))||ct(e,Hs(t))||ct(e,t))}let Yt=null,M0=null;function Yn(e){const t=Yt;return Yt=e,M0=e&&e.type.__scopeId||null,t}function Xe(e,t=Yt,s){if(!t||e._n)return e;const a=(...n)=>{a._d&&sc(-1);const r=Yn(t),o=e(...n);return Yn(r),a._d&&sc(1),o};return a._n=!0,a._c=!0,a._d=!0,a}function Hb(){}function lo(e){const{type:t,vnode:s,proxy:a,withProxy:n,props:r,propsOptions:[o],slots:l,attrs:v,emit:c,render:m,renderCache:u,data:p,setupState:y,ctx:i,inheritAttrs:H}=e;let L,N;const h=Yn(e);try{if(s.shapeFlag&4){const C=n||a;L=Ps(m.call(C,C,u,r,y,p,i)),N=v}else{const C=t;L=Ps(C.length>1?C(r,{attrs:v,slots:l,emit:c}):C(r,null)),N=t.props?v:df(v)}}catch(C){jr.length=0,Dn(C,e,1),L=Re(Ss)}let k=L;if(N&&H!==!1){const C=Object.keys(N),{shapeFlag:A}=k;C.length&&A&7&&(o&&C.some(Ui)&&(N=ff(N,o)),k=ca(k,N))}return s.dirs&&(k=ca(k),k.dirs=k.dirs?k.dirs.concat(s.dirs):s.dirs),s.transition&&(k.transition=s.transition),L=k,Yn(h),L}const df=e=>{let t;for(const s in e)(s==="class"||s==="style"||An(s))&&((t||(t={}))[s]=e[s]);return t},ff=(e,t)=>{const s={};for(const a in e)(!Ui(a)||!(a.slice(9)in t))&&(s[a]=e[a]);return s};function mf(e,t,s){const{props:a,children:n,component:r}=e,{props:o,children:l,patchFlag:v}=t,c=r.emitsOptions;if(t.dirs||t.transition)return!0;if(s&&v>=0){if(v&1024)return!0;if(v&16)return a?T0(a,o,c):!!o;if(v&8){const m=t.dynamicProps;for(let u=0;u<m.length;u++){const p=m[u];if(o[p]!==a[p]&&!zn(c,p))return!0}}}else return(n||l)&&(!l||!l.$stable)?!0:a===o?!1:a?o?T0(a,o,c):!0:!!o;return!1}function T0(e,t,s){const a=Object.keys(t);if(a.length!==Object.keys(e).length)return!0;for(let n=0;n<a.length;n++){const r=a[n];if(t[r]!==e[r]&&!zn(s,r))return!0}return!1}function hf({vnode:e,parent:t},s){for(;t&&t.subTree===e;)(e=t.vnode).el=s,t=t.parent}const vf=e=>e.__isSuspense;function _f(e,t){t&&t.pendingBranch?Qe(e)?t.effects.push(...e):t.effects.push(e):cf(e)}function pf(e,t){if(Ut){let s=Ut.provides;const a=Ut.parent&&Ut.parent.provides;a===s&&(s=Ut.provides=Object.create(a)),s[e]=t}}function co(e,t,s=!1){const a=Ut||Yt;if(a){const n=a.parent==null?a.vnode.appContext&&a.vnode.appContext.provides:a.parent.provides;if(n&&e in n)return n[e];if(arguments.length>1)return s&&nt(t)?t.call(a.proxy):t}}const E0={};function Xt(e,t,s){return A0(e,t,s)}function A0(e,t,{immediate:s,deep:a,flush:n,onTrack:r,onTrigger:o}=wt){const l=Ut;let v,c=!1,m=!1;if(zt(e)?(v=()=>e.value,c=ao(e)):nr(e)?(v=()=>e,a=!0):Qe(e)?(m=!0,c=e.some(N=>nr(N)||ao(N)),v=()=>e.map(N=>{if(zt(N))return N.value;if(nr(N))return Ta(N);if(nt(N))return ia(N,l,2)})):nt(e)?t?v=()=>ia(e,l,2):v=()=>{if(!(l&&l.isUnmounted))return u&&u(),xs(e,l,3,[p])}:v=ks,t&&a){const N=v;v=()=>Ta(N())}let u,p=N=>{u=L.onStop=()=>{ia(N,l,4)}};if(Pr)return p=ks,t?s&&xs(t,l,3,[v(),m?[]:void 0,p]):v(),ks;let y=m?[]:E0;const i=()=>{if(!!L.active)if(t){const N=L.run();(a||c||(m?N.some((h,k)=>Mr(h,y[k])):Mr(N,y)))&&(u&&u(),xs(t,l,3,[N,y===E0?void 0:y,p]),y=N)}else L.run()};i.allowRecurse=!!t;let H;n==="sync"?H=i:n==="post"?H=()=>es(i,l&&l.suspense):H=()=>lf(i);const L=new Qi(v,H);return t?s?i():y=L.run():n==="post"?es(L.run.bind(L),l&&l.suspense):L.run(),()=>{L.stop(),l&&l.scope&&qi(l.scope.effects,L)}}function gf(e,t,s){const a=this.proxy,n=jt(e)?e.includes(".")?k0(a,e):()=>a[e]:e.bind(a,a);let r;nt(t)?r=t:(r=t.handler,s=t);const o=Ut;lr(this);const l=A0(n,r.bind(a),s);return o?lr(o):Oa(),l}function k0(e,t){const s=t.split(".");return()=>{let a=e;for(let n=0;n<s.length&&a;n++)a=a[s[n]];return a}}function Ta(e,t){if(!Ht(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),zt(e))Ta(e.value,t);else if(Qe(e))for(let s=0;s<e.length;s++)Ta(e[s],t);else if(ql(e)||tr(e))e.forEach(s=>{Ta(s,t)});else if(Yl(e))for(const s in e)Ta(e[s],t);return e}function R0(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return mo(()=>{e.isMounted=!0}),j0(()=>{e.isUnmounting=!0}),e}const ws=[Function,Array],O0={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:ws,onEnter:ws,onAfterEnter:ws,onEnterCancelled:ws,onBeforeLeave:ws,onLeave:ws,onAfterLeave:ws,onLeaveCancelled:ws,onBeforeAppear:ws,onAppear:ws,onAfterAppear:ws,onAppearCancelled:ws},setup(e,{slots:t}){const s=ko(),a=R0();let n;return()=>{const r=t.default&&fo(t.default(),!0);if(!r||!r.length)return;let o=r[0];if(r.length>1){for(const H of r)if(H.type!==Ss){o=H;break}}const l=mt(e),{mode:v}=l;if(a.isLeaving)return uo(o);const c=C0(o);if(!c)return uo(o);const m=Cr(c,l,a,s);Br(c,m);const u=s.subTree,p=u&&C0(u);let y=!1;const{getTransitionKey:i}=c.type;if(i){const H=i();n===void 0?n=H:H!==n&&(n=H,y=!0)}if(p&&p.type!==Ss&&(!Ra(c,p)||y)){const H=Cr(p,l,a,s);if(Br(p,H),v==="out-in")return a.isLeaving=!0,H.afterLeave=()=>{a.isLeaving=!1,s.update()},uo(o);v==="in-out"&&c.type!==Ss&&(H.delayLeave=(L,N,h)=>{const k=I0(a,p);k[String(p.key)]=p,L._leaveCb=()=>{N(),L._leaveCb=void 0,delete m.delayedLeave},m.delayedLeave=h})}return o}}};function I0(e,t){const{leavingVNodes:s}=e;let a=s.get(t.type);return a||(a=Object.create(null),s.set(t.type,a)),a}function Cr(e,t,s,a){const{appear:n,mode:r,persisted:o=!1,onBeforeEnter:l,onEnter:v,onAfterEnter:c,onEnterCancelled:m,onBeforeLeave:u,onLeave:p,onAfterLeave:y,onLeaveCancelled:i,onBeforeAppear:H,onAppear:L,onAfterAppear:N,onAppearCancelled:h}=t,k=String(e.key),C=I0(s,e),A=(E,S)=>{E&&xs(E,a,9,S)},B=(E,S)=>{const _=S[1];A(E,S),Qe(E)?E.every(x=>x.length<=1)&&_():E.length<=1&&_()},d={mode:r,persisted:o,beforeEnter(E){let S=l;if(!s.isMounted)if(n)S=H||l;else return;E._leaveCb&&E._leaveCb(!0);const _=C[k];_&&Ra(e,_)&&_.el._leaveCb&&_.el._leaveCb(),A(S,[E])},enter(E){let S=v,_=c,x=m;if(!s.isMounted)if(n)S=L||v,_=N||c,x=h||m;else return;let b=!1;const g=E._enterCb=M=>{b||(b=!0,M?A(x,[E]):A(_,[E]),d.delayedLeave&&d.delayedLeave(),E._enterCb=void 0)};S?B(S,[E,g]):g()},leave(E,S){const _=String(e.key);if(E._enterCb&&E._enterCb(!0),s.isUnmounting)return S();A(u,[E]);let x=!1;const b=E._leaveCb=g=>{x||(x=!0,S(),g?A(i,[E]):A(y,[E]),E._leaveCb=void 0,C[_]===e&&delete C[_])};C[_]=e,p?B(p,[E,b]):b()},clone(E){return Cr(E,t,s,a)}};return d}function uo(e){if(Xn(e))return e=ca(e),e.children=null,e}function C0(e){return Xn(e)?e.children?e.children[0]:void 0:e}function Br(e,t){e.shapeFlag&6&&e.component?Br(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function fo(e,t=!1,s){let a=[],n=0;for(let r=0;r<e.length;r++){let o=e[r];const l=s==null?o.key:String(s)+String(o.key!=null?o.key:r);o.type===ut?(o.patchFlag&128&&n++,a=a.concat(fo(o.children,t,l))):(t||o.type!==Ss)&&a.push(l!=null?ca(o,{key:l}):o)}if(n>1)for(let r=0;r<a.length;r++)a[r].patchFlag=-2;return a}function B0(e){return nt(e)?{setup:e,name:e.name}:e}const Lr=e=>!!e.type.__asyncLoader,Xn=e=>e.type.__isKeepAlive;function bf(e,t){L0(e,"a",t)}function yf(e,t){L0(e,"da",t)}function L0(e,t,s=Ut){const a=e.__wdc||(e.__wdc=()=>{let n=s;for(;n;){if(n.isDeactivated)return;n=n.parent}return e()});if(Kn(t,a,s),s){let n=s.parent;for(;n&&n.parent;)Xn(n.parent.vnode)&&xf(a,t,s,n),n=n.parent}}function xf(e,t,s,a){const n=Kn(t,e,a,!0);H0(()=>{qi(a[t],n)},s)}function Kn(e,t,s=Ut,a=!1){if(s){const n=s[e]||(s[e]=[]),r=t.__weh||(t.__weh=(...o)=>{if(s.isUnmounted)return;sr(),lr(s);const l=xs(t,s,e,o);return Oa(),ar(),l});return a?n.unshift(r):n.push(r),r}}const Js=e=>(t,s=Ut)=>(!Pr||e==="sp")&&Kn(e,t,s),wf=Js("bm"),mo=Js("m"),Sf=Js("bu"),N0=Js("u"),j0=Js("bum"),H0=Js("um"),Mf=Js("sp"),Tf=Js("rtg"),Ef=Js("rtc");function Af(e,t=Ut){Kn("ec",e,t)}function la(e,t){const s=Yt;if(s===null)return e;const a=ti(s)||s.proxy,n=e.dirs||(e.dirs=[]);for(let r=0;r<t.length;r++){let[o,l,v,c=wt]=t[r];nt(o)&&(o={mounted:o,updated:o}),o.deep&&Ta(l),n.push({dir:o,instance:a,value:l,oldValue:void 0,arg:v,modifiers:c})}return e}function Ea(e,t,s,a){const n=e.dirs,r=t&&t.dirs;for(let o=0;o<n.length;o++){const l=n[o];r&&(l.oldValue=r[o].value);let v=l.dir[a];v&&(sr(),xs(v,s,8,[e.el,l,e,t]),ar())}}const ho="components",kf="directives";function Ke(e,t){return vo(ho,e,!0,t)||e}const P0=Symbol();function Rf(e){return jt(e)?vo(ho,e,!1)||e:e||P0}function Gn(e){return vo(kf,e)}function vo(e,t,s=!0,a=!1){const n=Yt||Ut;if(n){const r=n.type;if(e===ho){const l=nm(r,!1);if(l&&(l===t||l===bs(t)||l===In(bs(t))))return r}const o=F0(n[e]||r[e],t)||F0(n.appContext[e],t);return!o&&a?r:o}}function F0(e,t){return e&&(e[t]||e[bs(t)]||e[In(bs(t))])}function at(e,t,s,a){let n;const r=s&&s[a];if(Qe(e)||jt(e)){n=new Array(e.length);for(let o=0,l=e.length;o<l;o++)n[o]=t(e[o],o,void 0,r&&r[o])}else if(typeof e=="number"){n=new Array(e);for(let o=0;o<e;o++)n[o]=t(o+1,o,void 0,r&&r[o])}else if(Ht(e))if(e[Symbol.iterator])n=Array.from(e,(o,l)=>t(o,l,void 0,r&&r[l]));else{const o=Object.keys(e);n=new Array(o.length);for(let l=0,v=o.length;l<v;l++){const c=o[l];n[l]=t(e[c],c,l,r&&r[l])}}else n=[];return s&&(s[a]=n),n}function gt(e,t){for(let s=0;s<t.length;s++){const a=t[s];if(Qe(a))for(let n=0;n<a.length;n++)e[a[n].name]=a[n].fn;else a&&(e[a.name]=a.fn)}return e}function Oe(e,t,s={},a,n){if(Yt.isCE||Yt.parent&&Lr(Yt.parent)&&Yt.parent.isCE)return Re("slot",t==="default"?null:{name:t},a&&a());let r=e[t];r&&r._c&&(r._d=!1),Q();const o=r&&D0(r(s)),l=ht(ut,{key:s.key||`_${t}`},o||(a?a():[]),o&&e._===1?64:-2);return!n&&l.scopeId&&(l.slotScopeIds=[l.scopeId+"-s"]),r&&r._c&&(r._d=!0),l}function D0(e){return e.some(t=>Jn(t)?!(t.type===Ss||t.type===ut&&!D0(t.children)):!0)?e:null}const _o=e=>e?nc(e)?ti(e)||e.proxy:_o(e.parent):null,Wn=Dt(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>_o(e.parent),$root:e=>_o(e.root),$emit:e=>e.emit,$options:e=>V0(e),$forceUpdate:e=>e.f||(e.f=()=>g0(e.update)),$nextTick:e=>e.n||(e.n=qn.bind(e.proxy)),$watch:e=>gf.bind(e)}),Of={get({_:e},t){const{ctx:s,setupState:a,data:n,props:r,accessCache:o,type:l,appContext:v}=e;let c;if(t[0]!=="$"){const y=o[t];if(y!==void 0)switch(y){case 1:return a[t];case 2:return n[t];case 4:return s[t];case 3:return r[t]}else{if(a!==wt&&ct(a,t))return o[t]=1,a[t];if(n!==wt&&ct(n,t))return o[t]=2,n[t];if((c=e.propsOptions[0])&&ct(c,t))return o[t]=3,r[t];if(s!==wt&&ct(s,t))return o[t]=4,s[t];po&&(o[t]=0)}}const m=Wn[t];let u,p;if(m)return t==="$attrs"&&us(e,"get",t),m(e);if((u=l.__cssModules)&&(u=u[t]))return u;if(s!==wt&&ct(s,t))return o[t]=4,s[t];if(p=v.config.globalProperties,ct(p,t))return p[t]},set({_:e},t,s){const{data:a,setupState:n,ctx:r}=e;return n!==wt&&ct(n,t)?(n[t]=s,!0):a!==wt&&ct(a,t)?(a[t]=s,!0):ct(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(r[t]=s,!0)},has({_:{data:e,setupState:t,accessCache:s,ctx:a,appContext:n,propsOptions:r}},o){let l;return!!s[o]||e!==wt&&ct(e,o)||t!==wt&&ct(t,o)||(l=r[0])&&ct(l,o)||ct(a,o)||ct(Wn,o)||ct(n.config.globalProperties,o)},defineProperty(e,t,s){return s.get!=null?e._.accessCache[t]=0:ct(s,"value")&&this.set(e,t,s.value,null),Reflect.defineProperty(e,t,s)}};let po=!0;function If(e){const t=V0(e),s=e.proxy,a=e.ctx;po=!1,t.beforeCreate&&U0(t.beforeCreate,e,"bc");const{data:n,computed:r,methods:o,watch:l,provide:v,inject:c,created:m,beforeMount:u,mounted:p,beforeUpdate:y,updated:i,activated:H,deactivated:L,beforeDestroy:N,beforeUnmount:h,destroyed:k,unmounted:C,render:A,renderTracked:B,renderTriggered:d,errorCaptured:E,serverPrefetch:S,expose:_,inheritAttrs:x,components:b,directives:g,filters:M}=t;if(c&&Cf(c,a,null,e.appContext.config.unwrapInjectedRef),o)for(const X in o){const F=o[X];nt(F)&&(a[X]=F.bind(s))}if(n){const X=n.call(s,s);Ht(X)&&(e.data=rr(X))}if(po=!0,r)for(const X in r){const F=r[X],V=nt(F)?F.bind(s,s):nt(F.get)?F.get.bind(s,s):ks,f=!nt(F)&&nt(F.set)?F.set.bind(s):ks,T=Ia({get:V,set:f});Object.defineProperty(a,X,{enumerable:!0,configurable:!0,get:()=>T.value,set:W=>T.value=W})}if(l)for(const X in l)q0(l[X],a,s,X);if(v){const X=nt(v)?v.call(s):v;Reflect.ownKeys(X).forEach(F=>{pf(F,X[F])})}m&&U0(m,e,"c");function j(X,F){Qe(F)?F.forEach(V=>X(V.bind(s))):F&&X(F.bind(s))}if(j(wf,u),j(mo,p),j(Sf,y),j(N0,i),j(bf,H),j(yf,L),j(Af,E),j(Ef,B),j(Tf,d),j(j0,h),j(H0,C),j(Mf,S),Qe(_))if(_.length){const X=e.exposed||(e.exposed={});_.forEach(F=>{Object.defineProperty(X,F,{get:()=>s[F],set:V=>s[F]=V})})}else e.exposed||(e.exposed={});A&&e.render===ks&&(e.render=A),x!=null&&(e.inheritAttrs=x),b&&(e.components=b),g&&(e.directives=g)}function Cf(e,t,s=ks,a=!1){Qe(e)&&(e=go(e));for(const n in e){const r=e[n];let o;Ht(r)?"default"in r?o=co(r.from||n,r.default,!0):o=co(r.from||n):o=co(r),zt(o)&&a?Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:()=>o.value,set:l=>o.value=l}):t[n]=o}}function U0(e,t,s){xs(Qe(e)?e.map(a=>a.bind(t.proxy)):e.bind(t.proxy),t,s)}function q0(e,t,s,a){const n=a.includes(".")?k0(s,a):()=>s[a];if(jt(e)){const r=t[e];nt(r)&&Xt(n,r)}else if(nt(e))Xt(n,e.bind(s));else if(Ht(e))if(Qe(e))e.forEach(r=>q0(r,t,s,a));else{const r=nt(e.handler)?e.handler.bind(s):t[e.handler];nt(r)&&Xt(n,r,e)}}function V0(e){const t=e.type,{mixins:s,extends:a}=t,{mixins:n,optionsCache:r,config:{optionMergeStrategies:o}}=e.appContext,l=r.get(t);let v;return l?v=l:!n.length&&!s&&!a?v=t:(v={},n.length&&n.forEach(c=>Zn(v,c,o,!0)),Zn(v,t,o)),r.set(t,v),v}function Zn(e,t,s,a=!1){const{mixins:n,extends:r}=t;r&&Zn(e,r,s,!0),n&&n.forEach(o=>Zn(e,o,s,!0));for(const o in t)if(!(a&&o==="expose")){const l=Bf[o]||s&&s[o];e[o]=l?l(e[o],t[o]):t[o]}return e}const Bf={data:z0,props:Aa,emits:Aa,methods:Aa,computed:Aa,beforeCreate:Jt,created:Jt,beforeMount:Jt,mounted:Jt,beforeUpdate:Jt,updated:Jt,beforeDestroy:Jt,beforeUnmount:Jt,destroyed:Jt,unmounted:Jt,activated:Jt,deactivated:Jt,errorCaptured:Jt,serverPrefetch:Jt,components:Aa,directives:Aa,watch:Nf,provide:z0,inject:Lf};function z0(e,t){return t?e?function(){return Dt(nt(e)?e.call(this,this):e,nt(t)?t.call(this,this):t)}:t:e}function Lf(e,t){return Aa(go(e),go(t))}function go(e){if(Qe(e)){const t={};for(let s=0;s<e.length;s++)t[e[s]]=e[s];return t}return e}function Jt(e,t){return e?[...new Set([].concat(e,t))]:t}function Aa(e,t){return e?Dt(Dt(Object.create(null),e),t):t}function Nf(e,t){if(!e)return t;if(!t)return e;const s=Dt(Object.create(null),e);for(const a in t)s[a]=Jt(e[a],t[a]);return s}function jf(e,t,s,a=!1){const n={},r={};Cn(r,$n,1),e.propsDefaults=Object.create(null),Y0(e,t,n,r);for(const o in e.propsOptions[0])o in n||(n[o]=void 0);s?e.props=a?n:Jd(n):e.type.props?e.props=n:e.props=r,e.attrs=r}function Hf(e,t,s,a){const{props:n,attrs:r,vnode:{patchFlag:o}}=e,l=mt(n),[v]=e.propsOptions;let c=!1;if((a||o>0)&&!(o&16)){if(o&8){const m=e.vnode.dynamicProps;for(let u=0;u<m.length;u++){let p=m[u];if(zn(e.emitsOptions,p))continue;const y=t[p];if(v)if(ct(r,p))y!==r[p]&&(r[p]=y,c=!0);else{const i=bs(p);n[i]=bo(v,l,i,y,e,!1)}else y!==r[p]&&(r[p]=y,c=!0)}}}else{Y0(e,t,n,r)&&(c=!0);let m;for(const u in l)(!t||!ct(t,u)&&((m=Hs(u))===u||!ct(t,m)))&&(v?s&&(s[u]!==void 0||s[m]!==void 0)&&(n[u]=bo(v,l,u,void 0,e,!0)):delete n[u]);if(r!==l)for(const u in r)(!t||!ct(t,u)&&!0)&&(delete r[u],c=!0)}c&&Zs(e,"set","$attrs")}function Y0(e,t,s,a){const[n,r]=e.propsOptions;let o=!1,l;if(t)for(let v in t){if(Rn(v))continue;const c=t[v];let m;n&&ct(n,m=bs(v))?!r||!r.includes(m)?s[m]=c:(l||(l={}))[m]=c:zn(e.emitsOptions,v)||(!(v in a)||c!==a[v])&&(a[v]=c,o=!0)}if(r){const v=mt(s),c=l||wt;for(let m=0;m<r.length;m++){const u=r[m];s[u]=bo(n,v,u,c[u],e,!ct(c,u))}}return o}function bo(e,t,s,a,n,r){const o=e[s];if(o!=null){const l=ct(o,"default");if(l&&a===void 0){const v=o.default;if(o.type!==Function&&nt(v)){const{propsDefaults:c}=n;s in c?a=c[s]:(lr(n),a=c[s]=v.call(null,t),Oa())}else a=v}o[0]&&(r&&!l?a=!1:o[1]&&(a===""||a===Hs(s))&&(a=!0))}return a}function X0(e,t,s=!1){const a=t.propsCache,n=a.get(e);if(n)return n;const r=e.props,o={},l=[];let v=!1;if(!nt(e)){const m=u=>{v=!0;const[p,y]=X0(u,t,!0);Dt(o,p),y&&l.push(...y)};!s&&t.mixins.length&&t.mixins.forEach(m),e.extends&&m(e.extends),e.mixins&&e.mixins.forEach(m)}if(!r&&!v)return a.set(e,er),er;if(Qe(r))for(let m=0;m<r.length;m++){const u=bs(r[m]);K0(u)&&(o[u]=wt)}else if(r)for(const m in r){const u=bs(m);if(K0(u)){const p=r[m],y=o[u]=Qe(p)||nt(p)?{type:p}:p;if(y){const i=Z0(Boolean,y.type),H=Z0(String,y.type);y[0]=i>-1,y[1]=H<0||i<H,(i>-1||ct(y,"default"))&&l.push(u)}}}const c=[o,l];return a.set(e,c),c}function K0(e){return e[0]!=="$"}function G0(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:e===null?"null":""}function W0(e,t){return G0(e)===G0(t)}function Z0(e,t){return Qe(t)?t.findIndex(s=>W0(s,e)):nt(t)&&W0(t,e)?0:-1}const Q0=e=>e[0]==="_"||e==="$stable",yo=e=>Qe(e)?e.map(Ps):[Ps(e)],Pf=(e,t,s)=>{if(t._n)return t;const a=Xe((...n)=>yo(t(...n)),s);return a._c=!1,a},J0=(e,t,s)=>{const a=e._ctx;for(const n in e){if(Q0(n))continue;const r=e[n];if(nt(r))t[n]=Pf(n,r,a);else if(r!=null){const o=yo(r);t[n]=()=>o}}},$0=(e,t)=>{const s=yo(t);e.slots.default=()=>s},Ff=(e,t)=>{if(e.vnode.shapeFlag&32){const s=t._;s?(e.slots=mt(t),Cn(t,"_",s)):J0(t,e.slots={})}else e.slots={},t&&$0(e,t);Cn(e.slots,$n,1)},Df=(e,t,s)=>{const{vnode:a,slots:n}=e;let r=!0,o=wt;if(a.shapeFlag&32){const l=t._;l?s&&l===1?r=!1:(Dt(n,t),!s&&l===1&&delete n._):(r=!t.$stable,J0(t,n)),o=t}else t&&($0(e,t),o={default:1});if(r)for(const l in n)!Q0(l)&&!(l in o)&&delete n[l]};function ec(){return{app:null,config:{isNativeTag:_d,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Uf=0;function qf(e,t){return function(a,n=null){nt(a)||(a=Object.assign({},a)),n!=null&&!Ht(n)&&(n=null);const r=ec(),o=new Set;let l=!1;const v=r.app={_uid:Uf++,_component:a,_props:n,_container:null,_context:r,_instance:null,version:om,get config(){return r.config},set config(c){},use(c,...m){return o.has(c)||(c&&nt(c.install)?(o.add(c),c.install(v,...m)):nt(c)&&(o.add(c),c(v,...m))),v},mixin(c){return r.mixins.includes(c)||r.mixins.push(c),v},component(c,m){return m?(r.components[c]=m,v):r.components[c]},directive(c,m){return m?(r.directives[c]=m,v):r.directives[c]},mount(c,m,u){if(!l){const p=Re(a,n);return p.appContext=r,m&&t?t(p,c):e(p,c,u),l=!0,v._container=c,c.__vue_app__=v,ti(p.component)||p.component.proxy}},unmount(){l&&(e(null,v._container),delete v._container.__vue_app__)},provide(c,m){return r.provides[c]=m,v}};return v}}function xo(e,t,s,a,n=!1){if(Qe(e)){e.forEach((p,y)=>xo(p,t&&(Qe(t)?t[y]:t),s,a,n));return}if(Lr(a)&&!n)return;const r=a.shapeFlag&4?ti(a.component)||a.component.proxy:a.el,o=n?null:r,{i:l,r:v}=e,c=t&&t.r,m=l.refs===wt?l.refs={}:l.refs,u=l.setupState;if(c!=null&&c!==v&&(jt(c)?(m[c]=null,ct(u,c)&&(u[c]=null)):zt(c)&&(c.value=null)),nt(v))ia(v,l,12,[o,m]);else{const p=jt(v),y=zt(v);if(p||y){const i=()=>{if(e.f){const H=p?m[v]:v.value;n?Qe(H)&&qi(H,r):Qe(H)?H.includes(r)||H.push(r):p?(m[v]=[r],ct(u,v)&&(u[v]=m[v])):(v.value=[r],e.k&&(m[e.k]=v.value))}else p?(m[v]=o,ct(u,v)&&(u[v]=o)):y&&(v.value=o,e.k&&(m[e.k]=o))};o?(i.id=-1,es(i,s)):i()}}}const es=_f;function Vf(e){return zf(e)}function zf(e,t){const s=wd();s.__VUE__=!0;const{insert:a,remove:n,patchProp:r,createElement:o,createText:l,createComment:v,setText:c,setElementText:m,parentNode:u,nextSibling:p,setScopeId:y=ks,cloneNode:i,insertStaticContent:H}=e,L=(D,z,te,le=null,ue=null,xe=null,Ee=!1,be=null,Se=!!z.dynamicChildren)=>{if(D===z)return;D&&!Ra(D,z)&&(le=De(D),Z(D,ue,xe,!0),D=null),z.patchFlag===-2&&(Se=!1,z.dynamicChildren=null);const{type:he,ref:Pe,shapeFlag:Ne}=z;switch(he){case Mo:N(D,z,te,le);break;case Ss:h(D,z,te,le);break;case To:D==null&&k(z,te,le,Ee);break;case ut:g(D,z,te,le,ue,xe,Ee,be,Se);break;default:Ne&1?B(D,z,te,le,ue,xe,Ee,be,Se):Ne&6?M(D,z,te,le,ue,xe,Ee,be,Se):(Ne&64||Ne&128)&&he.process(D,z,te,le,ue,xe,Ee,be,Se,me)}Pe!=null&&ue&&xo(Pe,D&&D.ref,xe,z||D,!z)},N=(D,z,te,le)=>{if(D==null)a(z.el=l(z.children),te,le);else{const ue=z.el=D.el;z.children!==D.children&&c(ue,z.children)}},h=(D,z,te,le)=>{D==null?a(z.el=v(z.children||""),te,le):z.el=D.el},k=(D,z,te,le)=>{[D.el,D.anchor]=H(D.children,z,te,le,D.el,D.anchor)},C=({el:D,anchor:z},te,le)=>{let ue;for(;D&&D!==z;)ue=p(D),a(D,te,le),D=ue;a(z,te,le)},A=({el:D,anchor:z})=>{let te;for(;D&&D!==z;)te=p(D),n(D),D=te;n(z)},B=(D,z,te,le,ue,xe,Ee,be,Se)=>{Ee=Ee||z.type==="svg",D==null?d(z,te,le,ue,xe,Ee,be,Se):_(D,z,ue,xe,Ee,be,Se)},d=(D,z,te,le,ue,xe,Ee,be)=>{let Se,he;const{type:Pe,props:Ne,shapeFlag:Fe,transition:Ue,patchFlag:We,dirs:ce}=D;if(D.el&&i!==void 0&&We===-1)Se=D.el=i(D.el);else{if(Se=D.el=o(D.type,xe,Ne&&Ne.is,Ne),Fe&8?m(Se,D.children):Fe&16&&S(D.children,Se,null,le,ue,xe&&Pe!=="foreignObject",Ee,be),ce&&Ea(D,null,le,"created"),Ne){for(const $ in Ne)$!=="value"&&!Rn($)&&r(Se,$,null,Ne[$],xe,D.children,le,ue,ve);"value"in Ne&&r(Se,"value",null,Ne.value),(he=Ne.onVnodeBeforeMount)&&Fs(he,le,D)}E(Se,D,D.scopeId,Ee,le)}ce&&Ea(D,null,le,"beforeMount");const ye=(!ue||ue&&!ue.pendingBranch)&&Ue&&!Ue.persisted;ye&&Ue.beforeEnter(Se),a(Se,z,te),((he=Ne&&Ne.onVnodeMounted)||ye||ce)&&es(()=>{he&&Fs(he,le,D),ye&&Ue.enter(Se),ce&&Ea(D,null,le,"mounted")},ue)},E=(D,z,te,le,ue)=>{if(te&&y(D,te),le)for(let xe=0;xe<le.length;xe++)y(D,le[xe]);if(ue){let xe=ue.subTree;if(z===xe){const Ee=ue.vnode;E(D,Ee,Ee.scopeId,Ee.slotScopeIds,ue.parent)}}},S=(D,z,te,le,ue,xe,Ee,be,Se=0)=>{for(let he=Se;he<D.length;he++){const Pe=D[he]=be?da(D[he]):Ps(D[he]);L(null,Pe,z,te,le,ue,xe,Ee,be)}},_=(D,z,te,le,ue,xe,Ee)=>{const be=z.el=D.el;let{patchFlag:Se,dynamicChildren:he,dirs:Pe}=z;Se|=D.patchFlag&16;const Ne=D.props||wt,Fe=z.props||wt;let Ue;te&&ka(te,!1),(Ue=Fe.onVnodeBeforeUpdate)&&Fs(Ue,te,z,D),Pe&&Ea(z,D,te,"beforeUpdate"),te&&ka(te,!0);const We=ue&&z.type!=="foreignObject";if(he?x(D.dynamicChildren,he,be,te,le,We,xe):Ee||V(D,z,be,null,te,le,We,xe,!1),Se>0){if(Se&16)b(be,z,Ne,Fe,te,le,ue);else if(Se&2&&Ne.class!==Fe.class&&r(be,"class",null,Fe.class,ue),Se&4&&r(be,"style",Ne.style,Fe.style,ue),Se&8){const ce=z.dynamicProps;for(let ye=0;ye<ce.length;ye++){const $=ce[ye],Ce=Ne[$],R=Fe[$];(R!==Ce||$==="value")&&r(be,$,Ce,R,ue,D.children,te,le,ve)}}Se&1&&D.children!==z.children&&m(be,z.children)}else!Ee&&he==null&&b(be,z,Ne,Fe,te,le,ue);((Ue=Fe.onVnodeUpdated)||Pe)&&es(()=>{Ue&&Fs(Ue,te,z,D),Pe&&Ea(z,D,te,"updated")},le)},x=(D,z,te,le,ue,xe,Ee)=>{for(let be=0;be<z.length;be++){const Se=D[be],he=z[be],Pe=Se.el&&(Se.type===ut||!Ra(Se,he)||Se.shapeFlag&70)?u(Se.el):te;L(Se,he,Pe,null,le,ue,xe,Ee,!0)}},b=(D,z,te,le,ue,xe,Ee)=>{if(te!==le){for(const be in le){if(Rn(be))continue;const Se=le[be],he=te[be];Se!==he&&be!=="value"&&r(D,be,he,Se,Ee,z.children,ue,xe,ve)}if(te!==wt)for(const be in te)!Rn(be)&&!(be in le)&&r(D,be,te[be],null,Ee,z.children,ue,xe,ve);"value"in le&&r(D,"value",te.value,le.value)}},g=(D,z,te,le,ue,xe,Ee,be,Se)=>{const he=z.el=D?D.el:l(""),Pe=z.anchor=D?D.anchor:l("");let{patchFlag:Ne,dynamicChildren:Fe,slotScopeIds:Ue}=z;Ue&&(be=be?be.concat(Ue):Ue),D==null?(a(he,te,le),a(Pe,te,le),S(z.children,te,Pe,ue,xe,Ee,be,Se)):Ne>0&&Ne&64&&Fe&&D.dynamicChildren?(x(D.dynamicChildren,Fe,te,ue,xe,Ee,be),(z.key!=null||ue&&z===ue.subTree)&&wo(D,z,!0)):V(D,z,te,Pe,ue,xe,Ee,be,Se)},M=(D,z,te,le,ue,xe,Ee,be,Se)=>{z.slotScopeIds=be,D==null?z.shapeFlag&512?ue.ctx.activate(z,te,le,Ee,Se):w(z,te,le,ue,xe,Ee,Se):j(D,z,Se)},w=(D,z,te,le,ue,xe,Ee)=>{const be=D.component=em(D,le,ue);if(Xn(D)&&(be.ctx.renderer=me),tm(be),be.asyncDep){if(ue&&ue.registerDep(be,X),!D.el){const Se=be.subTree=Re(Ss);h(null,Se,z,te)}return}X(be,D,z,te,ue,xe,Ee)},j=(D,z,te)=>{const le=z.component=D.component;if(mf(D,z,te))if(le.asyncDep&&!le.asyncResolved){F(le,z,te);return}else le.next=z,of(le.update),le.update();else z.el=D.el,le.vnode=z},X=(D,z,te,le,ue,xe,Ee)=>{const be=()=>{if(D.isMounted){let{next:Pe,bu:Ne,u:Fe,parent:Ue,vnode:We}=D,ce=Pe,ye;ka(D,!1),Pe?(Pe.el=We.el,F(D,Pe,Ee)):Pe=We,Ne&&Xi(Ne),(ye=Pe.props&&Pe.props.onVnodeBeforeUpdate)&&Fs(ye,Ue,Pe,We),ka(D,!0);const $=lo(D),Ce=D.subTree;D.subTree=$,L(Ce,$,u(Ce.el),De(Ce),D,ue,xe),Pe.el=$.el,ce===null&&hf(D,$.el),Fe&&es(Fe,ue),(ye=Pe.props&&Pe.props.onVnodeUpdated)&&es(()=>Fs(ye,Ue,Pe,We),ue)}else{let Pe;const{el:Ne,props:Fe}=z,{bm:Ue,m:We,parent:ce}=D,ye=Lr(z);if(ka(D,!1),Ue&&Xi(Ue),!ye&&(Pe=Fe&&Fe.onVnodeBeforeMount)&&Fs(Pe,ce,z),ka(D,!0),Ne&&ot){const $=()=>{D.subTree=lo(D),ot(Ne,D.subTree,D,ue,null)};ye?z.type.__asyncLoader().then(()=>!D.isUnmounted&&$()):$()}else{const $=D.subTree=lo(D);L(null,$,te,le,D,ue,xe),z.el=$.el}if(We&&es(We,ue),!ye&&(Pe=Fe&&Fe.onVnodeMounted)){const $=z;es(()=>Fs(Pe,ce,$),ue)}(z.shapeFlag&256||ce&&Lr(ce.vnode)&&ce.vnode.shapeFlag&256)&&D.a&&es(D.a,ue),D.isMounted=!0,z=te=le=null}},Se=D.effect=new Qi(be,()=>g0(he),D.scope),he=D.update=()=>Se.run();he.id=D.uid,ka(D,!0),he()},F=(D,z,te)=>{z.component=D;const le=D.vnode.props;D.vnode=z,D.next=null,Hf(D,z.props,le,te),Df(D,z.children,te),sr(),Vn(void 0,D.update),ar()},V=(D,z,te,le,ue,xe,Ee,be,Se=!1)=>{const he=D&&D.children,Pe=D?D.shapeFlag:0,Ne=z.children,{patchFlag:Fe,shapeFlag:Ue}=z;if(Fe>0){if(Fe&128){T(he,Ne,te,le,ue,xe,Ee,be,Se);return}else if(Fe&256){f(he,Ne,te,le,ue,xe,Ee,be,Se);return}}Ue&8?(Pe&16&&ve(he,ue,xe),Ne!==he&&m(te,Ne)):Pe&16?Ue&16?T(he,Ne,te,le,ue,xe,Ee,be,Se):ve(he,ue,xe,!0):(Pe&8&&m(te,""),Ue&16&&S(Ne,te,le,ue,xe,Ee,be,Se))},f=(D,z,te,le,ue,xe,Ee,be,Se)=>{D=D||er,z=z||er;const he=D.length,Pe=z.length,Ne=Math.min(he,Pe);let Fe;for(Fe=0;Fe<Ne;Fe++){const Ue=z[Fe]=Se?da(z[Fe]):Ps(z[Fe]);L(D[Fe],Ue,te,null,ue,xe,Ee,be,Se)}he>Pe?ve(D,ue,xe,!0,!1,Ne):S(z,te,le,ue,xe,Ee,be,Se,Ne)},T=(D,z,te,le,ue,xe,Ee,be,Se)=>{let he=0;const Pe=z.length;let Ne=D.length-1,Fe=Pe-1;for(;he<=Ne&&he<=Fe;){const Ue=D[he],We=z[he]=Se?da(z[he]):Ps(z[he]);if(Ra(Ue,We))L(Ue,We,te,null,ue,xe,Ee,be,Se);else break;he++}for(;he<=Ne&&he<=Fe;){const Ue=D[Ne],We=z[Fe]=Se?da(z[Fe]):Ps(z[Fe]);if(Ra(Ue,We))L(Ue,We,te,null,ue,xe,Ee,be,Se);else break;Ne--,Fe--}if(he>Ne){if(he<=Fe){const Ue=Fe+1,We=Ue<Pe?z[Ue].el:le;for(;he<=Fe;)L(null,z[he]=Se?da(z[he]):Ps(z[he]),te,We,ue,xe,Ee,be,Se),he++}}else if(he>Fe)for(;he<=Ne;)Z(D[he],ue,xe,!0),he++;else{const Ue=he,We=he,ce=new Map;for(he=We;he<=Fe;he++){const Y=z[he]=Se?da(z[he]):Ps(z[he]);Y.key!=null&&ce.set(Y.key,he)}let ye,$=0;const Ce=Fe-We+1;let R=!1,I=0;const U=new Array(Ce);for(he=0;he<Ce;he++)U[he]=0;for(he=Ue;he<=Ne;he++){const Y=D[he];if($>=Ce){Z(Y,ue,xe,!0);continue}let P;if(Y.key!=null)P=ce.get(Y.key);else for(ye=We;ye<=Fe;ye++)if(U[ye-We]===0&&Ra(Y,z[ye])){P=ye;break}P===void 0?Z(Y,ue,xe,!0):(U[P-We]=he+1,P>=I?I=P:R=!0,L(Y,z[P],te,null,ue,xe,Ee,be,Se),$++)}const q=R?Yf(U):er;for(ye=q.length-1,he=Ce-1;he>=0;he--){const Y=We+he,P=z[Y],G=Y+1<Pe?z[Y+1].el:le;U[he]===0?L(null,P,te,G,ue,xe,Ee,be,Se):R&&(ye<0||he!==q[ye]?W(P,te,G,2):ye--)}}},W=(D,z,te,le,ue=null)=>{const{el:xe,type:Ee,transition:be,children:Se,shapeFlag:he}=D;if(he&6){W(D.component.subTree,z,te,le);return}if(he&128){D.suspense.move(z,te,le);return}if(he&64){Ee.move(D,z,te,me);return}if(Ee===ut){a(xe,z,te);for(let Ne=0;Ne<Se.length;Ne++)W(Se[Ne],z,te,le);a(D.anchor,z,te);return}if(Ee===To){C(D,z,te);return}if(le!==2&&he&1&&be)if(le===0)be.beforeEnter(xe),a(xe,z,te),es(()=>be.enter(xe),ue);else{const{leave:Ne,delayLeave:Fe,afterLeave:Ue}=be,We=()=>a(xe,z,te),ce=()=>{Ne(xe,()=>{We(),Ue&&Ue()})};Fe?Fe(xe,We,ce):ce()}else a(xe,z,te)},Z=(D,z,te,le=!1,ue=!1)=>{const{type:xe,props:Ee,ref:be,children:Se,dynamicChildren:he,shapeFlag:Pe,patchFlag:Ne,dirs:Fe}=D;if(be!=null&&xo(be,null,te,D,!0),Pe&256){z.ctx.deactivate(D);return}const Ue=Pe&1&&Fe,We=!Lr(D);let ce;if(We&&(ce=Ee&&Ee.onVnodeBeforeUnmount)&&Fs(ce,z,D),Pe&6)Te(D.component,te,le);else{if(Pe&128){D.suspense.unmount(te,le);return}Ue&&Ea(D,null,z,"beforeUnmount"),Pe&64?D.type.remove(D,z,te,ue,me,le):he&&(xe!==ut||Ne>0&&Ne&64)?ve(he,z,te,!1,!0):(xe===ut&&Ne&384||!ue&&Pe&16)&&ve(Se,z,te),le&&de(D)}(We&&(ce=Ee&&Ee.onVnodeUnmounted)||Ue)&&es(()=>{ce&&Fs(ce,z,D),Ue&&Ea(D,null,z,"unmounted")},te)},de=D=>{const{type:z,el:te,anchor:le,transition:ue}=D;if(z===ut){Me(te,le);return}if(z===To){A(D);return}const xe=()=>{n(te),ue&&!ue.persisted&&ue.afterLeave&&ue.afterLeave()};if(D.shapeFlag&1&&ue&&!ue.persisted){const{leave:Ee,delayLeave:be}=ue,Se=()=>Ee(te,xe);be?be(D.el,xe,Se):Se()}else xe()},Me=(D,z)=>{let te;for(;D!==z;)te=p(D),n(D),D=te;n(z)},Te=(D,z,te)=>{const{bum:le,scope:ue,update:xe,subTree:Ee,um:be}=D;le&&Xi(le),ue.stop(),xe&&(xe.active=!1,Z(Ee,D,z,te)),be&&es(be,z),es(()=>{D.isUnmounted=!0},z),z&&z.pendingBranch&&!z.isUnmounted&&D.asyncDep&&!D.asyncResolved&&D.suspenseId===z.pendingId&&(z.deps--,z.deps===0&&z.resolve())},ve=(D,z,te,le=!1,ue=!1,xe=0)=>{for(let Ee=xe;Ee<D.length;Ee++)Z(D[Ee],z,te,le,ue)},De=D=>D.shapeFlag&6?De(D.component.subTree):D.shapeFlag&128?D.suspense.next():p(D.anchor||D.el),Le=(D,z,te)=>{D==null?z._vnode&&Z(z._vnode,null,null,!0):L(z._vnode||null,D,z,null,null,null,te),x0(),z._vnode=D},me={p:L,um:Z,m:W,r:de,mt:w,mc:S,pc:V,pbc:x,n:De,o:e};let Ge,ot;return t&&([Ge,ot]=t(me)),{render:Le,hydrate:Ge,createApp:qf(Le,Ge)}}function ka({effect:e,update:t},s){e.allowRecurse=t.allowRecurse=s}function wo(e,t,s=!1){const a=e.children,n=t.children;if(Qe(a)&&Qe(n))for(let r=0;r<a.length;r++){const o=a[r];let l=n[r];l.shapeFlag&1&&!l.dynamicChildren&&((l.patchFlag<=0||l.patchFlag===32)&&(l=n[r]=da(n[r]),l.el=o.el),s||wo(o,l))}}function Yf(e){const t=e.slice(),s=[0];let a,n,r,o,l;const v=e.length;for(a=0;a<v;a++){const c=e[a];if(c!==0){if(n=s[s.length-1],e[n]<c){t[a]=n,s.push(a);continue}for(r=0,o=s.length-1;r<o;)l=r+o>>1,e[s[l]]<c?r=l+1:o=l;c<e[s[r]]&&(r>0&&(t[a]=s[r-1]),s[r]=a)}}for(r=s.length,o=s[r-1];r-- >0;)s[r]=o,o=t[o];return s}const Xf=e=>e.__isTeleport,Nr=e=>e&&(e.disabled||e.disabled===""),tc=e=>typeof SVGElement!="undefined"&&e instanceof SVGElement,So=(e,t)=>{const s=e&&e.to;return jt(s)?t?t(s):null:s},Kf={__isTeleport:!0,process(e,t,s,a,n,r,o,l,v,c){const{mc:m,pc:u,pbc:p,o:{insert:y,querySelector:i,createText:H,createComment:L}}=c,N=Nr(t.props);let{shapeFlag:h,children:k,dynamicChildren:C}=t;if(e==null){const A=t.el=H(""),B=t.anchor=H("");y(A,s,a),y(B,s,a);const d=t.target=So(t.props,i),E=t.targetAnchor=H("");d&&(y(E,d),o=o||tc(d));const S=(_,x)=>{h&16&&m(k,_,x,n,r,o,l,v)};N?S(s,B):d&&S(d,E)}else{t.el=e.el;const A=t.anchor=e.anchor,B=t.target=e.target,d=t.targetAnchor=e.targetAnchor,E=Nr(e.props),S=E?s:B,_=E?A:d;if(o=o||tc(B),C?(p(e.dynamicChildren,C,S,n,r,o,l),wo(e,t,!0)):v||u(e,t,S,_,n,r,o,l,!1),N)E||Qn(t,s,A,c,1);else if((t.props&&t.props.to)!==(e.props&&e.props.to)){const x=t.target=So(t.props,i);x&&Qn(t,x,null,c,0)}else E&&Qn(t,B,d,c,1)}},remove(e,t,s,a,{um:n,o:{remove:r}},o){const{shapeFlag:l,children:v,anchor:c,targetAnchor:m,target:u,props:p}=e;if(u&&r(m),(o||!Nr(p))&&(r(c),l&16))for(let y=0;y<v.length;y++){const i=v[y];n(i,t,s,!0,!!i.dynamicChildren)}},move:Qn,hydrate:Gf};function Qn(e,t,s,{o:{insert:a},m:n},r=2){r===0&&a(e.targetAnchor,t,s);const{el:o,anchor:l,shapeFlag:v,children:c,props:m}=e,u=r===2;if(u&&a(o,t,s),(!u||Nr(m))&&v&16)for(let p=0;p<c.length;p++)n(c[p],t,s,2);u&&a(l,t,s)}function Gf(e,t,s,a,n,r,{o:{nextSibling:o,parentNode:l,querySelector:v}},c){const m=t.target=So(t.props,v);if(m){const u=m._lpa||m.firstChild;if(t.shapeFlag&16)if(Nr(t.props))t.anchor=c(o(e),t,l(e),s,a,n,r),t.targetAnchor=u;else{t.anchor=o(e);let p=u;for(;p;)if(p=o(p),p&&p.nodeType===8&&p.data==="teleport anchor"){t.targetAnchor=p,m._lpa=t.targetAnchor&&o(t.targetAnchor);break}c(u,t,m,s,a,n,r)}}return t.anchor&&o(t.anchor)}const Wf=Kf,ut=Symbol(void 0),Mo=Symbol(void 0),Ss=Symbol(void 0),To=Symbol(void 0),jr=[];let Os=null;function Q(e=!1){jr.push(Os=e?null:[])}function Zf(){jr.pop(),Os=jr[jr.length-1]||null}let Hr=1;function sc(e){Hr+=e}function ac(e){return e.dynamicChildren=Hr>0?Os||er:null,Zf(),Hr>0&&Os&&Os.push(e),e}function ne(e,t,s,a,n,r){return ac(fe(e,t,s,a,n,r,!0))}function ht(e,t,s,a,n){return ac(Re(e,t,s,a,n,!0))}function Jn(e){return e?e.__v_isVNode===!0:!1}function Ra(e,t){return e.type===t.type&&e.key===t.key}const $n="__vInternal",rc=({key:e})=>e!=null?e:null,ei=({ref:e,ref_key:t,ref_for:s})=>e!=null?jt(e)||zt(e)||nt(e)?{i:Yt,r:e,k:t,f:!!s}:e:null;function fe(e,t=null,s=null,a=0,n=null,r=e===ut?0:1,o=!1,l=!1){const v={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&rc(t),ref:t&&ei(t),scopeId:M0,slotScopeIds:null,children:s,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:a,dynamicProps:n,dynamicChildren:null,appContext:null};return l?(Eo(v,s),r&128&&e.normalize(v)):s&&(v.shapeFlag|=jt(s)?8:16),Hr>0&&!o&&Os&&(v.patchFlag>0||r&6)&&v.patchFlag!==32&&Os.push(v),v}const Re=Qf;function Qf(e,t=null,s=null,a=0,n=null,r=!1){if((!e||e===P0)&&(e=Ss),Jn(e)){const l=ca(e,t,!0);return s&&Eo(l,s),Hr>0&&!r&&Os&&(l.shapeFlag&6?Os[Os.indexOf(e)]=l:Os.push(l)),l.patchFlag|=-2,l}if(im(e)&&(e=e.__vccOpts),t){t=_t(t);let{class:l,style:v}=t;l&&!jt(l)&&(t.class=st(l)),Ht(v)&&(d0(v)&&!Qe(v)&&(v=Dt({},v)),t.style=xt(v))}const o=jt(e)?1:vf(e)?128:Xf(e)?64:Ht(e)?4:nt(e)?2:0;return fe(e,t,s,a,n,o,r,!0)}function _t(e){return e?d0(e)||$n in e?Dt({},e):e:null}function ca(e,t,s=!1){const{props:a,ref:n,patchFlag:r,children:o}=e,l=t?Ao(a||{},t):a;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:l,key:l&&rc(l),ref:t&&t.ref?s&&n?Qe(n)?n.concat(ei(t)):[n,ei(t)]:ei(t):n,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:o,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==ut?r===-1?16:r|16:r,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&ca(e.ssContent),ssFallback:e.ssFallback&&ca(e.ssFallback),el:e.el,anchor:e.anchor}}function ua(e=" ",t=0){return Re(Mo,null,e,t)}function Ae(e="",t=!1){return t?(Q(),ht(Ss,null,e)):Re(Ss,null,e)}function Ps(e){return e==null||typeof e=="boolean"?Re(Ss):Qe(e)?Re(ut,null,e.slice()):typeof e=="object"?da(e):Re(Mo,null,String(e))}function da(e){return e.el===null||e.memo?e:ca(e)}function Eo(e,t){let s=0;const{shapeFlag:a}=e;if(t==null)t=null;else if(Qe(t))s=16;else if(typeof t=="object")if(a&65){const n=t.default;n&&(n._c&&(n._d=!1),Eo(e,n()),n._c&&(n._d=!0));return}else{s=32;const n=t._;!n&&!($n in t)?t._ctx=Yt:n===3&&Yt&&(Yt.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else nt(t)?(t={default:t,_ctx:Yt},s=32):(t=String(t),a&64?(s=16,t=[ua(t)]):s=8);e.children=t,e.shapeFlag|=s}function Ao(...e){const t={};for(let s=0;s<e.length;s++){const a=e[s];for(const n in a)if(n==="class")t.class!==a.class&&(t.class=st([t.class,a.class]));else if(n==="style")t.style=xt([t.style,a.style]);else if(An(n)){const r=t[n],o=a[n];o&&r!==o&&!(Qe(r)&&r.includes(o))&&(t[n]=r?[].concat(r,o):o)}else n!==""&&(t[n]=a[n])}return t}function Fs(e,t,s,a=null){xs(e,t,7,[s,a])}const Jf=ec();let $f=0;function em(e,t,s){const a=e.type,n=(t?t.appContext:e.appContext)||Jf,r={uid:$f++,vnode:e,type:a,parent:t,appContext:n,root:null,next:null,subTree:null,effect:null,update:null,scope:new Sd(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(n.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:X0(a,n),emitsOptions:S0(a,n),emit:null,emitted:null,propsDefaults:wt,inheritAttrs:a.inheritAttrs,ctx:wt,data:wt,props:wt,attrs:wt,slots:wt,refs:wt,setupState:wt,setupContext:null,suspense:s,suspenseId:s?s.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=t?t.root:r,r.emit=uf.bind(null,r),e.ce&&e.ce(r),r}let Ut=null;const ko=()=>Ut||Yt,lr=e=>{Ut=e,e.scope.on()},Oa=()=>{Ut&&Ut.scope.off(),Ut=null};function nc(e){return e.vnode.shapeFlag&4}let Pr=!1;function tm(e,t=!1){Pr=t;const{props:s,children:a}=e.vnode,n=nc(e);jf(e,s,n,t),Ff(e,a);const r=n?sm(e,t):void 0;return Pr=!1,r}function sm(e,t){const s=e.type;e.accessCache=Object.create(null),e.proxy=f0(new Proxy(e.ctx,Of));const{setup:a}=s;if(a){const n=e.setupContext=a.length>1?rm(e):null;lr(e),sr();const r=ia(a,e,0,[e.props,n]);if(ar(),Oa(),Vl(r)){if(r.then(Oa,Oa),t)return r.then(o=>{ic(e,o,t)}).catch(o=>{Dn(o,e,0)});e.asyncDep=r}else ic(e,r,t)}else lc(e,t)}function ic(e,t,s){nt(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Ht(t)&&(e.setupState=_0(t)),lc(e,s)}let oc;function lc(e,t,s){const a=e.type;if(!e.render){if(!t&&oc&&!a.render){const n=a.template;if(n){const{isCustomElement:r,compilerOptions:o}=e.appContext.config,{delimiters:l,compilerOptions:v}=a,c=Dt(Dt({isCustomElement:r,delimiters:l},o),v);a.render=oc(n,c)}}e.render=a.render||ks}lr(e),sr(),If(e),ar(),Oa()}function am(e){return new Proxy(e.attrs,{get(t,s){return us(e,"get","$attrs"),t[s]}})}function rm(e){const t=a=>{e.exposed=a||{}};let s;return{get attrs(){return s||(s=am(e))},slots:e.slots,emit:e.emit,expose:t}}function ti(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(_0(f0(e.exposed)),{get(t,s){if(s in t)return t[s];if(s in Wn)return Wn[s](e)}}))}function nm(e,t=!0){return nt(e)?e.displayName||e.name:e.name||t&&e.__name}function im(e){return nt(e)&&"__vccOpts"in e}const Ia=(e,t)=>af(e,t,Pr);function cc(e,t,s){const a=arguments.length;return a===2?Ht(t)&&!Qe(t)?Jn(t)?Re(e,null,[t]):Re(e,t):Re(e,null,t):(a>3?s=Array.prototype.slice.call(arguments,2):a===3&&Jn(s)&&(s=[s]),Re(e,t,s))}const om="3.2.37",lm="http://www.w3.org/2000/svg",Ca=typeof document!="undefined"?document:null,uc=Ca&&Ca.createElement("template"),cm={insert:(e,t,s)=>{t.insertBefore(e,s||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,s,a)=>{const n=t?Ca.createElementNS(lm,e):Ca.createElement(e,s?{is:s}:void 0);return e==="select"&&a&&a.multiple!=null&&n.setAttribute("multiple",a.multiple),n},createText:e=>Ca.createTextNode(e),createComment:e=>Ca.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Ca.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},cloneNode(e){const t=e.cloneNode(!0);return"_value"in e&&(t._value=e._value),t},insertStaticContent(e,t,s,a,n,r){const o=s?s.previousSibling:t.lastChild;if(n&&(n===r||n.nextSibling))for(;t.insertBefore(n.cloneNode(!0),s),!(n===r||!(n=n.nextSibling)););else{uc.innerHTML=a?`<svg>${e}</svg>`:e;const l=uc.content;if(a){const v=l.firstChild;for(;v.firstChild;)l.appendChild(v.firstChild);l.removeChild(v)}t.insertBefore(l,s)}return[o?o.nextSibling:t.firstChild,s?s.previousSibling:t.lastChild]}};function um(e,t,s){const a=e._vtc;a&&(t=(t?[t,...a]:[...a]).join(" ")),t==null?e.removeAttribute("class"):s?e.setAttribute("class",t):e.className=t}function dm(e,t,s){const a=e.style,n=jt(s);if(s&&!n){for(const r in s)Ro(a,r,s[r]);if(t&&!jt(t))for(const r in t)s[r]==null&&Ro(a,r,"")}else{const r=a.display;n?t!==s&&(a.cssText=s):t&&e.removeAttribute("style"),"_vod"in e&&(a.display=r)}}const dc=/\s*!important$/;function Ro(e,t,s){if(Qe(s))s.forEach(a=>Ro(e,t,a));else if(s==null&&(s=""),t.startsWith("--"))e.setProperty(t,s);else{const a=fm(e,t);dc.test(s)?e.setProperty(Hs(a),s.replace(dc,""),"important"):e[a]=s}}const fc=["Webkit","Moz","ms"],Oo={};function fm(e,t){const s=Oo[t];if(s)return s;let a=bs(t);if(a!=="filter"&&a in e)return Oo[t]=a;a=In(a);for(let n=0;n<fc.length;n++){const r=fc[n]+a;if(r in e)return Oo[t]=r}return t}const mc="http://www.w3.org/1999/xlink";function mm(e,t,s,a,n){if(a&&t.startsWith("xlink:"))s==null?e.removeAttributeNS(mc,t.slice(6,t.length)):e.setAttributeNS(mc,t,s);else{const r=fd(t);s==null||r&&!Dl(s)?e.removeAttribute(t):e.setAttribute(t,r?"":s)}}function hm(e,t,s,a,n,r,o){if(t==="innerHTML"||t==="textContent"){a&&o(a,n,r),e[t]=s==null?"":s;return}if(t==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=s;const v=s==null?"":s;(e.value!==v||e.tagName==="OPTION")&&(e.value=v),s==null&&e.removeAttribute(t);return}let l=!1;if(s===""||s==null){const v=typeof e[t];v==="boolean"?s=Dl(s):s==null&&v==="string"?(s="",l=!0):v==="number"&&(s=0,l=!0)}try{e[t]=s}catch{}l&&e.removeAttribute(t)}const[hc,vm]=(()=>{let e=Date.now,t=!1;if(typeof window!="undefined"){Date.now()>document.createEvent("Event").timeStamp&&(e=performance.now.bind(performance));const s=navigator.userAgent.match(/firefox\/(\d+)/i);t=!!(s&&Number(s[1])<=53)}return[e,t]})();let Io=0;const _m=Promise.resolve(),pm=()=>{Io=0},gm=()=>Io||(_m.then(pm),Io=hc());function bm(e,t,s,a){e.addEventListener(t,s,a)}function ym(e,t,s,a){e.removeEventListener(t,s,a)}function xm(e,t,s,a,n=null){const r=e._vei||(e._vei={}),o=r[t];if(a&&o)o.value=a;else{const[l,v]=wm(t);if(a){const c=r[t]=Sm(a,n);bm(e,l,c,v)}else o&&(ym(e,l,o,v),r[t]=void 0)}}const vc=/(?:Once|Passive|Capture)$/;function wm(e){let t;if(vc.test(e)){t={};let s;for(;s=e.match(vc);)e=e.slice(0,e.length-s[0].length),t[s[0].toLowerCase()]=!0}return[Hs(e.slice(2)),t]}function Sm(e,t){const s=a=>{const n=a.timeStamp||hc();(vm||n>=s.attached-1)&&xs(Mm(a,s.value),t,5,[a])};return s.value=e,s.attached=gm(),s}function Mm(e,t){if(Qe(t)){const s=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{s.call(e),e._stopped=!0},t.map(a=>n=>!n._stopped&&a&&a(n))}else return t}const _c=/^on[a-z]/,Tm=(e,t,s,a,n=!1,r,o,l,v)=>{t==="class"?um(e,a,n):t==="style"?dm(e,s,a):An(t)?Ui(t)||xm(e,t,s,a,o):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Em(e,t,a,n))?hm(e,t,a,r,o,l,v):(t==="true-value"?e._trueValue=a:t==="false-value"&&(e._falseValue=a),mm(e,t,a,n))};function Em(e,t,s,a){return a?!!(t==="innerHTML"||t==="textContent"||t in e&&_c.test(t)&&nt(s)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||_c.test(t)&&jt(s)?!1:t in e}function Am(e,t){const s=B0(e);class a extends Co{constructor(r){super(s,r,t)}}return a.def=s,a}const km=typeof HTMLElement!="undefined"?HTMLElement:class{};class Co extends km{constructor(t,s={},a){super(),this._def=t,this._props=s,this._instance=null,this._connected=!1,this._resolved=!1,this._numberProps=null,this.shadowRoot&&a?a(this._createVNode(),this.shadowRoot):this.attachShadow({mode:"open"})}connectedCallback(){this._connected=!0,this._instance||this._resolveDef()}disconnectedCallback(){this._connected=!1,qn(()=>{this._connected||(Rc(null,this.shadowRoot),this._instance=null)})}_resolveDef(){if(this._resolved)return;this._resolved=!0;for(let a=0;a<this.attributes.length;a++)this._setAttr(this.attributes[a].name);new MutationObserver(a=>{for(const n of a)this._setAttr(n.attributeName)}).observe(this,{attributes:!0});const t=a=>{const{props:n,styles:r}=a,o=!Qe(n),l=n?o?Object.keys(n):n:[];let v;if(o)for(const c in this._props){const m=n[c];(m===Number||m&&m.type===Number)&&(this._props[c]=Bn(this._props[c]),(v||(v=Object.create(null)))[c]=!0)}this._numberProps=v;for(const c of Object.keys(this))c[0]!=="_"&&this._setProp(c,this[c],!0,!1);for(const c of l.map(bs))Object.defineProperty(this,c,{get(){return this._getProp(c)},set(m){this._setProp(c,m)}});this._applyStyles(r),this._update()},s=this._def.__asyncLoader;s?s().then(t):t(this._def)}_setAttr(t){let s=this.getAttribute(t);this._numberProps&&this._numberProps[t]&&(s=Bn(s)),this._setProp(bs(t),s,!1)}_getProp(t){return this._props[t]}_setProp(t,s,a=!0,n=!0){s!==this._props[t]&&(this._props[t]=s,n&&this._instance&&this._update(),a&&(s===!0?this.setAttribute(Hs(t),""):typeof s=="string"||typeof s=="number"?this.setAttribute(Hs(t),s+""):s||this.removeAttribute(Hs(t))))}_update(){Rc(this._createVNode(),this.shadowRoot)}_createVNode(){const t=Re(this._def,Dt({},this._props));return this._instance||(t.ce=s=>{this._instance=s,s.isCE=!0,s.emit=(n,...r)=>{this.dispatchEvent(new CustomEvent(n,{detail:r}))};let a=this;for(;a=a&&(a.parentNode||a.host);)if(a instanceof Co){s.parent=a._instance;break}}),t}_applyStyles(t){t&&t.forEach(s=>{const a=document.createElement("style");a.textContent=s,this.shadowRoot.appendChild(a)})}}const fa="transition",Fr="animation",Ct=(e,{slots:t})=>cc(O0,bc(e),t);Ct.displayName="Transition";const pc={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Rm=Ct.props=Dt({},O0.props,pc),Ba=(e,t=[])=>{Qe(e)?e.forEach(s=>s(...t)):e&&e(...t)},gc=e=>e?Qe(e)?e.some(t=>t.length>1):e.length>1:!1;function bc(e){const t={};for(const b in e)b in pc||(t[b]=e[b]);if(e.css===!1)return t;const{name:s="v",type:a,duration:n,enterFromClass:r=`${s}-enter-from`,enterActiveClass:o=`${s}-enter-active`,enterToClass:l=`${s}-enter-to`,appearFromClass:v=r,appearActiveClass:c=o,appearToClass:m=l,leaveFromClass:u=`${s}-leave-from`,leaveActiveClass:p=`${s}-leave-active`,leaveToClass:y=`${s}-leave-to`}=e,i=Om(n),H=i&&i[0],L=i&&i[1],{onBeforeEnter:N,onEnter:h,onEnterCancelled:k,onLeave:C,onLeaveCancelled:A,onBeforeAppear:B=N,onAppear:d=h,onAppearCancelled:E=k}=t,S=(b,g,M)=>{ma(b,g?m:l),ma(b,g?c:o),M&&M()},_=(b,g)=>{b._isLeaving=!1,ma(b,u),ma(b,y),ma(b,p),g&&g()},x=b=>(g,M)=>{const w=b?d:h,j=()=>S(g,b,M);Ba(w,[g,j]),yc(()=>{ma(g,b?v:r),$s(g,b?m:l),gc(w)||xc(g,a,H,j)})};return Dt(t,{onBeforeEnter(b){Ba(N,[b]),$s(b,r),$s(b,o)},onBeforeAppear(b){Ba(B,[b]),$s(b,v),$s(b,c)},onEnter:x(!1),onAppear:x(!0),onLeave(b,g){b._isLeaving=!0;const M=()=>_(b,g);$s(b,u),Tc(),$s(b,p),yc(()=>{!b._isLeaving||(ma(b,u),$s(b,y),gc(C)||xc(b,a,L,M))}),Ba(C,[b,M])},onEnterCancelled(b){S(b,!1),Ba(k,[b])},onAppearCancelled(b){S(b,!0),Ba(E,[b])},onLeaveCancelled(b){_(b),Ba(A,[b])}})}function Om(e){if(e==null)return null;if(Ht(e))return[Bo(e.enter),Bo(e.leave)];{const t=Bo(e);return[t,t]}}function Bo(e){return Bn(e)}function $s(e,t){t.split(/\s+/).forEach(s=>s&&e.classList.add(s)),(e._vtc||(e._vtc=new Set)).add(t)}function ma(e,t){t.split(/\s+/).forEach(a=>a&&e.classList.remove(a));const{_vtc:s}=e;s&&(s.delete(t),s.size||(e._vtc=void 0))}function yc(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let Im=0;function xc(e,t,s,a){const n=e._endId=++Im,r=()=>{n===e._endId&&a()};if(s)return setTimeout(r,s);const{type:o,timeout:l,propCount:v}=wc(e,t);if(!o)return a();const c=o+"end";let m=0;const u=()=>{e.removeEventListener(c,p),r()},p=y=>{y.target===e&&++m>=v&&u()};setTimeout(()=>{m<v&&u()},l+1),e.addEventListener(c,p)}function wc(e,t){const s=window.getComputedStyle(e),a=i=>(s[i]||"").split(", "),n=a(fa+"Delay"),r=a(fa+"Duration"),o=Sc(n,r),l=a(Fr+"Delay"),v=a(Fr+"Duration"),c=Sc(l,v);let m=null,u=0,p=0;t===fa?o>0&&(m=fa,u=o,p=r.length):t===Fr?c>0&&(m=Fr,u=c,p=v.length):(u=Math.max(o,c),m=u>0?o>c?fa:Fr:null,p=m?m===fa?r.length:v.length:0);const y=m===fa&&/\b(transform|all)(,|$)/.test(s[fa+"Property"]);return{type:m,timeout:u,propCount:p,hasTransform:y}}function Sc(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((s,a)=>Mc(s)+Mc(e[a])))}function Mc(e){return Number(e.slice(0,-1).replace(",","."))*1e3}function Tc(){return document.body.offsetHeight}const Ec=new WeakMap,Ac=new WeakMap,Lo={name:"TransitionGroup",props:Dt({},Rm,{tag:String,moveClass:String}),setup(e,{slots:t}){const s=ko(),a=R0();let n,r;return N0(()=>{if(!n.length)return;const o=e.moveClass||`${e.name||"v"}-move`;if(!Nm(n[0].el,s.vnode.el,o))return;n.forEach(Cm),n.forEach(Bm);const l=n.filter(Lm);Tc(),l.forEach(v=>{const c=v.el,m=c.style;$s(c,o),m.transform=m.webkitTransform=m.transitionDuration="";const u=c._moveCb=p=>{p&&p.target!==c||(!p||/transform$/.test(p.propertyName))&&(c.removeEventListener("transitionend",u),c._moveCb=null,ma(c,o))};c.addEventListener("transitionend",u)})}),()=>{const o=mt(e),l=bc(o);let v=o.tag||ut;n=r,r=t.default?fo(t.default()):[];for(let c=0;c<r.length;c++){const m=r[c];m.key!=null&&Br(m,Cr(m,l,a,s))}if(n)for(let c=0;c<n.length;c++){const m=n[c];Br(m,Cr(m,l,a,s)),Ec.set(m,m.el.getBoundingClientRect())}return Re(v,null,r)}}};function Cm(e){const t=e.el;t._moveCb&&t._moveCb(),t._enterCb&&t._enterCb()}function Bm(e){Ac.set(e,e.el.getBoundingClientRect())}function Lm(e){const t=Ec.get(e),s=Ac.get(e),a=t.left-s.left,n=t.top-s.top;if(a||n){const r=e.el.style;return r.transform=r.webkitTransform=`translate(${a}px,${n}px)`,r.transitionDuration="0s",e}}function Nm(e,t,s){const a=e.cloneNode();e._vtc&&e._vtc.forEach(o=>{o.split(/\s+/).forEach(l=>l&&a.classList.remove(l))}),s.split(/\s+/).forEach(o=>o&&a.classList.add(o)),a.style.display="none";const n=t.nodeType===1?t:t.parentNode;n.appendChild(a);const{hasTransform:r}=wc(a);return n.removeChild(a),r}const jm=["ctrl","shift","alt","meta"],Hm={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>jm.some(s=>e[`${s}Key`]&&!t.includes(s))},Ds=(e,t)=>(s,...a)=>{for(let n=0;n<t.length;n++){const r=Hm[t[n]];if(r&&r(s,t))return}return e(s,...a)},Pm={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},La=(e,t)=>s=>{if(!("key"in s))return;const a=Hs(s.key);if(t.some(n=>n===a||Pm[n]===a))return e(s)},si={beforeMount(e,{value:t},{transition:s}){e._vod=e.style.display==="none"?"":e.style.display,s&&t?s.beforeEnter(e):Dr(e,t)},mounted(e,{value:t},{transition:s}){s&&t&&s.enter(e)},updated(e,{value:t,oldValue:s},{transition:a}){!t!=!s&&(a?t?(a.beforeEnter(e),Dr(e,!0),a.enter(e)):a.leave(e,()=>{Dr(e,!1)}):Dr(e,t))},beforeUnmount(e,{value:t}){Dr(e,t)}};function Dr(e,t){e.style.display=t?e._vod:"none"}const Fm=Dt({patchProp:Tm},cm);let kc;function Dm(){return kc||(kc=Vf(Fm))}const Rc=(...e)=>{Dm().render(...e)};var St=(e,t)=>{const s=e.__vccOpts||e;for(const[a,n]of t)s[a]=n;return s};const Um={name:"AppLoader",props:{show:{type:Boolean,default:!1},infinite:{type:Boolean,default:!1},type:{type:String,required:!0},messageId:{type:String,default:""}}},qm=fe("div",{id:"vac-circle"},null,-1),Vm=fe("div",{id:"vac-circle"},null,-1),zm=fe("div",{id:"vac-circle"},null,-1),Ym=fe("div",{id:"vac-circle"},null,-1),Xm=fe("div",{id:"vac-circle"},null,-1),Km=fe("div",{id:"vac-circle"},null,-1);function Gm(e,t,s,a,n,r){return Q(),ht(Ct,{name:"vac-fade-spinner",appear:""},{default:Xe(()=>[s.show?(Q(),ne("div",{key:0,class:st(["vac-loader-wrapper",{"vac-container-center":!s.infinite,"vac-container-top":s.infinite}])},[s.type==="rooms"?Oe(e.$slots,"spinner-icon-rooms",{key:0},()=>[qm]):Ae("",!0),s.type==="infinite-rooms"?Oe(e.$slots,"spinner-icon-infinite-rooms",{key:1},()=>[Vm]):Ae("",!0),s.type==="message-file"?Oe(e.$slots,"spinner-icon-message-file_"+s.messageId,{key:2},()=>[zm]):Ae("",!0),s.type==="room-file"?Oe(e.$slots,"spinner-icon-room-file",{key:3},()=>[Ym]):Ae("",!0),s.type==="messages"?Oe(e.$slots,"spinner-icon-messages",{key:4},()=>[Xm]):Ae("",!0),s.type==="infinite-messages"?Oe(e.$slots,"spinner-icon-infinite-messages",{key:5},()=>[Km]):Ae("",!0)],2)):Ae("",!0)]),_:3})}var ai=St(Um,[["render",Gm]]);const Wm={name:"SvgIcon",props:{name:{type:String,default:null},param:{type:String,default:null}},data(){return{svgItem:{search:{path:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"},add:{path:"M17,13H13V17H11V13H7V11H11V7H13V11H17M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"},toggle:{path:"M5,13L9,17L7.6,18.42L1.18,12L7.6,5.58L9,7L5,11H21V13H5M21,6V8H11V6H21M21,16V18H11V16H21Z"},menu:{path:"M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z"},close:{path:"M12,2C17.53,2 22,6.47 22,12C22,17.53 17.53,22 12,22C6.47,22 2,17.53 2,12C2,6.47 6.47,2 12,2M15.59,7L12,10.59L8.41,7L7,8.41L10.59,12L7,15.59L8.41,17L12,13.41L15.59,17L17,15.59L13.41,12L17,8.41L15.59,7Z"},file:{path:"M14,17H7V15H14M17,13H7V11H17M17,9H7V7H17M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3Z"},paperclip:{path:"M16.5,6V17.5A4,4 0 0,1 12.5,21.5A4,4 0 0,1 8.5,17.5V5A2.5,2.5 0 0,1 11,2.5A2.5,2.5 0 0,1 13.5,5V15.5A1,1 0 0,1 12.5,16.5A1,1 0 0,1 11.5,15.5V6H10V15.5A2.5,2.5 0 0,0 12.5,18A2.5,2.5 0 0,0 15,15.5V5A4,4 0 0,0 11,1A4,4 0 0,0 7,5V17.5A5.5,5.5 0 0,0 12.5,23A5.5,5.5 0 0,0 18,17.5V6H16.5Z"},"close-outline":{path:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"},send:{path:"M2,21L23,12L2,3V10L17,12L2,14V21Z"},emoji:{path:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm3.5-9c.83 0 1.5-.67 1.5-1.5S16.33 8 15.5 8 14 8.67 14 9.5s.67 1.5 1.5 1.5zm-7 0c.83 0 1.5-.67 1.5-1.5S9.33 8 8.5 8 7 8.67 7 9.5 7.67 11 8.5 11zm3.5 6.5c2.33 0 4.31-1.46 5.11-3.5H6.89c.8 2.04 2.78 3.5 5.11 3.5z"},document:{path:"M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z"},pencil:{path:"M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"},checkmark:{path:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"},"double-checkmark":{path:"M18 7l-1.41-1.41-6.34 6.34 1.41 1.41L18 7zm4.24-1.41L11.66 16.17 7.48 12l-1.41 1.41L11.66 19l12-12-1.42-1.41zM.41 13.41L6 19l1.41-1.41L1.83 12 .41 13.41z"},eye:{path:"M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"},dropdown:{path:"M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"},deleted:{path:"M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12C4,13.85 4.63,15.55 5.68,16.91L16.91,5.68C15.55,4.63 13.85,4 12,4M12,20A8,8 0 0,0 20,12C20,10.15 19.37,8.45 18.32,7.09L7.09,18.32C8.45,19.37 10.15,20 12,20Z"},microphone:{size:"large",path:"M432.8,216.4v39.2c0,45.2-15.3,84.3-45.2,118.4c-29.8,33.2-67.3,52.8-111.6,57.9v40.9h78.4c5.1,0,10.2,1.7,13.6,6c4.3,4.3,6,8.5,6,13.6c0,5.1-1.7,10.2-6,13.6c-4.3,4.3-8.5,6-13.6,6H157.6c-5.1,0-10.2-1.7-13.6-6c-4.3-4.3-6-8.5-6-13.6c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6H236v-40.9c-44.3-5.1-81.8-23.9-111.6-57.9s-45.2-73.3-45.2-118.4v-39.2c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6s10.2,1.7,13.6,6c4.3,4.3,6,8.5,6,13.6v39.2c0,37.5,13.6,70.7,40,97.1s59.6,40,97.1,40s70.7-13.6,97.1-40c26.4-26.4,40-59.6,40-97.1v-39.2c0-5.1,1.7-10.2,6-13.6c4.3-4.3,8.5-6,13.6-6c5.1,0,10.2,1.7,13.6,6C430.2,206.2,432.8,211.3,432.8,216.4z M353.5,98v157.6c0,27.3-9.4,50.3-29,69c-19.6,19.6-42.6,29-69,29s-50.3-9.4-69-29c-19.6-19.6-29-42.6-29-69V98c0-27.3,9.4-50.3,29-69c19.6-19.6,42.6-29,69-29s50.3,9.4,69,29C344.2,47.7,353.5,71.6,353.5,98z"},"audio-play":{size:"medium",path:"M43.331,21.237L7.233,0.397c-0.917-0.529-2.044-0.529-2.96,0c-0.916,0.528-1.48,1.505-1.48,2.563v41.684   c0,1.058,0.564,2.035,1.48,2.563c0.458,0.268,0.969,0.397,1.48,0.397c0.511,0,1.022-0.133,1.48-0.397l36.098-20.84   c0.918-0.529,1.479-1.506,1.479-2.564S44.247,21.767,43.331,21.237z"},"audio-pause":{size:"medium",path:"M17.991,40.976c0,3.662-2.969,6.631-6.631,6.631l0,0c-3.662,0-6.631-2.969-6.631-6.631V6.631C4.729,2.969,7.698,0,11.36,0l0,0c3.662,0,6.631,2.969,6.631,6.631V40.976z",path2:"M42.877,40.976c0,3.662-2.969,6.631-6.631,6.631l0,0c-3.662,0-6.631-2.969-6.631-6.631V6.631C29.616,2.969,32.585,0,36.246,0l0,0c3.662,0,6.631,2.969,6.631,6.631V40.976z"}}}},computed:{svgId(){const e=this.param?"-"+this.param:"";return`vac-icon-${this.name}${e}`},size(){const e=this.svgItem[this.name];return e.size==="large"?512:e.size==="medium"?48:24}}},Zm=["viewBox"],Qm=["id","d"],Jm=["id","d"];function $m(e,t,s,a,n,r){return Q(),ne("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",width:"24",height:"24",viewBox:`0 0 ${r.size} ${r.size}`},[fe("path",{id:r.svgId,d:n.svgItem[s.name].path},null,8,Qm),n.svgItem[s.name].path2?(Q(),ne("path",{key:0,id:r.svgId,d:n.svgItem[s.name].path2},null,8,Jm)):Ae("",!0)],8,Zm)}var Vt=St(Wm,[["render",$m]]);const eh={name:"RoomsSearch",components:{SvgIcon:Vt},props:{textMessages:{type:Object,required:!0},showSearch:{type:Boolean,required:!0},showAddRoom:{type:Boolean,required:!0},rooms:{type:Array,required:!0},loadingRooms:{type:Boolean,required:!0}},emits:["search-room","add-room"],computed:{showSearchBar(){return this.showSearch||this.showAddRoom}}},th={key:0,class:"vac-icon-search"},sh=["placeholder"];function ah(e,t,s,a,n,r){const o=Ke("svg-icon");return Q(),ne("div",{class:st({"vac-box-search":r.showSearchBar,"vac-box-empty":!r.showSearchBar})},[s.showSearch?(Q(),ne(ut,{key:0},[!s.loadingRooms&&s.rooms.length?(Q(),ne("div",th,[Oe(e.$slots,"search-icon",{},()=>[Re(o,{name:"search"})])])):Ae("",!0),!s.loadingRooms&&s.rooms.length?(Q(),ne("input",{key:1,type:"search",placeholder:s.textMessages.SEARCH,autocomplete:"off",class:"vac-input",onInput:t[0]||(t[0]=l=>e.$emit("search-room",l))},null,40,sh)):Ae("",!0)],64)):Ae("",!0),s.showAddRoom?(Q(),ne("div",{key:1,class:"vac-svg-button vac-add-icon",onClick:t[1]||(t[1]=l=>e.$emit("add-room"))},[Oe(e.$slots,"add-icon",{},()=>[Re(o,{name:"add"})])])):Ae("",!0)],2)}var rh=St(eh,[["render",ah]]),Kt={},cr={};cr.__esModule=!0,cr.inherits=nh;function nh(e,t){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=Object.create(e.prototype);for(var n in s)a[n]=s[n];return a.constructor=t,t.prototype=a,t}var Ur={};Ur.__esModule=!0;var ih=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fs={defaultProtocol:"http",events:null,format:Ic,formatHref:Ic,nl2br:!1,tagName:"a",target:lh,validate:!0,ignoreTags:[],attributes:null,className:"linkified"};Ur.defaults=fs,Ur.Options=Oc,Ur.contains=oh;function Oc(e){e=e||{},this.defaultProtocol=e.hasOwnProperty("defaultProtocol")?e.defaultProtocol:fs.defaultProtocol,this.events=e.hasOwnProperty("events")?e.events:fs.events,this.format=e.hasOwnProperty("format")?e.format:fs.format,this.formatHref=e.hasOwnProperty("formatHref")?e.formatHref:fs.formatHref,this.nl2br=e.hasOwnProperty("nl2br")?e.nl2br:fs.nl2br,this.tagName=e.hasOwnProperty("tagName")?e.tagName:fs.tagName,this.target=e.hasOwnProperty("target")?e.target:fs.target,this.validate=e.hasOwnProperty("validate")?e.validate:fs.validate,this.ignoreTags=[],this.attributes=e.attributes||e.linkAttributes||fs.attributes,this.className=e.hasOwnProperty("className")?e.className:e.linkClass||fs.className;for(var t=e.hasOwnProperty("ignoreTags")?e.ignoreTags:fs.ignoreTags,s=0;s<t.length;s++)this.ignoreTags.push(t[s].toUpperCase())}Oc.prototype={resolve:function(t){var s=t.toHref(this.defaultProtocol);return{formatted:this.get("format",t.toString(),t),formattedHref:this.get("formatHref",s,t),tagName:this.get("tagName",s,t),className:this.get("className",s,t),target:this.get("target",s,t),events:this.getObject("events",s,t),attributes:this.getObject("attributes",s,t)}},check:function(t){return this.get("validate",t.toString(),t)},get:function(t,s,a){var n=void 0,r=this[t];if(!r)return r;switch(typeof r=="undefined"?"undefined":ih(r)){case"function":return r(s,a.type);case"object":return n=r.hasOwnProperty(a.type)?r[a.type]:fs[t],typeof n=="function"?n(s,a.type):n}return r},getObject:function(t,s,a){var n=this[t];return typeof n=="function"?n(s,a.type):n}};function oh(e,t){for(var s=0;s<e.length;s++)if(e[s]===t)return!0;return!1}function Ic(e){return e}function lh(e,t){return t==="url"?"_blank":null}var Us={},ea={};ea.__esModule=!0,ea.stateify=ea.TokenState=ea.CharacterState=void 0;var Cc=cr;function No(){return function(e){this.j=[],this.T=e||null}}var jo=No();jo.prototype={defaultTransition:!1,on:function(t,s){if(t instanceof Array){for(var a=0;a<t.length;a++)this.j.push([t[a],s]);return this}return this.j.push([t,s]),this},next:function(t){for(var s=0;s<this.j.length;s++){var a=this.j[s],n=a[0],r=a[1];if(this.test(t,n))return r}return this.defaultTransition},accepts:function(){return!!this.T},test:function(t,s){return t===s},emit:function(){return this.T}};var Ho=(0,Cc.inherits)(jo,No(),{test:function(t,s){return t===s||s instanceof RegExp&&s.test(t)}}),ch=(0,Cc.inherits)(jo,No(),{jump:function(t){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,a=this.next(new t(""));return a===this.defaultTransition?(a=new this.constructor(s),this.on(t,a)):s&&(a.T=s),a},test:function(t,s){return t instanceof s}});function uh(e,t,s,a){for(var n=0,r=e.length,o=t,l=[],v=void 0;n<r&&(v=o.next(e[n]));)o=v,n++;if(n>=r)return[];for(;n<r-1;)v=new Ho(a),l.push(v),o.on(e[n],v),o=v,n++;return v=new Ho(s),l.push(v),o.on(e[r-1],v),l}ea.CharacterState=Ho,ea.TokenState=ch,ea.stateify=uh;var qe={},ri={};ri.__esModule=!0;function dh(){return function(e){e&&(this.v=e)}}ri.createTokenClass=dh,qe.__esModule=!0,qe.AMPERSAND=qe.CLOSEPAREN=qe.CLOSEANGLEBRACKET=qe.CLOSEBRACKET=qe.CLOSEBRACE=qe.OPENPAREN=qe.OPENANGLEBRACKET=qe.OPENBRACKET=qe.OPENBRACE=qe.WS=qe.TLD=qe.SYM=qe.UNDERSCORE=qe.SLASH=qe.MAILTO=qe.PROTOCOL=qe.QUERY=qe.POUND=qe.PLUS=qe.NUM=qe.NL=qe.LOCALHOST=qe.PUNCTUATION=qe.DOT=qe.COLON=qe.AT=qe.DOMAIN=qe.Base=void 0;var Bc=ri,fh=cr,Po=(0,Bc.createTokenClass)();Po.prototype={toString:function(){return this.v+""}};function Mt(e){var t=e?{v:e}:{};return(0,fh.inherits)(Po,(0,Bc.createTokenClass)(),t)}var mh=Mt(),hh=Mt("@"),vh=Mt(":"),_h=Mt("."),ph=Mt(),gh=Mt(),bh=Mt(`
`),yh=Mt(),xh=Mt("+"),wh=Mt("#"),Sh=Mt(),Mh=Mt("mailto:"),Th=Mt("?"),Eh=Mt("/"),Ah=Mt("_"),kh=Mt(),Rh=Mt(),Oh=Mt(),Ih=Mt("{"),Ch=Mt("["),Bh=Mt("<"),Lh=Mt("("),Nh=Mt("}"),jh=Mt("]"),Hh=Mt(">"),Ph=Mt(")"),Fh=Mt("&");qe.Base=Po,qe.DOMAIN=mh,qe.AT=hh,qe.COLON=vh,qe.DOT=_h,qe.PUNCTUATION=ph,qe.LOCALHOST=gh,qe.NL=bh,qe.NUM=yh,qe.PLUS=xh,qe.POUND=wh,qe.QUERY=Th,qe.PROTOCOL=Sh,qe.MAILTO=Mh,qe.SLASH=Eh,qe.UNDERSCORE=Ah,qe.SYM=kh,qe.TLD=Rh,qe.WS=Oh,qe.OPENBRACE=Ih,qe.OPENBRACKET=Ch,qe.OPENANGLEBRACKET=Bh,qe.OPENPAREN=Lh,qe.CLOSEBRACE=Nh,qe.CLOSEBRACKET=jh,qe.CLOSEANGLEBRACKET=Hh,qe.CLOSEPAREN=Ph,qe.AMPERSAND=Fh,Us.__esModule=!0,Us.start=Us.run=Us.TOKENS=Us.State=void 0;var ha=ea,it=qe,Dh=Uh(it);function Uh(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t.default=e,t}var Lc="aaa|aarp|abarth|abb|abbott|abbvie|abc|able|abogado|abudhabi|ac|academy|accenture|accountant|accountants|aco|active|actor|ad|adac|ads|adult|ae|aeg|aero|aetna|af|afamilycompany|afl|africa|ag|agakhan|agency|ai|aig|aigo|airbus|airforce|airtel|akdn|al|alfaromeo|alibaba|alipay|allfinanz|allstate|ally|alsace|alstom|am|americanexpress|americanfamily|amex|amfam|amica|amsterdam|analytics|android|anquan|anz|ao|aol|apartments|app|apple|aq|aquarelle|ar|arab|aramco|archi|army|arpa|art|arte|as|asda|asia|associates|at|athleta|attorney|au|auction|audi|audible|audio|auspost|author|auto|autos|avianca|aw|aws|ax|axa|az|azure|ba|baby|baidu|banamex|bananarepublic|band|bank|bar|barcelona|barclaycard|barclays|barefoot|bargains|baseball|basketball|bauhaus|bayern|bb|bbc|bbt|bbva|bcg|bcn|bd|be|beats|beauty|beer|bentley|berlin|best|bestbuy|bet|bf|bg|bh|bharti|bi|bible|bid|bike|bing|bingo|bio|biz|bj|black|blackfriday|blanco|blockbuster|blog|bloomberg|blue|bm|bms|bmw|bn|bnl|bnpparibas|bo|boats|boehringer|bofa|bom|bond|boo|book|booking|boots|bosch|bostik|boston|bot|boutique|box|br|bradesco|bridgestone|broadway|broker|brother|brussels|bs|bt|budapest|bugatti|build|builders|business|buy|buzz|bv|bw|by|bz|bzh|ca|cab|cafe|cal|call|calvinklein|cam|camera|camp|cancerresearch|canon|capetown|capital|capitalone|car|caravan|cards|care|career|careers|cars|cartier|casa|case|caseih|cash|casino|cat|catering|catholic|cba|cbn|cbre|cbs|cc|cd|ceb|center|ceo|cern|cf|cfa|cfd|cg|ch|chanel|channel|chase|chat|cheap|chintai|chloe|christmas|chrome|chrysler|church|ci|cipriani|circle|cisco|citadel|citi|citic|city|cityeats|ck|cl|claims|cleaning|click|clinic|clinique|clothing|cloud|club|clubmed|cm|cn|co|coach|codes|coffee|college|cologne|com|comcast|commbank|community|company|compare|computer|comsec|condos|construction|consulting|contact|contractors|cooking|cookingchannel|cool|coop|corsica|country|coupon|coupons|courses|cr|credit|creditcard|creditunion|cricket|crown|crs|cruise|cruises|csc|cu|cuisinella|cv|cw|cx|cy|cymru|cyou|cz|dabur|dad|dance|data|date|dating|datsun|day|dclk|dds|de|deal|dealer|deals|degree|delivery|dell|deloitte|delta|democrat|dental|dentist|desi|design|dev|dhl|diamonds|diet|digital|direct|directory|discount|discover|dish|diy|dj|dk|dm|dnp|do|docs|doctor|dodge|dog|doha|domains|dot|download|drive|dtv|dubai|duck|dunlop|duns|dupont|durban|dvag|dvr|dz|earth|eat|ec|eco|edeka|edu|education|ee|eg|email|emerck|energy|engineer|engineering|enterprises|epost|epson|equipment|er|ericsson|erni|es|esq|estate|esurance|et|etisalat|eu|eurovision|eus|events|everbank|exchange|expert|exposed|express|extraspace|fage|fail|fairwinds|faith|family|fan|fans|farm|farmers|fashion|fast|fedex|feedback|ferrari|ferrero|fi|fiat|fidelity|fido|film|final|finance|financial|fire|firestone|firmdale|fish|fishing|fit|fitness|fj|fk|flickr|flights|flir|florist|flowers|fly|fm|fo|foo|food|foodnetwork|football|ford|forex|forsale|forum|foundation|fox|fr|free|fresenius|frl|frogans|frontdoor|frontier|ftr|fujitsu|fujixerox|fun|fund|furniture|futbol|fyi|ga|gal|gallery|gallo|gallup|game|games|gap|garden|gb|gbiz|gd|gdn|ge|gea|gent|genting|george|gf|gg|ggee|gh|gi|gift|gifts|gives|giving|gl|glade|glass|gle|global|globo|gm|gmail|gmbh|gmo|gmx|gn|godaddy|gold|goldpoint|golf|goo|goodhands|goodyear|goog|google|gop|got|gov|gp|gq|gr|grainger|graphics|gratis|green|gripe|grocery|group|gs|gt|gu|guardian|gucci|guge|guide|guitars|guru|gw|gy|hair|hamburg|hangout|haus|hbo|hdfc|hdfcbank|health|healthcare|help|helsinki|here|hermes|hgtv|hiphop|hisamitsu|hitachi|hiv|hk|hkt|hm|hn|hockey|holdings|holiday|homedepot|homegoods|homes|homesense|honda|honeywell|horse|hospital|host|hosting|hot|hoteles|hotels|hotmail|house|how|hr|hsbc|ht|htc|hu|hughes|hyatt|hyundai|ibm|icbc|ice|icu|id|ie|ieee|ifm|ikano|il|im|imamat|imdb|immo|immobilien|in|industries|infiniti|info|ing|ink|institute|insurance|insure|int|intel|international|intuit|investments|io|ipiranga|iq|ir|irish|is|iselect|ismaili|ist|istanbul|it|itau|itv|iveco|iwc|jaguar|java|jcb|jcp|je|jeep|jetzt|jewelry|jio|jlc|jll|jm|jmp|jnj|jo|jobs|joburg|jot|joy|jp|jpmorgan|jprs|juegos|juniper|kaufen|kddi|ke|kerryhotels|kerrylogistics|kerryproperties|kfh|kg|kh|ki|kia|kim|kinder|kindle|kitchen|kiwi|km|kn|koeln|komatsu|kosher|kp|kpmg|kpn|kr|krd|kred|kuokgroup|kw|ky|kyoto|kz|la|lacaixa|ladbrokes|lamborghini|lamer|lancaster|lancia|lancome|land|landrover|lanxess|lasalle|lat|latino|latrobe|law|lawyer|lb|lc|lds|lease|leclerc|lefrak|legal|lego|lexus|lgbt|li|liaison|lidl|life|lifeinsurance|lifestyle|lighting|like|lilly|limited|limo|lincoln|linde|link|lipsy|live|living|lixil|lk|loan|loans|locker|locus|loft|lol|london|lotte|lotto|love|lpl|lplfinancial|lr|ls|lt|ltd|ltda|lu|lundbeck|lupin|luxe|luxury|lv|ly|ma|macys|madrid|maif|maison|makeup|man|management|mango|map|market|marketing|markets|marriott|marshalls|maserati|mattel|mba|mc|mckinsey|md|me|med|media|meet|melbourne|meme|memorial|men|menu|meo|merckmsd|metlife|mg|mh|miami|microsoft|mil|mini|mint|mit|mitsubishi|mk|ml|mlb|mls|mm|mma|mn|mo|mobi|mobile|mobily|moda|moe|moi|mom|monash|money|monster|mopar|mormon|mortgage|moscow|moto|motorcycles|mov|movie|movistar|mp|mq|mr|ms|msd|mt|mtn|mtr|mu|museum|mutual|mv|mw|mx|my|mz|na|nab|nadex|nagoya|name|nationwide|natura|navy|nba|nc|ne|nec|net|netbank|netflix|network|neustar|new|newholland|news|next|nextdirect|nexus|nf|nfl|ng|ngo|nhk|ni|nico|nike|nikon|ninja|nissan|nissay|nl|no|nokia|northwesternmutual|norton|now|nowruz|nowtv|np|nr|nra|nrw|ntt|nu|nyc|nz|obi|observer|off|office|okinawa|olayan|olayangroup|oldnavy|ollo|om|omega|one|ong|onl|online|onyourside|ooo|open|oracle|orange|org|organic|origins|osaka|otsuka|ott|ovh|pa|page|panasonic|panerai|paris|pars|partners|parts|party|passagens|pay|pccw|pe|pet|pf|pfizer|pg|ph|pharmacy|phd|philips|phone|photo|photography|photos|physio|piaget|pics|pictet|pictures|pid|pin|ping|pink|pioneer|pizza|pk|pl|place|play|playstation|plumbing|plus|pm|pn|pnc|pohl|poker|politie|porn|post|pr|pramerica|praxi|press|prime|pro|prod|productions|prof|progressive|promo|properties|property|protection|pru|prudential|ps|pt|pub|pw|pwc|py|qa|qpon|quebec|quest|qvc|racing|radio|raid|re|read|realestate|realtor|realty|recipes|red|redstone|redumbrella|rehab|reise|reisen|reit|reliance|ren|rent|rentals|repair|report|republican|rest|restaurant|review|reviews|rexroth|rich|richardli|ricoh|rightathome|ril|rio|rip|rmit|ro|rocher|rocks|rodeo|rogers|room|rs|rsvp|ru|rugby|ruhr|run|rw|rwe|ryukyu|sa|saarland|safe|safety|sakura|sale|salon|samsclub|samsung|sandvik|sandvikcoromant|sanofi|sap|sapo|sarl|sas|save|saxo|sb|sbi|sbs|sc|sca|scb|schaeffler|schmidt|scholarships|school|schule|schwarz|science|scjohnson|scor|scot|sd|se|search|seat|secure|security|seek|select|sener|services|ses|seven|sew|sex|sexy|sfr|sg|sh|shangrila|sharp|shaw|shell|shia|shiksha|shoes|shop|shopping|shouji|show|showtime|shriram|si|silk|sina|singles|site|sj|sk|ski|skin|sky|skype|sl|sling|sm|smart|smile|sn|sncf|so|soccer|social|softbank|software|sohu|solar|solutions|song|sony|soy|space|spiegel|spot|spreadbetting|sr|srl|srt|st|stada|staples|star|starhub|statebank|statefarm|statoil|stc|stcgroup|stockholm|storage|store|stream|studio|study|style|su|sucks|supplies|supply|support|surf|surgery|suzuki|sv|swatch|swiftcover|swiss|sx|sy|sydney|symantec|systems|sz|tab|taipei|talk|taobao|target|tatamotors|tatar|tattoo|tax|taxi|tc|tci|td|tdk|team|tech|technology|tel|telecity|telefonica|temasek|tennis|teva|tf|tg|th|thd|theater|theatre|tiaa|tickets|tienda|tiffany|tips|tires|tirol|tj|tjmaxx|tjx|tk|tkmaxx|tl|tm|tmall|tn|to|today|tokyo|tools|top|toray|toshiba|total|tours|town|toyota|toys|tr|trade|trading|training|travel|travelchannel|travelers|travelersinsurance|trust|trv|tt|tube|tui|tunes|tushu|tv|tvs|tw|tz|ua|ubank|ubs|uconnect|ug|uk|unicom|university|uno|uol|ups|us|uy|uz|va|vacations|vana|vanguard|vc|ve|vegas|ventures|verisign|versicherung|vet|vg|vi|viajes|video|vig|viking|villas|vin|vip|virgin|visa|vision|vista|vistaprint|viva|vivo|vlaanderen|vn|vodka|volkswagen|volvo|vote|voting|voto|voyage|vu|vuelos|wales|walmart|walter|wang|wanggou|warman|watch|watches|weather|weatherchannel|webcam|weber|website|wed|wedding|weibo|weir|wf|whoswho|wien|wiki|williamhill|win|windows|wine|winners|wme|wolterskluwer|woodside|work|works|world|wow|ws|wtc|wtf|xbox|xerox|xfinity|xihuan|xin|xn--11b4c3d|xn--1ck2e1b|xn--1qqw23a|xn--2scrj9c|xn--30rr7y|xn--3bst00m|xn--3ds443g|xn--3e0b707e|xn--3hcrj9c|xn--3oq18vl8pn36a|xn--3pxu8k|xn--42c2d9a|xn--45br5cyl|xn--45brj9c|xn--45q11c|xn--4gbrim|xn--54b7fta0cc|xn--55qw42g|xn--55qx5d|xn--5su34j936bgsg|xn--5tzm5g|xn--6frz82g|xn--6qq986b3xl|xn--80adxhks|xn--80ao21a|xn--80aqecdr1a|xn--80asehdb|xn--80aswg|xn--8y0a063a|xn--90a3ac|xn--90ae|xn--90ais|xn--9dbq2a|xn--9et52u|xn--9krt00a|xn--b4w605ferd|xn--bck1b9a5dre4c|xn--c1avg|xn--c2br7g|xn--cck2b3b|xn--cg4bki|xn--clchc0ea0b2g2a9gcd|xn--czr694b|xn--czrs0t|xn--czru2d|xn--d1acj3b|xn--d1alf|xn--e1a4c|xn--eckvdtc9d|xn--efvy88h|xn--estv75g|xn--fct429k|xn--fhbei|xn--fiq228c5hs|xn--fiq64b|xn--fiqs8s|xn--fiqz9s|xn--fjq720a|xn--flw351e|xn--fpcrj9c3d|xn--fzc2c9e2c|xn--fzys8d69uvgm|xn--g2xx48c|xn--gckr3f0f|xn--gecrj9c|xn--gk3at1e|xn--h2breg3eve|xn--h2brj9c|xn--h2brj9c8c|xn--hxt814e|xn--i1b6b1a6a2e|xn--imr513n|xn--io0a7i|xn--j1aef|xn--j1amh|xn--j6w193g|xn--jlq61u9w7b|xn--jvr189m|xn--kcrx77d1x4a|xn--kprw13d|xn--kpry57d|xn--kpu716f|xn--kput3i|xn--l1acc|xn--lgbbat1ad8j|xn--mgb9awbf|xn--mgba3a3ejt|xn--mgba3a4f16a|xn--mgba7c0bbn0a|xn--mgbaakc7dvf|xn--mgbaam7a8h|xn--mgbab2bd|xn--mgbai9azgqp6j|xn--mgbayh7gpa|xn--mgbb9fbpob|xn--mgbbh1a|xn--mgbbh1a71e|xn--mgbc0a9azcg|xn--mgbca7dzdo|xn--mgberp4a5d4ar|xn--mgbgu82a|xn--mgbi4ecexp|xn--mgbpl2fh|xn--mgbt3dhd|xn--mgbtx2b|xn--mgbx4cd0ab|xn--mix891f|xn--mk1bu44c|xn--mxtq1m|xn--ngbc5azd|xn--ngbe9e0a|xn--ngbrx|xn--node|xn--nqv7f|xn--nqv7fs00ema|xn--nyqy26a|xn--o3cw4h|xn--ogbpf8fl|xn--p1acf|xn--p1ai|xn--pbt977c|xn--pgbs0dh|xn--pssy2u|xn--q9jyb4c|xn--qcka1pmc|xn--qxam|xn--rhqv96g|xn--rovu88b|xn--rvc1e0am3e|xn--s9brj9c|xn--ses554g|xn--t60b56a|xn--tckwe|xn--tiq49xqyj|xn--unup4y|xn--vermgensberater-ctb|xn--vermgensberatung-pwb|xn--vhquv|xn--vuq861b|xn--w4r85el8fhu5dnra|xn--w4rs40l|xn--wgbh1c|xn--wgbl6a|xn--xhq521b|xn--xkc2al3hye2a|xn--xkc2dl3a5ee0h|xn--y9a3aq|xn--yfro4i67o|xn--ygbi2ammx|xn--zfr164b|xperia|xxx|xyz|yachts|yahoo|yamaxun|yandex|ye|yodobashi|yoga|yokohama|you|youtube|yt|yun|za|zappos|zara|zero|zip|zippo|zm|zone|zuerich|zw".split("|"),Fo="0123456789".split(""),ni="0123456789abcdefghijklmnopqrstuvwxyz".split(""),Nc=[" ","\f","\r","	","\v","\xA0","\u1680","\u180E"],$t=[],bt=function(t){return new ha.CharacterState(t)},Ms=bt(),Do=bt(it.NUM),ur=bt(it.DOMAIN),qr=bt(),Uo=bt(it.WS);Ms.on("@",bt(it.AT)).on(".",bt(it.DOT)).on("+",bt(it.PLUS)).on("#",bt(it.POUND)).on("?",bt(it.QUERY)).on("/",bt(it.SLASH)).on("_",bt(it.UNDERSCORE)).on(":",bt(it.COLON)).on("{",bt(it.OPENBRACE)).on("[",bt(it.OPENBRACKET)).on("<",bt(it.OPENANGLEBRACKET)).on("(",bt(it.OPENPAREN)).on("}",bt(it.CLOSEBRACE)).on("]",bt(it.CLOSEBRACKET)).on(">",bt(it.CLOSEANGLEBRACKET)).on(")",bt(it.CLOSEPAREN)).on("&",bt(it.AMPERSAND)).on([",",";","!",'"',"'"],bt(it.PUNCTUATION)),Ms.on(`
`,bt(it.NL)).on(Nc,Uo),Uo.on(Nc,Uo);for(var qo=0;qo<Lc.length;qo++){var qh=(0,ha.stateify)(Lc[qo],Ms,it.TLD,it.DOMAIN);$t.push.apply($t,qh)}var jc=(0,ha.stateify)("file",Ms,it.DOMAIN,it.DOMAIN),Hc=(0,ha.stateify)("ftp",Ms,it.DOMAIN,it.DOMAIN),Pc=(0,ha.stateify)("http",Ms,it.DOMAIN,it.DOMAIN),Fc=(0,ha.stateify)("mailto",Ms,it.DOMAIN,it.DOMAIN);$t.push.apply($t,jc),$t.push.apply($t,Hc),$t.push.apply($t,Pc),$t.push.apply($t,Fc);var Vh=jc.pop(),zh=Hc.pop(),Yh=Pc.pop(),Xh=Fc.pop(),ii=bt(it.DOMAIN),oi=bt(it.PROTOCOL),Kh=bt(it.MAILTO);zh.on("s",ii).on(":",oi),Yh.on("s",ii).on(":",oi),$t.push(ii),Vh.on(":",oi),ii.on(":",oi),Xh.on(":",Kh);var Gh=(0,ha.stateify)("localhost",Ms,it.LOCALHOST,it.DOMAIN);$t.push.apply($t,Gh),Ms.on(Fo,Do),Do.on("-",qr).on(Fo,Do).on(ni,ur),ur.on("-",qr).on(ni,ur);for(var Vo=0;Vo<$t.length;Vo++)$t[Vo].on("-",qr).on(ni,ur);qr.on("-",qr).on(Fo,ur).on(ni,ur),Ms.defaultTransition=bt(it.SYM);var Wh=function(t){for(var s=t.replace(/[A-Z]/g,function(p){return p.toLowerCase()}),a=t.length,n=[],r=0;r<a;){for(var o=Ms,l=null,v=0,c=null,m=-1;r<a&&(l=o.next(s[r]));)o=l,o.accepts()?(m=0,c=o):m>=0&&m++,v++,r++;if(!(m<0)){r-=m,v-=m;var u=c.emit();n.push(new u(t.substr(r-v,v)))}}return n},Zh=Ms;Us.State=ha.CharacterState,Us.TOKENS=Dh,Us.run=Wh,Us.start=Zh;var qs={},ts={};ts.__esModule=!0,ts.URL=ts.TEXT=ts.NL=ts.EMAIL=ts.MAILTOEMAIL=ts.Base=void 0;var dr=ri,Vr=cr,zr=qe;function Qh(e){return e instanceof zr.DOMAIN||e instanceof zr.TLD}var Na=(0,dr.createTokenClass)();Na.prototype={type:"token",isLink:!1,toString:function(){for(var t=[],s=0;s<this.v.length;s++)t.push(this.v[s].toString());return t.join("")},toHref:function(){return this.toString()},toObject:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"http";return{type:this.type,value:this.toString(),href:this.toHref(t)}}};var Jh=(0,Vr.inherits)(Na,(0,dr.createTokenClass)(),{type:"email",isLink:!0}),$h=(0,Vr.inherits)(Na,(0,dr.createTokenClass)(),{type:"email",isLink:!0,toHref:function(){return"mailto:"+this.toString()}}),e2=(0,Vr.inherits)(Na,(0,dr.createTokenClass)(),{type:"text"}),t2=(0,Vr.inherits)(Na,(0,dr.createTokenClass)(),{type:"nl"}),s2=(0,Vr.inherits)(Na,(0,dr.createTokenClass)(),{type:"url",isLink:!0,toHref:function(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"http",s=!1,a=!1,n=this.v,r=[],o=0;n[o]instanceof zr.PROTOCOL;)s=!0,r.push(n[o].toString().toLowerCase()),o++;for(;n[o]instanceof zr.SLASH;)a=!0,r.push(n[o].toString()),o++;for(;Qh(n[o]);)r.push(n[o].toString().toLowerCase()),o++;for(;o<n.length;o++)r.push(n[o].toString());return r=r.join(""),s||a||(r=t+"://"+r),r},hasProtocol:function(){return this.v[0]instanceof zr.PROTOCOL}});ts.Base=Na,ts.MAILTOEMAIL=Jh,ts.EMAIL=$h,ts.NL=t2,ts.TEXT=e2,ts.URL=s2,qs.__esModule=!0,qs.start=qs.run=qs.TOKENS=qs.State=void 0;var Dc=ea,ss=ts,a2=r2(ss),we=qe;function r2(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t.default=e,t}var lt=function(t){return new Dc.TokenState(t)},li=lt(),Uc=lt(),qc=lt(),zo=lt(),Vc=lt(),va=lt(),ci=lt(),Yr=lt(ss.URL),zc=lt(),Yc=lt(ss.URL),It=lt(ss.URL),Xr=lt(),Kr=lt(),Gr=lt(),Wr=lt(),Zr=lt(),ja=lt(ss.URL),Ha=lt(ss.URL),Pa=lt(ss.URL),Fa=lt(ss.URL),Qr=lt(),Jr=lt(),$r=lt(),en=lt(),fr=lt(),Yo=lt(),ui=lt(ss.EMAIL),Xc=lt(),n2=lt(ss.EMAIL),Da=lt(ss.MAILTOEMAIL),Xo=lt(),mr=lt(),di=lt(),Kc=lt(),i2=lt(ss.NL);li.on(we.NL,i2).on(we.PROTOCOL,Uc).on(we.MAILTO,qc).on(we.SLASH,zo),Uc.on(we.SLASH,zo),zo.on(we.SLASH,Vc),li.on(we.TLD,va).on(we.DOMAIN,va).on(we.LOCALHOST,Yr).on(we.NUM,va),Vc.on(we.TLD,It).on(we.DOMAIN,It).on(we.NUM,It).on(we.LOCALHOST,It),va.on(we.DOT,ci),fr.on(we.DOT,Yo),ci.on(we.TLD,Yr).on(we.DOMAIN,va).on(we.NUM,va).on(we.LOCALHOST,va),Yo.on(we.TLD,ui).on(we.DOMAIN,fr).on(we.NUM,fr).on(we.LOCALHOST,fr),Yr.on(we.DOT,ci),ui.on(we.DOT,Yo),Yr.on(we.COLON,zc).on(we.SLASH,It),zc.on(we.NUM,Yc),Yc.on(we.SLASH,It),ui.on(we.COLON,Xc),Xc.on(we.NUM,n2);var Gt=[we.DOMAIN,we.AT,we.LOCALHOST,we.NUM,we.PLUS,we.POUND,we.PROTOCOL,we.SLASH,we.TLD,we.UNDERSCORE,we.SYM,we.AMPERSAND],Wt=[we.COLON,we.DOT,we.QUERY,we.PUNCTUATION,we.CLOSEBRACE,we.CLOSEBRACKET,we.CLOSEANGLEBRACKET,we.CLOSEPAREN,we.OPENBRACE,we.OPENBRACKET,we.OPENANGLEBRACKET,we.OPENPAREN];It.on(we.OPENBRACE,Kr).on(we.OPENBRACKET,Gr).on(we.OPENANGLEBRACKET,Wr).on(we.OPENPAREN,Zr),Xr.on(we.OPENBRACE,Kr).on(we.OPENBRACKET,Gr).on(we.OPENANGLEBRACKET,Wr).on(we.OPENPAREN,Zr),Kr.on(we.CLOSEBRACE,It),Gr.on(we.CLOSEBRACKET,It),Wr.on(we.CLOSEANGLEBRACKET,It),Zr.on(we.CLOSEPAREN,It),ja.on(we.CLOSEBRACE,It),Ha.on(we.CLOSEBRACKET,It),Pa.on(we.CLOSEANGLEBRACKET,It),Fa.on(we.CLOSEPAREN,It),Qr.on(we.CLOSEBRACE,It),Jr.on(we.CLOSEBRACKET,It),$r.on(we.CLOSEANGLEBRACKET,It),en.on(we.CLOSEPAREN,It),Kr.on(Gt,ja),Gr.on(Gt,Ha),Wr.on(Gt,Pa),Zr.on(Gt,Fa),Kr.on(Wt,Qr),Gr.on(Wt,Jr),Wr.on(Wt,$r),Zr.on(Wt,en),ja.on(Gt,ja),Ha.on(Gt,Ha),Pa.on(Gt,Pa),Fa.on(Gt,Fa),ja.on(Wt,ja),Ha.on(Wt,Ha),Pa.on(Wt,Pa),Fa.on(Wt,Fa),Qr.on(Gt,ja),Jr.on(Gt,Ha),$r.on(Gt,Pa),en.on(Gt,Fa),Qr.on(Wt,Qr),Jr.on(Wt,Jr),$r.on(Wt,$r),en.on(Wt,en),It.on(Gt,It),Xr.on(Gt,It),It.on(Wt,Xr),Xr.on(Wt,Xr),qc.on(we.TLD,Da).on(we.DOMAIN,Da).on(we.NUM,Da).on(we.LOCALHOST,Da),Da.on(Gt,Da).on(Wt,Xo),Xo.on(Gt,Da).on(Wt,Xo);var tn=[we.DOMAIN,we.NUM,we.PLUS,we.POUND,we.QUERY,we.UNDERSCORE,we.SYM,we.AMPERSAND,we.TLD];va.on(tn,mr).on(we.AT,di),Yr.on(tn,mr).on(we.AT,di),ci.on(tn,mr),mr.on(tn,mr).on(we.AT,di).on(we.DOT,Kc),Kc.on(tn,mr),di.on(we.TLD,fr).on(we.DOMAIN,fr).on(we.LOCALHOST,ui);var o2=function(t){for(var s=t.length,a=0,n=[],r=[];a<s;){for(var o=li,l=null,v=null,c=0,m=null,u=-1;a<s&&!(l=o.next(t[a]));)r.push(t[a++]);for(;a<s&&(v=l||o.next(t[a]));)l=null,o=v,o.accepts()?(u=0,m=o):u>=0&&u++,a++,c++;if(u<0)for(var p=a-c;p<a;p++)r.push(t[p]);else{r.length>0&&(n.push(new ss.TEXT(r)),r=[]),a-=u,c-=u;var y=m.emit();n.push(new y(t.slice(a-c,a)))}}return r.length>0&&n.push(new ss.TEXT(r)),n};qs.State=Dc.TokenState,qs.TOKENS=a2,qs.run=o2,qs.start=li,Kt.__esModule=!0,Kt.tokenize=Kt.test=Kt.scanner=Kt.parser=Kt.options=Kt.inherits=Kt.find=void 0;var l2=cr,c2=Ur,u2=Ko(c2),d2=Us,Gc=Ko(d2),f2=qs,Wc=Ko(f2);function Ko(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t.default=e,t}Array.isArray||(Array.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"});var Go=function(t){return Wc.run(Gc.run(t))},m2=function(t){for(var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,a=Go(t),n=[],r=0;r<a.length;r++){var o=a[r];o.isLink&&(!s||o.type===s)&&n.push(o.toObject())}return n},h2=function(t){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,a=Go(t);return a.length===1&&a[0].isLink&&(!s||a[0].type===s)};Kt.find=m2,Kt.inherits=l2.inherits,Kt.options=u2,Kt.parser=Wc,Kt.scanner=Gc,Kt.test=h2,Kt.tokenize=Go;var Zc=Kt,v2=(e,t,s)=>{const a={bold:s.bold,italic:s.italic,strike:s.strike,underline:s.underline,multilineCode:s.multilineCode,inlineCode:s.inlineCode},n={[a.bold]:{end:"\\"+a.bold,allowed_chars:".",type:"bold"},[a.italic]:{end:a.italic,allowed_chars:".",type:"italic"},[a.strike]:{end:a.strike,allowed_chars:".",type:"strike"},[a.underline]:{end:a.underline,allowed_chars:".",type:"underline"},[a.multilineCode]:{end:a.multilineCode,allowed_chars:`(.|
)`,type:"multiline-code"},[a.inlineCode]:{end:a.inlineCode,allowed_chars:".",type:"inline-code"},"<usertag>":{allowed_chars:".",end:"</usertag>",type:"tag"}},r=fi(e,n),o=_2(r,n),l=[].concat.apply([],o);return t&&g2(l),l};function fi(e,t){let s=[],a=-1,n=null,r=Zc.find(e),o=!1;if(r.length>0&&(a=e.indexOf(r[0].value),o=!0),Object.keys(t).forEach(l=>{const v=e.indexOf(l);v>=0&&(a<0||v<a)&&(a=v,n=l,o=!1)}),o&&n!==-1){let l=e.substr(0,a),v=e.substr(a,r[0].value.length),c=e.substr(a+r[0].value.length);return s.push(l),s.push(v),s=s.concat(fi(c,t)),s}if(n){let l=e.substr(0,a);const v=n;let c=e.substr(a+v.length);if(e.replace(/\s/g,"").length===v.length*2)return[e];const m=c.match(new RegExp("^("+(t[v].allowed_chars||".")+"*"+(t[v].end?"?":"")+")"+(t[v].end?"("+t[v].end+")":""),"m"));if(!m||!m[1])l=l+v,s.push(l);else{l&&s.push(l);const u={start:v,content:fi(m[1],t),end:m[2],type:t[v].type};s.push(u),c=c.substr(m[0].length)}return s=s.concat(fi(c,t)),s}else return e?[e]:[]}function _2(e,t){const s=[];return e.forEach(a=>{typeof a=="string"?s.push({types:[],value:a}):t[a.start]&&s.push(p2(a))}),s}function p2(e){const t=[];return Qc(e,t,[]),t}function Qc(e,t,s){e.content.forEach(a=>{typeof a=="string"?t.push({types:Jc(s.concat([e.type])),value:a}):Qc(a,t,Jc([a.type].concat([e.type]).concat(s)))})}function Jc(e){return[...new Set(e)]}function g2(e){const t=[];return e.forEach(s=>{const a=Zc.find(s.value);if(a.length){const n=s.value.replace(a[0].value,"");t.push({types:s.types,value:n}),s.types=["url"].concat(s.types),s.href=a[0].href,s.value=a[0].value}t.push(s)}),t}const Wo=["png","jpg","jpeg","webp","svg","gif"],$c=["mp4","video/ogg","webm","quicktime"],b2=["mp3","audio/ogg","wav","mpeg"],y2={name:"FormatMessage",components:{SvgIcon:Vt},props:{messageId:{type:String,default:""},roomId:{type:String,default:""},roomList:{type:Boolean,default:!1},content:{type:[String,Number],required:!0},deleted:{type:Boolean,default:!1},users:{type:Array,default:()=>[]},linkify:{type:Boolean,default:!0},singleLine:{type:Boolean,default:!1},reply:{type:Boolean,default:!1},textFormatting:{type:Object,required:!0},textMessages:{type:Object,default:()=>{}},linkOptions:{type:Object,required:!0}},emits:["open-user-tag"],computed:{linkifiedMessage(){if(this.deleted)return[{value:this.textMessages.MESSAGE_DELETED}];const e=v2(this.formatTags(this.content),this.linkify&&!this.linkOptions.disabled,this.textFormatting);return e.forEach(t=>{t.url=this.checkType(t,"url"),t.bold=this.checkType(t,"bold"),t.italic=this.checkType(t,"italic"),t.strike=this.checkType(t,"strike"),t.underline=this.checkType(t,"underline"),t.inline=this.checkType(t,"inline-code"),t.multiline=this.checkType(t,"multiline-code"),t.tag=this.checkType(t,"tag"),t.image=this.checkImageType(t),t.value=this.replaceEmojiByElement(t.value)}),e},formattedContent(){return this.deleted?this.textMessages.MESSAGE_DELETED:this.formatTags(this.content)}},methods:{checkType(e,t){return e.types&&e.types.indexOf(t)!==-1},checkImageType(e){let t=e.value.lastIndexOf(".");e.value.lastIndexOf("/")>t&&(t=-1);const a=e.value.substring(t+1,e.value.length),n=t>0&&Wo.some(r=>a.toLowerCase().includes(r));return n&&this.setImageSize(e),n},setImageSize(e){const t=new Image;t.src=e.value,t.addEventListener("load",s);function s(a){const n=a.path[0].width/150;e.height=Math.round(a.path[0].height/n)+"px",t.removeEventListener("load",s)}},formatTags(e){const t="<usertag>",s="</usertag>",a=[...e.matchAll(new RegExp(t,"gi"))].map(r=>r.index),n=e;return a.forEach(r=>{const o=n.substring(r+t.length,n.indexOf(s,r)),l=this.users.find(v=>v._id===o);e=e.replaceAll(o,`@${(l==null?void 0:l.username)||"unknown"}`)}),e},openTag(e){if(!this.singleLine&&this.checkType(e,"tag")){const t=this.users.find(s=>e.value.indexOf(s.username)!==-1);this.$emit("open-user-tag",t)}},replaceEmojiByElement(e){let t;return this.singleLine?t=16:t=this.containsOnlyEmojis()?28:20,e.replaceAll(/[\p{Extended_Pictographic}\u{1F3FB}-\u{1F3FF}\u{1F9B0}-\u{1F9B3}]/gu,s=>`<span style="font-size: ${t}px">${s}</span>`)},containsOnlyEmojis(){const e=this.content.replace(new RegExp("[\0-\u1EEFf]","g"),""),t=this.content.replace(new RegExp(`[
\rs]+|( )+`,"g"),"");return e.length===t.length}}},x2={class:"vac-image-link-container"},w2={class:"vac-image-link-message"},S2=["innerHTML"],M2=["innerHTML"];function T2(e,t,s,a,n,r){const o=Ke("svg-icon");return Q(),ne("div",{class:st(["vac-format-message-wrapper",{"vac-text-ellipsis":s.singleLine}])},[s.textFormatting.disabled?(Q(),ne("div",{key:1,innerHTML:r.formattedContent},null,8,M2)):(Q(),ne("div",{key:0,class:st({"vac-text-ellipsis":s.singleLine})},[(Q(!0),ne(ut,null,at(r.linkifiedMessage,(l,v)=>(Q(),ne("div",{key:v,class:"vac-format-container"},[(Q(),ht(Rf(l.url?"a":"span"),{class:st({"vac-text-ellipsis":s.singleLine,"vac-text-bold":l.bold,"vac-text-italic":s.deleted||l.italic,"vac-text-strike":l.strike,"vac-text-underline":l.underline,"vac-text-inline-code":!s.singleLine&&l.inline,"vac-text-multiline-code":!s.singleLine&&l.multiline,"vac-text-tag":!s.singleLine&&!s.reply&&l.tag}),href:l.href,target:l.href?s.linkOptions.target:null,rel:l.href?s.linkOptions.rel:null,onClick:c=>r.openTag(l)},{default:Xe(()=>[s.deleted?(Q(),ne(ut,{key:0},[Oe(e.$slots,s.roomList?"deleted-icon-room_"+s.roomId:"deleted-icon_"+s.messageId,{},()=>[Re(o,{name:"deleted",class:st(["vac-icon-deleted",{"vac-icon-deleted-room":s.roomList}])},null,8,["class"])]),ua(" "+$e(s.textMessages.MESSAGE_DELETED),1)],64)):l.url&&l.image?(Q(),ne(ut,{key:1},[fe("div",x2,[fe("div",{class:"vac-image-link",style:xt({"background-image":`url('${l.value}')`,height:l.height})},null,4)]),fe("div",w2,[fe("span",null,$e(l.value),1)])],64)):(Q(),ne("span",{key:2,innerHTML:l.value},null,8,S2))]),_:2},1032,["class","href","target","rel","onClick"]))]))),128))],2))],2)}var sn=St(y2,[["render",T2]]);const Ua="__v-click-outside",e1=typeof window!="undefined",E2=typeof navigator!="undefined",A2=e1&&("ontouchstart"in window||E2&&navigator.msMaxTouchPoints>0)?["touchstart"]:["click"],k2=e=>{const t=typeof e=="function";if(!t&&typeof e!="object")throw new Error("v-click-outside: Binding value must be a function or an object");return{handler:t?e:e.handler,middleware:e.middleware||(s=>s),events:e.events||A2,isActive:e.isActive!==!1,detectIframe:e.detectIframe!==!1,capture:Boolean(e.capture)}},t1=({event:e,handler:t,middleware:s})=>{s(e)&&t(e)},R2=({el:e,event:t,handler:s,middleware:a})=>{setTimeout(()=>{const{activeElement:n}=document;n&&n.tagName==="IFRAME"&&!e.contains(n)&&t1({event:t,handler:s,middleware:a})},0)},O2=({el:e,event:t,handler:s,middleware:a})=>{const n=t.path||t.composedPath&&t.composedPath();(n?n.indexOf(e)<0:!e.contains(t.target))&&t1({event:t,handler:s,middleware:a})},s1=(e,{value:t})=>{const{events:s,handler:a,middleware:n,isActive:r,detectIframe:o,capture:l}=k2(t);if(!!r){if(e[Ua]=s.map(v=>({event:v,srcTarget:document.documentElement,handler:c=>O2({el:e,event:c,handler:a,middleware:n}),capture:l})),o){const v={event:"blur",srcTarget:window,handler:c=>R2({el:e,event:c,handler:a,middleware:n}),capture:l};e[Ua]=[...e[Ua],v]}e[Ua].forEach(({event:v,srcTarget:c,handler:m})=>setTimeout(()=>{!e[Ua]||c.addEventListener(v,m,l)},0))}},a1=e=>{(e[Ua]||[]).forEach(({event:s,srcTarget:a,handler:n,capture:r})=>a.removeEventListener(s,n,r)),delete e[Ua]};var mi=e1?{beforeMount:s1,updated:(e,{value:t,oldValue:s})=>{JSON.stringify(t)!==JSON.stringify(s)&&(a1(e),s1(e,{value:t}))},unmounted:a1}:{},r1=(e,t,s)=>{if(e.typingUsers&&e.typingUsers.length){const a=e.users.filter(n=>{if(n._id!==t&&e.typingUsers.indexOf(n._id)!==-1&&!(n.status&&n.status.state==="offline"))return!0});return a.length?e.users.length===2?s.IS_TYPING:a.map(n=>n.username).join(", ")+" "+s.IS_TYPING:void 0}};function an(e,t){if(!(!t||!t.type))return e.some(s=>t.type.toLowerCase().includes(s))}function hr(e){return an(Wo,e)}function rn(e){return an($c,e)}function n1(e){return an(Wo,e)||an($c,e)}function hi(e){return an(b2,e)}const I2={name:"RoomsContent",components:{SvgIcon:Vt,FormatMessage:sn},directives:{clickOutside:mi},props:{currentUserId:{type:[String,Number],required:!0},room:{type:Object,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},textMessages:{type:Object,required:!0},roomActions:{type:Array,required:!0}},emits:["room-action-handler"],data(){return{roomMenuOpened:null}},computed:{getLastMessage(){const e=this.typingUsers;if(e)return e;const t=this.room.lastMessage.content;if(this.room.users.length<=2)return t;const s=this.room.users.find(a=>a._id===this.room.lastMessage.senderId);return this.room.lastMessage.username?`${this.room.lastMessage.username} - ${t}`:!s||s._id===this.currentUserId?t:`${s.username} - ${t}`},userStatus(){if(!this.room.users||this.room.users.length!==2)return;const e=this.room.users.find(t=>t._id!==this.currentUserId);return e&&e.status?e.status.state:null},typingUsers(){return r1(this.room,this.currentUserId,this.textMessages)},isMessageCheckmarkVisible(){return!this.typingUsers&&this.room.lastMessage&&!this.room.lastMessage.deleted&&this.room.lastMessage.senderId===this.currentUserId&&(this.room.lastMessage.saved||this.room.lastMessage.distributed||this.room.lastMessage.seen)},formattedDuration(){var t,s;const e=(s=(t=this.room.lastMessage)==null?void 0:t.files)==null?void 0:s[0];if(e){if(!e.duration)return`${e.name}.${e.extension}`;let a=Math.floor(e.duration);return(a-(a%=60))/60+(a>9?":":":0")+a}return""},isAudio(){return this.room.lastMessage.files?hi(this.room.lastMessage.files[0]):!1}},methods:{roomActionHandler(e){this.closeRoomMenu(),this.$emit("room-action-handler",{action:e,roomId:this.room.roomId})},closeRoomMenu(){this.roomMenuOpened=null}}},C2={class:"vac-room-container"},B2={class:"vac-name-container vac-text-ellipsis"},L2={class:"vac-title-container"},N2={class:"vac-room-name vac-text-ellipsis"},j2={key:1,class:"vac-text-date"},H2={key:0},P2={key:1,class:"vac-text-ellipsis"},F2={key:3,class:"vac-text-ellipsis"},D2={class:"vac-room-options-container"},U2={key:0,class:"vac-badge-counter vac-room-badge"},q2={key:0,class:"vac-menu-options"},V2={class:"vac-menu-list"},z2=["onClick"];function Y2(e,t,s,a,n,r){const o=Ke("svg-icon"),l=Ke("format-message"),v=Gn("click-outside");return Q(),ne("div",C2,[Oe(e.$slots,"room-list-item_"+s.room.roomId,{},()=>[Oe(e.$slots,"room-list-avatar_"+s.room.roomId,{},()=>[s.room.avatar?(Q(),ne("div",{key:0,class:"vac-avatar",style:xt({"background-image":`url('${s.room.avatar}')`})},null,4)):Ae("",!0)]),fe("div",B2,[fe("div",L2,[r.userStatus?(Q(),ne("div",{key:0,class:st(["vac-state-circle",{"vac-state-online":r.userStatus==="online"}])},null,2)):Ae("",!0),fe("div",N2,$e(s.room.roomName),1),s.room.lastMessage?(Q(),ne("div",j2,$e(s.room.lastMessage.timestamp),1)):Ae("",!0)]),fe("div",{class:st(["vac-text-last",{"vac-message-new":s.room.lastMessage&&s.room.lastMessage.new&&!r.typingUsers}])},[r.isMessageCheckmarkVisible?(Q(),ne("span",H2,[Oe(e.$slots,"checkmark-icon_"+s.room.roomId,{},()=>[Re(o,{name:s.room.lastMessage.distributed?"double-checkmark":"checkmark",param:s.room.lastMessage.seen?"seen":"",class:"vac-icon-check"},null,8,["name","param"])])])):Ae("",!0),s.room.lastMessage&&!s.room.lastMessage.deleted&&r.isAudio?(Q(),ne("div",P2,[Oe(e.$slots,"microphone-icon_"+s.room.roomId,{},()=>[Re(o,{name:"microphone",class:"vac-icon-microphone"})]),ua(" "+$e(r.formattedDuration),1)])):s.room.lastMessage?(Q(),ht(l,{key:2,"message-id":s.room.lastMessage._id,"room-id":s.room.roomId,"room-list":!0,content:r.getLastMessage,deleted:!!s.room.lastMessage.deleted&&!r.typingUsers,users:s.room.users,"text-messages":s.textMessages,linkify:!1,"text-formatting":s.textFormatting,"link-options":s.linkOptions,"single-line":!0},gt({_:2},[at(e.$slots,(c,m)=>({name:m,fn:Xe(u=>[Oe(e.$slots,m,pt(_t(u)))])}))]),1032,["message-id","room-id","content","deleted","users","text-messages","text-formatting","link-options"])):Ae("",!0),!s.room.lastMessage&&r.typingUsers?(Q(),ne("div",F2,$e(r.typingUsers),1)):Ae("",!0),fe("div",D2,[s.room.unreadCount?(Q(),ne("div",U2,$e(s.room.unreadCount),1)):Ae("",!0),Oe(e.$slots,"room-list-options_"+s.room.roomId,{},()=>[s.roomActions.length?(Q(),ne("div",{key:0,class:"vac-svg-button vac-list-room-options",onClick:t[0]||(t[0]=Ds(c=>n.roomMenuOpened=s.room.roomId,["stop"]))},[Oe(e.$slots,"room-list-options-icon_"+s.room.roomId,{},()=>[Re(o,{name:"dropdown",param:"room"})])])):Ae("",!0),s.roomActions.length?(Q(),ht(Ct,{key:1,name:"vac-slide-left"},{default:Xe(()=>[n.roomMenuOpened===s.room.roomId?la((Q(),ne("div",q2,[fe("div",V2,[(Q(!0),ne(ut,null,at(s.roomActions,c=>(Q(),ne("div",{key:c.name},[fe("div",{class:"vac-menu-item",onClick:Ds(m=>r.roomActionHandler(c),["stop"])},$e(c.title),9,z2)]))),128))])])),[[v,r.closeRoomMenu]]):Ae("",!0)]),_:1})):Ae("",!0)])])],2)])])])}var X2=St(I2,[["render",Y2]]),Zo=(e,t,s,a=!1)=>!s||s===""?e:e.filter(n=>a?vi(n[t]).startsWith(vi(s)):vi(n[t]).includes(vi(s)));function vi(e){return e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}const K2={name:"RoomsList",components:{Loader:ai,RoomsSearch:rh,RoomContent:X2},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},showRoomsList:{type:Boolean,required:!0},showSearch:{type:Boolean,required:!0},showAddRoom:{type:Boolean,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},isMobile:{type:Boolean,required:!0},rooms:{type:Array,required:!0},loadingRooms:{type:Boolean,required:!0},roomsLoaded:{type:Boolean,required:!0},room:{type:Object,required:!0},customSearchRoomEnabled:{type:[Boolean,String],default:!1},roomActions:{type:Array,required:!0},scrollDistance:{type:Number,required:!0}},emits:["add-room","search-room","room-action-handler","loading-more-rooms","fetch-room","fetch-more-rooms"],data(){return{filteredRooms:this.rooms||[],observer:null,showLoader:!0,loadingMoreRooms:!1,selectedRoomId:""}},watch:{rooms:{deep:!0,handler(e,t){this.filteredRooms=e,(e.length!==t.length||this.roomsLoaded)&&(this.loadingMoreRooms=!1)}},loadingRooms(e){e||setTimeout(()=>this.initIntersectionObserver())},loadingMoreRooms(e){this.$emit("loading-more-rooms",e)},roomsLoaded:{immediate:!0,handler(e){e&&(this.loadingMoreRooms=!1,this.loadingRooms||(this.showLoader=!1))}},room:{immediate:!0,handler(e){e&&!this.isMobile&&(this.selectedRoomId=e.roomId)}}},methods:{initIntersectionObserver(){this.observer&&(this.showLoader=!0,this.observer.disconnect());const e=this.$el.querySelector("#infinite-loader-rooms");if(e){const t={root:this.$el.querySelector("#rooms-list"),rootMargin:`${this.scrollDistance}px`,threshold:0};this.observer=new IntersectionObserver(s=>{s[0].isIntersecting&&this.loadMoreRooms()},t),this.observer.observe(e)}},searchRoom(e){this.customSearchRoomEnabled?this.$emit("search-room",e.target.value):this.filteredRooms=Zo(this.rooms,"roomName",e.target.value)},openRoom(e){e.roomId===this.room.roomId&&!this.isMobile||(this.isMobile||(this.selectedRoomId=e.roomId),this.$emit("fetch-room",{room:e}))},loadMoreRooms(){if(!this.loadingMoreRooms){if(this.roomsLoaded){this.loadingMoreRooms=!1,this.showLoader=!1;return}this.$emit("fetch-more-rooms"),this.loadingMoreRooms=!0}}}},G2={key:0,class:"vac-rooms-empty"},W2={key:1,id:"rooms-list",class:"vac-room-list"},Z2=["id","onClick"],Q2={key:0,id:"infinite-loader-rooms"};function J2(e,t,s,a,n,r){const o=Ke("rooms-search"),l=Ke("loader"),v=Ke("room-content");return la((Q(),ne("div",{class:st(["vac-rooms-container",{"vac-rooms-container-full":s.isMobile,"vac-app-border-r":!s.isMobile}])},[Oe(e.$slots,"rooms-header"),Oe(e.$slots,"rooms-list-search",{},()=>[Re(o,{rooms:s.rooms,"loading-rooms":s.loadingRooms,"text-messages":s.textMessages,"show-search":s.showSearch,"show-add-room":s.showAddRoom,onSearchRoom:r.searchRoom,onAddRoom:t[0]||(t[0]=c=>e.$emit("add-room"))},gt({_:2},[at(e.$slots,(c,m)=>({name:m,fn:Xe(u=>[Oe(e.$slots,m,pt(_t(u)))])}))]),1032,["rooms","loading-rooms","text-messages","show-search","show-add-room","onSearchRoom"])]),Re(l,{show:s.loadingRooms,type:"rooms"},gt({_:2},[at(e.$slots,(c,m)=>({name:m,fn:Xe(u=>[Oe(e.$slots,m,pt(_t(u)))])}))]),1032,["show"]),!s.loadingRooms&&!s.rooms.length?(Q(),ne("div",G2,[Oe(e.$slots,"rooms-empty",{},()=>[ua($e(s.textMessages.ROOMS_EMPTY),1)])])):Ae("",!0),s.loadingRooms?Ae("",!0):(Q(),ne("div",W2,[(Q(!0),ne(ut,null,at(n.filteredRooms,c=>(Q(),ne("div",{id:c.roomId,key:c.roomId,class:st(["vac-room-item",{"vac-room-selected":n.selectedRoomId===c.roomId}]),onClick:m=>r.openRoom(c)},[Re(v,{"current-user-id":s.currentUserId,room:c,"text-formatting":s.textFormatting,"link-options":s.linkOptions,"text-messages":s.textMessages,"room-actions":s.roomActions,onRoomActionHandler:t[1]||(t[1]=m=>e.$emit("room-action-handler",m))},gt({_:2},[at(e.$slots,(m,u)=>({name:u,fn:Xe(p=>[Oe(e.$slots,u,pt(_t(p)))])}))]),1032,["current-user-id","room","text-formatting","link-options","text-messages","room-actions"])],10,Z2))),128)),Re(Ct,{name:"vac-fade-message"},{default:Xe(()=>[s.rooms.length&&!s.loadingRooms?(Q(),ne("div",Q2,[Re(l,{show:n.showLoader,infinite:!0,type:"infinite-rooms"},gt({_:2},[at(e.$slots,(c,m)=>({name:m,fn:Xe(u=>[Oe(e.$slots,m,pt(_t(u)))])}))]),1032,["show"])])):Ae("",!0)]),_:3})]))],2)),[[si,s.showRoomsList]])}var $2=St(K2,[["render",J2]]);const ev={name:"RoomHeader",components:{SvgIcon:Vt},directives:{clickOutside:mi},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},singleRoom:{type:Boolean,required:!0},showRoomsList:{type:Boolean,required:!0},isMobile:{type:Boolean,required:!0},roomInfoEnabled:{type:Boolean,required:!0},menuActions:{type:Array,required:!0},room:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0},messageSelectionActions:{type:Array,required:!0},selectedMessagesTotal:{type:Number,required:!0}},emits:["toggle-rooms-list","room-info","menu-action-handler","cancel-message-selection","message-selection-action-handler"],data(){return{menuOpened:!1,messageSelectionAnimationEnded:!0}},computed:{typingUsers(){return r1(this.room,this.currentUserId,this.textMessages)},userStatus(){if(!this.room.users||this.room.users.length!==2)return;const e=this.room.users.find(s=>s._id!==this.currentUserId);if(!(e!=null&&e.status))return;let t="";return e.status.state==="online"?t=this.textMessages.IS_ONLINE:e.status.lastChanged&&(t=this.textMessages.LAST_SEEN+e.status.lastChanged),t}},watch:{messageSelectionEnabled(e){e?this.messageSelectionAnimationEnded=!1:setTimeout(()=>{this.messageSelectionAnimationEnded=!0},300)}},methods:{menuActionHandler(e){this.closeMenu(),this.$emit("menu-action-handler",e)},closeMenu(){this.menuOpened=!1},messageSelectionActionHandler(e){this.$emit("message-selection-action-handler",e)}}},tv={class:"vac-room-header vac-app-border-b"},sv={class:"vac-room-wrapper"},av={key:0,class:"vac-room-selection"},rv=["id"],nv=["onClick"],iv={class:"vac-selection-button-count"},ov={class:"vac-text-ellipsis"},lv={class:"vac-room-name vac-text-ellipsis"},cv={key:0,class:"vac-room-info vac-text-ellipsis"},uv={key:1,class:"vac-room-info vac-text-ellipsis"},dv={key:0,class:"vac-menu-options"},fv={class:"vac-menu-list"},mv=["onClick"];function hv(e,t,s,a,n,r){const o=Ke("svg-icon"),l=Gn("click-outside");return Q(),ne("div",tv,[Oe(e.$slots,"room-header",{},()=>[fe("div",sv,[Re(Ct,{name:"vac-slide-up"},{default:Xe(()=>[s.messageSelectionEnabled?(Q(),ne("div",av,[(Q(!0),ne(ut,null,at(s.messageSelectionActions,v=>(Q(),ne("div",{id:v.name,key:v.name},[fe("div",{class:"vac-selection-button",onClick:c=>r.messageSelectionActionHandler(v)},[ua($e(v.title)+" ",1),fe("span",iv,$e(s.selectedMessagesTotal),1)],8,nv)],8,rv))),128)),fe("div",{class:"vac-selection-cancel vac-item-clickable",onClick:t[0]||(t[0]=v=>e.$emit("cancel-message-selection"))},$e(s.textMessages.CANCEL_SELECT_MESSAGE),1)])):Ae("",!0)]),_:1}),!s.messageSelectionEnabled&&n.messageSelectionAnimationEnded?(Q(),ne(ut,{key:0},[s.singleRoom?Ae("",!0):(Q(),ne("div",{key:0,class:st(["vac-svg-button vac-toggle-button",{"vac-rotate-icon-init":!s.isMobile,"vac-rotate-icon":!s.showRoomsList&&!s.isMobile}]),onClick:t[1]||(t[1]=v=>e.$emit("toggle-rooms-list"))},[Oe(e.$slots,"toggle-icon",{},()=>[Re(o,{name:"toggle"})])],2)),fe("div",{class:st(["vac-info-wrapper",{"vac-item-clickable":s.roomInfoEnabled}]),onClick:t[2]||(t[2]=v=>e.$emit("room-info"))},[Oe(e.$slots,"room-header-avatar",{},()=>[s.room.avatar?(Q(),ne("div",{key:0,class:"vac-avatar",style:xt({"background-image":`url('${s.room.avatar}')`})},null,4)):Ae("",!0)]),Oe(e.$slots,"room-header-info",{},()=>[fe("div",ov,[fe("div",lv,$e(s.room.roomName),1),r.typingUsers?(Q(),ne("div",cv,$e(r.typingUsers),1)):(Q(),ne("div",uv,$e(r.userStatus),1))])])],2),s.room.roomId?Oe(e.$slots,"room-options",{key:1},()=>[s.menuActions.length?(Q(),ne("div",{key:0,class:"vac-svg-button vac-room-options",onClick:t[3]||(t[3]=v=>n.menuOpened=!n.menuOpened)},[Oe(e.$slots,"menu-icon",{},()=>[Re(o,{name:"menu"})])])):Ae("",!0),s.menuActions.length?(Q(),ht(Ct,{key:1,name:"vac-slide-left"},{default:Xe(()=>[n.menuOpened?la((Q(),ne("div",dv,[fe("div",fv,[(Q(!0),ne(ut,null,at(s.menuActions,v=>(Q(),ne("div",{key:v.name},[fe("div",{class:"vac-menu-item",onClick:c=>r.menuActionHandler(v)},$e(v.title),9,mv)]))),128))])])),[[l,r.closeMenu]]):Ae("",!0)]),_:1})):Ae("",!0)]):Ae("",!0)],64)):Ae("",!0)])])])}var vv=St(ev,[["render",hv]]);function _i(e){if(typeof e!="string"||!e)throw new Error("expected a non-empty string, got: "+e)}function Qo(e){if(typeof e!="number")throw new Error("expected a number, got: "+e)}const _v=1,pv=1,qa="emoji",vr="keyvalue",Jo="favorites",gv="tokens",i1="tokens",bv="unicode",o1="count",yv="group",xv="order",l1="group-order",$o="eTag",pi="url",c1="skinTone",_r="readonly",el="readwrite",u1="skinUnicodes",wv="skinUnicodes",Sv="https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",Mv="en";function Tv(e,t){const s=new Set,a=[];for(const n of e){const r=t(n);s.has(r)||(s.add(r),a.push(n))}return a}function d1(e){return Tv(e,t=>t.unicode)}function Ev(e){function t(s,a,n){const r=a?e.createObjectStore(s,{keyPath:a}):e.createObjectStore(s);if(n)for(const[o,[l,v]]of Object.entries(n))r.createIndex(o,l,{multiEntry:v});return r}t(vr),t(qa,bv,{[i1]:[gv,!0],[l1]:[[yv,xv]],[u1]:[wv,!0]}),t(Jo,void 0,{[o1]:[""]})}const tl={},gi={},bi={};function f1(e,t,s){s.onerror=()=>t(s.error),s.onblocked=()=>t(new Error("IDB blocked")),s.onsuccess=()=>e(s.result)}async function Av(e){const t=await new Promise((s,a)=>{const n=indexedDB.open(e,_v);tl[e]=n,n.onupgradeneeded=r=>{r.oldVersion<pv&&Ev(n.result)},f1(s,a,n)});return t.onclose=()=>sl(e),t}function kv(e){return gi[e]||(gi[e]=Av(e)),gi[e]}function ta(e,t,s,a){return new Promise((n,r)=>{const o=e.transaction(t,s,{durability:"relaxed"}),l=typeof t=="string"?o.objectStore(t):t.map(c=>o.objectStore(c));let v;a(l,o,c=>{v=c}),o.oncomplete=()=>n(v),o.onerror=()=>r(o.error)})}function sl(e){const t=tl[e],s=t&&t.result;if(s){s.close();const a=bi[e];if(a)for(const n of a)n()}delete tl[e],delete gi[e],delete bi[e]}function Rv(e){return new Promise((t,s)=>{sl(e);const a=indexedDB.deleteDatabase(e);f1(t,s,a)})}function Ov(e,t){let s=bi[e];s||(s=bi[e]=[]),s.push(t)}const Iv=new Set([":D","XD",":'D","O:)",":X",":P",";P","XP",":L",":Z",":j","8D","XO","8)",":B",":O",":S",":'o","Dx","X(","D:",":C",">0)",":3","</3","<3","\\M/",":E","8#"]);function pr(e){return e.split(/[\s_]+/).map(t=>!t.match(/\w/)||Iv.has(t)?t.toLowerCase():t.replace(/[)(:,]/g,"").replace(/’/g,"'").toLowerCase()).filter(Boolean)}const Cv=2;function m1(e){return e.filter(Boolean).map(t=>t.toLowerCase()).filter(t=>t.length>=Cv)}function Bv(e){return e.map(({annotation:s,emoticon:a,group:n,order:r,shortcodes:o,skins:l,tags:v,emoji:c,version:m})=>{const u=[...new Set(m1([...(o||[]).map(pr).flat(),...v.map(pr).flat(),...pr(s),a]))].sort(),p={annotation:s,group:n,order:r,tags:v,tokens:u,unicode:c,version:m};if(a&&(p.emoticon=a),o&&(p.shortcodes=o),l){p.skinTones=[],p.skinUnicodes=[],p.skinVersions=[];for(const{tone:y,emoji:i,version:H}of l)p.skinTones.push(y),p.skinUnicodes.push(i),p.skinVersions.push(H)}return p})}function h1(e,t,s,a){e[t](s).onsuccess=n=>a&&a(n.target.result)}function Va(e,t,s){h1(e,"get",t,s)}function v1(e,t,s){h1(e,"getAll",t,s)}function al(e){e.commit&&e.commit()}function Lv(e,t){let s=e[0];for(let a=1;a<e.length;a++){const n=e[a];t(s)>t(n)&&(s=n)}return s}function _1(e,t){const s=Lv(e,n=>n.length),a=[];for(const n of s)e.some(r=>r.findIndex(o=>t(o)===t(n))===-1)||a.push(n);return a}async function Nv(e){return!await rl(e,vr,pi)}async function jv(e,t,s){const[a,n]=await Promise.all([$o,pi].map(r=>rl(e,vr,r)));return a===s&&n===t}async function Hv(e,t){return ta(e,qa,_r,(a,n,r)=>{let o;const l=()=>{a.getAll(o&&IDBKeyRange.lowerBound(o,!0),50).onsuccess=v=>{const c=v.target.result;for(const m of c)if(o=m.unicode,t(m))return r(m);if(c.length<50)return r();l()}};l()})}async function p1(e,t,s,a){try{const n=Bv(t);await ta(e,[qa,vr],el,([r,o],l)=>{let v,c,m=0;function u(){++m===2&&p()}function p(){if(!(v===a&&c===s)){r.clear();for(const y of n)r.put(y);o.put(a,$o),o.put(s,pi),al(l)}}Va(o,$o,y=>{v=y,u()}),Va(o,pi,y=>{c=y,u()})})}finally{}}async function Pv(e,t){return ta(e,qa,_r,(s,a,n)=>{const r=IDBKeyRange.bound([t,0],[t+1,0],!1,!0);v1(s.index(l1),r,n)})}async function g1(e,t){const s=m1(pr(t));return s.length?ta(e,qa,_r,(a,n,r)=>{const o=[],l=()=>{o.length===s.length&&v()},v=()=>{const c=_1(o,m=>m.unicode);r(c.sort((m,u)=>m.order<u.order?-1:1))};for(let c=0;c<s.length;c++){const m=s[c],u=c===s.length-1?IDBKeyRange.bound(m,m+"\uFFFF",!1,!0):IDBKeyRange.only(m);v1(a.index(i1),u,p=>{o.push(p),l()})}}):[]}async function Fv(e,t){const s=await g1(e,t);return s.length?s.filter(a=>(a.shortcodes||[]).map(r=>r.toLowerCase()).includes(t.toLowerCase()))[0]||null:await Hv(e,n=>(n.shortcodes||[]).includes(t.toLowerCase()))||null}async function Dv(e,t){return ta(e,qa,_r,(s,a,n)=>Va(s,t,r=>{if(r)return n(r);Va(s.index(u1),t,o=>n(o||null))}))}function rl(e,t,s){return ta(e,t,_r,(a,n,r)=>Va(a,s,r))}function Uv(e,t,s,a){return ta(e,t,el,(n,r)=>{n.put(a,s),al(r)})}function qv(e,t){return ta(e,Jo,el,(s,a)=>Va(s,t,n=>{s.put((n||0)+1,t),al(a)}))}function Vv(e,t,s){return s===0?[]:ta(e,[Jo,qa],_r,([a,n],r,o)=>{const l=[];a.index(o1).openCursor(void 0,"prev").onsuccess=v=>{const c=v.target.result;if(!c)return o(l);function m(y){if(l.push(y),l.length===s)return o(l);c.continue()}const u=c.primaryKey,p=t.byName(u);if(p)return m(p);Va(n,u,y=>{if(y)return m(y);c.continue()})}})}const yi="";function zv(e,t){const s=new Map;for(const n of e){const r=t(n);for(const o of r){let l=s;for(let c=0;c<o.length;c++){const m=o.charAt(c);let u=l.get(m);u||(u=new Map,l.set(m,u)),l=u}let v=l.get(yi);v||(v=[],l.set(yi,v)),v.push(n)}}return(n,r)=>{let o=s;for(let c=0;c<n.length;c++){const m=n.charAt(c),u=o.get(m);if(u)o=u;else return[]}if(r)return o.get(yi)||[];const l=[],v=[o];for(;v.length;){const m=[...v.shift().entries()].sort((u,p)=>u[0]<p[0]?-1:1);for(const[u,p]of m)u===yi?l.push(...p):v.push(p)}return l}}const Yv=["name","url"];function Xv(e){const t=e&&Array.isArray(e),s=t&&e.length&&(!e[0]||Yv.some(a=>!(a in e[0])));if(!t||s)throw new Error("Custom emojis are in the wrong format")}function b1(e){Xv(e);const t=(p,y)=>p.name.toLowerCase()<y.name.toLowerCase()?-1:1,s=e.sort(t),n=zv(e,p=>[...new Set((p.shortcodes||[]).map(y=>pr(y)).flat())]),r=p=>n(p,!0),o=p=>n(p,!1),l=p=>{const y=pr(p),i=y.map((H,L)=>(L<y.length-1?r:o)(H));return _1(i,H=>H.name).sort(t)},v=new Map,c=new Map;for(const p of e){c.set(p.name.toLowerCase(),p);for(const y of p.shortcodes||[])v.set(y.toLowerCase(),p)}return{all:s,search:l,byShortcode:p=>v.get(p.toLowerCase()),byName:p=>c.get(p.toLowerCase())}}function nn(e){if(!e)return e;if(delete e.tokens,e.skinTones){const t=e.skinTones.length;e.skins=Array(t);for(let s=0;s<t;s++)e.skins[s]={tone:e.skinTones[s],unicode:e.skinUnicodes[s],version:e.skinVersions[s]};delete e.skinTones,delete e.skinUnicodes,delete e.skinVersions}return e}function y1(e){e||console.warn("emoji-picker-element is more efficient if the dataSource server exposes an ETag header.")}const Kv=["annotation","emoji","group","order","tags","version"];function Gv(e){if(!e||!Array.isArray(e)||!e[0]||typeof e[0]!="object"||Kv.some(t=>!(t in e[0])))throw new Error("Emoji data is in the wrong format")}function x1(e,t){if(Math.floor(e.status/100)!==2)throw new Error("Failed to fetch: "+t+":  "+e.status)}async function Wv(e){const t=await fetch(e,{method:"HEAD"});x1(t,e);const s=t.headers.get("etag");return y1(s),s}async function nl(e){const t=await fetch(e);x1(t,e);const s=t.headers.get("etag");y1(s);const a=await t.json();return Gv(a),[s,a]}function Zv(e){for(var t="",s=new Uint8Array(e),a=s.byteLength,n=-1;++n<a;)t+=String.fromCharCode(s[n]);return t}function Qv(e){for(var t=e.length,s=new ArrayBuffer(t),a=new Uint8Array(s),n=-1;++n<t;)a[n]=e.charCodeAt(n);return s}async function w1(e){const t=JSON.stringify(e),s=Qv(t),a=await crypto.subtle.digest("SHA-1",s),n=Zv(a);return btoa(n)}async function Jv(e,t){let s,a=await Wv(t);if(!a){const n=await nl(t);a=n[0],s=n[1],a||(a=await w1(s))}await jv(e,t,a)||(s||(s=(await nl(t))[1]),await p1(e,s,t,a))}async function $v(e,t){let[s,a]=await nl(t);s||(s=await w1(a)),await p1(e,a,t,s)}class S1{constructor({dataSource:t=Sv,locale:s=Mv,customEmoji:a=[]}={}){this.dataSource=t,this.locale=s,this._dbName=`emoji-picker-element-${this.locale}`,this._db=void 0,this._lazyUpdate=void 0,this._custom=b1(a),this._clear=this._clear.bind(this),this._ready=this._init()}async _init(){const t=this._db=await kv(this._dbName);Ov(this._dbName,this._clear);const s=this.dataSource;await Nv(t)?await $v(t,s):this._lazyUpdate=Jv(t,s)}async ready(){const t=async()=>(this._ready||(this._ready=this._init()),this._ready);await t(),this._db||await t()}async getEmojiByGroup(t){return Qo(t),await this.ready(),d1(await Pv(this._db,t)).map(nn)}async getEmojiBySearchQuery(t){_i(t),await this.ready();const s=this._custom.search(t),a=d1(await g1(this._db,t)).map(nn);return[...s,...a]}async getEmojiByShortcode(t){_i(t),await this.ready();const s=this._custom.byShortcode(t);return s||nn(await Fv(this._db,t))}async getEmojiByUnicodeOrName(t){_i(t),await this.ready();const s=this._custom.byName(t);return s||nn(await Dv(this._db,t))}async getPreferredSkinTone(){return await this.ready(),await rl(this._db,vr,c1)||0}async setPreferredSkinTone(t){return Qo(t),await this.ready(),Uv(this._db,vr,c1,t)}async incrementFavoriteEmojiCount(t){return _i(t),await this.ready(),qv(this._db,t)}async getTopFavoriteEmoji(t){return Qo(t),await this.ready(),(await Vv(this._db,this._custom,t)).map(nn)}set customEmoji(t){this._custom=b1(t)}get customEmoji(){return this._custom.all}async _shutdown(){await this.ready();try{await this._lazyUpdate}catch{}}_clear(){this._db=this._ready=this._lazyUpdate=void 0}async close(){await this._shutdown(),await sl(this._dbName)}async delete(){await this._shutdown(),await Rv(this._dbName)}}function on(){}function M1(e){return e()}function T1(){return Object.create(null)}function ln(e){e.forEach(M1)}function E1(e){return typeof e=="function"}function e_(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}let xi;function wi(e,t){return xi||(xi=document.createElement("a")),xi.href=t,e===xi.href}function t_(e){return Object.keys(e).length===0}function s_(e){return e&&E1(e.destroy)?e.destroy:on}function Tt(e,t){e.appendChild(t)}function Is(e,t,s){e.insertBefore(t,s||null)}function Cs(e){e.parentNode.removeChild(e)}function yt(e){return document.createElement(e)}function Vs(e){return document.createTextNode(e)}function Bs(e,t,s,a){return e.addEventListener(t,s,a),()=>e.removeEventListener(t,s,a)}function se(e,t,s){s==null?e.removeAttribute(t):e.getAttribute(t)!==s&&e.setAttribute(t,s)}function zs(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function A1(e,t){e.value=t==null?"":t}function _a(e,t,s,a){s===null?e.style.removeProperty(t):e.style.setProperty(t,s,a?"important":"")}let il;function cn(e){il=e}const un=[],gr=[],Si=[],k1=[],R1=Promise.resolve();let ol=!1;function O1(){ol||(ol=!0,R1.then(I1))}function a_(){return O1(),R1}function ll(e){Si.push(e)}const cl=new Set;let Mi=0;function I1(){const e=il;do{for(;Mi<un.length;){const t=un[Mi];Mi++,cn(t),r_(t.$$)}for(cn(null),un.length=0,Mi=0;gr.length;)gr.pop()();for(let t=0;t<Si.length;t+=1){const s=Si[t];cl.has(s)||(cl.add(s),s())}Si.length=0}while(un.length);for(;k1.length;)k1.pop()();ol=!1,cl.clear(),cn(e)}function r_(e){if(e.fragment!==null){e.update(),ln(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(ll)}}const n_=new Set;function i_(e,t){e&&e.i&&(n_.delete(e),e.i(t))}const o_=typeof window!="undefined"?window:typeof globalThis!="undefined"?globalThis:global;function dn(e,t){e.d(1),t.delete(e.key)}function fn(e,t,s,a,n,r,o,l,v,c,m,u){let p=e.length,y=r.length,i=p;const H={};for(;i--;)H[e[i].key]=i;const L=[],N=new Map,h=new Map;for(i=y;i--;){const B=u(n,r,i),d=s(B);let E=o.get(d);E?a&&E.p(B,t):(E=c(d,B),E.c()),N.set(d,L[i]=E),d in H&&h.set(d,Math.abs(i-H[d]))}const k=new Set,C=new Set;function A(B){i_(B,1),B.m(l,m),o.set(B.key,B),m=B.first,y--}for(;p&&y;){const B=L[y-1],d=e[p-1],E=B.key,S=d.key;B===d?(m=B.first,p--,y--):N.has(S)?!o.has(E)||k.has(E)?A(B):C.has(S)?p--:h.get(E)>h.get(S)?(C.add(E),A(B)):(k.add(S),p--):(v(d,o),p--)}for(;p--;){const B=e[p];N.has(B.key)||v(B,o)}for(;y;)A(L[y-1]);return L}function l_(e,t,s,a){const{fragment:n,on_mount:r,on_destroy:o,after_update:l}=e.$$;n&&n.m(t,s),a||ll(()=>{const v=r.map(M1).filter(E1);o?o.push(...v):ln(v),e.$$.on_mount=[]}),l.forEach(ll)}function c_(e,t){const s=e.$$;s.fragment!==null&&(ln(s.on_destroy),s.fragment&&s.fragment.d(t),s.on_destroy=s.fragment=null,s.ctx=[])}function u_(e,t){e.$$.dirty[0]===-1&&(un.push(e),O1(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function d_(e,t,s,a,n,r,o,l=[-1]){const v=il;cn(e);const c=e.$$={fragment:null,ctx:null,props:r,update:on,not_equal:n,bound:T1(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(v?v.$$.context:[]),callbacks:T1(),dirty:l,skip_bound:!1,root:t.target||v.$$.root};o&&o(c.root);let m=!1;c.ctx=s?s(e,t.props||{},(u,p,...y)=>{const i=y.length?y[0]:p;return c.ctx&&n(c.ctx[u],c.ctx[u]=i)&&(!c.skip_bound&&c.bound[u]&&c.bound[u](i),m&&u_(e,u)),p}):[],c.update(),m=!0,ln(c.before_update),c.fragment=a?a(c.ctx):!1,t.target&&(c.fragment&&c.fragment.c(),l_(e,t.target,void 0,void 0),I1()),cn(v)}class f_{$destroy(){c_(this,1),this.$destroy=on}$on(t,s){const a=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return a.push(s),()=>{const n=a.indexOf(s);n!==-1&&a.splice(n,1)}}$set(t){this.$$set&&!t_(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const C1=[[-1,"\u2728","custom"],[0,"\u{1F600}","smileys-emotion"],[1,"\u{1F44B}","people-body"],[3,"\u{1F431}","animals-nature"],[4,"\u{1F34E}","food-drink"],[5,"\u{1F3E0}\uFE0F","travel-places"],[6,"\u26BD","activities"],[7,"\u{1F4DD}","objects"],[8,"\u26D4\uFE0F","symbols"],[9,"\u{1F3C1}","flags"]].map(([e,t,s])=>({id:e,emoji:t,name:s})),Ti=C1.slice(1),m_=C1[0],h_=2,B1=6,L1=typeof requestIdleCallback=="function"?requestIdleCallback:setTimeout;function N1(e){return e.unicode.includes("\u200D")}const v_={"\u{1FAE0}":14,"\u{1F972}":13.1,"\u{1F97B}":12.1,"\u{1F970}":11,"\u{1F929}":5,"\u{1F471}\u200D\u2640\uFE0F":4,"\u{1F923}":3,"\u{1F441}\uFE0F\u200D\u{1F5E8}\uFE0F":2,"\u{1F600}":1,"\u{1F610}\uFE0F":.7,"\u{1F603}":.6},__=1e3,p_="\u{1F590}\uFE0F",g_=8,b_=["\u{1F60A}","\u{1F612}","\u2665\uFE0F","\u{1F44D}\uFE0F","\u{1F60D}","\u{1F602}","\u{1F62D}","\u263A\uFE0F","\u{1F614}","\u{1F629}","\u{1F60F}","\u{1F495}","\u{1F64C}","\u{1F618}"],j1='"Twemoji Mozilla","Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji","EmojiOne Color","Android Emoji",sans-serif',y_=(e,t)=>e<t?-1:e>t?1:0,H1=(e,t)=>{const s=document.createElement("canvas");s.width=s.height=1;const a=s.getContext("2d");return a.textBaseline="top",a.font=`100px ${j1}`,a.fillStyle=t,a.scale(.01,.01),a.fillText(e,0,0),a.getImageData(0,0,1,1).data},x_=(e,t)=>{const s=[...e].join(","),a=[...t].join(",");return s===a&&!s.startsWith("0,0,0,")};function w_(e){const t=H1(e,"#000"),s=H1(e,"#fff");return t&&s&&x_(t,s)}function S_(){const e=Object.entries(v_);try{for(const[t,s]of e)if(w_(t))return s}catch{}finally{}return e[0][1]}const ul=new Promise(e=>L1(()=>e(S_()))),dl=new Map,M_="\uFE0F",T_="\uD83C",E_="\u200D",A_=127995,k_=57339;function R_(e,t){if(t===0)return e;const s=e.indexOf(E_);return s!==-1?e.substring(0,s)+String.fromCodePoint(A_+t-1)+e.substring(s):(e.endsWith(M_)&&(e=e.substring(0,e.length-1)),e+T_+String.fromCodePoint(k_+t-1))}function pa(e){e.preventDefault(),e.stopPropagation()}function fl(e,t,s){return t+=e?-1:1,t<0?t=s.length-1:t>=s.length&&(t=0),t}function P1(e,t){const s=new Set,a=[];for(const n of e){const r=t(n);s.has(r)||(s.add(r),a.push(n))}return a}function O_(e,t){const s=a=>{const n={};for(const r of a)typeof r.tone=="number"&&r.version<=t&&(n[r.tone]=r.unicode);return n};return e.map(({unicode:a,skins:n,shortcodes:r,url:o,name:l,category:v})=>({unicode:a,name:l,shortcodes:r,url:o,category:v,id:a||l,skins:n&&s(n),title:(r||[]).join(", ")}))}const Ei=requestAnimationFrame;let I_=typeof ResizeObserver=="function";function C_(e,t){let s;return I_?(s=new ResizeObserver(a=>t(a[0].contentRect.width)),s.observe(e)):Ei(()=>t(e.getBoundingClientRect().width)),{destroy(){s&&s.disconnect()}}}function F1(e){{const t=document.createRange();return t.selectNode(e.firstChild),t.getBoundingClientRect().width}}let ml;function B_(e,t,s){for(const a of e){const n=s(a),r=F1(n);typeof ml=="undefined"&&(ml=F1(t));const o=r/1.8<ml;dl.set(a.unicode,o)}}function L_(e){return P1(e,t=>t)}const{Map:mn}=o_;function D1(e,t,s){const a=e.slice();return a[63]=t[s],a[65]=s,a}function U1(e,t,s){const a=e.slice();return a[66]=t[s],a[65]=s,a}function q1(e,t,s){const a=e.slice();return a[63]=t[s],a[65]=s,a}function V1(e,t,s){const a=e.slice();return a[69]=t[s],a}function z1(e,t,s){const a=e.slice();return a[72]=t[s],a[65]=s,a}function Y1(e,t){let s,a=t[72]+"",n,r,o,l,v,c;return{key:e,first:null,c(){s=yt("div"),n=Vs(a),se(s,"id",r="skintone-"+t[65]),se(s,"class",o="emoji hide-focus "+(t[65]===t[20]?"active":"")),se(s,"aria-selected",l=t[65]===t[20]),se(s,"role","option"),se(s,"title",v=t[0].skinTones[t[65]]),se(s,"tabindex","-1"),se(s,"aria-label",c=t[0].skinTones[t[65]]),this.first=s},m(m,u){Is(m,s,u),Tt(s,n)},p(m,u){t=m,u[0]&512&&a!==(a=t[72]+"")&&zs(n,a),u[0]&512&&r!==(r="skintone-"+t[65])&&se(s,"id",r),u[0]&1049088&&o!==(o="emoji hide-focus "+(t[65]===t[20]?"active":""))&&se(s,"class",o),u[0]&1049088&&l!==(l=t[65]===t[20])&&se(s,"aria-selected",l),u[0]&513&&v!==(v=t[0].skinTones[t[65]])&&se(s,"title",v),u[0]&513&&c!==(c=t[0].skinTones[t[65]])&&se(s,"aria-label",c)},d(m){m&&Cs(s)}}}function X1(e,t){let s,a,n=t[69].emoji+"",r,o,l,v,c,m,u;function p(){return t[49](t[69])}return{key:e,first:null,c(){s=yt("button"),a=yt("div"),r=Vs(n),se(a,"class","nav-emoji emoji"),se(s,"role","tab"),se(s,"class","nav-button"),se(s,"aria-controls",o="tab-"+t[69].id),se(s,"aria-label",l=t[0].categories[t[69].name]),se(s,"aria-selected",v=!t[4]&&t[13].id===t[69].id),se(s,"title",c=t[0].categories[t[69].name]),this.first=s},m(y,i){Is(y,s,i),Tt(s,a),Tt(a,r),m||(u=Bs(s,"click",p),m=!0)},p(y,i){t=y,i[0]&4096&&n!==(n=t[69].emoji+"")&&zs(r,n),i[0]&4096&&o!==(o="tab-"+t[69].id)&&se(s,"aria-controls",o),i[0]&4097&&l!==(l=t[0].categories[t[69].name])&&se(s,"aria-label",l),i[0]&12304&&v!==(v=!t[4]&&t[13].id===t[69].id)&&se(s,"aria-selected",v),i[0]&4097&&c!==(c=t[0].categories[t[69].name])&&se(s,"title",c)},d(y){y&&Cs(s),m=!1,u()}}}function N_(e){let t,s;return{c(){t=yt("img"),se(t,"class","custom-emoji"),wi(t.src,s=e[63].url)||se(t,"src",s),se(t,"alt",""),se(t,"loading","lazy")},m(a,n){Is(a,t,n)},p(a,n){n[0]&32768&&!wi(t.src,s=a[63].url)&&se(t,"src",s)},d(a){a&&Cs(t)}}}function j_(e){let t=e[27](e[63],e[8])+"",s;return{c(){s=Vs(t)},m(a,n){Is(a,s,n)},p(a,n){n[0]&33024&&t!==(t=a[27](a[63],a[8])+"")&&zs(s,t)},d(a){a&&Cs(s)}}}function K1(e,t){let s,a,n,r,o,l,v;function c(p,y){return p[63].unicode?j_:N_}let m=c(t),u=m(t);return{key:e,first:null,c(){s=yt("button"),u.c(),se(s,"role",a=t[4]?"option":"menuitem"),se(s,"aria-selected",n=t[4]?t[65]==t[5]:""),se(s,"aria-label",r=t[28](t[63],t[8])),se(s,"title",o=t[63].title),se(s,"class",l="emoji "+(t[4]&&t[65]===t[5]?"active":"")),se(s,"id",v="emo-"+t[63].id),this.first=s},m(p,y){Is(p,s,y),u.m(s,null)},p(p,y){t=p,m===(m=c(t))&&u?u.p(t,y):(u.d(1),u=m(t),u&&(u.c(),u.m(s,null))),y[0]&16&&a!==(a=t[4]?"option":"menuitem")&&se(s,"role",a),y[0]&32816&&n!==(n=t[4]?t[65]==t[5]:"")&&se(s,"aria-selected",n),y[0]&33024&&r!==(r=t[28](t[63],t[8]))&&se(s,"aria-label",r),y[0]&32768&&o!==(o=t[63].title)&&se(s,"title",o),y[0]&32816&&l!==(l="emoji "+(t[4]&&t[65]===t[5]?"active":""))&&se(s,"class",l),y[0]&32768&&v!==(v="emo-"+t[63].id)&&se(s,"id",v)},d(p){p&&Cs(s),u.d()}}}function G1(e,t){let s,a=(t[4]?t[0].searchResultsLabel:t[66].category?t[66].category:t[15].length>1?t[0].categories.custom:t[0].categories[t[13].name])+"",n,r,o,l,v=[],c=new mn,m,u,p,y=t[66].emojis;const i=H=>H[63].id;for(let H=0;H<y.length;H+=1){let L=q1(t,y,H),N=i(L);c.set(N,v[H]=K1(N,L))}return{key:e,first:null,c(){s=yt("div"),n=Vs(a),l=yt("div");for(let H=0;H<v.length;H+=1)v[H].c();se(s,"id",r="menu-label-"+t[65]),se(s,"class",o="category "+(t[15].length===1&&t[15][0].category===""?"gone":"")),se(s,"aria-hidden","true"),se(l,"class","emoji-menu"),se(l,"role",m=t[4]?"listbox":"menu"),se(l,"aria-labelledby",u="menu-label-"+t[65]),se(l,"id",p=t[4]?"search-results":""),this.first=s},m(H,L){Is(H,s,L),Tt(s,n),Is(H,l,L);for(let N=0;N<v.length;N+=1)v[N].m(l,null)},p(H,L){t=H,L[0]&40977&&a!==(a=(t[4]?t[0].searchResultsLabel:t[66].category?t[66].category:t[15].length>1?t[0].categories.custom:t[0].categories[t[13].name])+"")&&zs(n,a),L[0]&32768&&r!==(r="menu-label-"+t[65])&&se(s,"id",r),L[0]&32768&&o!==(o="category "+(t[15].length===1&&t[15][0].category===""?"gone":""))&&se(s,"class",o),L[0]&402686256&&(y=t[66].emojis,v=fn(v,L,i,1,t,y,c,l,dn,K1,null,q1)),L[0]&16&&m!==(m=t[4]?"listbox":"menu")&&se(l,"role",m),L[0]&32768&&u!==(u="menu-label-"+t[65])&&se(l,"aria-labelledby",u),L[0]&16&&p!==(p=t[4]?"search-results":"")&&se(l,"id",p)},d(H){H&&Cs(s),H&&Cs(l);for(let L=0;L<v.length;L+=1)v[L].d()}}}function H_(e){let t,s;return{c(){t=yt("img"),se(t,"class","custom-emoji"),wi(t.src,s=e[63].url)||se(t,"src",s),se(t,"alt",""),se(t,"loading","lazy")},m(a,n){Is(a,t,n)},p(a,n){n[0]&1024&&!wi(t.src,s=a[63].url)&&se(t,"src",s)},d(a){a&&Cs(t)}}}function P_(e){let t=e[27](e[63],e[8])+"",s;return{c(){s=Vs(t)},m(a,n){Is(a,s,n)},p(a,n){n[0]&1280&&t!==(t=a[27](a[63],a[8])+"")&&zs(s,t)},d(a){a&&Cs(s)}}}function W1(e,t){let s,a,n,r;function o(c,m){return c[63].unicode?P_:H_}let l=o(t),v=l(t);return{key:e,first:null,c(){s=yt("button"),v.c(),se(s,"role","menuitem"),se(s,"aria-label",a=t[28](t[63],t[8])),se(s,"title",n=t[63].title),se(s,"class","emoji"),se(s,"id",r="fav-"+t[63].id),this.first=s},m(c,m){Is(c,s,m),v.m(s,null)},p(c,m){t=c,l===(l=o(t))&&v?v.p(t,m):(v.d(1),v=l(t),v&&(v.c(),v.m(s,null))),m[0]&1280&&a!==(a=t[28](t[63],t[8]))&&se(s,"aria-label",a),m[0]&1024&&n!==(n=t[63].title)&&se(s,"title",n),m[0]&1024&&r!==(r="fav-"+t[63].id)&&se(s,"id",r)},d(c){c&&Cs(s),v.d()}}}function F_(e){let t,s,a,n,r,o,l,v,c,m=e[0].searchLabel+"",u,p,y=e[0].searchDescription+"",i,H,L,N,h,k,C,A=e[0].skinToneDescription+"",B,d,E=[],S=new mn,_,x,b,g,M,w=[],j=new mn,X,F,V,f,T,W,Z,de,Me=[],Te=new mn,ve,De,Le,me,Ge,ot=[],D=new mn,z,te,le,ue,xe,Ee,be=e[9];const Se=ce=>ce[72];for(let ce=0;ce<be.length;ce+=1){let ye=z1(e,be,ce),$=Se(ye);S.set($,E[ce]=Y1($,ye))}let he=e[12];const Pe=ce=>ce[69].id;for(let ce=0;ce<he.length;ce+=1){let ye=V1(e,he,ce),$=Pe(ye);j.set($,w[ce]=X1($,ye))}let Ne=e[15];const Fe=ce=>ce[66].category;for(let ce=0;ce<Ne.length;ce+=1){let ye=U1(e,Ne,ce),$=Fe(ye);Te.set($,Me[ce]=G1($,ye))}let Ue=e[10];const We=ce=>ce[63].id;for(let ce=0;ce<Ue.length;ce+=1){let ye=D1(e,Ue,ce),$=We(ye);D.set($,ot[ce]=W1($,ye))}return{c(){t=yt("section"),s=yt("div"),a=yt("div"),n=yt("div"),r=yt("input"),c=yt("label"),u=Vs(m),p=yt("span"),i=Vs(y),H=yt("div"),L=yt("button"),N=Vs(e[21]),C=yt("span"),B=Vs(A),d=yt("div");for(let ce=0;ce<E.length;ce+=1)E[ce].c();M=yt("div");for(let ce=0;ce<w.length;ce+=1)w[ce].c();F=yt("div"),V=yt("div"),f=yt("div"),T=Vs(e[18]),Z=yt("div"),de=yt("div");for(let ce=0;ce<Me.length;ce+=1)Me[ce].c();Ge=yt("div");for(let ce=0;ce<ot.length;ce+=1)ot[ce].c();le=yt("button"),le.textContent="\u{1F600}",se(s,"class","pad-top"),se(r,"id","search"),se(r,"class","search"),se(r,"type","search"),se(r,"role","combobox"),se(r,"enterkeyhint","search"),se(r,"placeholder",o=e[0].searchLabel),se(r,"autocapitalize","none"),se(r,"autocomplete","off"),se(r,"spellcheck","true"),se(r,"aria-expanded",l=!!(e[4]&&e[1].length)),se(r,"aria-controls","search-results"),se(r,"aria-describedby","search-description"),se(r,"aria-autocomplete","list"),se(r,"aria-activedescendant",v=e[26]?`emo-${e[26]}`:""),se(c,"class","sr-only"),se(c,"for","search"),se(p,"id","search-description"),se(p,"class","sr-only"),se(n,"class","search-wrapper"),se(L,"id","skintone-button"),se(L,"class",h="emoji "+(e[6]?"hide-focus":"")),se(L,"aria-label",e[23]),se(L,"title",e[23]),se(L,"aria-describedby","skintone-description"),se(L,"aria-haspopup","listbox"),se(L,"aria-expanded",e[6]),se(L,"aria-controls","skintone-list"),se(H,"class",k="skintone-button-wrapper "+(e[19]?"expanded":"")),se(C,"id","skintone-description"),se(C,"class","sr-only"),se(d,"id","skintone-list"),se(d,"class",_="skintone-list "+(e[6]?"":"hidden no-animate")),_a(d,"transform","translateY("+(e[6]?0:"calc(-1 * var(--num-skintones) * var(--total-emoji-size))")+")"),se(d,"role","listbox"),se(d,"aria-label",x=e[0].skinTonesLabel),se(d,"aria-activedescendant",b="skintone-"+e[20]),se(d,"aria-hidden",g=!e[6]),se(a,"class","search-row"),se(M,"class","nav"),se(M,"role","tablist"),_a(M,"grid-template-columns","repeat("+e[12].length+", 1fr)"),se(M,"aria-label",X=e[0].categoriesLabel),se(V,"class","indicator"),_a(V,"transform","translateX("+(e[24]?-1:1)*e[11]*100+"%)"),se(F,"class","indicator-wrapper"),se(f,"class",W="message "+(e[18]?"":"gone")),se(f,"role","alert"),se(f,"aria-live","polite"),se(Z,"class",ve="tabpanel "+(!e[14]||e[18]?"gone":"")),se(Z,"role",De=e[4]?"region":"tabpanel"),se(Z,"aria-label",Le=e[4]?e[0].searchResultsLabel:e[0].categories[e[13].name]),se(Z,"id",me=e[4]?"":`tab-${e[13].id}`),se(Z,"tabindex","0"),se(Ge,"class",z="favorites emoji-menu "+(e[18]?"gone":"")),se(Ge,"role","menu"),se(Ge,"aria-label",te=e[0].favoritesLabel),_a(Ge,"padding-inline-end",e[25]+"px"),se(le,"aria-hidden","true"),se(le,"tabindex","-1"),se(le,"class","abs-pos hidden emoji"),se(t,"class","picker"),se(t,"aria-label",ue=e[0].regionLabel),se(t,"style",e[22])},m(ce,ye){Is(ce,t,ye),Tt(t,s),Tt(t,a),Tt(a,n),Tt(n,r),A1(r,e[2]),Tt(n,c),Tt(c,u),Tt(n,p),Tt(p,i),Tt(a,H),Tt(H,L),Tt(L,N),Tt(a,C),Tt(C,B),Tt(a,d);for(let $=0;$<E.length;$+=1)E[$].m(d,null);e[48](d),Tt(t,M);for(let $=0;$<w.length;$+=1)w[$].m(M,null);Tt(t,F),Tt(F,V),Tt(t,f),Tt(f,T),Tt(t,Z),Tt(Z,de);for(let $=0;$<Me.length;$+=1)Me[$].m(de,null);e[50](Z),Tt(t,Ge);for(let $=0;$<ot.length;$+=1)ot[$].m(Ge,null);Tt(t,le),e[51](le),e[52](t),xe||(Ee=[Bs(r,"input",e[47]),Bs(r,"keydown",e[30]),Bs(L,"click",e[35]),Bs(d,"focusout",e[38]),Bs(d,"click",e[34]),Bs(d,"keydown",e[36]),Bs(d,"keyup",e[37]),Bs(M,"keydown",e[32]),s_(e[29].call(null,de)),Bs(Z,"click",e[33]),Bs(Ge,"click",e[33])],xe=!0)},p(ce,ye){ye[0]&1&&o!==(o=ce[0].searchLabel)&&se(r,"placeholder",o),ye[0]&18&&l!==(l=!!(ce[4]&&ce[1].length))&&se(r,"aria-expanded",l),ye[0]&67108864&&v!==(v=ce[26]?`emo-${ce[26]}`:"")&&se(r,"aria-activedescendant",v),ye[0]&4&&A1(r,ce[2]),ye[0]&1&&m!==(m=ce[0].searchLabel+"")&&zs(u,m),ye[0]&1&&y!==(y=ce[0].searchDescription+"")&&zs(i,y),ye[0]&2097152&&zs(N,ce[21]),ye[0]&64&&h!==(h="emoji "+(ce[6]?"hide-focus":""))&&se(L,"class",h),ye[0]&8388608&&se(L,"aria-label",ce[23]),ye[0]&8388608&&se(L,"title",ce[23]),ye[0]&64&&se(L,"aria-expanded",ce[6]),ye[0]&524288&&k!==(k="skintone-button-wrapper "+(ce[19]?"expanded":""))&&se(H,"class",k),ye[0]&1&&A!==(A=ce[0].skinToneDescription+"")&&zs(B,A),ye[0]&1049089&&(be=ce[9],E=fn(E,ye,Se,1,ce,be,S,d,dn,Y1,null,z1)),ye[0]&64&&_!==(_="skintone-list "+(ce[6]?"":"hidden no-animate"))&&se(d,"class",_),ye[0]&64&&_a(d,"transform","translateY("+(ce[6]?0:"calc(-1 * var(--num-skintones) * var(--total-emoji-size))")+")"),ye[0]&1&&x!==(x=ce[0].skinTonesLabel)&&se(d,"aria-label",x),ye[0]&1048576&&b!==(b="skintone-"+ce[20])&&se(d,"aria-activedescendant",b),ye[0]&64&&g!==(g=!ce[6])&&se(d,"aria-hidden",g),ye[0]&12305|ye[1]&1&&(he=ce[12],w=fn(w,ye,Pe,1,ce,he,j,M,dn,X1,null,V1)),ye[0]&4096&&_a(M,"grid-template-columns","repeat("+ce[12].length+", 1fr)"),ye[0]&1&&X!==(X=ce[0].categoriesLabel)&&se(M,"aria-label",X),ye[0]&16779264&&_a(V,"transform","translateX("+(ce[24]?-1:1)*ce[11]*100+"%)"),ye[0]&262144&&zs(T,ce[18]),ye[0]&262144&&W!==(W="message "+(ce[18]?"":"gone"))&&se(f,"class",W),ye[0]&402694449&&(Ne=ce[15],Me=fn(Me,ye,Fe,1,ce,Ne,Te,de,dn,G1,null,U1)),ye[0]&278528&&ve!==(ve="tabpanel "+(!ce[14]||ce[18]?"gone":""))&&se(Z,"class",ve),ye[0]&16&&De!==(De=ce[4]?"region":"tabpanel")&&se(Z,"role",De),ye[0]&8209&&Le!==(Le=ce[4]?ce[0].searchResultsLabel:ce[0].categories[ce[13].name])&&se(Z,"aria-label",Le),ye[0]&8208&&me!==(me=ce[4]?"":`tab-${ce[13].id}`)&&se(Z,"id",me),ye[0]&402654464&&(Ue=ce[10],ot=fn(ot,ye,We,1,ce,Ue,D,Ge,dn,W1,null,D1)),ye[0]&262144&&z!==(z="favorites emoji-menu "+(ce[18]?"gone":""))&&se(Ge,"class",z),ye[0]&1&&te!==(te=ce[0].favoritesLabel)&&se(Ge,"aria-label",te),ye[0]&33554432&&_a(Ge,"padding-inline-end",ce[25]+"px"),ye[0]&1&&ue!==(ue=ce[0].regionLabel)&&se(t,"aria-label",ue),ye[0]&4194304&&se(t,"style",ce[22])},i:on,o:on,d(ce){ce&&Cs(t);for(let ye=0;ye<E.length;ye+=1)E[ye].d();e[48](null);for(let ye=0;ye<w.length;ye+=1)w[ye].d();for(let ye=0;ye<Me.length;ye+=1)Me[ye].d();e[50](null);for(let ye=0;ye<ot.length;ye+=1)ot[ye].d();e[51](null),e[52](null),xe=!1,ln(Ee)}}}function D_(e,t,s){let{skinToneEmoji:a}=t,{i18n:n}=t,{database:r}=t,{customEmoji:o}=t,{customCategorySorting:l}=t,v=!0,c=[],m=[],u="",p="",y,i,H,L=!1,N=-1,h,k=!1,C=!1,A,B=0,d=0,E,S,_="",x=[],b=[],g,M=g_,w=!1,j=0,X=0,F=Ti,V,f=!1,T;const W=$=>{y.getRootNode().getElementById($).focus()},Z=($,Ce)=>{y.dispatchEvent(new CustomEvent($,{detail:Ce,bubbles:!0,composed:!0}))},de=($,Ce)=>Ce&&$.skins&&$.skins[Ce]||$.unicode,Me=($,Ce)=>L_([$.name||de($,Ce),...$.shortcodes||[]]).join(", "),Te=$=>/^skintone-/.test($.id);ul.then($=>{$||s(18,h=n.emojiUnsupportedMessage)});function ve($){return C_($,Ce=>{{const R=getComputedStyle(y),I=parseInt(R.getPropertyValue("--num-columns"),10),U=R.getPropertyValue("direction")==="rtl",Y=$.parentElement.getBoundingClientRect().width-Ce;s(46,M=I),s(25,j=Y),s(24,w=U)}})}function De($){const Ce=y.getRootNode();B_($,i,I=>Ce.getElementById(`emo-${I.id}`)),s(1,c=c)}function Le($){return!$.unicode||!N1($)||dl.get($.unicode)}async function me($){const Ce=await ul;return $.filter(({version:R})=>!R||R<=Ce)}async function Ge($){return O_($,await ul)}async function ot($){if(typeof $=="undefined")return[];const Ce=$===-1?o:await r.getEmojiByGroup($);return Ge(await me(Ce))}async function D($){return Ge(await me(await r.getEmojiBySearchQuery($)))}function z($){if(!L||!c.length)return;const Ce=R=>{pa($),s(5,N=fl(R,N,c))};switch($.key){case"ArrowDown":return Ce(!1);case"ArrowUp":return Ce(!0);case"Enter":if(N!==-1)return pa($),ue(c[N].id);c.length&&s(5,N=0)}}function te($){s(2,u=""),s(44,p=""),s(5,N=-1),s(11,X=F.findIndex(Ce=>Ce.id===$.id))}function le($){const{target:Ce,key:R}=$,I=U=>{U&&(pa($),U.focus())};switch(R){case"ArrowLeft":return I(Ce.previousSibling);case"ArrowRight":return I(Ce.nextSibling);case"Home":return I(Ce.parentElement.firstChild);case"End":return I(Ce.parentElement.lastChild)}}async function ue($){const Ce=await r.getEmojiByUnicodeOrName($),R=[...c,...b].find(U=>U.id===$),I=R.unicode&&de(R,B);await r.incrementFavoriteEmojiCount($),Z("emoji-click",{emoji:Ce,skinTone:B,...I&&{unicode:I},...R.name&&{name:R.name}})}async function xe($){const{target:Ce}=$;if(!Ce.classList.contains("emoji"))return;pa($);const R=Ce.id.substring(4);ue(R)}async function Ee($){const{target:Ce}=$;if(!Te(Ce))return;pa($);const R=parseInt(Ce.id.slice(9),10);s(8,B=R),s(6,k=!1),W("skintone-button"),Z("skin-tone-change",{skinTone:R}),r.setPreferredSkinTone(R)}async function be($){s(6,k=!k),s(20,d=B),k&&(pa($),Ei(()=>W(`skintone-${d}`)))}function Se($){if(!k)return;const Ce=async R=>{pa($),s(20,d=R),await a_(),W(`skintone-${d}`)};switch($.key){case"ArrowUp":return Ce(fl(!0,d,x));case"ArrowDown":return Ce(fl(!1,d,x));case"Home":return Ce(0);case"End":return Ce(x.length-1);case"Enter":return Ee($);case"Escape":return pa($),s(6,k=!1),W("skintone-button")}}function he($){if(!!k)switch($.key){case" ":return Ee($)}}async function Pe($){const{relatedTarget:Ce}=$;(!Ce||!Te(Ce))&&s(6,k=!1)}function Ne(){u=this.value,s(2,u)}function Fe($){gr[$?"unshift":"push"](()=>{A=$,s(7,A)})}const Ue=$=>te($);function We($){gr[$?"unshift":"push"](()=>{H=$,s(3,H)})}function ce($){gr[$?"unshift":"push"](()=>{i=$,s(17,i)})}function ye($){gr[$?"unshift":"push"](()=>{y=$,s(16,y)})}return e.$$set=$=>{"skinToneEmoji"in $&&s(40,a=$.skinToneEmoji),"i18n"in $&&s(0,n=$.i18n),"database"in $&&s(39,r=$.database),"customEmoji"in $&&s(41,o=$.customEmoji),"customCategorySorting"in $&&s(42,l=$.customCategorySorting)},e.$$.update=()=>{if(e.$$.dirty[1]&1280&&o&&r&&s(39,r.customEmoji=o,r),e.$$.dirty[0]&1|e.$$.dirty[1]&256){async function $(){let Ce=!1;const R=setTimeout(()=>{Ce=!0,s(18,h=n.loadingMessage)},__);try{await r.ready(),s(14,f=!0)}catch(I){console.error(I),s(18,h=n.networkErrorMessage)}finally{clearTimeout(R),Ce&&(Ce=!1,s(18,h=""))}}r&&$()}if(e.$$.dirty[0]&6144|e.$$.dirty[1]&1024&&(o&&o.length?s(12,F=[m_,...Ti]):F!==Ti&&(X&&s(11,X--,X),s(12,F=Ti))),e.$$.dirty[0]&4&&L1(()=>{s(44,p=(u||"").trim()),s(5,N=-1)}),e.$$.dirty[0]&6144&&s(13,V=F[X]),e.$$.dirty[0]&24576|e.$$.dirty[1]&8192){async function $(){if(!f)s(1,c=[]),s(4,L=!1);else if(p.length>=h_){const Ce=p,R=await D(Ce);Ce===p&&(s(1,c=R),s(4,L=!0))}else if(V){const Ce=V.id,R=await ot(Ce);Ce===V.id&&(s(1,c=R),s(4,L=!1))}}$()}if(e.$$.dirty[0]&4112&&s(22,S=`
  --font-family: ${j1};
  --num-groups: ${F.length}; 
  --indicator-opacity: ${L?0:1}; 
  --num-skintones: ${B1};`),e.$$.dirty[0]&16384|e.$$.dirty[1]&256){async function $(){f&&s(8,B=await r.getPreferredSkinTone())}$()}if(e.$$.dirty[1]&512&&s(9,x=Array(B1).fill().map(($,Ce)=>R_(a,Ce))),e.$$.dirty[0]&768&&s(21,E=x[B]),e.$$.dirty[0]&257&&s(23,_=n.skinToneLabel.replace("{skinTone}",n.skinTones[B])),e.$$.dirty[0]&16384|e.$$.dirty[1]&256){async function $(){s(45,g=(await Promise.all(b_.map(Ce=>r.getEmojiByUnicodeOrName(Ce)))).filter(Boolean))}f&&$()}if(e.$$.dirty[0]&16384|e.$$.dirty[1]&49408){async function $(){const Ce=await r.getTopFavoriteEmoji(M),R=await Ge(P1([...Ce,...g],I=>I.unicode||I.name).slice(0,M));s(10,b=R)}f&&g&&$()}if(e.$$.dirty[0]&10){const $=c.filter(Ce=>Ce.unicode).filter(Ce=>N1(Ce)&&!dl.has(Ce.unicode));$.length?Ei(()=>De($)):(s(1,c=c.filter(Le)),Ei(()=>{(H||{}).scrollTop=0}))}e.$$.dirty[0]&1026|e.$$.dirty[1]&4096,e.$$.dirty[0]&18|e.$$.dirty[1]&2048&&s(15,m=function(){if(L)return[{category:"",emojis:c}];const Ce=new Map;for(const R of c){const I=R.category||"";let U=Ce.get(I);U||(U=[],Ce.set(I,U)),U.push(R)}return[...Ce.entries()].map(([R,I])=>({category:R,emojis:I})).sort((R,I)=>l(R.category,I.category))}()),e.$$.dirty[0]&34&&s(26,T=N!==-1&&c[N].id),e.$$.dirty[0]&192&&(k?A.addEventListener("transitionend",()=>{s(19,C=!0)},{once:!0}):s(19,C=!1))},[n,c,u,H,L,N,k,A,B,x,b,X,F,V,f,m,y,i,h,C,d,E,S,_,w,j,T,de,Me,ve,z,te,le,xe,Ee,be,Se,he,Pe,r,a,o,l,v,p,g,M,Ne,Fe,Ue,We,ce,ye]}class U_ extends f_{constructor(t){super(),d_(this,t,D_,F_,e_,{skinToneEmoji:40,i18n:0,database:39,customEmoji:41,customCategorySorting:42},null,[-1,-1,-1])}}const q_="https://cdn.jsdelivr.net/npm/emoji-picker-element-data@^1/en/emojibase/data.json",V_="en";var z_={categoriesLabel:"Categories",emojiUnsupportedMessage:"Your browser does not support color emoji.",favoritesLabel:"Favorites",loadingMessage:"Loading\u2026",networkErrorMessage:"Could not load emoji.",regionLabel:"Emoji picker",searchDescription:"When search results are available, press up or down to select and enter to choose.",searchLabel:"Search",searchResultsLabel:"Search results",skinToneDescription:"When expanded, press up or down to select and enter to choose.",skinToneLabel:"Choose a skin tone (currently {skinTone})",skinTonesLabel:"Skin tones",skinTones:["Default","Light","Medium-Light","Medium","Medium-Dark","Dark"],categories:{custom:"Custom","smileys-emotion":"Smileys and emoticons","people-body":"People and body","animals-nature":"Animals and nature","food-drink":"Food and drink","travel-places":"Travel and places",activities:"Activities",objects:"Objects",symbols:"Symbols",flags:"Flags"}};const Z1=["customEmoji","customCategorySorting","database","dataSource","i18n","locale","skinToneEmoji"];class Q1 extends HTMLElement{constructor(t){super(),this.attachShadow({mode:"open"});const s=document.createElement("style");s.textContent=":host{--emoji-size:1.375rem;--emoji-padding:0.5rem;--category-emoji-size:var(--emoji-size);--category-emoji-padding:var(--emoji-padding);--indicator-height:3px;--input-border-radius:0.5rem;--input-border-size:1px;--input-font-size:1rem;--input-line-height:1.5;--input-padding:0.25rem;--num-columns:8;--outline-size:2px;--border-size:1px;--skintone-border-radius:1rem;--category-font-size:1rem;display:flex;width:min-content;height:400px}:host,:host(.light){--background:#fff;--border-color:#e0e0e0;--indicator-color:#385ac1;--input-border-color:#999;--input-font-color:#111;--input-placeholder-color:#999;--outline-color:#999;--category-font-color:#111;--button-active-background:#e6e6e6;--button-hover-background:#d9d9d9}:host(.dark){--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}@media (prefers-color-scheme:dark){:host{--background:#222;--border-color:#444;--indicator-color:#5373ec;--input-border-color:#ccc;--input-font-color:#efefef;--input-placeholder-color:#ccc;--outline-color:#fff;--category-font-color:#efefef;--button-active-background:#555555;--button-hover-background:#484848}}:host([hidden]){display:none}button{margin:0;padding:0;border:0;background:0 0;box-shadow:none;-webkit-tap-highlight-color:transparent}button::-moz-focus-inner{border:0}input{padding:0;margin:0;line-height:1.15;font-family:inherit}input[type=search]{-webkit-appearance:none}:focus{outline:var(--outline-color) solid var(--outline-size);outline-offset:calc(-1*var(--outline-size))}:host([data-js-focus-visible]) :focus:not([data-focus-visible-added]){outline:0}:focus:not(:focus-visible){outline:0}.hide-focus{outline:0}*{box-sizing:border-box}.picker{contain:content;display:flex;flex-direction:column;background:var(--background);border:var(--border-size) solid var(--border-color);width:100%;height:100%;overflow:hidden;--total-emoji-size:calc(var(--emoji-size) + (2 * var(--emoji-padding)));--total-category-emoji-size:calc(var(--category-emoji-size) + (2 * var(--category-emoji-padding)))}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.hidden{opacity:0;pointer-events:none}.abs-pos{position:absolute;left:0;top:0}.gone{display:none!important}.skintone-button-wrapper,.skintone-list{background:var(--background);z-index:3}.skintone-button-wrapper.expanded{z-index:1}.skintone-list{position:absolute;inset-inline-end:0;top:0;z-index:2;overflow:visible;border-bottom:var(--border-size) solid var(--border-color);border-radius:0 0 var(--skintone-border-radius) var(--skintone-border-radius);will-change:transform;transition:transform .2s ease-in-out;transform-origin:center 0}@media (prefers-reduced-motion:reduce){.skintone-list{transition-duration:.001s}}@supports not (inset-inline-end:0){.skintone-list{right:0}}.skintone-list.no-animate{transition:none}.tabpanel{overflow-y:auto;-webkit-overflow-scrolling:touch;will-change:transform;min-height:0;flex:1;contain:content}.emoji-menu{display:grid;grid-template-columns:repeat(var(--num-columns),var(--total-emoji-size));justify-content:space-around;align-items:flex-start;width:100%}.category{padding:var(--emoji-padding);font-size:var(--category-font-size);color:var(--category-font-color)}.custom-emoji,.emoji,button.emoji{height:var(--total-emoji-size);width:var(--total-emoji-size)}.emoji,button.emoji{font-size:var(--emoji-size);display:flex;align-items:center;justify-content:center;border-radius:100%;line-height:1;overflow:hidden;font-family:var(--font-family);cursor:pointer}@media (hover:hover) and (pointer:fine){.emoji:hover,button.emoji:hover{background:var(--button-hover-background)}}.emoji.active,.emoji:active,button.emoji.active,button.emoji:active{background:var(--button-active-background)}.custom-emoji{padding:var(--emoji-padding);object-fit:contain;pointer-events:none;background-repeat:no-repeat;background-position:center center;background-size:var(--emoji-size) var(--emoji-size)}.nav,.nav-button{align-items:center}.nav{display:grid;justify-content:space-between;contain:content}.nav-button{display:flex;justify-content:center}.nav-emoji{font-size:var(--category-emoji-size);width:var(--total-category-emoji-size);height:var(--total-category-emoji-size)}.indicator-wrapper{display:flex;border-bottom:1px solid var(--border-color)}.indicator{width:calc(100%/var(--num-groups));height:var(--indicator-height);opacity:var(--indicator-opacity);background-color:var(--indicator-color);will-change:transform,opacity;transition:opacity .1s linear,transform .25s ease-in-out}@media (prefers-reduced-motion:reduce){.indicator{will-change:opacity;transition:opacity .1s linear}}.pad-top,input.search{background:var(--background);width:100%}.pad-top{height:var(--emoji-padding);z-index:3}.search-row{display:flex;align-items:center;position:relative;padding-inline-start:var(--emoji-padding);padding-bottom:var(--emoji-padding)}.search-wrapper{flex:1;min-width:0}input.search{padding:var(--input-padding);border-radius:var(--input-border-radius);border:var(--input-border-size) solid var(--input-border-color);color:var(--input-font-color);font-size:var(--input-font-size);line-height:var(--input-line-height)}input.search::placeholder{color:var(--input-placeholder-color)}.favorites{display:flex;flex-direction:row;border-top:var(--border-size) solid var(--border-color);contain:content}.message{padding:var(--emoji-padding)}",this.shadowRoot.appendChild(s),this._ctx={locale:V_,dataSource:q_,skinToneEmoji:p_,customCategorySorting:y_,customEmoji:null,i18n:z_,...t};for(const a of Z1)a!=="database"&&Object.prototype.hasOwnProperty.call(this,a)&&(this._ctx[a]=this[a],delete this[a]);this._dbFlush()}connectedCallback(){this._cmp=new U_({target:this.shadowRoot,props:this._ctx})}disconnectedCallback(){this._cmp.$destroy(),this._cmp=void 0;const{database:t}=this._ctx;t&&t.close().catch(s=>console.error(s))}static get observedAttributes(){return["locale","data-source","skin-tone-emoji"]}attributeChangedCallback(t,s,a){this._set(t.replace(/-([a-z])/g,(n,r)=>r.toUpperCase()),a)}_set(t,s){this._ctx[t]=s,this._cmp&&this._cmp.$set({[t]:s}),["locale","dataSource"].includes(t)&&this._dbFlush()}_dbCreate(){const{locale:t,dataSource:s,database:a}=this._ctx;(!a||a.locale!==t||a.dataSource!==s)&&this._set("database",new S1({locale:t,dataSource:s}))}_dbFlush(){Promise.resolve().then(()=>this._dbCreate())}}const J1={};for(const e of Z1)J1[e]={get(){return e==="database"&&this._dbCreate(),this._ctx[e]},set(t){if(e==="database")throw new Error("database is read-only");this._set(e,t)}};Object.defineProperties(Q1.prototype,J1),customElements.get("emoji-picker")||customElements.define("emoji-picker",Q1);function $1(e,t){for(;e&&!e.querySelector(t);){e=e.parentNode;const s=e.querySelector(t);if(s)return s}return null}var eu;const hl=typeof window!="undefined",tu=e=>typeof e=="string",ms=()=>{},Ai=hl&&((eu=window==null?void 0:window.navigator)==null?void 0:eu.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function as(e){return typeof e=="function"?e():v0(e)}function su(e,t){function s(...a){return new Promise((n,r)=>{Promise.resolve(e(()=>t.apply(this,a),{fn:t,thisArg:this,args:a})).then(n).catch(r)})}return s}function Y_(e,t={}){let s,a,n=ms;const r=l=>{clearTimeout(l),n(),n=ms};return l=>{const v=as(e),c=as(t.maxWait);return s&&r(s),v<=0||c!==void 0&&c<=0?(a&&(r(a),a=null),Promise.resolve(l())):new Promise((m,u)=>{n=t.rejectOnCancel?u:m,c&&!a&&(a=setTimeout(()=>{s&&r(s),a=null,m(l())},c)),s=setTimeout(()=>{a&&r(a),a=null,m(l())},v)})}}function X_(e,t=!0,s=!0,a=!1){let n=0,r,o=!0,l=ms,v;const c=()=>{r&&(clearTimeout(r),r=void 0,l(),l=ms)};return u=>{const p=as(e),y=Date.now()-n,i=()=>v=u();return c(),p<=0?(n=Date.now(),i()):(y>p&&(s||!o)?(n=Date.now(),i()):t&&(v=new Promise((H,L)=>{l=a?L:H,r=setTimeout(()=>{n=Date.now(),o=!0,H(i()),c()},Math.max(0,p-y))})),!s&&!r&&(r=setTimeout(()=>o=!0,p)),o=!1,v)}}const Ys={mounted:"mounted",updated:"updated",unmounted:"unmounted"};function K_(e){return e}function hn(e){return Td()?(Ed(e),!0):!1}function G_(e,t=200,s={}){return su(Y_(t,s),e)}function W_(e,t=200,s=!1,a=!0,n=!1){return su(X_(t,s,a,n),e)}function Z_(e){return typeof e=="function"?Ia(e):ys(e)}function Q_(e,t=!0){ko()?mo(e):t?e():qn(e)}function vn(e){var t;const s=as(e);return(t=s==null?void 0:s.$el)!=null?t:s}const au=hl?window:void 0;function vl(...e){let t,s,a,n;if(tu(e[0])||Array.isArray(e[0])?([s,a,n]=e,t=au):[t,s,a,n]=e,!t)return ms;Array.isArray(s)||(s=[s]),Array.isArray(a)||(a=[a]);const r=[],o=()=>{r.forEach(m=>m()),r.length=0},l=(m,u,p,y)=>(m.addEventListener(u,p,y),()=>m.removeEventListener(u,p,y)),v=Xt(()=>[vn(t),as(n)],([m,u])=>{o(),m&&r.push(...s.flatMap(p=>a.map(y=>l(m,p,y,u))))},{immediate:!0,flush:"post"}),c=()=>{v(),o()};return hn(c),c}let ru=!1;function J_(e,t,s={}){const{window:a=au,ignore:n=[],capture:r=!0,detectIframe:o=!1}=s;if(!a)return;Ai&&!ru&&(ru=!0,Array.from(a.document.body.children).forEach(p=>p.addEventListener("click",ms)));let l=!0;const v=p=>n.some(y=>{if(typeof y=="string")return Array.from(a.document.querySelectorAll(y)).some(i=>i===p.target||p.composedPath().includes(i));{const i=vn(y);return i&&(p.target===i||p.composedPath().includes(i))}}),m=[vl(a,"click",p=>{const y=vn(e);if(!(!y||y===p.target||p.composedPath().includes(y))){if(p.detail===0&&(l=!v(p)),!l){l=!0;return}t(p)}},{passive:!0,capture:r}),vl(a,"pointerdown",p=>{const y=vn(e);y&&(l=!p.composedPath().includes(y)&&!v(p))},{passive:!0}),o&&vl(a,"blur",p=>{var y;const i=vn(e);((y=a.document.activeElement)==null?void 0:y.tagName)==="IFRAME"&&!(i!=null&&i.contains(a.document.activeElement))&&t(p)})].filter(Boolean);return()=>m.forEach(p=>p())}const _l=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},pl="__vueuse_ssr_handlers__";_l[pl]=_l[pl]||{},_l[pl];var nu;(function(e){e.UP="UP",e.RIGHT="RIGHT",e.DOWN="DOWN",e.LEFT="LEFT",e.NONE="NONE"})(nu||(nu={}));var $_=Object.defineProperty,iu=Object.getOwnPropertySymbols,ep=Object.prototype.hasOwnProperty,tp=Object.prototype.propertyIsEnumerable,ou=(e,t,s)=>t in e?$_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,sp=(e,t)=>{for(var s in t||(t={}))ep.call(t,s)&&ou(e,s,t[s]);if(iu)for(var s of iu(t))tp.call(t,s)&&ou(e,s,t[s]);return e};sp({linear:K_},{easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]});const ap=B0({name:"OnClickOutside",props:["as","options"],emits:["trigger"],setup(e,{slots:t,emit:s}){const a=ys();return J_(a,n=>{s("trigger",n)},e.options),()=>{if(t.default)return cc(e.as||"div",{ref:a},t.default())}}});function rs(e){var t;const s=as(e);return(t=s==null?void 0:s.$el)!=null?t:s}const za=hl?window:void 0;function hs(...e){let t,s,a,n;if(tu(e[0])||Array.isArray(e[0])?([s,a,n]=e,t=za):[t,s,a,n]=e,!t)return ms;Array.isArray(s)||(s=[s]),Array.isArray(a)||(a=[a]);const r=[],o=()=>{r.forEach(m=>m()),r.length=0},l=(m,u,p,y)=>(m.addEventListener(u,p,y),()=>m.removeEventListener(u,p,y)),v=Xt(()=>[rs(t),as(n)],([m,u])=>{o(),m&&r.push(...s.flatMap(p=>a.map(y=>l(m,p,y,u))))},{immediate:!0,flush:"post"}),c=()=>{v(),o()};return hn(c),c}let lu=!1;function cu(e,t,s={}){const{window:a=za,ignore:n=[],capture:r=!0,detectIframe:o=!1}=s;if(!a)return;Ai&&!lu&&(lu=!0,Array.from(a.document.body.children).forEach(p=>p.addEventListener("click",ms)));let l=!0;const v=p=>n.some(y=>{if(typeof y=="string")return Array.from(a.document.querySelectorAll(y)).some(i=>i===p.target||p.composedPath().includes(i));{const i=rs(y);return i&&(p.target===i||p.composedPath().includes(i))}}),m=[hs(a,"click",p=>{const y=rs(e);if(!(!y||y===p.target||p.composedPath().includes(y))){if(p.detail===0&&(l=!v(p)),!l){l=!0;return}t(p)}},{passive:!0,capture:r}),hs(a,"pointerdown",p=>{const y=rs(e);y&&(l=!p.composedPath().includes(y)&&!v(p))},{passive:!0}),o&&hs(a,"blur",p=>{var y;const i=rs(e);((y=a.document.activeElement)==null?void 0:y.tagName)==="IFRAME"&&!(i!=null&&i.contains(a.document.activeElement))&&t(p)})].filter(Boolean);return()=>m.forEach(p=>p())}Ys.mounted+"",Ys.unmounted+"";const rp=e=>typeof e=="function"?e:typeof e=="string"?t=>t.key===e:Array.isArray(e)?t=>e.includes(t.key):()=>!0;function uu(...e){let t,s,a={};e.length===3?(t=e[0],s=e[1],a=e[2]):e.length===2?typeof e[1]=="object"?(t=!0,s=e[0],a=e[1]):(t=e[0],s=e[1]):(t=!0,s=e[0]);const{target:n=za,eventName:r="keydown",passive:o=!1}=a,l=rp(t);return hs(n,r,c=>{l(c)&&s(c)},o)}var np=Object.defineProperty,du=Object.getOwnPropertySymbols,ip=Object.prototype.hasOwnProperty,op=Object.prototype.propertyIsEnumerable,fu=(e,t,s)=>t in e?np(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,lp=(e,t)=>{for(var s in t||(t={}))ip.call(t,s)&&fu(e,s,t[s]);if(du)for(var s of du(t))op.call(t,s)&&fu(e,s,t[s]);return e};Ys.mounted+"";const cp=500;function mu(e,t,s){var a,n;const r=Ia(()=>rs(e));let o;function l(){o&&(clearTimeout(o),o=void 0)}function v(m){var u,p,y,i;((u=s==null?void 0:s.modifiers)==null?void 0:u.self)&&m.target!==r.value||(l(),(p=s==null?void 0:s.modifiers)!=null&&p.prevent&&m.preventDefault(),(y=s==null?void 0:s.modifiers)!=null&&y.stop&&m.stopPropagation(),o=setTimeout(()=>t(m),(i=s==null?void 0:s.delay)!=null?i:cp))}const c={capture:(a=s==null?void 0:s.modifiers)==null?void 0:a.capture,once:(n=s==null?void 0:s.modifiers)==null?void 0:n.once};hs(r,"pointerdown",v,c),hs(r,"pointerup",l,c),hs(r,"pointerleave",l,c)}Ys.mounted+"";const gl=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},bl="__vueuse_ssr_handlers__";gl[bl]=gl[bl]||{},gl[bl];function hu(e,t=!1){const s=ys(),a=()=>s.value=Boolean(e());return a(),Q_(a,t),s}function up(e,t={}){const s=t?t.delayEnter:0,a=t?t.delayLeave:0,n=ys(!1);let r;const o=l=>{const v=l?s:a;r&&(clearTimeout(r),r=void 0),v?r=setTimeout(()=>n.value=l,v):n.value=l};return window&&(hs(e,"mouseenter",()=>o(!0),{passive:!0}),hs(e,"mouseleave",()=>o(!1),{passive:!0})),n}Ys.mounted+"";var vu=Object.getOwnPropertySymbols,dp=Object.prototype.hasOwnProperty,fp=Object.prototype.propertyIsEnumerable,mp=(e,t)=>{var s={};for(var a in e)dp.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(e!=null&&vu)for(var a of vu(e))t.indexOf(a)<0&&fp.call(e,a)&&(s[a]=e[a]);return s};function hp(e,t,s={}){const a=s,{window:n=za}=a,r=mp(a,["window"]);let o;const l=hu(()=>n&&"ResizeObserver"in n),v=()=>{o&&(o.disconnect(),o=void 0)},c=Xt(()=>rs(e),u=>{v(),l.value&&n&&u&&(o=new ResizeObserver(t),o.observe(u,r))},{immediate:!0,flush:"post"}),m=()=>{v(),c()};return hn(m),{isSupported:l,stop:m}}function vp(e,t={width:0,height:0},s={}){const{window:a=za,box:n="content-box"}=s,r=Ia(()=>{var v,c;return(c=(v=rs(e))==null?void 0:v.namespaceURI)==null?void 0:c.includes("svg")}),o=ys(t.width),l=ys(t.height);return hp(e,([v])=>{const c=n==="border-box"?v.borderBoxSize:n==="content-box"?v.contentBoxSize:v.devicePixelContentBoxSize;if(a&&r.value){const m=rs(e);if(m){const u=a.getComputedStyle(m);o.value=parseFloat(u.width),l.value=parseFloat(u.height)}}else if(c){const m=Array.isArray(c)?c:[c];o.value=m.reduce((u,{inlineSize:p})=>u+p,0),l.value=m.reduce((u,{blockSize:p})=>u+p,0)}else o.value=v.contentRect.width,l.value=v.contentRect.height},s),Xt(()=>rs(e),v=>{o.value=v?t.width:0,l.value=v?t.height:0}),{width:o,height:l}}Ys.mounted+"";function _u(e,{window:t=za,scrollTarget:s}={}){const a=ys(!1),n=()=>{if(!t)return;const r=t.document,o=rs(e);if(!o)a.value=!1;else{const l=o.getBoundingClientRect();a.value=l.top<=(t.innerHeight||r.documentElement.clientHeight)&&l.left<=(t.innerWidth||r.documentElement.clientWidth)&&l.bottom>=0&&l.right>=0}};return Xt(()=>rs(e),()=>n(),{immediate:!0,flush:"post"}),t&&hs(s||t,"scroll",n,{capture:!1,passive:!0}),a}Ys.mounted+"";const pu=1;function yl(e,t={}){const{throttle:s=0,idle:a=200,onStop:n=ms,onScroll:r=ms,offset:o={left:0,right:0,top:0,bottom:0},eventListenerOptions:l={capture:!1,passive:!0},behavior:v="auto"}=t,c=ys(0),m=ys(0),u=Ia({get(){return c.value},set(C){y(C,void 0)}}),p=Ia({get(){return m.value},set(C){y(void 0,C)}});function y(C,A){var B,d,E;const S=as(e);!S||(E=S instanceof Document?document.body:S)==null||E.scrollTo({top:(B=as(A))!=null?B:p.value,left:(d=as(C))!=null?d:u.value,behavior:as(v)})}const i=ys(!1),H=rr({left:!0,right:!1,top:!0,bottom:!1}),L=rr({left:!1,right:!1,top:!1,bottom:!1}),N=C=>{!i.value||(i.value=!1,L.left=!1,L.right=!1,L.top=!1,L.bottom=!1,n(C))},h=G_(N,s+a),k=C=>{const A=C.target===document?C.target.documentElement:C.target,B=A.scrollLeft;L.left=B<c.value,L.right=B>m.value,H.left=B<=0+(o.left||0),H.right=B+A.clientWidth>=A.scrollWidth-(o.right||0)-pu,c.value=B;let d=A.scrollTop;C.target===document&&!d&&(d=document.body.scrollTop),L.top=d<m.value,L.bottom=d>m.value,H.top=d<=0+(o.top||0),H.bottom=d+A.clientHeight>=A.scrollHeight-(o.bottom||0)-pu,m.value=d,i.value=!0,h(C),r(C)};return hs(e,"scroll",s?W_(k,s,!0,!1):k,l),hs(e,"scrollend",N,l),{x:u,y:p,isScrolling:i,arrivedState:H,directions:L}}var _p=Object.defineProperty,pp=Object.defineProperties,gp=Object.getOwnPropertyDescriptors,gu=Object.getOwnPropertySymbols,bp=Object.prototype.hasOwnProperty,yp=Object.prototype.propertyIsEnumerable,bu=(e,t,s)=>t in e?_p(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,yu=(e,t)=>{for(var s in t||(t={}))bp.call(t,s)&&bu(e,s,t[s]);if(gu)for(var s of gu(t))yp.call(t,s)&&bu(e,s,t[s]);return e},xp=(e,t)=>pp(e,gp(t));function xu(e,t,s={}){var a,n;const r=(a=s.direction)!=null?a:"bottom",o=rr(yl(e,xp(yu({},s),{offset:yu({[r]:(n=s.distance)!=null?n:0},s.offset)})));Xt(()=>o.arrivedState[r],async l=>{var v,c;if(l){const m=as(e),u={height:(v=m==null?void 0:m.scrollHeight)!=null?v:0,width:(c=m==null?void 0:m.scrollWidth)!=null?c:0};await t(o),s.preserveScrollPosition&&m&&qn(()=>{m.scrollTo({top:m.scrollHeight-u.height,left:m.scrollWidth-u.width})})}})}Ys.mounted+"";function wu(e,t,s={}){const{root:a,rootMargin:n="0px",threshold:r=.1,window:o=za}=s,l=hu(()=>o&&"IntersectionObserver"in o);let v=ms;const c=l.value?Xt(()=>({el:rs(e),root:rs(a)}),({el:u,root:p})=>{if(v(),!u)return;const y=new IntersectionObserver(t,{root:p,rootMargin:n,threshold:r});y.observe(u),v=()=>{y.disconnect(),v=ms}},{immediate:!0,flush:"post"}):ms,m=()=>{v(),c()};return hn(m),{isSupported:l,stop:m}}Ys.mounted+"";var wp=Object.defineProperty,Sp=Object.defineProperties,Mp=Object.getOwnPropertyDescriptors,Su=Object.getOwnPropertySymbols,Tp=Object.prototype.hasOwnProperty,Ep=Object.prototype.propertyIsEnumerable,Mu=(e,t,s)=>t in e?wp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,Ap=(e,t)=>{for(var s in t||(t={}))Tp.call(t,s)&&Mu(e,s,t[s]);if(Su)for(var s of Su(t))Ep.call(t,s)&&Mu(e,s,t[s]);return e},kp=(e,t)=>Sp(e,Mp(t));Ys.mounted+"";function Tu(e){const t=window.getComputedStyle(e);if(t.overflowX==="scroll"||t.overflowY==="scroll"||t.overflowX==="auto"&&e.clientHeight<e.scrollHeight||t.overflowY==="auto"&&e.clientWidth<e.scrollWidth)return!0;{const s=e.parentNode;return!s||s.tagName==="BODY"?!1:Tu(s)}}function Rp(e){const t=e||window.event,s=t.target;return Tu(s)?!1:t.touches.length>1?!0:(t.preventDefault&&t.preventDefault(),!1)}function Op(e,t=!1){const s=ys(t);let a=null,n;Xt(Z_(e),l=>{if(l){const v=l;n=v.style.overflow,s.value&&(v.style.overflow="hidden")}},{immediate:!0});const r=()=>{const l=as(e);!l||s.value||(Ai&&(a=hs(l,"touchmove",v=>{Rp(v)},{passive:!1})),l.style.overflow="hidden",s.value=!0)},o=()=>{const l=as(e);!l||!s.value||(Ai&&(a==null||a()),l.style.overflow=n,s.value=!1)};return hn(o),Ia({get(){return s.value},set(l){l?r():o()}})}(()=>{let e=!1;const t=ys(!1);return(s,a)=>{if(t.value=a.value,e)return;e=!0;const n=Op(s,a.value);Xt(t,r=>n.value=r)}})();const Ip={name:"EmojiPickerContainer",components:{SvgIcon:Vt,OnClickOutside:ap},props:{emojiOpened:{type:Boolean,default:!1},emojiReaction:{type:Boolean,default:!1},positionTop:{type:Boolean,default:!1},positionRight:{type:Boolean,default:!1},messageId:{type:String,default:""},emojiDataSource:{type:String,default:void 0},teleportTarget:{type:Object,default:void 0}},emits:["add-emoji","open-emoji","close-emoji"],data(){return{emojiPickerHeight:320,emojiPickerTop:0,emojiPickerRight:""}},watch:{emojiOpened(e){e&&setTimeout(()=>{this.addCustomStyling(),this.$refs.emojiPicker.shadowRoot.addEventListener("emoji-click",({detail:t})=>{this.$emit("add-emoji",{unicode:t.unicode})})},0)}},methods:{addCustomStyling(){const e=`.picker {
				border: none;
			}`,t=`.nav {
				overflow-x: auto;
			}`,s=`.search-wrapper {
				padding-right: 2px;
				padding-left: 2px;
			}`,a=`input.search {
				height: 32px;
				font-size: 14px;
				border-radius: 10rem;
				border: var(--chat-border-style);
				padding: 5px 10px;
				outline: none;
				background: var(--chat-bg-color-input);
				color: var(--chat-color);
			}`,n=document.createElement("style");n.textContent=e+t+s+a,this.$refs.emojiPicker.shadowRoot.appendChild(n)},openEmoji(e){this.$emit("open-emoji",!this.emojiOpened),this.setEmojiPickerPosition(e.clientY,e.view.innerWidth,e.view.innerHeight)},closeEmoji(){this.$emit("open-emoji",!1)},setEmojiPickerPosition(e,t,s){const a=t<500||s<700,n=$1(this.$el,"#room-footer");if(!n){a&&(this.emojiPickerRight="-50px");return}a?(this.emojiPickerRight=t/2-(this.positionTop?200:150)+"px",this.emojiPickerTop=100,this.emojiPickerHeight=s-200):(n.getBoundingClientRect().top-e>this.emojiPickerHeight-50?this.emojiPickerTop=e+10:this.emojiPickerTop=e-this.emojiPickerHeight-10,this.emojiPickerRight=this.positionTop?"0px":this.positionRight?"60px":"")}}},Cp={class:"vac-emoji-wrapper"};function Bp(e,t,s,a,n,r){const o=Ke("svg-icon"),l=Ke("emoji-picker"),v=Ke("OnClickOutside");return Q(),ne("div",Cp,[fe("div",{class:st(["vac-svg-button",{"vac-emoji-reaction":s.emojiReaction}]),onClick:t[0]||(t[0]=(...c)=>r.openEmoji&&r.openEmoji(...c))},[Oe(e.$slots,s.messageId?"emoji-picker-reaction-icon_"+s.messageId:"emoji-picker-icon",{},()=>[Re(o,{name:"emoji",param:s.emojiReaction?"reaction":""},null,8,["param"])])],2),s.emojiOpened?(Q(),ne(ut,{key:0},[s.teleportTarget?(Q(),ht(Wf,{key:0,to:s.teleportTarget},[Re(Ct,{name:"vac-slide-up",appear:""},{default:Xe(()=>[Re(v,{onTrigger:r.closeEmoji},{default:Xe(()=>[fe("div",{class:st(["vac-emoji-picker",{"vac-picker-reaction":s.emojiReaction}]),style:xt({height:`${n.emojiPickerHeight}px`,top:s.positionTop?n.emojiPickerHeight:`${n.emojiPickerTop}px`,right:n.emojiPickerRight,display:n.emojiPickerTop||!s.emojiReaction?"initial":"none"})},[s.emojiOpened?(Q(),ht(l,{key:0,ref:"emojiPicker","data-source":s.emojiDataSource},null,8,["data-source"])):Ae("",!0)],6)]),_:1},8,["onTrigger"])]),_:1})],8,["to"])):(Q(),ht(Ct,{key:1,name:"vac-slide-up",appear:""},{default:Xe(()=>[Re(v,{onTrigger:r.closeEmoji},{default:Xe(()=>[fe("div",{class:st(["vac-emoji-picker",{"vac-picker-reaction":s.emojiReaction}]),style:xt({height:`${n.emojiPickerHeight}px`,top:s.positionTop?n.emojiPickerHeight:`${n.emojiPickerTop}px`,right:n.emojiPickerRight,display:n.emojiPickerTop||!s.emojiReaction?"initial":"none"})},[s.emojiOpened?(Q(),ht(l,{key:0,ref:"emojiPicker","data-source":s.emojiDataSource},null,8,["data-source"])):Ae("",!0)],6)]),_:1},8,["onTrigger"])]),_:1}))],64)):Ae("",!0)])}var Eu=St(Ip,[["render",Bp]]);const Lp={name:"RoomFiles",components:{Loader:ai,SvgIcon:Vt},props:{file:{type:Object,required:!0},index:{type:Number,required:!0}},emits:["remove-file"],computed:{isImage(){return hr(this.file)},isVideo(){return rn(this.file)}}},Np={class:"vac-room-file-container"},jp=["src"],Hp={class:"vac-text-ellipsis"},Pp={key:0,class:"vac-text-ellipsis vac-text-extension"};function Fp(e,t,s,a,n,r){const o=Ke("loader"),l=Ke("svg-icon");return Q(),ne("div",Np,[Re(o,{show:s.file.loading,type:"room-file"},gt({_:2},[at(e.$slots,(v,c)=>({name:c,fn:Xe(m=>[Oe(e.$slots,c,pt(_t(m)))])}))]),1032,["show"]),fe("div",{class:"vac-svg-button vac-icon-remove",onClick:t[0]||(t[0]=v=>e.$emit("remove-file",s.index))},[Oe(e.$slots,"image-close-icon",{},()=>[Re(l,{name:"close",param:"image"})])]),r.isImage?(Q(),ne("div",{key:0,class:st(["vac-message-image",{"vac-blur-loading":s.file.loading}]),style:xt({"background-image":`url('${s.file.localUrl||s.file.url}')`})},null,6)):r.isVideo?(Q(),ne("video",{key:1,controls:"",class:st({"vac-blur-loading":s.file.loading})},[fe("source",{src:s.file.localUrl||s.file.url},null,8,jp)],2)):(Q(),ne("div",{key:2,class:st(["vac-file-container",{"vac-blur-loading":s.file.loading}])},[fe("div",null,[Oe(e.$slots,"file-icon",{},()=>[Re(l,{name:"file"})])]),fe("div",Hp,$e(s.file.name),1),s.file.extension?(Q(),ne("div",Pp,$e(s.file.extension),1)):Ae("",!0)],2))])}var Dp=St(Lp,[["render",Fp]]);const Up={name:"RoomFiles",components:{SvgIcon:Vt,RoomFile:Dp},props:{files:{type:Array,required:!0}},emits:["remove-file","reset-message"],computed:{}},qp={key:0,class:"vac-room-files-container"},Vp={class:"vac-files-box"},zp={class:"vac-icon-close"};function Yp(e,t,s,a,n,r){const o=Ke("room-file"),l=Ke("svg-icon");return Q(),ht(Ct,{name:"vac-slide-up"},{default:Xe(()=>[s.files.length?(Q(),ne("div",qp,[fe("div",Vp,[(Q(!0),ne(ut,null,at(s.files,(v,c)=>(Q(),ne("div",{key:c},[Re(o,{file:v,index:c,onRemoveFile:t[0]||(t[0]=m=>e.$emit("remove-file",m))},gt({_:2},[at(e.$slots,(m,u)=>({name:u,fn:Xe(p=>[Oe(e.$slots,u,pt(_t(p)))])}))]),1032,["file","index"])]))),128))]),fe("div",zp,[fe("div",{class:"vac-svg-button",onClick:t[1]||(t[1]=v=>e.$emit("reset-message"))},[Oe(e.$slots,"files-close-icon",{},()=>[Re(l,{name:"close-outline"})])])])])):Ae("",!0)]),_:3})}var Xp=St(Up,[["render",Yp]]);const Kp={props:{percentage:{type:Number,default:0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["hover-audio-progress","change-linehead"],data(){return{isMouseDown:!1}},methods:{onMouseDown(e){if(this.messageSelectionEnabled)return;this.isMouseDown=!0;const t=this.calculateLineHeadPosition(e,this.$refs.progress);this.$emit("change-linehead",t),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)},onMouseUp(e){if(this.messageSelectionEnabled)return;this.isMouseDown=!1,document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("mousemove",this.onMouseMove);const t=this.calculateLineHeadPosition(e,this.$refs.progress);this.$emit("change-linehead",t)},onMouseMove(e){if(this.messageSelectionEnabled)return;const t=this.calculateLineHeadPosition(e,this.$refs.progress);this.$emit("change-linehead",t)},calculateLineHeadPosition(e,t){const s=t.getBoundingClientRect().width,a=t.getBoundingClientRect().left;let n=(e.clientX-a)/s;return n=n<0?0:n,n=n>1?1:n,n}}},Gp={class:"vac-player-progress"},Wp={class:"vac-line-container"};function Zp(e,t,s,a,n,r){return Q(),ne("div",{ref:"progress",class:"vac-player-bar",onMousedown:t[0]||(t[0]=(...o)=>r.onMouseDown&&r.onMouseDown(...o)),onMouseover:t[1]||(t[1]=o=>e.$emit("hover-audio-progress",!0)),onMouseout:t[2]||(t[2]=o=>e.$emit("hover-audio-progress",!1))},[fe("div",Gp,[fe("div",Wp,[fe("div",{class:"vac-line-progress",style:xt({width:`${s.percentage}%`})},null,4),fe("div",{class:st(["vac-line-dot",{"vac-line-dot__active":n.isMouseDown}]),style:xt({left:`${s.percentage}%`})},null,6)])])],544)}var Qp=St(Kp,[["render",Zp]]);const Jp={name:"AudioPlayer",components:{SvgIcon:Vt,AudioControl:Qp},props:{messageId:{type:[String,Number],default:null},src:{type:String,default:null},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["hover-audio-progress","update-progress-time"],data(){return{isPlaying:!1,duration:this.convertTimeMMSS(0),playedTime:this.convertTimeMMSS(0),progress:0}},computed:{playerUniqId(){return`audio-player${this.messageId}`},audioSource(){return this.src?this.src:(this.resetProgress(),null)}},mounted(){this.player=this.$el.querySelector("#"+this.playerUniqId),this.player.addEventListener("ended",()=>{this.isPlaying=!1}),this.player.addEventListener("loadeddata",()=>{this.resetProgress(),this.duration=this.convertTimeMMSS(this.player.duration),this.updateProgressTime()}),this.player.addEventListener("timeupdate",this.onTimeUpdate)},methods:{convertTimeMMSS(e){return new Date(e*1e3).toISOString().substr(14,5)},playback(){this.messageSelectionEnabled||!this.audioSource||(this.isPlaying?this.player.pause():setTimeout(()=>this.player.play()),this.isPlaying=!this.isPlaying)},resetProgress(){this.isPlaying&&this.player.pause(),this.duration=this.convertTimeMMSS(0),this.playedTime=this.convertTimeMMSS(0),this.progress=0,this.isPlaying=!1,this.updateProgressTime()},onTimeUpdate(){this.playedTime=this.convertTimeMMSS(this.player.currentTime),this.progress=this.player.currentTime/this.player.duration*100,this.updateProgressTime()},onUpdateProgress(e){e&&(this.player.currentTime=e*this.player.duration)},updateProgressTime(){this.$emit("update-progress-time",this.progress>1?this.playedTime:this.duration)}}},$p={class:"vac-audio-player"},e3=["id","src"];function t3(e,t,s,a,n,r){const o=Ke("svg-icon"),l=Ke("audio-control");return Q(),ne("div",null,[fe("div",$p,[fe("div",{class:"vac-svg-button",onClick:t[0]||(t[0]=(...v)=>r.playback&&r.playback(...v))},[n.isPlaying?Oe(e.$slots,"audio-pause-icon_"+s.messageId,{key:0},()=>[Re(o,{name:"audio-pause"})]):Oe(e.$slots,"audio-play-icon_"+s.messageId,{key:1},()=>[Re(o,{name:"audio-play"})])]),Re(l,{percentage:n.progress,"message-selection-enabled":s.messageSelectionEnabled,onChangeLinehead:r.onUpdateProgress,onHoverAudioProgress:t[1]||(t[1]=v=>e.$emit("hover-audio-progress",v))},null,8,["percentage","message-selection-enabled","onChangeLinehead"]),fe("audio",{id:r.playerUniqId,src:r.audioSource},null,8,e3)])])}var xl=St(Jp,[["render",t3]]);const s3={name:"RoomMessageReply",components:{SvgIcon:Vt,FormatMessage:sn,AudioPlayer:xl},props:{room:{type:Object,required:!0},messageReply:{type:Object,default:null},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0}},emits:["reset-message"],computed:{firstFile(){var e,t;return(t=(e=this.messageReply)==null?void 0:e.files)!=null&&t.length?this.messageReply.files[0]:{}},isImage(){return hr(this.firstFile)},isVideo(){return rn(this.firstFile)},isAudio(){return hi(this.firstFile)},isOtherFile(){var e,t;return((t=(e=this.messageReply)==null?void 0:e.files)==null?void 0:t.length)&&!this.isAudio&&!this.isVideo&&!this.isImage}}},a3={key:0,class:"vac-reply-container"},r3={class:"vac-reply-box"},n3={class:"vac-reply-info"},i3={class:"vac-reply-username"},o3={class:"vac-reply-content"},l3=["src"],c3={key:1,controls:"",class:"vac-image-reply"},u3=["src"],d3={key:3,class:"vac-image-reply vac-file-container"},f3={class:"vac-text-ellipsis"},m3={key:0,class:"vac-text-ellipsis vac-text-extension"},h3={class:"vac-icon-reply"};function v3(e,t,s,a,n,r){const o=Ke("format-message"),l=Ke("audio-player"),v=Ke("svg-icon");return Q(),ht(Ct,{name:"vac-slide-up"},{default:Xe(()=>[s.messageReply?(Q(),ne("div",a3,[fe("div",r3,[fe("div",n3,[fe("div",i3,$e(s.messageReply.username),1),fe("div",o3,[Re(o,{"message-id":s.messageReply._id,content:s.messageReply.content,users:s.room.users,"text-formatting":s.textFormatting,"link-options":s.linkOptions,reply:!0},null,8,["message-id","content","users","text-formatting","link-options"])])]),r.isImage?(Q(),ne("img",{key:0,src:r.firstFile.url,class:"vac-image-reply"},null,8,l3)):r.isVideo?(Q(),ne("video",c3,[fe("source",{src:r.firstFile.url},null,8,u3)])):r.isAudio?(Q(),ht(l,{key:2,src:r.firstFile.url,"message-selection-enabled":!1,class:"vac-audio-reply"},gt({_:2},[at(e.$slots,(c,m)=>({name:m,fn:Xe(u=>[Oe(e.$slots,m,pt(_t(u)))])}))]),1032,["src"])):r.isOtherFile?(Q(),ne("div",d3,[fe("div",null,[Oe(e.$slots,"file-icon",{},()=>[Re(v,{name:"file"})])]),fe("div",f3,$e(r.firstFile.name),1),r.firstFile.extension?(Q(),ne("div",m3,$e(r.firstFile.extension),1)):Ae("",!0)])):Ae("",!0)]),fe("div",h3,[fe("div",{class:"vac-svg-button",onClick:t[0]||(t[0]=c=>e.$emit("reset-message"))},[Oe(e.$slots,"reply-close-icon",{},()=>[Re(v,{name:"close-outline"})])])])])):Ae("",!0)]),_:3})}var _3=St(s3,[["render",v3]]);const p3={name:"RoomUsersTag",props:{filteredUsersTag:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-user-tag","activate-item"],data(){return{activeItem:null}},watch:{filteredUsersTag(e,t){(!t.length||e.length!==t.length)&&(this.activeItem=0)},selectItem(e){e&&this.$emit("select-user-tag",this.filteredUsersTag[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredUsersTag.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},g3={key:0,class:"vac-tags-container"},b3=["onMouseover","onClick"],y3={class:"vac-tags-info"},x3={class:"vac-tags-username"};function w3(e,t,s,a,n,r){return Q(),ht(Ct,{name:"vac-slide-up"},{default:Xe(()=>[s.filteredUsersTag.length?(Q(),ne("div",g3,[(Q(!0),ne(ut,null,at(s.filteredUsersTag,(o,l)=>(Q(),ne("div",{key:o._id,class:st(["vac-tags-box",{"vac-tags-box-active":l===n.activeItem}]),onMouseover:v=>n.activeItem=l,onClick:v=>e.$emit("select-user-tag",o)},[fe("div",y3,[o.avatar?(Q(),ne("div",{key:0,class:"vac-avatar vac-tags-avatar",style:xt({"background-image":`url('${o.avatar}')`})},null,4)):Ae("",!0),fe("div",x3,$e(o.username),1)])],42,b3))),128))])):Ae("",!0)]),_:1})}var S3=St(p3,[["render",w3]]);const M3={name:"RoomEmojis",props:{filteredEmojis:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-emoji","activate-item"],data(){return{activeItem:null}},watch:{filteredEmojis(e,t){(!t.length||e.length!==t.length)&&(this.activeItem=0)},selectItem(e){e&&this.$emit("select-emoji",this.filteredEmojis[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredEmojis.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},T3={key:0,class:"vac-emojis-container"},E3=["onMouseover","onClick"];function A3(e,t,s,a,n,r){return Q(),ht(Ct,{name:"vac-slide-up"},{default:Xe(()=>[s.filteredEmojis.length?(Q(),ne("div",T3,[(Q(!0),ne(ut,null,at(s.filteredEmojis,(o,l)=>(Q(),ne("div",{key:o,class:st(["vac-emoji-element",{"vac-emoji-element-active":l===n.activeItem}]),onMouseover:v=>n.activeItem=l,onClick:v=>e.$emit("select-emoji",o)},$e(o),43,E3))),128))])):Ae("",!0)]),_:1})}var k3=St(M3,[["render",A3]]);const R3={name:"RoomTemplatesText",props:{filteredTemplatesText:{type:Array,required:!0},selectItem:{type:Boolean,default:null},activeUpOrDown:{type:Number,default:null}},emits:["select-template-text","activate-item"],data(){return{activeItem:null}},watch:{filteredTemplatesText(e,t){(!t.length||e.length!==t.length)&&(this.activeItem=0)},selectItem(e){e&&this.$emit("select-template-text",this.filteredTemplatesText[this.activeItem])},activeUpOrDown(){this.activeUpOrDown>0&&this.activeItem<this.filteredTemplatesText.length-1?this.activeItem++:this.activeUpOrDown<0&&this.activeItem>0&&this.activeItem--,this.$emit("activate-item")}}},O3={key:0,class:"vac-template-container vac-app-box-shadow"},I3=["onMouseover","onClick"],C3={class:"vac-template-info"},B3={class:"vac-template-tag"},L3={class:"vac-template-text"};function N3(e,t,s,a,n,r){return Q(),ht(Ct,{name:"vac-slide-up"},{default:Xe(()=>[s.filteredTemplatesText.length?(Q(),ne("div",O3,[(Q(!0),ne(ut,null,at(s.filteredTemplatesText,(o,l)=>(Q(),ne("div",{key:l,class:st(["vac-template-box",{"vac-template-active":l===n.activeItem}]),onMouseover:v=>n.activeItem=l,onClick:v=>e.$emit("select-template-text",o)},[fe("div",C3,[fe("div",B3," /"+$e(o.tag),1),fe("div",L3,$e(o.text),1)])],42,I3))),128))])):Ae("",!0)]),_:1})}var j3=St(R3,[["render",N3]]);function H3(e){return new Int8Array(e)}function Au(e){return new Int16Array(e)}function ku(e){return new Int32Array(e)}function Ru(e){return new Float32Array(e)}function P3(e){return new Float64Array(e)}function Ou(e){if(e.length==1)return Ru(e[0]);var t=e[0];e=e.slice(1);for(var s=[],a=0;a<t;a++)s.push(Ou(e));return s}function Iu(e){if(e.length==1)return ku(e[0]);var t=e[0];e=e.slice(1);for(var s=[],a=0;a<t;a++)s.push(Iu(e));return s}function Cu(e){if(e.length==1)return Au(e[0]);var t=e[0];e=e.slice(1);for(var s=[],a=0;a<t;a++)s.push(Cu(e));return s}function Bu(e){if(e.length==1)return new Array(e[0]);var t=e[0];e=e.slice(1);for(var s=[],a=0;a<t;a++)s.push(Bu(e));return s}var Lu={};Lu.fill=function(e,t,s,a){if(arguments.length==2)for(var n=0;n<e.length;n++)e[n]=arguments[1];else for(var n=t;n<s;n++)e[n]=a};var _n={};_n.arraycopy=function(e,t,s,a,n){for(var r=t+n;t<r;)s[a++]=e[t++]},_n.out={},_n.out.println=function(e){console.log(e)},_n.out.printf=function(){console.log.apply(console,arguments)};var ki={};ki.SQRT2=1.4142135623730951,ki.FAST_LOG10=function(e){return Math.log10(e)},ki.FAST_LOG10_X=function(e,t){return Math.log10(e)*t};function sa(e){this.ordinal=e}sa.short_block_allowed=new sa(0),sa.short_block_coupled=new sa(1),sa.short_block_dispensed=new sa(2),sa.short_block_forced=new sa(3);var Nu={};Nu.MAX_VALUE=34028235e31;function vs(e){this.ordinal=e}vs.vbr_off=new vs(0),vs.vbr_mt=new vs(1),vs.vbr_rh=new vs(2),vs.vbr_abr=new vs(3),vs.vbr_mtrh=new vs(4),vs.vbr_default=vs.vbr_mtrh;var F3=function(e){},ke={System:_n,VbrMode:vs,Float:Nu,ShortBlock:sa,Util:ki,Arrays:Lu,new_array_n:Bu,new_byte:H3,new_double:P3,new_float:Ru,new_float_n:Ou,new_int:ku,new_int_n:Iu,new_short:Au,new_short_n:Cu,assert:F3},D3=ke.System,Bt=ke.Util,U3=ke.Arrays,q3=ke.new_float;function V3(){var e=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*Bt.SQRT2*.5/2384e-9,.017876148*Bt.SQRT2*.5/2384e-9,.003134727*Bt.SQRT2*.5/2384e-9,.002457142*Bt.SQRT2*.5/2384e-9,971317e-9*Bt.SQRT2*.5/2384e-9,218868e-9*Bt.SQRT2*.5/2384e-9,101566e-9*Bt.SQRT2*.5/2384e-9,13828e-9*Bt.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],t=12,s=36,a=[[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,940084909404969e-27,6423305872147839e-28,2382191739347918e-28,5456116108943412e-27,4878985199565852e-27,4240448995017367e-27,3559909094758252e-27,2858043359288075e-27,2156177623817898e-27,1475637723558783e-27,8371015190102974e-28,2599706096327376e-28,-5456116108943412e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758252e-27,-2858043359288076e-27,-2156177623817898e-27,-1475637723558783e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347923e-28,-6423305872147843e-28,-9400849094049696e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049694e-28,-642330587214784e-27,-2382191739347918e-28],[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,9400849094049688e-28,6423305872147841e-28,2382191739347918e-28,5456116108943413e-27,4878985199565852e-27,4240448995017367e-27,3559909094758253e-27,2858043359288075e-27,2156177623817898e-27,1475637723558782e-27,8371015190102975e-28,2599706096327376e-28,-5461314069809755e-27,-4921085770524055e-27,-4343405037091838e-27,-3732668368707687e-27,-3093523840190885e-27,-2430835727329465e-27,-1734679010007751e-27,-974825365660928e-27,-2797435120168326e-28,0,0,0,0,0,0,-2283748241799531e-28,-4037858874020686e-28,-2146547464825323e-28],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2283748241799531e-28,4037858874020686e-28,2146547464825323e-28,5461314069809755e-27,4921085770524055e-27,4343405037091838e-27,3732668368707687e-27,3093523840190885e-27,2430835727329466e-27,1734679010007751e-27,974825365660928e-27,2797435120168326e-28,-5456116108943413e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758253e-27,-2858043359288075e-27,-2156177623817898e-27,-1475637723558782e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347913e-28,-6423305872147834e-28,-9400849094049688e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049688e-28,-6423305872147841e-28,-2382191739347918e-28]],n=a[O.SHORT_TYPE],r=a[O.SHORT_TYPE],o=a[O.SHORT_TYPE],l=a[O.SHORT_TYPE],v=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];function c(p,y,i){for(var H=10,L=y+238-14-286,N=-15;N<0;N++){var h,k,C;h=e[H+-10],k=p[L+-224]*h,C=p[y+224]*h,h=e[H+-9],k+=p[L+-160]*h,C+=p[y+160]*h,h=e[H+-8],k+=p[L+-96]*h,C+=p[y+96]*h,h=e[H+-7],k+=p[L+-32]*h,C+=p[y+32]*h,h=e[H+-6],k+=p[L+32]*h,C+=p[y+-32]*h,h=e[H+-5],k+=p[L+96]*h,C+=p[y+-96]*h,h=e[H+-4],k+=p[L+160]*h,C+=p[y+-160]*h,h=e[H+-3],k+=p[L+224]*h,C+=p[y+-224]*h,h=e[H+-2],k+=p[y+-256]*h,C-=p[L+256]*h,h=e[H+-1],k+=p[y+-192]*h,C-=p[L+192]*h,h=e[H+0],k+=p[y+-128]*h,C-=p[L+128]*h,h=e[H+1],k+=p[y+-64]*h,C-=p[L+64]*h,h=e[H+2],k+=p[y+0]*h,C-=p[L+0]*h,h=e[H+3],k+=p[y+64]*h,C-=p[L+-64]*h,h=e[H+4],k+=p[y+128]*h,C-=p[L+-128]*h,h=e[H+5],k+=p[y+192]*h,C-=p[L+-192]*h,k*=e[H+6],h=C-k,i[30+N*2]=C+k,i[31+N*2]=e[H+7]*h,H+=18,y--,L++}{var k,C,A,B;C=p[y+-16]*e[H+-10],k=p[y+-32]*e[H+-2],C+=(p[y+-48]-p[y+16])*e[H+-9],k+=p[y+-96]*e[H+-1],C+=(p[y+-80]+p[y+48])*e[H+-8],k+=p[y+-160]*e[H+0],C+=(p[y+-112]-p[y+80])*e[H+-7],k+=p[y+-224]*e[H+1],C+=(p[y+-144]+p[y+112])*e[H+-6],k-=p[y+32]*e[H+2],C+=(p[y+-176]-p[y+144])*e[H+-5],k-=p[y+96]*e[H+3],C+=(p[y+-208]+p[y+176])*e[H+-4],k-=p[y+160]*e[H+4],C+=(p[y+-240]-p[y+208])*e[H+-3],k-=p[y+224],A=k-C,B=k+C,C=i[14],k=i[15]-C,i[31]=B+C,i[30]=A+k,i[15]=A-k,i[14]=B-C}{var d;d=i[28]-i[0],i[0]+=i[28],i[28]=d*e[H+-2*18+7],d=i[29]-i[1],i[1]+=i[29],i[29]=d*e[H+-2*18+7],d=i[26]-i[2],i[2]+=i[26],i[26]=d*e[H+-4*18+7],d=i[27]-i[3],i[3]+=i[27],i[27]=d*e[H+-4*18+7],d=i[24]-i[4],i[4]+=i[24],i[24]=d*e[H+-6*18+7],d=i[25]-i[5],i[5]+=i[25],i[25]=d*e[H+-6*18+7],d=i[22]-i[6],i[6]+=i[22],i[22]=d*Bt.SQRT2,d=i[23]-i[7],i[7]+=i[23],i[23]=d*Bt.SQRT2-i[7],i[7]-=i[6],i[22]-=i[7],i[23]-=i[22],d=i[6],i[6]=i[31]-d,i[31]=i[31]+d,d=i[7],i[7]=i[30]-d,i[30]=i[30]+d,d=i[22],i[22]=i[15]-d,i[15]=i[15]+d,d=i[23],i[23]=i[14]-d,i[14]=i[14]+d,d=i[20]-i[8],i[8]+=i[20],i[20]=d*e[H+-10*18+7],d=i[21]-i[9],i[9]+=i[21],i[21]=d*e[H+-10*18+7],d=i[18]-i[10],i[10]+=i[18],i[18]=d*e[H+-12*18+7],d=i[19]-i[11],i[11]+=i[19],i[19]=d*e[H+-12*18+7],d=i[16]-i[12],i[12]+=i[16],i[16]=d*e[H+-14*18+7],d=i[17]-i[13],i[13]+=i[17],i[17]=d*e[H+-14*18+7],d=-i[20]+i[24],i[20]+=i[24],i[24]=d*e[H+-12*18+7],d=-i[21]+i[25],i[21]+=i[25],i[25]=d*e[H+-12*18+7],d=i[4]-i[8],i[4]+=i[8],i[8]=d*e[H+-12*18+7],d=i[5]-i[9],i[5]+=i[9],i[9]=d*e[H+-12*18+7],d=i[0]-i[12],i[0]+=i[12],i[12]=d*e[H+-4*18+7],d=i[1]-i[13],i[1]+=i[13],i[13]=d*e[H+-4*18+7],d=i[16]-i[28],i[16]+=i[28],i[28]=d*e[H+-4*18+7],d=-i[17]+i[29],i[17]+=i[29],i[29]=d*e[H+-4*18+7],d=Bt.SQRT2*(i[2]-i[10]),i[2]+=i[10],i[10]=d,d=Bt.SQRT2*(i[3]-i[11]),i[3]+=i[11],i[11]=d,d=Bt.SQRT2*(-i[18]+i[26]),i[18]+=i[26],i[26]=d-i[18],d=Bt.SQRT2*(-i[19]+i[27]),i[19]+=i[27],i[27]=d-i[19],d=i[2],i[19]-=i[3],i[3]-=d,i[2]=i[31]-d,i[31]+=d,d=i[3],i[11]-=i[19],i[18]-=d,i[3]=i[30]-d,i[30]+=d,d=i[18],i[27]-=i[11],i[19]-=d,i[18]=i[15]-d,i[15]+=d,d=i[19],i[10]-=d,i[19]=i[14]-d,i[14]+=d,d=i[10],i[11]-=d,i[10]=i[23]-d,i[23]+=d,d=i[11],i[26]-=d,i[11]=i[22]-d,i[22]+=d,d=i[26],i[27]-=d,i[26]=i[7]-d,i[7]+=d,d=i[27],i[27]=i[6]-d,i[6]+=d,d=Bt.SQRT2*(i[0]-i[4]),i[0]+=i[4],i[4]=d,d=Bt.SQRT2*(i[1]-i[5]),i[1]+=i[5],i[5]=d,d=Bt.SQRT2*(i[16]-i[20]),i[16]+=i[20],i[20]=d,d=Bt.SQRT2*(i[17]-i[21]),i[17]+=i[21],i[21]=d,d=-Bt.SQRT2*(i[8]-i[12]),i[8]+=i[12],i[12]=d-i[8],d=-Bt.SQRT2*(i[9]-i[13]),i[9]+=i[13],i[13]=d-i[9],d=-Bt.SQRT2*(i[25]-i[29]),i[25]+=i[29],i[29]=d-i[25],d=-Bt.SQRT2*(i[24]+i[28]),i[24]-=i[28],i[28]=d-i[24],d=i[24]-i[16],i[24]=d,d=i[20]-d,i[20]=d,d=i[28]-d,i[28]=d,d=i[25]-i[17],i[25]=d,d=i[21]-d,i[21]=d,d=i[29]-d,i[29]=d,d=i[17]-i[1],i[17]=d,d=i[9]-d,i[9]=d,d=i[25]-d,i[25]=d,d=i[5]-d,i[5]=d,d=i[21]-d,i[21]=d,d=i[13]-d,i[13]=d,d=i[29]-d,i[29]=d,d=i[1]-i[0],i[1]=d,d=i[16]-d,i[16]=d,d=i[17]-d,i[17]=d,d=i[8]-d,i[8]=d,d=i[9]-d,i[9]=d,d=i[24]-d,i[24]=d,d=i[25]-d,i[25]=d,d=i[4]-d,i[4]=d,d=i[5]-d,i[5]=d,d=i[20]-d,i[20]=d,d=i[21]-d,i[21]=d,d=i[12]-d,i[12]=d,d=i[13]-d,i[13]=d,d=i[28]-d,i[28]=d,d=i[29]-d,i[29]=d,d=i[0],i[0]+=i[31],i[31]-=d,d=i[1],i[1]+=i[30],i[30]-=d,d=i[16],i[16]+=i[15],i[15]-=d,d=i[17],i[17]+=i[14],i[14]-=d,d=i[8],i[8]+=i[23],i[23]-=d,d=i[9],i[9]+=i[22],i[22]-=d,d=i[24],i[24]+=i[7],i[7]-=d,d=i[25],i[25]+=i[6],i[6]-=d,d=i[4],i[4]+=i[27],i[27]-=d,d=i[5],i[5]+=i[26],i[26]-=d,d=i[20],i[20]+=i[11],i[11]-=d,d=i[21],i[21]+=i[10],i[10]-=d,d=i[12],i[12]+=i[19],i[19]-=d,d=i[13],i[13]+=i[18],i[18]-=d,d=i[28],i[28]+=i[3],i[3]-=d,d=i[29],i[29]+=i[2],i[2]-=d}}function m(p,y){for(var i=0;i<3;i++){var H,L,N,h,k,C;h=p[y+2*3]*a[O.SHORT_TYPE][0]-p[y+5*3],H=p[y+0*3]*a[O.SHORT_TYPE][2]-p[y+3*3],L=h+H,N=h-H,h=p[y+5*3]*a[O.SHORT_TYPE][0]+p[y+2*3],H=p[y+3*3]*a[O.SHORT_TYPE][2]+p[y+0*3],k=h+H,C=-h+H,H=(p[y+1*3]*a[O.SHORT_TYPE][1]-p[y+4*3])*2069978111953089e-26,h=(p[y+4*3]*a[O.SHORT_TYPE][1]+p[y+1*3])*2069978111953089e-26,p[y+3*0]=L*190752519173728e-25+H,p[y+3*5]=-k*190752519173728e-25+h,N=N*.8660254037844387*1907525191737281e-26,k=k*.5*1907525191737281e-26+h,p[y+3*1]=N-k,p[y+3*2]=N+k,L=L*.5*1907525191737281e-26-H,C=C*.8660254037844387*1907525191737281e-26,p[y+3*3]=L+C,p[y+3*4]=L-C,y++}}function u(p,y,i){var H,L;{var N,h,k,C,A,B,d,E;N=i[17]-i[9],k=i[15]-i[11],C=i[14]-i[12],A=i[0]+i[8],B=i[1]+i[7],d=i[2]+i[6],E=i[3]+i[5],p[y+17]=A+d-E-(B-i[4]),L=(A+d-E)*r[12+7]+(B-i[4]),H=(N-k-C)*r[12+6],p[y+5]=H+L,p[y+6]=H-L,h=(i[16]-i[10])*r[12+6],B=B*r[12+7]+i[4],H=N*r[12+0]+h+k*r[12+1]+C*r[12+2],L=-A*r[12+4]+B-d*r[12+5]+E*r[12+3],p[y+1]=H+L,p[y+2]=H-L,H=N*r[12+1]-h-k*r[12+2]+C*r[12+0],L=-A*r[12+5]+B-d*r[12+3]+E*r[12+4],p[y+9]=H+L,p[y+10]=H-L,H=N*r[12+2]-h+k*r[12+0]-C*r[12+1],L=A*r[12+3]-B+d*r[12+4]-E*r[12+5],p[y+13]=H+L,p[y+14]=H-L}{var S,_,x,b,g,M,w,j;S=i[8]-i[0],x=i[6]-i[2],b=i[5]-i[3],g=i[17]+i[9],M=i[16]+i[10],w=i[15]+i[11],j=i[14]+i[12],p[y+0]=g+w+j+(M+i[13]),H=(g+w+j)*r[12+7]-(M+i[13]),L=(S-x+b)*r[12+6],p[y+11]=H+L,p[y+12]=H-L,_=(i[7]-i[1])*r[12+6],M=i[13]-M*r[12+7],H=g*r[12+3]-M+w*r[12+4]+j*r[12+5],L=S*r[12+2]+_+x*r[12+0]+b*r[12+1],p[y+3]=H+L,p[y+4]=H-L,H=-g*r[12+5]+M-w*r[12+3]-j*r[12+4],L=S*r[12+1]+_-x*r[12+2]-b*r[12+0],p[y+7]=H+L,p[y+8]=H-L,H=-g*r[12+4]+M-w*r[12+5]-j*r[12+3],L=S*r[12+0]-_+x*r[12+1]-b*r[12+2],p[y+15]=H+L,p[y+16]=H-L}}this.mdct_sub48=function(p,y,i){for(var H=y,L=286,N=0;N<p.channels_out;N++){for(var h=0;h<p.mode_gr;h++){for(var k,C=p.l3_side.tt[h][N],A=C.xr,B=0,d=p.sb_sample[N][1-h],E=0,S=0;S<18/2;S++)for(c(H,L,d[E]),c(H,L+32,d[E+1]),E+=2,L+=64,k=1;k<32;k+=2)d[E-1][k]*=-1;for(k=0;k<32;k++,B+=18){var _=C.block_type,x=p.sb_sample[N][h],b=p.sb_sample[N][1-h];if(C.mixed_block_flag!=0&&k<2&&(_=0),p.amp_filter[k]<1e-12)U3.fill(A,B+0,B+18,0);else{if(p.amp_filter[k]<1)for(var S=0;S<18;S++)b[S][v[k]]*=p.amp_filter[k];if(_==O.SHORT_TYPE){for(var S=-t/4;S<0;S++){var g=a[O.SHORT_TYPE][S+3];A[B+S*3+9]=x[9+S][v[k]]*g-x[8-S][v[k]],A[B+S*3+18]=x[14-S][v[k]]*g+x[15+S][v[k]],A[B+S*3+10]=x[15+S][v[k]]*g-x[14-S][v[k]],A[B+S*3+19]=b[2-S][v[k]]*g+b[3+S][v[k]],A[B+S*3+11]=b[3+S][v[k]]*g-b[2-S][v[k]],A[B+S*3+20]=b[8-S][v[k]]*g+b[9+S][v[k]]}m(A,B)}else{for(var M=q3(18),S=-s/4;S<0;S++){var w,j;w=a[_][S+27]*b[S+9][v[k]]+a[_][S+36]*b[8-S][v[k]],j=a[_][S+9]*x[S+9][v[k]]-a[_][S+18]*x[8-S][v[k]],M[S+9]=w-j*n[3+S+9],M[S+18]=w*n[3+S+9]+j}u(A,B,M)}}if(_!=O.SHORT_TYPE&&k!=0)for(var S=7;S>=0;--S){var X,F;X=A[B+S]*o[20+S]+A[B+-1-S]*l[28+S],F=A[B+S]*l[28+S]-A[B+-1-S]*o[20+S],A[B+-1-S]=X,A[B+S]=F}}}if(H=i,L=286,p.mode_gr==1)for(var V=0;V<18;V++)D3.arraycopy(p.sb_sample[N][1][V],0,p.sb_sample[N][0][V],0,32)}}}var z3=ke.System,Y3=ke.new_float,X3=ke.new_float_n;function Ri(){this.l=Y3(O.SBMAX_l),this.s=X3([O.SBMAX_s,3]);var e=this;this.assign=function(t){z3.arraycopy(t.l,0,e.l,0,O.SBMAX_l);for(var s=0;s<O.SBMAX_s;s++)for(var a=0;a<3;a++)e.s[s][a]=t.s[s][a]}}function ga(){this.thm=new Ri,this.en=new Ri}function vt(e){var t=e;this.ordinal=function(){return t}}vt.STEREO=new vt(0),vt.JOINT_STEREO=new vt(1),vt.DUAL_CHANNEL=new vt(2),vt.MONO=new vt(3),vt.NOT_SET=new vt(4);var ju=ke.System,Oi=ke.VbrMode,Hu=ke.new_array_n,Pu=ke.new_float,K3=ke.new_float_n,G3=ke.new_int,Ii=ke.assert;O.ENCDELAY=576,O.POSTDELAY=1152,O.MDCTDELAY=48,O.FFTOFFSET=224+O.MDCTDELAY,O.DECDELAY=528,O.SBLIMIT=32,O.CBANDS=64,O.SBPSY_l=21,O.SBPSY_s=12,O.SBMAX_l=22,O.SBMAX_s=13,O.PSFB21=6,O.PSFB12=6,O.BLKSIZE=1024,O.HBLKSIZE=O.BLKSIZE/2+1,O.BLKSIZE_s=256,O.HBLKSIZE_s=O.BLKSIZE_s/2+1,O.NORM_TYPE=0,O.START_TYPE=1,O.SHORT_TYPE=2,O.STOP_TYPE=3,O.MPG_MD_LR_LR=0,O.MPG_MD_LR_I=1,O.MPG_MD_MS_LR=2,O.MPG_MD_MS_I=3,O.fircoef=[-.0207887*5,-.0378413*5,-.0432472*5,-.031183*5,779609e-23*5,.0467745*5,.10091*5,.151365*5,.187098*5];function O(){var e=O.FFTOFFSET,t=O.MPG_MD_MS_LR,s=null;this.psy=null;var a=null,n=null,r=null;this.setModules=function(m,u,p,y){s=m,this.psy=u,a=u,n=y,r=p};var o=new V3;function l(m){var u,p;if(m.ATH.useAdjust==0){m.ATH.adjust=1;return}if(p=m.loudness_sq[0][0],u=m.loudness_sq[1][0],m.channels_out==2?(p+=m.loudness_sq[0][1],u+=m.loudness_sq[1][1]):(p+=p,u+=u),m.mode_gr==2&&(p=Math.max(p,u)),p*=.5,p*=m.ATH.aaSensitivityP,p>.03125)m.ATH.adjust>=1?m.ATH.adjust=1:m.ATH.adjust<m.ATH.adjustLimit&&(m.ATH.adjust=m.ATH.adjustLimit),m.ATH.adjustLimit=1;else{var y=31.98*p+625e-6;m.ATH.adjust>=y?(m.ATH.adjust*=y*.075+.925,m.ATH.adjust<y&&(m.ATH.adjust=y)):m.ATH.adjustLimit>=y?m.ATH.adjust=y:m.ATH.adjust<m.ATH.adjustLimit&&(m.ATH.adjust=m.ATH.adjustLimit),m.ATH.adjustLimit=y}}function v(m){var u,p;for(Ii(m.bitrate_index>=0&&m.bitrate_index<16),Ii(m.mode_ext>=0&&m.mode_ext<4),m.bitrate_stereoMode_Hist[m.bitrate_index][4]++,m.bitrate_stereoMode_Hist[15][4]++,m.channels_out==2&&(m.bitrate_stereoMode_Hist[m.bitrate_index][m.mode_ext]++,m.bitrate_stereoMode_Hist[15][m.mode_ext]++),u=0;u<m.mode_gr;++u)for(p=0;p<m.channels_out;++p){var y=m.l3_side.tt[u][p].block_type|0;m.l3_side.tt[u][p].mixed_block_flag!=0&&(y=4),m.bitrate_blockType_Hist[m.bitrate_index][y]++,m.bitrate_blockType_Hist[m.bitrate_index][5]++,m.bitrate_blockType_Hist[15][y]++,m.bitrate_blockType_Hist[15][5]++}}function c(m,u){var p=m.internal_flags,y,i;if(p.lame_encode_frame_init==0){var H,L,N=Pu(2014),h=Pu(286+1152+576);for(p.lame_encode_frame_init=1,H=0,L=0;H<286+576*(1+p.mode_gr);++H)H<576*p.mode_gr?(N[H]=0,p.channels_out==2&&(h[H]=0)):(N[H]=u[0][L],p.channels_out==2&&(h[H]=u[1][L]),++L);for(i=0;i<p.mode_gr;i++)for(y=0;y<p.channels_out;y++)p.l3_side.tt[i][y].block_type=O.SHORT_TYPE;o.mdct_sub48(p,N,h),Ii(p.mf_size>=O.BLKSIZE+m.framesize-O.FFTOFFSET),Ii(p.mf_size>=512+m.framesize-32)}}this.lame_encode_mp3_frame=function(m,u,p,y,i,H){var L,N=Hu([2,2]);N[0][0]=new ga,N[0][1]=new ga,N[1][0]=new ga,N[1][1]=new ga;var h=Hu([2,2]);h[0][0]=new ga,h[0][1]=new ga,h[1][0]=new ga,h[1][1]=new ga;var k,C=[null,null],A=m.internal_flags,B=K3([2,4]),d=[.5,.5],E=[[0,0],[0,0]],S=[[0,0],[0,0]],_,x,b;if(C[0]=u,C[1]=p,A.lame_encode_frame_init==0&&c(m,C),A.padding=0,(A.slot_lag-=A.frac_SpF)<0&&(A.slot_lag+=m.out_samplerate,A.padding=1),A.psymodel!=0){var g,M=[null,null],w=0,j=G3(2);for(b=0;b<A.mode_gr;b++){for(x=0;x<A.channels_out;x++)M[x]=C[x],w=576+b*576-O.FFTOFFSET;if(m.VBR==Oi.vbr_mtrh||m.VBR==Oi.vbr_mt?g=a.L3psycho_anal_vbr(m,M,w,b,N,h,E[b],S[b],B[b],j):g=a.L3psycho_anal_ns(m,M,w,b,N,h,E[b],S[b],B[b],j),g!=0)return-4;for(m.mode==vt.JOINT_STEREO&&(d[b]=B[b][2]+B[b][3],d[b]>0&&(d[b]=B[b][3]/d[b])),x=0;x<A.channels_out;x++){var X=A.l3_side.tt[b][x];X.block_type=j[x],X.mixed_block_flag=0}}}else for(b=0;b<A.mode_gr;b++)for(x=0;x<A.channels_out;x++)A.l3_side.tt[b][x].block_type=O.NORM_TYPE,A.l3_side.tt[b][x].mixed_block_flag=0,S[b][x]=E[b][x]=700;if(l(A),o.mdct_sub48(A,C[0],C[1]),A.mode_ext=O.MPG_MD_LR_LR,m.force_ms)A.mode_ext=O.MPG_MD_MS_LR;else if(m.mode==vt.JOINT_STEREO){var F=0,V=0;for(b=0;b<A.mode_gr;b++)for(x=0;x<A.channels_out;x++)F+=S[b][x],V+=E[b][x];if(F<=1*V){var f=A.l3_side.tt[0],T=A.l3_side.tt[A.mode_gr-1];f[0].block_type==f[1].block_type&&T[0].block_type==T[1].block_type&&(A.mode_ext=O.MPG_MD_MS_LR)}}if(A.mode_ext==t?(k=h,_=S):(k=N,_=E),m.analysis&&A.pinfo!=null)for(b=0;b<A.mode_gr;b++)for(x=0;x<A.channels_out;x++)A.pinfo.ms_ratio[b]=A.ms_ratio[b],A.pinfo.ms_ener_ratio[b]=d[b],A.pinfo.blocktype[b][x]=A.l3_side.tt[b][x].block_type,A.pinfo.pe[b][x]=_[b][x],ju.arraycopy(A.l3_side.tt[b][x].xr,0,A.pinfo.xr[b][x],0,576),A.mode_ext==t&&(A.pinfo.ers[b][x]=A.pinfo.ers[b][x+2],ju.arraycopy(A.pinfo.energy[b][x+2],0,A.pinfo.energy[b][x],0,A.pinfo.energy[b][x].length));if(m.VBR==Oi.vbr_off||m.VBR==Oi.vbr_abr){var W,Z;for(W=0;W<18;W++)A.nsPsy.pefirbuf[W]=A.nsPsy.pefirbuf[W+1];for(Z=0,b=0;b<A.mode_gr;b++)for(x=0;x<A.channels_out;x++)Z+=_[b][x];for(A.nsPsy.pefirbuf[18]=Z,Z=A.nsPsy.pefirbuf[9],W=0;W<9;W++)Z+=(A.nsPsy.pefirbuf[W]+A.nsPsy.pefirbuf[18-W])*O.fircoef[W];for(Z=670*5*A.mode_gr*A.channels_out/Z,b=0;b<A.mode_gr;b++)for(x=0;x<A.channels_out;x++)_[b][x]*=Z}if(A.iteration_loop.iteration_loop(m,_,d,k),s.format_bitstream(m),L=s.copy_buffer(A,y,i,H,1),m.bWriteVbrTag&&n.addVbrFrame(m),m.analysis&&A.pinfo!=null){for(x=0;x<A.channels_out;x++){var de;for(de=0;de<e;de++)A.pinfo.pcmdata[x][de]=A.pinfo.pcmdata[x][de+m.framesize];for(de=e;de<1600;de++)A.pinfo.pcmdata[x][de]=C[x][de-e]}r.set_frame_pinfo(m,k)}return v(A),L}}var Fu=ke.Util,Du=ke.new_float;function W3(){var e=Du(O.BLKSIZE),t=Du(O.BLKSIZE_s/2),s=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475];function a(r,o,l){var v=0,c,m,u;l<<=1;var p=o+l;c=4;do{var y,i,H,L,N,h,k;k=c>>1,L=c,N=c<<1,h=N+L,c=N<<1,m=o,u=m+k;do{var C,A,B,d;A=r[m+0]-r[m+L],C=r[m+0]+r[m+L],d=r[m+N]-r[m+h],B=r[m+N]+r[m+h],r[m+N]=C-B,r[m+0]=C+B,r[m+h]=A-d,r[m+L]=A+d,A=r[u+0]-r[u+L],C=r[u+0]+r[u+L],d=Fu.SQRT2*r[u+h],B=Fu.SQRT2*r[u+N],r[u+N]=C-B,r[u+0]=C+B,r[u+h]=A-d,r[u+L]=A+d,u+=c,m+=c}while(m<p);for(i=s[v+0],y=s[v+1],H=1;H<k;H++){var E,S;E=1-2*y*y,S=2*y*i,m=o+H,u=o+L-H;do{var _,x,b,C,A,g,B,M,d,w;x=S*r[m+L]-E*r[u+L],_=E*r[m+L]+S*r[u+L],A=r[m+0]-_,C=r[m+0]+_,g=r[u+0]-x,b=r[u+0]+x,x=S*r[m+h]-E*r[u+h],_=E*r[m+h]+S*r[u+h],d=r[m+N]-_,B=r[m+N]+_,w=r[u+N]-x,M=r[u+N]+x,x=y*B-i*w,_=i*B+y*w,r[m+N]=C-_,r[m+0]=C+_,r[u+h]=g-x,r[u+L]=g+x,x=i*M-y*d,_=y*M+i*d,r[u+N]=b-_,r[u+0]=b+_,r[m+h]=A-x,r[m+L]=A+x,u+=c,m+=c}while(m<p);E=i,i=E*s[v+0]-y*s[v+1],y=E*s[v+1]+y*s[v+0]}v+=2}while(c<l)}var n=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(r,o,l,v,c){for(var m=0;m<3;m++){var u=O.BLKSIZE_s/2,p=65535&576/3*(m+1),y=O.BLKSIZE_s/8-1;do{var i,H,L,N,h,k=n[y<<2]&255;i=t[k]*v[l][c+k+p],h=t[127-k]*v[l][c+k+p+128],H=i-h,i=i+h,L=t[k+64]*v[l][c+k+p+64],h=t[63-k]*v[l][c+k+p+192],N=L-h,L=L+h,u-=4,o[m][u+0]=i+L,o[m][u+2]=i-L,o[m][u+1]=H+N,o[m][u+3]=H-N,i=t[k+1]*v[l][c+k+p+1],h=t[126-k]*v[l][c+k+p+129],H=i-h,i=i+h,L=t[k+65]*v[l][c+k+p+65],h=t[62-k]*v[l][c+k+p+193],N=L-h,L=L+h,o[m][u+O.BLKSIZE_s/2+0]=i+L,o[m][u+O.BLKSIZE_s/2+2]=i-L,o[m][u+O.BLKSIZE_s/2+1]=H+N,o[m][u+O.BLKSIZE_s/2+3]=H-N}while(--y>=0);a(o[m],u,O.BLKSIZE_s/2)}},this.fft_long=function(r,o,l,v,c){var m=O.BLKSIZE/8-1,u=O.BLKSIZE/2;do{var p,y,i,H,L,N=n[m]&255;p=e[N]*v[l][c+N],L=e[N+512]*v[l][c+N+512],y=p-L,p=p+L,i=e[N+256]*v[l][c+N+256],L=e[N+768]*v[l][c+N+768],H=i-L,i=i+L,u-=4,o[u+0]=p+i,o[u+2]=p-i,o[u+1]=y+H,o[u+3]=y-H,p=e[N+1]*v[l][c+N+1],L=e[N+513]*v[l][c+N+513],y=p-L,p=p+L,i=e[N+257]*v[l][c+N+257],L=e[N+769]*v[l][c+N+769],H=i-L,i=i+L,o[u+O.BLKSIZE/2+0]=p+i,o[u+O.BLKSIZE/2+2]=p-i,o[u+O.BLKSIZE/2+1]=y+H,o[u+O.BLKSIZE/2+3]=y-H}while(--m>=0);a(o,u,O.BLKSIZE/2)},this.init_fft=function(r){for(var o=0;o<O.BLKSIZE;o++)e[o]=.42-.5*Math.cos(2*Math.PI*(o+.5)/O.BLKSIZE)+.08*Math.cos(4*Math.PI*(o+.5)/O.BLKSIZE);for(var o=0;o<O.BLKSIZE_s/2;o++)t[o]=.5*(1-Math.cos(2*Math.PI*(o+.5)/O.BLKSIZE_s))}}var br=ke.VbrMode,Uu=ke.Float,yr=ke.ShortBlock,ns=ke.Util,Z3=ke.Arrays,Pt=ke.new_float,Ts=ke.new_float_n,Ya=ke.new_int,tt=ke.assert;function wl(){var e=new W3,t=2.302585092994046,s=2,a=16,n=2,r=16,o=.34,l=1/(14752*14752)/(O.BLKSIZE/2),v=.01,c=.8,m=.6,u=.3,p=3.5,y=21,i=.2302585093;function H(R){return R}function L(R,I){for(var U=0,q=0;q<O.BLKSIZE/2;++q)U+=R[q]*I.ATH.eql_w[q];return U*=l,U}function N(R,I,U,q,Y,P,G,J,K,ie,ee){var oe=R.internal_flags;if(K<2)e.fft_long(oe,q[Y],K,ie,ee),e.fft_short(oe,P[G],K,ie,ee);else if(K==2){for(var Ie=O.BLKSIZE-1;Ie>=0;--Ie){var ze=q[Y+0][Ie],_e=q[Y+1][Ie];q[Y+0][Ie]=(ze+_e)*ns.SQRT2*.5,q[Y+1][Ie]=(ze-_e)*ns.SQRT2*.5}for(var Ve=2;Ve>=0;--Ve)for(var Ie=O.BLKSIZE_s-1;Ie>=0;--Ie){var ze=P[G+0][Ve][Ie],_e=P[G+1][Ve][Ie];P[G+0][Ve][Ie]=(ze+_e)*ns.SQRT2*.5,P[G+1][Ve][Ie]=(ze-_e)*ns.SQRT2*.5}}I[0]=q[Y+0][0],I[0]*=I[0];for(var Ie=O.BLKSIZE/2-1;Ie>=0;--Ie){var ae=q[Y+0][O.BLKSIZE/2-Ie],je=q[Y+0][O.BLKSIZE/2+Ie];I[O.BLKSIZE/2-Ie]=(ae*ae+je*je)*.5}for(var Ve=2;Ve>=0;--Ve){U[Ve][0]=P[G+0][Ve][0],U[Ve][0]*=U[Ve][0];for(var Ie=O.BLKSIZE_s/2-1;Ie>=0;--Ie){var ae=P[G+0][Ve][O.BLKSIZE_s/2-Ie],je=P[G+0][Ve][O.BLKSIZE_s/2+Ie];U[Ve][O.BLKSIZE_s/2-Ie]=(ae*ae+je*je)*.5}}{for(var et=0,Ie=11;Ie<O.HBLKSIZE;Ie++)et+=I[Ie];oe.tot_ener[K]=et}if(R.analysis){for(var Ie=0;Ie<O.HBLKSIZE;Ie++)oe.pinfo.energy[J][K][Ie]=oe.pinfo.energy_save[K][Ie],oe.pinfo.energy_save[K][Ie]=I[Ie];oe.pinfo.pe[J][K]=oe.pe[K]}R.athaa_loudapprox==2&&K<2&&(oe.loudness_sq[J][K]=oe.loudness_sq_save[K],oe.loudness_sq_save[K]=L(I,oe))}var h=8,k=23,C=15,A,B,d,E=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749];function S(){A=Math.pow(10,(h+1)/16),B=Math.pow(10,(k+1)/16),d=Math.pow(10,C/10)}var _=[3.3246*3.3246,3.23837*3.23837,3.15437*3.15437,3.00412*3.00412,2.86103*2.86103,2.65407*2.65407,2.46209*2.46209,2.284*2.284,2.11879*2.11879,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,1.56911*1.56911,1.46658*1.46658,1.37074*1.37074,1.31036*1.31036,1.25264*1.25264,1.20648*1.20648,1.16203*1.16203,1.12765*1.12765,1.09428*1.09428,1.0659*1.0659,1.03826*1.03826,1.01895*1.01895,1],x=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1],b=[2.35364*2.35364,2.29259*2.29259,2.23313*2.23313,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,1.49999*1.49999,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.11084*1.11084,1.03826*1.03826];function g(R,I,U,q,Y,P){var G;if(I>R)if(I<R*B)G=I/R;else return R+I;else{if(R>=I*B)return R+I;G=R/I}if(R+=I,q+3<=3+3){if(G>=A)return R;var J=0|ns.FAST_LOG10_X(G,16);return R*x[J]}var J=0|ns.FAST_LOG10_X(G,16);if(P!=0?I=Y.ATH.cb_s[U]*Y.ATH.adjust:I=Y.ATH.cb_l[U]*Y.ATH.adjust,R<d*I){if(R>I){var K,ie;return K=1,J<=13&&(K=b[J]),ie=ns.FAST_LOG10_X(R/I,10/15),R*((_[J]-K)*ie+K)}return J>13?R:R*b[J]}return R*_[J]}var M=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1];function w(R,I,U){var q;if(R<0&&(R=0),I<0&&(I=0),R<=0)return I;if(I<=0)return R;if(I>R?q=I/R:q=R/I,U>=-2&&U<=2){if(q>=A)return R+I;var Y=0|ns.FAST_LOG10_X(q,16);return(R+I)*M[Y]}return q<B?R+I:(R<I&&(R=I),R)}function j(R,I){var U=R.internal_flags;if(U.channels_out>1){for(var q=0;q<O.SBMAX_l;q++){var Y=U.thm[0].l[q],P=U.thm[1].l[q];U.thm[0].l[q]+=P*I,U.thm[1].l[q]+=Y*I}for(var q=0;q<O.SBMAX_s;q++)for(var G=0;G<3;G++){var Y=U.thm[0].s[q][G],P=U.thm[1].s[q][G];U.thm[0].s[q][G]+=P*I,U.thm[1].s[q][G]+=Y*I}}}function X(R){for(var I=0;I<O.SBMAX_l;I++)if(!(R.thm[0].l[I]>1.58*R.thm[1].l[I]||R.thm[1].l[I]>1.58*R.thm[0].l[I])){var U=R.mld_l[I]*R.en[3].l[I],q=Math.max(R.thm[2].l[I],Math.min(R.thm[3].l[I],U));U=R.mld_l[I]*R.en[2].l[I];var Y=Math.max(R.thm[3].l[I],Math.min(R.thm[2].l[I],U));R.thm[2].l[I]=q,R.thm[3].l[I]=Y}for(var I=0;I<O.SBMAX_s;I++)for(var P=0;P<3;P++)if(!(R.thm[0].s[I][P]>1.58*R.thm[1].s[I][P]||R.thm[1].s[I][P]>1.58*R.thm[0].s[I][P])){var U=R.mld_s[I]*R.en[3].s[I][P],q=Math.max(R.thm[2].s[I][P],Math.min(R.thm[3].s[I][P],U));U=R.mld_s[I]*R.en[2].s[I][P];var Y=Math.max(R.thm[3].s[I][P],Math.min(R.thm[2].s[I][P],U));R.thm[2].s[I][P]=q,R.thm[3].s[I][P]=Y}}function F(R,I,U){var q=I,Y=Math.pow(10,U);I*=2,q*=2;for(var P=0;P<O.SBMAX_l;P++){var G,J,K,ie;if(ie=R.ATH.cb_l[R.bm_l[P]]*Y,G=Math.min(Math.max(R.thm[0].l[P],ie),Math.max(R.thm[1].l[P],ie)),J=Math.max(R.thm[2].l[P],ie),K=Math.max(R.thm[3].l[P],ie),G*I<J+K){var ee=G*q/(J+K);J*=ee,K*=ee}R.thm[2].l[P]=Math.min(J,R.thm[2].l[P]),R.thm[3].l[P]=Math.min(K,R.thm[3].l[P])}Y*=O.BLKSIZE_s/O.BLKSIZE;for(var P=0;P<O.SBMAX_s;P++)for(var oe=0;oe<3;oe++){var G,J,K,ie;if(ie=R.ATH.cb_s[R.bm_s[P]]*Y,G=Math.min(Math.max(R.thm[0].s[P][oe],ie),Math.max(R.thm[1].s[P][oe],ie)),J=Math.max(R.thm[2].s[P][oe],ie),K=Math.max(R.thm[3].s[P][oe],ie),G*I<J+K){var ee=G*I/(J+K);J*=ee,K*=ee}R.thm[2].s[P][oe]=Math.min(R.thm[2].s[P][oe],J),R.thm[3].s[P][oe]=Math.min(R.thm[3].s[P][oe],K)}}function V(R,I,U,q,Y){var P,G,J=0,K=0;for(P=G=0;P<O.SBMAX_s;++G,++P){for(var ie=R.bo_s[P],ee=R.npart_s,oe=ie<ee?ie:ee;G<oe;)tt(I[G]>=0),tt(U[G]>=0),J+=I[G],K+=U[G],G++;if(R.en[q].s[P][Y]=J,R.thm[q].s[P][Y]=K,G>=ee){++P;break}tt(I[G]>=0),tt(U[G]>=0);{var Ie=R.PSY.bo_s_weight[P],ze=1-Ie;J=Ie*I[G],K=Ie*U[G],R.en[q].s[P][Y]+=J,R.thm[q].s[P][Y]+=K,J=ze*I[G],K=ze*U[G]}}for(;P<O.SBMAX_s;++P)R.en[q].s[P][Y]=0,R.thm[q].s[P][Y]=0}function f(R,I,U,q){var Y,P,G=0,J=0;for(Y=P=0;Y<O.SBMAX_l;++P,++Y){for(var K=R.bo_l[Y],ie=R.npart_l,ee=K<ie?K:ie;P<ee;)tt(I[P]>=0),tt(U[P]>=0),G+=I[P],J+=U[P],P++;if(R.en[q].l[Y]=G,R.thm[q].l[Y]=J,P>=ie){++Y;break}tt(I[P]>=0),tt(U[P]>=0);{var oe=R.PSY.bo_l_weight[Y],Ie=1-oe;G=oe*I[P],J=oe*U[P],R.en[q].l[Y]+=G,R.thm[q].l[Y]+=J,G=Ie*I[P],J=Ie*U[P]}}for(;Y<O.SBMAX_l;++Y)R.en[q].l[Y]=0,R.thm[q].l[Y]=0}function T(R,I,U,q,Y,P){var G=R.internal_flags,J,K;for(K=J=0;K<G.npart_s;++K){for(var ie=0,ee=G.numlines_s[K],oe=0;oe<ee;++oe,++J){var Ie=I[P][J];ie+=Ie}U[K]=ie}for(tt(K==G.npart_s),J=K=0;K<G.npart_s;K++){var ze=G.s3ind_s[K][0],_e=G.s3_ss[J++]*U[ze];for(++ze;ze<=G.s3ind_s[K][1];)_e+=G.s3_ss[J]*U[ze],++J,++ze;{var Ve=n*G.nb_s1[Y][K];q[K]=Math.min(_e,Ve)}if(G.blocktype_old[Y&1]==O.SHORT_TYPE){var Ve=r*G.nb_s2[Y][K],ae=q[K];q[K]=Math.min(Ve,ae)}G.nb_s2[Y][K]=G.nb_s1[Y][K],G.nb_s1[Y][K]=_e,tt(q[K]>=0)}for(;K<=O.CBANDS;++K)U[K]=0,q[K]=0}function W(R,I,U,q){var Y=R.internal_flags;R.short_blocks==yr.short_block_coupled&&!(I[0]!=0&&I[1]!=0)&&(I[0]=I[1]=0);for(var P=0;P<Y.channels_out;P++)q[P]=O.NORM_TYPE,R.short_blocks==yr.short_block_dispensed&&(I[P]=1),R.short_blocks==yr.short_block_forced&&(I[P]=0),I[P]!=0?(tt(Y.blocktype_old[P]!=O.START_TYPE),Y.blocktype_old[P]==O.SHORT_TYPE&&(q[P]=O.STOP_TYPE)):(q[P]=O.SHORT_TYPE,Y.blocktype_old[P]==O.NORM_TYPE&&(Y.blocktype_old[P]=O.START_TYPE),Y.blocktype_old[P]==O.STOP_TYPE&&(Y.blocktype_old[P]=O.SHORT_TYPE)),U[P]=Y.blocktype_old[P],Y.blocktype_old[P]=q[P]}function Z(R,I,U){return U>=1?R:U<=0?I:I>0?Math.pow(R/I,U)*I:0}var de=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130];function Me(R,I){for(var U=309.07,q=0;q<O.SBMAX_s-1;q++)for(var Y=0;Y<3;Y++){var P=R.thm.s[q][Y];if(P>0){var G=P*I,J=R.en.s[q][Y];J>G&&(J>G*1e10?U+=de[q]*(10*t):U+=de[q]*ns.FAST_LOG10(J/G))}}return U}var Te=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1];function ve(R,I){for(var U=281.0575,q=0;q<O.SBMAX_l-1;q++){var Y=R.thm.l[q];if(Y>0){var P=Y*I,G=R.en.l[q];G>P&&(G>P*1e10?U+=Te[q]*(10*t):U+=Te[q]*ns.FAST_LOG10(G/P))}}return U}function De(R,I,U,q,Y){var P,G;for(P=G=0;P<R.npart_l;++P){var J=0,K=0,ie;for(ie=0;ie<R.numlines_l[P];++ie,++G){var ee=I[G];J+=ee,K<ee&&(K=ee)}U[P]=J,q[P]=K,Y[P]=J*R.rnumlines_l[P],tt(R.rnumlines_l[P]>=0),tt(U[P]>=0),tt(q[P]>=0),tt(Y[P]>=0)}}function Le(R,I,U,q){var Y=E.length-1,P=0,G=U[P]+U[P+1];if(G>0){var J=I[P];J<I[P+1]&&(J=I[P+1]),tt(R.numlines_l[P]+R.numlines_l[P+1]-1>0),G=20*(J*2-G)/(G*(R.numlines_l[P]+R.numlines_l[P+1]-1));var K=0|G;K>Y&&(K=Y),q[P]=K}else q[P]=0;for(P=1;P<R.npart_l-1;P++)if(G=U[P-1]+U[P]+U[P+1],G>0){var J=I[P-1];J<I[P]&&(J=I[P]),J<I[P+1]&&(J=I[P+1]),tt(R.numlines_l[P-1]+R.numlines_l[P]+R.numlines_l[P+1]-1>0),G=20*(J*3-G)/(G*(R.numlines_l[P-1]+R.numlines_l[P]+R.numlines_l[P+1]-1));var K=0|G;K>Y&&(K=Y),q[P]=K}else q[P]=0;if(tt(P==R.npart_l-1),G=U[P-1]+U[P],G>0){var J=I[P-1];J<I[P]&&(J=I[P]),tt(R.numlines_l[P-1]+R.numlines_l[P]-1>0),G=20*(J*2-G)/(G*(R.numlines_l[P-1]+R.numlines_l[P]-1));var K=0|G;K>Y&&(K=Y),q[P]=K}else q[P]=0;tt(P==R.npart_l-1)}var me=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];this.L3psycho_anal_ns=function(R,I,U,q,Y,P,G,J,K,ie){var ee=R.internal_flags,oe=Ts([2,O.BLKSIZE]),Ie=Ts([2,3,O.BLKSIZE_s]),ze=Pt(O.CBANDS+1),_e=Pt(O.CBANDS+1),Ve=Pt(O.CBANDS+2),ae=Ya(2),je=Ya(2),et,pe,He,ge,Ye,At,Be,Ze,rt=Ts([2,576]),kt,_s=Ya(O.CBANDS+2),Nt=Ya(O.CBANDS+2);for(Z3.fill(Nt,0),et=ee.channels_out,R.mode==vt.JOINT_STEREO&&(et=4),R.VBR==br.vbr_off?kt=ee.ResvMax==0?0:ee.ResvSize/ee.ResvMax*.5:R.VBR==br.vbr_rh||R.VBR==br.vbr_mtrh||R.VBR==br.vbr_mt?kt=.6:kt=1,pe=0;pe<ee.channels_out;pe++){var Rt=I[pe],os=U+576-350-y+192;for(ge=0;ge<576;ge++){var ps,gs;for(ps=Rt[os+ge+10],gs=0,Ye=0;Ye<(y-1)/2-1;Ye+=2)ps+=me[Ye]*(Rt[os+ge+Ye]+Rt[os+ge+y-Ye]),gs+=me[Ye+1]*(Rt[os+ge+Ye+1]+Rt[os+ge+y-Ye-1]);rt[pe][ge]=ps+gs}Y[q][pe].en.assign(ee.en[pe]),Y[q][pe].thm.assign(ee.thm[pe]),et>2&&(P[q][pe].en.assign(ee.en[pe+2]),P[q][pe].thm.assign(ee.thm[pe+2]))}for(pe=0;pe<et;pe++){var Ns,js,Qt=Pt(12),Ws=[0,0,0,0],Sr=Pt(12),Cl=1,id,od=Pt(O.CBANDS),ld=Pt(O.CBANDS),Ot=[0,0,0,0],cd=Pt(O.HBLKSIZE),ud=Ts([3,O.HBLKSIZE_s]);for(tt(ee.npart_s<=O.CBANDS),tt(ee.npart_l<=O.CBANDS),ge=0;ge<3;ge++)Qt[ge]=ee.nsPsy.last_en_subshort[pe][ge+6],tt(ee.nsPsy.last_en_subshort[pe][ge+4]>0),Sr[ge]=Qt[ge]/ee.nsPsy.last_en_subshort[pe][ge+4],Ws[0]+=Qt[ge];if(pe==2)for(ge=0;ge<576;ge++){var Bl,Ll;Bl=rt[0][ge],Ll=rt[1][ge],rt[0][ge]=Bl+Ll,rt[1][ge]=Bl-Ll}{var dd=rt[pe&1],Sn=0;for(ge=0;ge<9;ge++){for(var Nb=Sn+64,qt=1;Sn<Nb;Sn++)qt<Math.abs(dd[Sn])&&(qt=Math.abs(dd[Sn]));ee.nsPsy.last_en_subshort[pe][ge]=Qt[ge+3]=qt,Ws[1+ge/3]+=qt,qt>Qt[ge+3-2]?(tt(Qt[ge+3-2]>0),qt=qt/Qt[ge+3-2]):Qt[ge+3-2]>qt*10?qt=Qt[ge+3-2]/(qt*10):qt=0,Sr[ge+3]=qt}}if(R.analysis){var Nl=Sr[0];for(ge=1;ge<12;ge++)Nl<Sr[ge]&&(Nl=Sr[ge]);ee.pinfo.ers[q][pe]=ee.pinfo.ers_save[pe],ee.pinfo.ers_save[pe]=Nl}for(id=pe==3?ee.nsPsy.attackthre_s:ee.nsPsy.attackthre,ge=0;ge<12;ge++)Ot[ge/3]==0&&Sr[ge]>id&&(Ot[ge/3]=ge%3+1);for(ge=1;ge<4;ge++){var jl;Ws[ge-1]>Ws[ge]?(tt(Ws[ge]>0),jl=Ws[ge-1]/Ws[ge]):(tt(Ws[ge-1]>0),jl=Ws[ge]/Ws[ge-1]),jl<1.7&&(Ot[ge]=0,ge==1&&(Ot[0]=0))}for(Ot[0]!=0&&ee.nsPsy.lastAttacks[pe]!=0&&(Ot[0]=0),(ee.nsPsy.lastAttacks[pe]==3||Ot[0]+Ot[1]+Ot[2]+Ot[3]!=0)&&(Cl=0,Ot[1]!=0&&Ot[0]!=0&&(Ot[1]=0),Ot[2]!=0&&Ot[1]!=0&&(Ot[2]=0),Ot[3]!=0&&Ot[2]!=0&&(Ot[3]=0)),pe<2?je[pe]=Cl:Cl==0&&(je[0]=je[1]=0),K[pe]=ee.tot_ener[pe],js=Ie,Ns=oe,N(R,cd,ud,Ns,pe&1,js,pe&1,q,pe,I,U),De(ee,cd,ze,od,ld),Le(ee,od,ld,_s),Ze=0;Ze<3;Ze++){var Hl,ls;for(T(R,ud,_e,Ve,pe,Ze),V(ee,_e,Ve,pe,Ze),Be=0;Be<O.SBMAX_s;Be++){if(ls=ee.thm[pe].s[Be][Ze],ls*=c,Ot[Ze]>=2||Ot[Ze+1]==1){var Mn=Ze!=0?Ze-1:2,qt=Z(ee.thm[pe].s[Be][Mn],ls,m*kt);ls=Math.min(ls,qt)}if(Ot[Ze]==1){var Mn=Ze!=0?Ze-1:2,qt=Z(ee.thm[pe].s[Be][Mn],ls,u*kt);ls=Math.min(ls,qt)}else if(Ze!=0&&Ot[Ze-1]==3||Ze==0&&ee.nsPsy.lastAttacks[pe]==3){var Mn=Ze!=2?Ze+1:0,qt=Z(ee.thm[pe].s[Be][Mn],ls,u*kt);ls=Math.min(ls,qt)}Hl=Qt[Ze*3+3]+Qt[Ze*3+4]+Qt[Ze*3+5],Qt[Ze*3+5]*6<Hl&&(ls*=.5,Qt[Ze*3+4]*6<Hl&&(ls*=.5)),ee.thm[pe].s[Be][Ze]=ls}}for(ee.nsPsy.lastAttacks[pe]=Ot[2],At=0,He=0;He<ee.npart_l;He++){for(var Ja=ee.s3ind[He][0],Pl=ze[Ja]*E[_s[Ja]],$a=ee.s3_ll[At++]*Pl;++Ja<=ee.s3ind[He][1];)Pl=ze[Ja]*E[_s[Ja]],$a=g($a,ee.s3_ll[At++]*Pl,Ja,Ja-He,ee,0);$a*=.158489319246111,ee.blocktype_old[pe&1]==O.SHORT_TYPE?Ve[He]=$a:Ve[He]=Z(Math.min($a,Math.min(s*ee.nb_1[pe][He],a*ee.nb_2[pe][He])),$a,kt),ee.nb_2[pe][He]=ee.nb_1[pe][He],ee.nb_1[pe][He]=$a}for(;He<=O.CBANDS;++He)ze[He]=0,Ve[He]=0;f(ee,ze,Ve,pe)}if((R.mode==vt.STEREO||R.mode==vt.JOINT_STEREO)&&R.interChRatio>0&&j(R,R.interChRatio),R.mode==vt.JOINT_STEREO){var Fl;X(ee),Fl=R.msfix,Math.abs(Fl)>0&&F(ee,Fl,R.ATHlower*ee.ATH.adjust)}for(W(R,je,ie,ae),pe=0;pe<et;pe++){var Tn,En=0,Fi,Di;pe>1?(Tn=J,En=-2,Fi=O.NORM_TYPE,(ie[0]==O.SHORT_TYPE||ie[1]==O.SHORT_TYPE)&&(Fi=O.SHORT_TYPE),Di=P[q][pe-2]):(Tn=G,En=0,Fi=ie[pe],Di=Y[q][pe]),Fi==O.SHORT_TYPE?Tn[En+pe]=Me(Di,ee.masking_lower):Tn[En+pe]=ve(Di,ee.masking_lower),R.analysis&&(ee.pinfo.pe[q][pe]=Tn[En+pe])}return 0};function Ge(R,I,U,q,Y,P,G,J){var K=R.internal_flags;if(q<2)e.fft_long(K,G[J],q,I,U);else if(q==2)for(var ie=O.BLKSIZE-1;ie>=0;--ie){var ee=G[J+0][ie],oe=G[J+1][ie];G[J+0][ie]=(ee+oe)*ns.SQRT2*.5,G[J+1][ie]=(ee-oe)*ns.SQRT2*.5}P[0]=G[J+0][0],P[0]*=P[0];for(var ie=O.BLKSIZE/2-1;ie>=0;--ie){var Ie=G[J+0][O.BLKSIZE/2-ie],ze=G[J+0][O.BLKSIZE/2+ie];P[O.BLKSIZE/2-ie]=(Ie*Ie+ze*ze)*.5}{for(var _e=0,ie=11;ie<O.HBLKSIZE;ie++)_e+=P[ie];K.tot_ener[q]=_e}if(R.analysis){for(var ie=0;ie<O.HBLKSIZE;ie++)K.pinfo.energy[Y][q][ie]=K.pinfo.energy_save[q][ie],K.pinfo.energy_save[q][ie]=P[ie];K.pinfo.pe[Y][q]=K.pe[q]}}function ot(R,I,U,q,Y,P,G,J){var K=R.internal_flags;if(Y==0&&q<2&&e.fft_short(K,G[J],q,I,U),q==2)for(var ie=O.BLKSIZE_s-1;ie>=0;--ie){var ee=G[J+0][Y][ie],oe=G[J+1][Y][ie];G[J+0][Y][ie]=(ee+oe)*ns.SQRT2*.5,G[J+1][Y][ie]=(ee-oe)*ns.SQRT2*.5}P[Y][0]=G[J+0][Y][0],P[Y][0]*=P[Y][0];for(var ie=O.BLKSIZE_s/2-1;ie>=0;--ie){var Ie=G[J+0][Y][O.BLKSIZE_s/2-ie],ze=G[J+0][Y][O.BLKSIZE_s/2+ie];P[Y][O.BLKSIZE_s/2-ie]=(Ie*Ie+ze*ze)*.5}}function D(R,I,U,q){var Y=R.internal_flags;R.athaa_loudapprox==2&&U<2&&(Y.loudness_sq[I][U]=Y.loudness_sq_save[U],Y.loudness_sq_save[U]=L(q,Y))}var z=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];function te(R,I,U,q,Y,P,G,J,K,ie){for(var ee=Ts([2,576]),oe=R.internal_flags,Ie=oe.channels_out,ze=R.mode==vt.JOINT_STEREO?4:Ie,_e=0;_e<Ie;_e++){firbuf=I[_e];for(var Ve=U+576-350-y+192,ae=0;ae<576;ae++){var je,et;je=firbuf[Ve+ae+10],et=0;for(var pe=0;pe<(y-1)/2-1;pe+=2)je+=z[pe]*(firbuf[Ve+ae+pe]+firbuf[Ve+ae+y-pe]),et+=z[pe+1]*(firbuf[Ve+ae+pe+1]+firbuf[Ve+ae+y-pe-1]);ee[_e][ae]=je+et}Y[q][_e].en.assign(oe.en[_e]),Y[q][_e].thm.assign(oe.thm[_e]),ze>2&&(P[q][_e].en.assign(oe.en[_e+2]),P[q][_e].thm.assign(oe.thm[_e+2]))}for(var _e=0;_e<ze;_e++){var He=Pt(12),ge=Pt(12),Ye=[0,0,0,0],At=ee[_e&1],Be=0,Ze=_e==3?oe.nsPsy.attackthre_s:oe.nsPsy.attackthre,rt=1;if(_e==2)for(var ae=0,pe=576;pe>0;++ae,--pe){var kt=ee[0][ae],_s=ee[1][ae];ee[0][ae]=kt+_s,ee[1][ae]=kt-_s}for(var ae=0;ae<3;ae++)ge[ae]=oe.nsPsy.last_en_subshort[_e][ae+6],tt(oe.nsPsy.last_en_subshort[_e][ae+4]>0),He[ae]=ge[ae]/oe.nsPsy.last_en_subshort[_e][ae+4],Ye[0]+=ge[ae];for(var ae=0;ae<9;ae++){for(var Nt=Be+64,Rt=1;Be<Nt;Be++)Rt<Math.abs(At[Be])&&(Rt=Math.abs(At[Be]));oe.nsPsy.last_en_subshort[_e][ae]=ge[ae+3]=Rt,Ye[1+ae/3]+=Rt,Rt>ge[ae+3-2]?(tt(ge[ae+3-2]>0),Rt=Rt/ge[ae+3-2]):ge[ae+3-2]>Rt*10?Rt=ge[ae+3-2]/(Rt*10):Rt=0,He[ae+3]=Rt}for(var ae=0;ae<3;++ae){var os=ge[ae*3+3]+ge[ae*3+4]+ge[ae*3+5],ps=1;ge[ae*3+5]*6<os&&(ps*=.5,ge[ae*3+4]*6<os&&(ps*=.5)),J[_e][ae]=ps}if(R.analysis){for(var gs=He[0],ae=1;ae<12;ae++)gs<He[ae]&&(gs=He[ae]);oe.pinfo.ers[q][_e]=oe.pinfo.ers_save[_e],oe.pinfo.ers_save[_e]=gs}for(var ae=0;ae<12;ae++)K[_e][ae/3]==0&&He[ae]>Ze&&(K[_e][ae/3]=ae%3+1);for(var ae=1;ae<4;ae++){var Ns=Ye[ae-1],js=Ye[ae],Qt=Math.max(Ns,js);Qt<4e4&&Ns<1.7*js&&js<1.7*Ns&&(ae==1&&K[_e][0]<=K[_e][ae]&&(K[_e][0]=0),K[_e][ae]=0)}K[_e][0]<=oe.nsPsy.lastAttacks[_e]&&(K[_e][0]=0),(oe.nsPsy.lastAttacks[_e]==3||K[_e][0]+K[_e][1]+K[_e][2]+K[_e][3]!=0)&&(rt=0,K[_e][1]!=0&&K[_e][0]!=0&&(K[_e][1]=0),K[_e][2]!=0&&K[_e][1]!=0&&(K[_e][2]=0),K[_e][3]!=0&&K[_e][2]!=0&&(K[_e][3]=0)),_e<2?ie[_e]=rt:rt==0&&(ie[0]=ie[1]=0),G[_e]=oe.tot_ener[_e]}}function le(R,I,U){if(U==0)for(var q=0;q<R.npart_s;q++)R.nb_s2[I][q]=R.nb_s1[I][q],R.nb_s1[I][q]=0}function ue(R,I){for(var U=0;U<R.npart_l;U++)R.nb_2[I][U]=R.nb_1[I][U],R.nb_1[I][U]=0}function xe(R,I,U,q){var Y=E.length-1,P=0,G=U[P]+U[P+1];if(G>0){var J=I[P];J<I[P+1]&&(J=I[P+1]),tt(R.numlines_s[P]+R.numlines_s[P+1]-1>0),G=20*(J*2-G)/(G*(R.numlines_s[P]+R.numlines_s[P+1]-1));var K=0|G;K>Y&&(K=Y),q[P]=K}else q[P]=0;for(P=1;P<R.npart_s-1;P++)if(G=U[P-1]+U[P]+U[P+1],tt(P+1<R.npart_s),G>0){var J=I[P-1];J<I[P]&&(J=I[P]),J<I[P+1]&&(J=I[P+1]),tt(R.numlines_s[P-1]+R.numlines_s[P]+R.numlines_s[P+1]-1>0),G=20*(J*3-G)/(G*(R.numlines_s[P-1]+R.numlines_s[P]+R.numlines_s[P+1]-1));var K=0|G;K>Y&&(K=Y),q[P]=K}else q[P]=0;if(tt(P==R.npart_s-1),G=U[P-1]+U[P],G>0){var J=I[P-1];J<I[P]&&(J=I[P]),tt(R.numlines_s[P-1]+R.numlines_s[P]-1>0),G=20*(J*2-G)/(G*(R.numlines_s[P-1]+R.numlines_s[P]-1));var K=0|G;K>Y&&(K=Y),q[P]=K}else q[P]=0;tt(P==R.npart_s-1)}function Ee(R,I,U,q,Y,P){var G=R.internal_flags,J=new float[O.CBANDS],K=Pt(O.CBANDS),ie,ee,oe,Ie=new int[O.CBANDS];for(oe=ee=0;oe<G.npart_s;++oe){var ze=0,_e=0,Ve=G.numlines_s[oe];for(ie=0;ie<Ve;++ie,++ee){var ae=I[P][ee];ze+=ae,_e<ae&&(_e=ae)}U[oe]=ze,J[oe]=_e,K[oe]=ze/Ve,tt(K[oe]>=0)}for(tt(oe==G.npart_s);oe<O.CBANDS;++oe)J[oe]=0,K[oe]=0;for(xe(G,J,K,Ie),ee=oe=0;oe<G.npart_s;oe++){var je=G.s3ind_s[oe][0],et=G.s3ind_s[oe][1],pe,He,ge,Ye,At;for(pe=Ie[je],He=1,Ye=G.s3_ss[ee]*U[je]*E[Ie[je]],++ee,++je;je<=et;)pe+=Ie[je],He+=1,ge=G.s3_ss[ee]*U[je]*E[Ie[je]],Ye=w(Ye,ge,je-oe),++ee,++je;pe=(1+2*pe)/(2*He),At=E[pe]*.5,Ye*=At,q[oe]=Ye,G.nb_s2[Y][oe]=G.nb_s1[Y][oe],G.nb_s1[Y][oe]=Ye,ge=J[oe],ge*=G.minval_s[oe],ge*=At,q[oe]>ge&&(q[oe]=ge),G.masking_lower>1&&(q[oe]*=G.masking_lower),q[oe]>U[oe]&&(q[oe]=U[oe]),G.masking_lower<1&&(q[oe]*=G.masking_lower),tt(q[oe]>=0)}for(;oe<O.CBANDS;++oe)U[oe]=0,q[oe]=0}function be(R,I,U,q,Y){var P=Pt(O.CBANDS),G=Pt(O.CBANDS),J=Ya(O.CBANDS+2),K;De(R,I,U,P,G),Le(R,P,G,J);var ie=0;for(K=0;K<R.npart_l;K++){var ee,oe,Ie,ze,_e=R.s3ind[K][0],Ve=R.s3ind[K][1],ae=0,je=0;for(ae=J[_e],je+=1,oe=R.s3_ll[ie]*U[_e]*E[J[_e]],++ie,++_e;_e<=Ve;)ae+=J[_e],je+=1,ee=R.s3_ll[ie]*U[_e]*E[J[_e]],ze=w(oe,ee,_e-K),oe=ze,++ie,++_e;if(ae=(1+2*ae)/(2*je),Ie=E[ae]*.5,oe*=Ie,R.blocktype_old[Y&1]==O.SHORT_TYPE){var et=s*R.nb_1[Y][K];et>0?q[K]=Math.min(oe,et):q[K]=Math.min(oe,U[K]*u)}else{var pe=a*R.nb_2[Y][K],He=s*R.nb_1[Y][K],et;pe<=0&&(pe=oe),He<=0&&(He=oe),R.blocktype_old[Y&1]==O.NORM_TYPE?et=Math.min(He,pe):et=He,q[K]=Math.min(oe,et)}R.nb_2[Y][K]=R.nb_1[Y][K],R.nb_1[Y][K]=oe,ee=P[K],ee*=R.minval_l[K],ee*=Ie,q[K]>ee&&(q[K]=ee),R.masking_lower>1&&(q[K]*=R.masking_lower),q[K]>U[K]&&(q[K]=U[K]),R.masking_lower<1&&(q[K]*=R.masking_lower),tt(q[K]>=0)}for(;K<O.CBANDS;++K)U[K]=0,q[K]=0}function Se(R,I){var U=R.internal_flags;R.short_blocks==yr.short_block_coupled&&!(I[0]!=0&&I[1]!=0)&&(I[0]=I[1]=0);for(var q=0;q<U.channels_out;q++)R.short_blocks==yr.short_block_dispensed&&(I[q]=1),R.short_blocks==yr.short_block_forced&&(I[q]=0)}function he(R,I,U){for(var q=R.internal_flags,Y=0;Y<q.channels_out;Y++){var P=O.NORM_TYPE;I[Y]!=0?(tt(q.blocktype_old[Y]!=O.START_TYPE),q.blocktype_old[Y]==O.SHORT_TYPE&&(P=O.STOP_TYPE)):(P=O.SHORT_TYPE,q.blocktype_old[Y]==O.NORM_TYPE&&(q.blocktype_old[Y]=O.START_TYPE),q.blocktype_old[Y]==O.STOP_TYPE&&(q.blocktype_old[Y]=O.SHORT_TYPE)),U[Y]=q.blocktype_old[Y],q.blocktype_old[Y]=P}}function Pe(R,I,U,q,Y,P,G){for(var J=P*2,K=P>0?Math.pow(10,Y):1,ie,ee,oe=0;oe<G;++oe){var Ie=R[2][oe],ze=R[3][oe],_e=I[0][oe],Ve=I[1][oe],ae=I[2][oe],je=I[3][oe];if(_e<=1.58*Ve&&Ve<=1.58*_e){var et=U[oe]*ze,pe=U[oe]*Ie;ee=Math.max(ae,Math.min(je,et)),ie=Math.max(je,Math.min(ae,pe))}else ee=ae,ie=je;if(P>0){var He,ge,Ye=q[oe]*K;if(He=Math.min(Math.max(_e,Ye),Math.max(Ve,Ye)),ae=Math.max(ee,Ye),je=Math.max(ie,Ye),ge=ae+je,ge>0&&He*J<ge){var At=He*J/ge;ae*=At,je*=At}ee=Math.min(ae,ee),ie=Math.min(je,ie)}ee>Ie&&(ee=Ie),ie>ze&&(ie=ze),I[2][oe]=ee,I[3][oe]=ie}}this.L3psycho_anal_vbr=function(R,I,U,q,Y,P,G,J,K,ie){var ee=R.internal_flags,oe,Ie,ze=Pt(O.HBLKSIZE),_e=Ts([3,O.HBLKSIZE_s]),Ve=Ts([2,O.BLKSIZE]),ae=Ts([2,3,O.BLKSIZE_s]),je=Ts([4,O.CBANDS]),et=Ts([4,O.CBANDS]),pe=Ts([4,3]),He=.6,ge=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],Ye=Ya(2),At=R.mode==vt.JOINT_STEREO?4:ee.channels_out;te(R,I,U,q,Y,P,K,pe,ge,Ye),Se(R,Ye);{for(var Be=0;Be<At;Be++){var Ze=Be&1;oe=Ve,Ge(R,I,U,Be,q,ze,oe,Ze),D(R,q,Be,ze),Ye[Ze]!=0?be(ee,ze,je[Be],et[Be],Be):ue(ee,Be)}Ye[0]+Ye[1]==2&&R.mode==vt.JOINT_STEREO&&Pe(je,et,ee.mld_cb_l,ee.ATH.cb_l,R.ATHlower*ee.ATH.adjust,R.msfix,ee.npart_l);for(var Be=0;Be<At;Be++){var Ze=Be&1;Ye[Ze]!=0&&f(ee,je[Be],et[Be],Be)}}{for(var rt=0;rt<3;rt++){for(var Be=0;Be<At;++Be){var Ze=Be&1;Ye[Ze]!=0?le(ee,Be,rt):(Ie=ae,ot(R,I,U,Be,rt,_e,Ie,Ze),Ee(R,_e,je[Be],et[Be],Be,rt))}Ye[0]+Ye[1]==0&&R.mode==vt.JOINT_STEREO&&Pe(je,et,ee.mld_cb_s,ee.ATH.cb_s,R.ATHlower*ee.ATH.adjust,R.msfix,ee.npart_s);for(var Be=0;Be<At;++Be){var Ze=Be&1;Ye[Ze]==0&&V(ee,je[Be],et[Be],Be,rt)}}for(var Be=0;Be<At;Be++){var Ze=Be&1;if(Ye[Ze]==0)for(var kt=0;kt<O.SBMAX_s;kt++){for(var _s=Pt(3),rt=0;rt<3;rt++){var Nt=ee.thm[Be].s[kt][rt];if(Nt*=c,ge[Be][rt]>=2||ge[Be][rt+1]==1){var Rt=rt!=0?rt-1:2,os=Z(ee.thm[Be].s[kt][Rt],Nt,m*He);Nt=Math.min(Nt,os)}else if(ge[Be][rt]==1){var Rt=rt!=0?rt-1:2,os=Z(ee.thm[Be].s[kt][Rt],Nt,u*He);Nt=Math.min(Nt,os)}else if(rt!=0&&ge[Be][rt-1]==3||rt==0&&ee.nsPsy.lastAttacks[Be]==3){var Rt=rt!=2?rt+1:0,os=Z(ee.thm[Be].s[kt][Rt],Nt,u*He);Nt=Math.min(Nt,os)}Nt*=pe[Be][rt],_s[rt]=Nt}for(var rt=0;rt<3;rt++)ee.thm[Be].s[kt][rt]=_s[rt]}}}for(var Be=0;Be<At;Be++)ee.nsPsy.lastAttacks[Be]=ge[Be][2];he(R,Ye,ie);for(var Be=0;Be<At;Be++){var ps,gs,Ns,js;Be>1?(ps=J,gs=-2,Ns=O.NORM_TYPE,(ie[0]==O.SHORT_TYPE||ie[1]==O.SHORT_TYPE)&&(Ns=O.SHORT_TYPE),js=P[q][Be-2]):(ps=G,gs=0,Ns=ie[Be],js=Y[q][Be]),Ns==O.SHORT_TYPE?ps[gs+Be]=Me(js,ee.masking_lower):ps[gs+Be]=ve(js,ee.masking_lower),R.analysis&&(ee.pinfo.pe[q][Be]=ps[gs+Be])}return 0};function Ne(R,I){var U=R,q;return U>=0?q=-U*27:q=U*I,q<=-72?0:Math.exp(q*i)}function Fe(R){var I=0,U=0;{var q=0,Y,P;for(q=0;Ne(q,R)>1e-20;q-=1);for(Y=q,P=0;Math.abs(P-Y)>1e-12;)q=(P+Y)/2,Ne(q,R)>0?P=q:Y=q;I=Y}{var q=0,Y,P;for(q=0;Ne(q,R)>1e-20;q+=1);for(Y=0,P=q;Math.abs(P-Y)>1e-12;)q=(P+Y)/2,Ne(q,R)>0?Y=q:P=q;U=P}{var G=0,J=1e3,K;for(K=0;K<=J;++K){var q=I+K*(U-I)/J,ie=Ne(q,R);G+=ie}{var ee=(J+1)/(G*(U-I));return ee}}}function Ue(R){var I,U,q,Y;return I=R,I>=0?I*=3:I*=1.5,I>=.5&&I<=2.5?(Y=I-.5,U=8*(Y*Y-2*Y)):U=0,I+=.474,q=15.811389+7.5*I-17.5*Math.sqrt(1+I*I),q<=-60?0:(I=Math.exp((U+q)*i),I/=.6609193,I)}function We(R){return R<0&&(R=0),R=R*.001,13*Math.atan(.76*R)+3.5*Math.atan(R*R/(7.5*7.5))}function ce(R,I,U,q,Y,P,G,J,K,ie,ee,oe){var Ie=Pt(O.CBANDS+1),ze=J/(oe>15?2*576:2*192),_e=Ya(O.HBLKSIZE),Ve;J/=K;var ae=0,je=0;for(Ve=0;Ve<O.CBANDS;Ve++){var et,pe;for(et=We(J*ae),Ie[Ve]=J*ae,pe=ae;We(J*pe)-et<o&&pe<=K/2;pe++);for(R[Ve]=pe-ae,je=Ve+1;ae<pe;)_e[ae++]=Ve;if(ae>K/2){ae=K/2,++Ve;break}}Ie[Ve]=J*ae;for(var He=0;He<oe;He++){var ge,Ye,At,Be,Ze;At=ie[He],Be=ie[He+1],ge=0|Math.floor(.5+ee*(At-.5)),ge<0&&(ge=0),Ye=0|Math.floor(.5+ee*(Be-.5)),Ye>K/2&&(Ye=K/2),U[He]=(_e[ge]+_e[Ye])/2,I[He]=_e[Ye];var rt=ze*Be;G[He]=(rt-Ie[I[He]])/(Ie[I[He]+1]-Ie[I[He]]),G[He]<0?G[He]=0:G[He]>1&&(G[He]=1),Ze=We(J*ie[He]*ee),Ze=Math.min(Ze,15.5)/15.5,P[He]=Math.pow(10,1.25*(1-Math.cos(Math.PI*Ze))-2.5)}ae=0;for(var kt=0;kt<je;kt++){var _s=R[kt],et,Nt;et=We(J*ae),Nt=We(J*(ae+_s-1)),q[kt]=.5*(et+Nt),et=We(J*(ae-.5)),Nt=We(J*(ae+_s-.5)),Y[kt]=Nt-et,ae+=_s}return je}function ye(R,I,U,q,Y,P){var G=Ts([O.CBANDS,O.CBANDS]),J,K=0;if(P)for(var ie=0;ie<I;ie++)for(J=0;J<I;J++){var ee=Ue(U[ie]-U[J])*q[J];G[ie][J]=ee*Y[ie]}else for(J=0;J<I;J++)for(var oe=15+Math.min(21/U[J],12),Ie=Fe(oe),ie=0;ie<I;ie++){var ee=Ie*Ne(U[ie]-U[J],oe)*q[J];G[ie][J]=ee*Y[ie]}for(var ie=0;ie<I;ie++){for(J=0;J<I&&!(G[ie][J]>0);J++);for(R[ie][0]=J,J=I-1;J>0&&!(G[ie][J]>0);J--);R[ie][1]=J,K+=R[ie][1]-R[ie][0]+1}for(var ze=Pt(K),_e=0,ie=0;ie<I;ie++)for(J=R[ie][0];J<=R[ie][1];J++)ze[_e++]=G[ie][J];return ze}function $(R){var I=We(R);return I=Math.min(I,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*I))-2.5)}this.psymodel_init=function(R){var I=R.internal_flags,U,q=!0,Y=13,P=24,G=0,J=0,K=-8.25,ie=-4.5,ee=Pt(O.CBANDS),oe=Pt(O.CBANDS),Ie=Pt(O.CBANDS),ze=R.out_samplerate;switch(R.experimentalZ){default:case 0:q=!0;break;case 1:q=!(R.VBR==br.vbr_mtrh||R.VBR==br.vbr_mt);break;case 2:q=!1;break;case 3:Y=8,G=-1.75,J=-.0125,K=-8.25,ie=-2.25;break}for(I.ms_ener_ratio_old=.25,I.blocktype_old[0]=I.blocktype_old[1]=O.NORM_TYPE,U=0;U<4;++U){for(var ae=0;ae<O.CBANDS;++ae)I.nb_1[U][ae]=1e20,I.nb_2[U][ae]=1e20,I.nb_s1[U][ae]=I.nb_s2[U][ae]=1;for(var _e=0;_e<O.SBMAX_l;_e++)I.en[U].l[_e]=1e20,I.thm[U].l[_e]=1e20;for(var ae=0;ae<3;++ae){for(var _e=0;_e<O.SBMAX_s;_e++)I.en[U].s[_e][ae]=1e20,I.thm[U].s[_e][ae]=1e20;I.nsPsy.lastAttacks[U]=0}for(var ae=0;ae<9;ae++)I.nsPsy.last_en_subshort[U][ae]=10}for(I.loudness_sq_save[0]=I.loudness_sq_save[1]=0,I.npart_l=ce(I.numlines_l,I.bo_l,I.bm_l,ee,oe,I.mld_l,I.PSY.bo_l_weight,ze,O.BLKSIZE,I.scalefac_band.l,O.BLKSIZE/(2*576),O.SBMAX_l),tt(I.npart_l<O.CBANDS),U=0;U<I.npart_l;U++){var Ve=G;ee[U]>=Y&&(Ve=J*(ee[U]-Y)/(P-Y)+G*(P-ee[U])/(P-Y)),Ie[U]=Math.pow(10,Ve/10),I.numlines_l[U]>0?I.rnumlines_l[U]=1/I.numlines_l[U]:I.rnumlines_l[U]=0}I.s3_ll=ye(I.s3ind,I.npart_l,ee,oe,Ie,q);var ae=0;for(U=0;U<I.npart_l;U++){var je;je=Uu.MAX_VALUE;for(var et=0;et<I.numlines_l[U];et++,ae++){var pe=ze*ae/(1e3*O.BLKSIZE),He;He=this.ATHformula(pe*1e3,R)-20,He=Math.pow(10,.1*He),He*=I.numlines_l[U],je>He&&(je=He)}I.ATH.cb_l[U]=je,je=-20+ee[U]*20/10,je>6&&(je=100),je<-15&&(je=-15),je-=8,I.minval_l[U]=Math.pow(10,je/10)*I.numlines_l[U]}for(I.npart_s=ce(I.numlines_s,I.bo_s,I.bm_s,ee,oe,I.mld_s,I.PSY.bo_s_weight,ze,O.BLKSIZE_s,I.scalefac_band.s,O.BLKSIZE_s/(2*192),O.SBMAX_s),tt(I.npart_s<O.CBANDS),ae=0,U=0;U<I.npart_s;U++){var je,Ve=K;ee[U]>=Y&&(Ve=ie*(ee[U]-Y)/(P-Y)+K*(P-ee[U])/(P-Y)),Ie[U]=Math.pow(10,Ve/10),je=Uu.MAX_VALUE;for(var et=0;et<I.numlines_s[U];et++,ae++){var pe=ze*ae/(1e3*O.BLKSIZE_s),He;He=this.ATHformula(pe*1e3,R)-20,He=Math.pow(10,.1*He),He*=I.numlines_s[U],je>He&&(je=He)}I.ATH.cb_s[U]=je,je=-7+ee[U]*7/12,ee[U]>12&&(je*=1+Math.log(1+je)*3.1),ee[U]<12&&(je*=1+Math.log(1-je)*2.3),je<-15&&(je=-15),je-=8,I.minval_s[U]=Math.pow(10,je/10)*I.numlines_s[U]}I.s3_ss=ye(I.s3ind_s,I.npart_s,ee,oe,Ie,q),S(),e.init_fft(I),I.decay=Math.exp(-1*t/(v*ze/192));{var ge;ge=p,(R.exp_nspsytune&2)!=0&&(ge=1),Math.abs(R.msfix)>0&&(ge=R.msfix),R.msfix=ge;for(var Ye=0;Ye<I.npart_l;Ye++)I.s3ind[Ye][1]>I.npart_l-1&&(I.s3ind[Ye][1]=I.npart_l-1)}var At=576*I.mode_gr/ze;if(I.ATH.decay=Math.pow(10,-12/10*At),I.ATH.adjust=.01,I.ATH.adjustLimit=1,tt(I.bo_l[O.SBMAX_l-1]<=I.npart_l),tt(I.bo_s[O.SBMAX_s-1]<=I.npart_s),R.ATHtype!=-1){var pe,Be=R.out_samplerate/O.BLKSIZE,Ze=0;for(pe=0,U=0;U<O.BLKSIZE/2;++U)pe+=Be,I.ATH.eql_w[U]=1/Math.pow(10,this.ATHformula(pe,R)/10),Ze+=I.ATH.eql_w[U];for(Ze=1/Ze,U=O.BLKSIZE/2;--U>=0;)I.ATH.eql_w[U]*=Ze}{for(var Ye=ae=0;Ye<I.npart_s;++Ye)for(U=0;U<I.numlines_s[Ye];++U)++ae;for(var Ye=ae=0;Ye<I.npart_l;++Ye)for(U=0;U<I.numlines_l[Ye];++U)++ae}for(ae=0,U=0;U<I.npart_l;U++){var pe=ze*(ae+I.numlines_l[U]/2)/(1*O.BLKSIZE);I.mld_cb_l[U]=$(pe),ae+=I.numlines_l[U]}for(;U<O.CBANDS;++U)I.mld_cb_l[U]=1;for(ae=0,U=0;U<I.npart_s;U++){var pe=ze*(ae+I.numlines_s[U]/2)/(1*O.BLKSIZE_s);I.mld_cb_s[U]=$(pe),ae+=I.numlines_s[U]}for(;U<O.CBANDS;++U)I.mld_cb_s[U]=1;return 0};function Ce(R,I){R<-.3&&(R=3410),R/=1e3,R=Math.max(.1,R);var U=3.64*Math.pow(R,-.8)-6.8*Math.exp(-.6*Math.pow(R-3.4,2))+6*Math.exp(-.15*Math.pow(R-8.7,2))+(.6+.04*I)*.001*Math.pow(R,4);return U}this.ATHformula=function(R,I){var U;switch(I.ATHtype){case 0:U=Ce(R,9);break;case 1:U=Ce(R,-1);break;case 2:U=Ce(R,0);break;case 3:U=Ce(R,1)+6;break;case 4:U=Ce(R,I.ATHcurve);break;default:U=Ce(R,0);break}return U}}function Q3(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=vt.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null}var ba={};ba.SFBMAX=O.SBMAX_s*3;var J3=ke.new_float,Xa=ke.new_int;function Ci(){this.xr=J3(576),this.l3_enc=Xa(576),this.scalefac=Xa(ba.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=Xa(3),this.subblock_gain=Xa(3+1),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=Xa(ba.SFBMAX),this.window=Xa(ba.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=Xa(4),this.max_nonzero_coeff=0;var e=this;function t(a){return new Int32Array(a)}function s(a){return new Float32Array(a)}this.assign=function(a){e.xr=s(a.xr),e.l3_enc=t(a.l3_enc),e.scalefac=t(a.scalefac),e.xrpow_max=a.xrpow_max,e.part2_3_length=a.part2_3_length,e.big_values=a.big_values,e.count1=a.count1,e.global_gain=a.global_gain,e.scalefac_compress=a.scalefac_compress,e.block_type=a.block_type,e.mixed_block_flag=a.mixed_block_flag,e.table_select=t(a.table_select),e.subblock_gain=t(a.subblock_gain),e.region0_count=a.region0_count,e.region1_count=a.region1_count,e.preflag=a.preflag,e.scalefac_scale=a.scalefac_scale,e.count1table_select=a.count1table_select,e.part2_length=a.part2_length,e.sfb_lmax=a.sfb_lmax,e.sfb_smin=a.sfb_smin,e.psy_lmax=a.psy_lmax,e.sfbmax=a.sfbmax,e.psymax=a.psymax,e.sfbdivide=a.sfbdivide,e.width=t(a.width),e.window=t(a.window),e.count1bits=a.count1bits,e.sfb_partition_table=a.sfb_partition_table.slice(0),e.slen=t(a.slen),e.max_nonzero_coeff=a.max_nonzero_coeff}}var qu=ke.new_int;function $3(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[qu(4),qu(4)];for(var e=0;e<2;e++)for(var t=0;t<2;t++)this.tt[e][t]=new Ci}var Bi=ke.System,Li=ke.new_int;function Xs(e,t,s,a){this.l=Li(1+O.SBMAX_l),this.s=Li(1+O.SBMAX_s),this.psfb21=Li(1+O.PSFB21),this.psfb12=Li(1+O.PSFB12);var n=this.l,r=this.s;arguments.length==4&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],Bi.arraycopy(this.arrL,0,n,0,Math.min(this.arrL.length,this.l.length)),Bi.arraycopy(this.arrS,0,r,0,Math.min(this.arrS.length,this.s.length)),Bi.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),Bi.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}var Sl=ke.new_float,eg=ke.new_float_n,tg=ke.new_int;function sg(){this.last_en_subshort=eg([4,9]),this.lastAttacks=tg(4),this.pefirbuf=Sl(19),this.longfact=Sl(O.SBMAX_l),this.shortfact=Sl(O.SBMAX_s),this.attackthre=0,this.attackthre_s=0}function ag(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0}var rg=ke.new_byte,ng=ke.new_double,Es=ke.new_float,Ka=ke.new_float_n,Ls=ke.new_int,Ni=ke.new_int_n;ft.MFSIZE=3*1152+O.ENCDELAY-O.MDCTDELAY,ft.MAX_HEADER_BUF=256,ft.MAX_BITS_PER_CHANNEL=4095,ft.MAX_BITS_PER_GRANULE=7680,ft.BPC=320;function ft(){var e=40;this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=Ka([2,ft.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new $3,this.ms_ratio=Es(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=Ls(2),this.CurrentStep=Ls(2),this.masking_lower=0,this.bv_scf=Ls(576),this.pseudohalf=Ls(ba.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*ft.BPC+1),this.itime=ng(2),this.sideinfo_len=0,this.sb_sample=Ka([2,2,18,O.SBLIMIT]),this.amp_filter=Es(32);function t(){this.write_timing=0,this.ptr=0,this.buf=rg(e)}this.header=new Array(ft.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new Xs,this.minval_l=Es(O.CBANDS),this.minval_s=Es(O.CBANDS),this.nb_1=Ka([4,O.CBANDS]),this.nb_2=Ka([4,O.CBANDS]),this.nb_s1=Ka([4,O.CBANDS]),this.nb_s2=Ka([4,O.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=Es(4),this.loudness_sq=Ka([2,2]),this.loudness_sq_save=Es(2),this.mld_l=Es(O.SBMAX_l),this.mld_s=Es(O.SBMAX_s),this.bm_l=Ls(O.SBMAX_l),this.bo_l=Ls(O.SBMAX_l),this.bm_s=Ls(O.SBMAX_s),this.bo_s=Ls(O.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=Ni([O.CBANDS,2]),this.s3ind_s=Ni([O.CBANDS,2]),this.numlines_s=Ls(O.CBANDS),this.numlines_l=Ls(O.CBANDS),this.rnumlines_l=Es(O.CBANDS),this.mld_cb_l=Es(O.CBANDS),this.mld_cb_s=Es(O.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=Es(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=Ls(2),this.nsPsy=new sg,this.VBR_seek_table=new ag,this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=Ni([16,4+1]),this.bitrate_blockType_Hist=Ni([16,4+1+1]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var s=0;s<this.en.length;s++)this.en[s]=new Ri;for(var s=0;s<this.thm.length;s++)this.thm[s]=new Ri;for(var s=0;s<this.header.length;s++)this.header[s]=new t}var Ga=ke.new_float;function ig(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=Ga(O.SBMAX_l),this.s=Ga(O.SBMAX_s),this.psfb21=Ga(O.PSFB21),this.psfb12=Ga(O.PSFB12),this.cb_l=Ga(O.CBANDS),this.cb_s=Ga(O.CBANDS),this.eql_w=Ga(O.BLKSIZE/2)}var is=ke.System,Vu=ke.Arrays;Lt.STEPS_per_dB=100,Lt.MAX_dB=120,Lt.GAIN_NOT_ENOUGH_SAMPLES=-24601,Lt.GAIN_ANALYSIS_ERROR=0,Lt.GAIN_ANALYSIS_OK=1,Lt.INIT_GAIN_ANALYSIS_ERROR=0,Lt.INIT_GAIN_ANALYSIS_OK=1,Lt.YULE_ORDER=10,Lt.MAX_ORDER=Lt.YULE_ORDER,Lt.MAX_SAMP_FREQ=48e3,Lt.RMS_WINDOW_TIME_NUMERATOR=1,Lt.RMS_WINDOW_TIME_DENOMINATOR=20,Lt.MAX_SAMPLES_PER_WINDOW=Lt.MAX_SAMP_FREQ*Lt.RMS_WINDOW_TIME_NUMERATOR/Lt.RMS_WINDOW_TIME_DENOMINATOR+1;function Lt(){var e=64.82,t=.95,s=Lt.RMS_WINDOW_TIME_NUMERATOR,a=Lt.RMS_WINDOW_TIME_DENOMINATOR,n=[[.038575994352,-3.84664617118067,-.02160367184185,7.81501653005538,-.00123395316851,-11.34170355132042,-9291677959e-14,13.05504219327545,-.01655260341619,-12.28759895145294,.02161526843274,9.4829380631979,-.02074045215285,-5.87257861775999,.00594298065125,2.75465861874613,.00306428023191,-.86984376593551,.00012025322027,.13919314567432,.00288463683916],[.0541865640643,-3.47845948550071,-.02911007808948,6.36317777566148,-.00848709379851,-8.54751527471874,-.00851165645469,9.4769360780128,-.00834990904936,-8.81498681370155,.02245293253339,6.85401540936998,-.02596338512915,-4.39470996079559,.01624864962975,2.19611684890774,-.00240879051584,-.75104302451432,.00674613682247,.13149317958808,-.00187763777362],[.15457299681924,-2.37898834973084,-.09331049056315,2.84868151156327,-.06247880153653,-2.64577170229825,.02163541888798,2.23697657451713,-.05588393329856,-1.67148153367602,.04781476674921,1.00595954808547,.00222312597743,-.45953458054983,.03174092540049,.16378164858596,-.01390589421898,-.05032077717131,.00651420667831,.0234789740702,-.00881362733839],[.30296907319327,-1.61273165137247,-.22613988682123,1.0797749225997,-.08587323730772,-.2565625775407,.03282930172664,-.1627671912044,-.00915702933434,-.22638893773906,-.02364141202522,.39120800788284,-.00584456039913,-.22138138954925,.06276101321749,.04500235387352,-828086748e-14,.02005851806501,.00205861885564,.00302439095741,-.02950134983287],[.33642304856132,-1.49858979367799,-.2557224142557,.87350271418188,-.11828570177555,.12205022308084,.11921148675203,-.80774944671438,-.07834489609479,.47854794562326,-.0046997791438,-.12453458140019,-.0058950022444,-.04067510197014,.05724228140351,.08333755284107,.00832043980773,-.04237348025746,-.0163538138454,.02977207319925,-.0176017656815],[.4491525660845,-.62820619233671,-.14351757464547,.29661783706366,-.22784394429749,-.372563729424,-.01419140100551,.00213767857124,.04078262797139,-.42029820170918,-.12398163381748,.22199650564824,.04097565135648,.00613424350682,.10478503600251,.06747620744683,-.01863887810927,.05784820375801,-.03193428438915,.03222754072173,.00541907748707],[.56619470757641,-1.04800335126349,-.75464456939302,.29156311971249,.1624213774223,-.26806001042947,.16744243493672,.00819999645858,-.18901604199609,.45054734505008,.3093178284183,-.33032403314006,-.27562961986224,.0673936833311,.00647310677246,-.04784254229033,.08647503780351,.01639907836189,-.0378898455484,.01807364323573,-.00588215443421],[.58100494960553,-.51035327095184,-.53174909058578,-.31863563325245,-.14289799034253,-.20256413484477,.17520704835522,.1472815413433,.02377945217615,.38952639978999,.15558449135573,-.23313271880868,-.25344790059353,-.05246019024463,.01628462406333,-.02505961724053,.06920467763959,.02442357316099,-.03721611395801,.01818801111503,-.00749618797172],[.53648789255105,-.2504987195602,-.42163034350696,-.43193942311114,-.00275953611929,-.03424681017675,.04267842219415,-.04678328784242,-.10214864179676,.26408300200955,.14590772289388,.15113130533216,-.02459864859345,-.17556493366449,-.11202315195388,-.18823009262115,-.04060034127,.05477720428674,.0478866554818,.0470440968812,-.02217936801134]],r=[[.98621192462708,-1.97223372919527,-1.97242384925416,.97261396931306,.98621192462708],[.98500175787242,-1.96977855582618,-1.97000351574484,.9702284756635,.98500175787242],[.97938932735214,-1.95835380975398,-1.95877865470428,.95920349965459,.97938932735214],[.97531843204928,-1.95002759149878,-1.95063686409857,.95124613669835,.97531843204928],[.97316523498161,-1.94561023566527,-1.94633046996323,.94705070426118,.97316523498161],[.96454515552826,-1.92783286977036,-1.92909031105652,.93034775234268,.96454515552826],[.96009142950541,-1.91858953033784,-1.92018285901082,.92177618768381,.96009142950541],[.95856916599601,-1.9154210807478,-1.91713833199203,.91885558323625,.95856916599601],[.94597685600279,-1.88903307939452,-1.89195371200558,.89487434461664,.94597685600279]];function o(u,p,y,i,H,L){for(;H--!=0;)y[i]=1e-10+u[p+0]*L[0]-y[i-1]*L[1]+u[p-1]*L[2]-y[i-2]*L[3]+u[p-2]*L[4]-y[i-3]*L[5]+u[p-3]*L[6]-y[i-4]*L[7]+u[p-4]*L[8]-y[i-5]*L[9]+u[p-5]*L[10]-y[i-6]*L[11]+u[p-6]*L[12]-y[i-7]*L[13]+u[p-7]*L[14]-y[i-8]*L[15]+u[p-8]*L[16]-y[i-9]*L[17]+u[p-9]*L[18]-y[i-10]*L[19]+u[p-10]*L[20],++i,++p}function l(u,p,y,i,H,L){for(;H--!=0;)y[i]=u[p+0]*L[0]-y[i-1]*L[1]+u[p-1]*L[2]-y[i-2]*L[3]+u[p-2]*L[4],++i,++p}function v(u,p){for(var y=0;y<MAX_ORDER;y++)u.linprebuf[y]=u.lstepbuf[y]=u.loutbuf[y]=u.rinprebuf[y]=u.rstepbuf[y]=u.routbuf[y]=0;switch(0|p){case 48e3:u.reqindex=0;break;case 44100:u.reqindex=1;break;case 32e3:u.reqindex=2;break;case 24e3:u.reqindex=3;break;case 22050:u.reqindex=4;break;case 16e3:u.reqindex=5;break;case 12e3:u.reqindex=6;break;case 11025:u.reqindex=7;break;case 8e3:u.reqindex=8;break;default:return INIT_GAIN_ANALYSIS_ERROR}return u.sampleWindow=0|(p*s+a-1)/a,u.lsum=0,u.rsum=0,u.totsamp=0,Vu.ill(u.A,0),INIT_GAIN_ANALYSIS_OK}this.InitGainAnalysis=function(u,p){return v(u,p)!=INIT_GAIN_ANALYSIS_OK?INIT_GAIN_ANALYSIS_ERROR:(u.linpre=MAX_ORDER,u.rinpre=MAX_ORDER,u.lstep=MAX_ORDER,u.rstep=MAX_ORDER,u.lout=MAX_ORDER,u.rout=MAX_ORDER,Vu.fill(u.B,0),INIT_GAIN_ANALYSIS_OK)};function c(u){return u*u}this.AnalyzeSamples=function(u,p,y,i,H,L,N){var h,k,C,A,B,d,E;if(L==0)return GAIN_ANALYSIS_OK;switch(E=0,B=L,N){case 1:i=p,H=y;break;case 2:break;default:return GAIN_ANALYSIS_ERROR}for(L<MAX_ORDER?(is.arraycopy(p,y,u.linprebuf,MAX_ORDER,L),is.arraycopy(i,H,u.rinprebuf,MAX_ORDER,L)):(is.arraycopy(p,y,u.linprebuf,MAX_ORDER,MAX_ORDER),is.arraycopy(i,H,u.rinprebuf,MAX_ORDER,MAX_ORDER));B>0;){d=B>u.sampleWindow-u.totsamp?u.sampleWindow-u.totsamp:B,E<MAX_ORDER?(h=u.linpre+E,k=u.linprebuf,C=u.rinpre+E,A=u.rinprebuf,d>MAX_ORDER-E&&(d=MAX_ORDER-E)):(h=y+E,k=p,C=H+E,A=i),o(k,h,u.lstepbuf,u.lstep+u.totsamp,d,n[u.reqindex]),o(A,C,u.rstepbuf,u.rstep+u.totsamp,d,n[u.reqindex]),l(u.lstepbuf,u.lstep+u.totsamp,u.loutbuf,u.lout+u.totsamp,d,r[u.reqindex]),l(u.rstepbuf,u.rstep+u.totsamp,u.routbuf,u.rout+u.totsamp,d,r[u.reqindex]),h=u.lout+u.totsamp,k=u.loutbuf,C=u.rout+u.totsamp,A=u.routbuf;for(var S=d%8;S--!=0;)u.lsum+=c(k[h++]),u.rsum+=c(A[C++]);for(S=d/8;S--!=0;)u.lsum+=c(k[h+0])+c(k[h+1])+c(k[h+2])+c(k[h+3])+c(k[h+4])+c(k[h+5])+c(k[h+6])+c(k[h+7]),h+=8,u.rsum+=c(A[C+0])+c(A[C+1])+c(A[C+2])+c(A[C+3])+c(A[C+4])+c(A[C+5])+c(A[C+6])+c(A[C+7]),C+=8;if(B-=d,E+=d,u.totsamp+=d,u.totsamp==u.sampleWindow){var _=Lt.STEPS_per_dB*10*Math.log10((u.lsum+u.rsum)/u.totsamp*.5+1e-37),x=_<=0?0:0|_;x>=u.A.length&&(x=u.A.length-1),u.A[x]++,u.lsum=u.rsum=0,is.arraycopy(u.loutbuf,u.totsamp,u.loutbuf,0,MAX_ORDER),is.arraycopy(u.routbuf,u.totsamp,u.routbuf,0,MAX_ORDER),is.arraycopy(u.lstepbuf,u.totsamp,u.lstepbuf,0,MAX_ORDER),is.arraycopy(u.rstepbuf,u.totsamp,u.rstepbuf,0,MAX_ORDER),u.totsamp=0}if(u.totsamp>u.sampleWindow)return GAIN_ANALYSIS_ERROR}return L<MAX_ORDER?(is.arraycopy(u.linprebuf,L,u.linprebuf,0,MAX_ORDER-L),is.arraycopy(u.rinprebuf,L,u.rinprebuf,0,MAX_ORDER-L),is.arraycopy(p,y,u.linprebuf,MAX_ORDER-L,L),is.arraycopy(i,H,u.rinprebuf,MAX_ORDER-L,L)):(is.arraycopy(p,y+L-MAX_ORDER,u.linprebuf,0,MAX_ORDER),is.arraycopy(i,H+L-MAX_ORDER,u.rinprebuf,0,MAX_ORDER)),GAIN_ANALYSIS_OK};function m(u,p){var y,i=0;for(y=0;y<p;y++)i+=u[y];if(i==0)return GAIN_NOT_ENOUGH_SAMPLES;var H=0|Math.ceil(i*(1-t));for(y=p;y-- >0&&!((H-=u[y])<=0););return e-y/Lt.STEPS_per_dB}this.GetTitleGain=function(u){for(var p=m(u.A,u.A.length),y=0;y<u.A.length;y++)u.B[y]+=u.A[y],u.A[y]=0;for(var y=0;y<MAX_ORDER;y++)u.linprebuf[y]=u.lstepbuf[y]=u.loutbuf[y]=u.rinprebuf[y]=u.rstepbuf[y]=u.routbuf[y]=0;return u.totsamp=0,u.lsum=u.rsum=0,p}}var xr=ke.new_float,zu=ke.new_int;function og(){this.linprebuf=xr(void 0*2),this.linpre=0,this.lstepbuf=xr(void 0+void 0),this.lstep=0,this.loutbuf=xr(void 0+void 0),this.lout=0,this.rinprebuf=xr(void 0*2),this.rinpre=0,this.rstepbuf=xr(void 0+void 0),this.rstep=0,this.routbuf=xr(void 0+void 0),this.rout=0,this.sampleWindow=0,this.totsamp=0,this.lsum=0,this.rsum=0,this.freqindex=0,this.first=0,this.A=zu(0|void 0*void 0),this.B=zu(0|void 0*void 0)}function Yu(e){this.bits=e}var Xu=ke.new_float,lg=ke.new_int,Ku=ke.assert;function cg(e){var t=e;this.quantize=t,this.iteration_loop=function(s,a,n,r){var o=s.internal_flags,l=Xu(ba.SFBMAX),v=Xu(576),c=lg(2),m=0,u,p=o.l3_side,y=new Yu(m);this.quantize.rv.ResvFrameBegin(s,y),m=y.bits;for(var i=0;i<o.mode_gr;i++){u=this.quantize.qupvt.on_pe(s,a,c,m,i,i),o.mode_ext==O.MPG_MD_MS_LR&&(this.quantize.ms_convert(o.l3_side,i),this.quantize.qupvt.reduce_side(c,n[i],m,u));for(var H=0;H<o.channels_out;H++){var L,N,h=p.tt[i][H];h.block_type!=O.SHORT_TYPE?(L=0,N=o.PSY.mask_adjust-L):(L=0,N=o.PSY.mask_adjust_short-L),o.masking_lower=Math.pow(10,N*.1),this.quantize.init_outer_loop(o,h),this.quantize.init_xrpow(o,h,v)&&(this.quantize.qupvt.calc_xmin(s,r[i][H],h,l),this.quantize.outer_loop(s,h,l,v,H,c[H])),this.quantize.iteration_finish_one(o,i,H),Ku(h.part2_3_length<=ft.MAX_BITS_PER_CHANNEL),Ku(h.part2_3_length<=c[H])}}this.quantize.rv.ResvFrameEnd(o,m)}}function dt(e,t,s,a){this.xlen=e,this.linmax=t,this.table=s,this.hlen=a}var re={};re.t1HB=[1,1,1,0],re.t2HB=[1,2,1,3,1,1,3,2,0],re.t3HB=[3,2,1,1,1,1,3,2,0],re.t5HB=[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0],re.t6HB=[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0],re.t7HB=[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0],re.t8HB=[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0],re.t9HB=[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0],re.t10HB=[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0],re.t11HB=[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0],re.t12HB=[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0],re.t13HB=[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1],re.t15HB=[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0],re.t16HB=[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3],re.t24HB=[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3],re.t32HB=[1<<0,5<<1,4<<1,5<<2,6<<1,5<<2,4<<2,4<<3,7<<1,3<<2,6<<2,0<<3,7<<2,2<<3,3<<3,1<<4],re.t33HB=[15<<0,14<<1,13<<1,12<<2,11<<1,10<<2,9<<2,8<<3,7<<1,6<<2,5<<2,4<<3,3<<2,2<<3,1<<3,0<<4],re.t1l=[1,4,3,5],re.t2l=[1,4,7,4,5,7,6,7,8],re.t3l=[2,3,7,4,4,7,6,7,8],re.t5l=[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10],re.t6l=[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9],re.t7l=[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12],re.t8l=[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13],re.t9l=[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11],re.t10l=[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13],re.t11l=[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12],re.t12l=[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12],re.t13l=[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18],re.t15l=[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15],re.t16_5l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12],re.t16l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10],re.t24l=[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6],re.t32l=[1+0,4+1,4+1,5+2,4+1,6+2,5+2,6+3,4+1,5+2,5+2,6+3,5+2,6+3,6+3,6+4],re.t33l=[4+0,4+1,4+1,4+2,4+1,4+2,4+2,4+3,4+1,4+2,4+2,4+3,4+2,4+3,4+3,4+4],re.ht=[new dt(0,0,null,null),new dt(2,0,re.t1HB,re.t1l),new dt(3,0,re.t2HB,re.t2l),new dt(3,0,re.t3HB,re.t3l),new dt(0,0,null,null),new dt(4,0,re.t5HB,re.t5l),new dt(4,0,re.t6HB,re.t6l),new dt(6,0,re.t7HB,re.t7l),new dt(6,0,re.t8HB,re.t8l),new dt(6,0,re.t9HB,re.t9l),new dt(8,0,re.t10HB,re.t10l),new dt(8,0,re.t11HB,re.t11l),new dt(8,0,re.t12HB,re.t12l),new dt(16,0,re.t13HB,re.t13l),new dt(0,0,null,re.t16_5l),new dt(16,0,re.t15HB,re.t15l),new dt(1,1,re.t16HB,re.t16l),new dt(2,3,re.t16HB,re.t16l),new dt(3,7,re.t16HB,re.t16l),new dt(4,15,re.t16HB,re.t16l),new dt(6,63,re.t16HB,re.t16l),new dt(8,255,re.t16HB,re.t16l),new dt(10,1023,re.t16HB,re.t16l),new dt(13,8191,re.t16HB,re.t16l),new dt(4,15,re.t24HB,re.t24l),new dt(5,31,re.t24HB,re.t24l),new dt(6,63,re.t24HB,re.t24l),new dt(7,127,re.t24HB,re.t24l),new dt(8,255,re.t24HB,re.t24l),new dt(9,511,re.t24HB,re.t24l),new dt(11,2047,re.t24HB,re.t24l),new dt(13,8191,re.t24HB,re.t24l),new dt(0,0,re.t32HB,re.t32l),new dt(0,0,re.t33HB,re.t33l)],re.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366],re.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296],re.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369],re.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]],re.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]],re.scfsi_band=[0,6,11,16,21];var Wa=ke.VbrMode,ji=ke.Float,Ml=ke.Util,Za=ke.new_float,ug=ke.new_int,pn=ke.assert;Zt.Q_MAX=256+1,Zt.Q_MAX2=116,Zt.LARGE_BITS=1e5,Zt.IXMAX_VAL=8206;function Zt(){var e=null,t=null,s=null;this.setModules=function(h,k,C){e=h,t=k,s=C};function a(h){return u[h+Zt.Q_MAX2]}this.IPOW20=function(h){return p[h]};var n=2220446049250313e-31,r=Zt.IXMAX_VAL,o=r+2,l=Zt.Q_MAX,v=Zt.Q_MAX2,c=100;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var m=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=m,this.sfBandIndex=[new Xs([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Xs([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Xs([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Xs([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Xs([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Xs([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Xs([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Xs([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new Xs([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0/3,24/3,48/3,72/3,108/3,156/3,216/3,288/3,372/3,480/3,486/3,492/3,498/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var u=Za(l+v+1),p=Za(l),y=Za(o),i=Za(o);this.adj43=i;function H(h,k){var C=s.ATHformula(k,h);return C-=c,C=Math.pow(10,C/10+h.ATHlower),C}function L(h){for(var k=h.internal_flags.ATH.l,C=h.internal_flags.ATH.psfb21,A=h.internal_flags.ATH.s,B=h.internal_flags.ATH.psfb12,d=h.internal_flags,E=h.out_samplerate,S=0;S<O.SBMAX_l;S++){var _=d.scalefac_band.l[S],x=d.scalefac_band.l[S+1];k[S]=ji.MAX_VALUE;for(var b=_;b<x;b++){var g=b*E/1152,M=H(h,g);k[S]=Math.min(k[S],M)}}for(var S=0;S<O.PSFB21;S++){var _=d.scalefac_band.psfb21[S],x=d.scalefac_band.psfb21[S+1];C[S]=ji.MAX_VALUE;for(var b=_;b<x;b++){var g=b*E/1152,M=H(h,g);C[S]=Math.min(C[S],M)}}for(var S=0;S<O.SBMAX_s;S++){var _=d.scalefac_band.s[S],x=d.scalefac_band.s[S+1];A[S]=ji.MAX_VALUE;for(var b=_;b<x;b++){var g=b*E/384,M=H(h,g);A[S]=Math.min(A[S],M)}A[S]*=d.scalefac_band.s[S+1]-d.scalefac_band.s[S]}for(var S=0;S<O.PSFB12;S++){var _=d.scalefac_band.psfb12[S],x=d.scalefac_band.psfb12[S+1];B[S]=ji.MAX_VALUE;for(var b=_;b<x;b++){var g=b*E/384,M=H(h,g);B[S]=Math.min(B[S],M)}B[S]*=d.scalefac_band.s[13]-d.scalefac_band.s[12]}if(h.noATH){for(var S=0;S<O.SBMAX_l;S++)k[S]=1e-20;for(var S=0;S<O.PSFB21;S++)C[S]=1e-20;for(var S=0;S<O.SBMAX_s;S++)A[S]=1e-20;for(var S=0;S<O.PSFB12;S++)B[S]=1e-20}d.ATH.floor=10*Math.log10(H(h,-1))}this.iteration_init=function(h){var k=h.internal_flags,C=k.l3_side,A;if(k.iteration_init_init==0){for(k.iteration_init_init=1,C.main_data_begin=0,L(h),y[0]=0,A=1;A<o;A++)y[A]=Math.pow(A,4/3);for(A=0;A<o-1;A++)i[A]=A+1-Math.pow(.5*(y[A]+y[A+1]),.75);for(i[A]=.5,A=0;A<l;A++)p[A]=Math.pow(2,(A-210)*-.1875);for(A=0;A<=l+v;A++)u[A]=Math.pow(2,(A-210-v)*.25);e.huffman_init(k);{var B,d,E,S;for(A=h.exp_nspsytune>>2&63,A>=32&&(A-=64),B=Math.pow(10,A/4/10),A=h.exp_nspsytune>>8&63,A>=32&&(A-=64),d=Math.pow(10,A/4/10),A=h.exp_nspsytune>>14&63,A>=32&&(A-=64),E=Math.pow(10,A/4/10),A=h.exp_nspsytune>>20&63,A>=32&&(A-=64),S=E*Math.pow(10,A/4/10),A=0;A<O.SBMAX_l;A++){var _;A<=6?_=B:A<=13?_=d:A<=20?_=E:_=S,k.nsPsy.longfact[A]=_}for(A=0;A<O.SBMAX_s;A++){var _;A<=5?_=B:A<=10?_=d:A<=11?_=E:_=S,k.nsPsy.shortfact[A]=_}}}},this.on_pe=function(h,k,C,A,B,d){var E=h.internal_flags,S=0,_,x=ug(2),b,g=new Yu(S),M=t.ResvMaxBits(h,A,g,d);S=g.bits;var w=S+M;for(w>ft.MAX_BITS_PER_GRANULE&&(w=ft.MAX_BITS_PER_GRANULE),_=0,b=0;b<E.channels_out;++b)C[b]=Math.min(ft.MAX_BITS_PER_CHANNEL,S/E.channels_out),x[b]=0|C[b]*k[B][b]/700-C[b],x[b]>A*3/4&&(x[b]=A*3/4),x[b]<0&&(x[b]=0),x[b]+C[b]>ft.MAX_BITS_PER_CHANNEL&&(x[b]=Math.max(0,ft.MAX_BITS_PER_CHANNEL-C[b])),_+=x[b];if(_>M)for(b=0;b<E.channels_out;++b)x[b]=M*x[b]/_;for(b=0;b<E.channels_out;++b)C[b]+=x[b],M-=x[b];for(_=0,b=0;b<E.channels_out;++b)_+=C[b];if(_>ft.MAX_BITS_PER_GRANULE){var j=0;for(b=0;b<E.channels_out;++b)C[b]*=ft.MAX_BITS_PER_GRANULE,C[b]/=_,j+=C[b]}return w},this.reduce_side=function(h,k,C,A){pn(h[0]+h[1]<=ft.MAX_BITS_PER_GRANULE);var B=.33*(.5-k)/.5;B<0&&(B=0),B>.5&&(B=.5);var d=0|B*.5*(h[0]+h[1]);d>ft.MAX_BITS_PER_CHANNEL-h[0]&&(d=ft.MAX_BITS_PER_CHANNEL-h[0]),d<0&&(d=0),h[1]>=125&&(h[1]-d>125?(h[0]<C&&(h[0]+=d),h[1]-=d):(h[0]+=h[1]-125,h[1]=125)),d=h[0]+h[1],d>A&&(h[0]=A*h[0]/d,h[1]=A*h[1]/d),pn(h[0]<=ft.MAX_BITS_PER_CHANNEL),pn(h[1]<=ft.MAX_BITS_PER_CHANNEL),pn(h[0]+h[1]<=ft.MAX_BITS_PER_GRANULE)},this.athAdjust=function(h,k,C){var A=90.30873362,B=94.82444863,d=Ml.FAST_LOG10_X(k,10),E=h*h,S=0;return d-=C,E>1e-20&&(S=1+Ml.FAST_LOG10_X(E,10/A)),S<0&&(S=0),d*=S,d+=C+A-B,Math.pow(10,.1*d)},this.calc_xmin=function(h,k,C,A){var B=0,d=h.internal_flags,E,S=0,_=0,x=d.ATH,b=C.xr,g=h.VBR==Wa.vbr_mtrh?1:0,M=d.masking_lower;for((h.VBR==Wa.vbr_mtrh||h.VBR==Wa.vbr_mt)&&(M=1),E=0;E<C.psy_lmax;E++){var w,j,X,F,V,f;h.VBR==Wa.vbr_rh||h.VBR==Wa.vbr_mtrh?j=athAdjust(x.adjust,x.l[E],x.floor):j=x.adjust*x.l[E],V=C.width[E],X=j/V,F=n,f=V>>1,w=0;do{var T,W;T=b[S]*b[S],w+=T,F+=T<X?T:X,S++,W=b[S]*b[S],w+=W,F+=W<X?W:X,S++}while(--f>0);if(w>j&&_++,E==O.SBPSY_l){var Z=j*d.nsPsy.longfact[E];F<Z&&(F=Z)}if(g!=0&&(j=F),!h.ATHonly){var de=k.en.l[E];if(de>0){var Z;Z=w*k.thm.l[E]*M/de,g!=0&&(Z*=d.nsPsy.longfact[E]),j<Z&&(j=Z)}}g!=0?A[B++]=j:A[B++]=j*d.nsPsy.longfact[E]}var Me=575;if(C.block_type!=O.SHORT_TYPE)for(var Te=576;Te--!=0&&As.EQ(b[Te],0);)Me=Te;C.max_nonzero_coeff=Me;for(var ve=C.sfb_smin;E<C.psymax;ve++,E+=3){var V,De,Le;for(h.VBR==Wa.vbr_rh||h.VBR==Wa.vbr_mtrh?Le=athAdjust(x.adjust,x.s[ve],x.floor):Le=x.adjust*x.s[ve],V=C.width[E],De=0;De<3;De++){var w=0,j,X,F,f=V>>1;X=Le/V,F=n;do{var T,W;T=b[S]*b[S],w+=T,F+=T<X?T:X,S++,W=b[S]*b[S],w+=W,F+=W<X?W:X,S++}while(--f>0);if(w>Le&&_++,ve==O.SBPSY_s){var Z=Le*d.nsPsy.shortfact[ve];F<Z&&(F=Z)}if(g!=0?j=F:j=Le,!h.ATHonly&&!h.ATHshort){var de=k.en.s[ve][De];if(de>0){var Z;Z=w*k.thm.s[ve][De]*M/de,g!=0&&(Z*=d.nsPsy.shortfact[ve]),j<Z&&(j=Z)}}g!=0?A[B++]=j:A[B++]=j*d.nsPsy.shortfact[ve]}h.useTemporal&&(A[B-3]>A[B-3+1]&&(A[B-3+1]+=(A[B-3]-A[B-3+1])*d.decay),A[B-3+1]>A[B-3+2]&&(A[B-3+2]+=(A[B-3+1]-A[B-3+2])*d.decay))}return _};function N(h){this.s=h}this.calc_noise_core=function(h,k,C,A){var B=0,d=k.s,E=h.l3_enc;if(d>h.count1)for(;C--!=0;){var S;S=h.xr[d],d++,B+=S*S,S=h.xr[d],d++,B+=S*S}else if(d>h.big_values){var _=Za(2);for(_[0]=0,_[1]=A;C--!=0;){var S;S=Math.abs(h.xr[d])-_[E[d]],d++,B+=S*S,S=Math.abs(h.xr[d])-_[E[d]],d++,B+=S*S}}else for(;C--!=0;){var S;S=Math.abs(h.xr[d])-y[E[d]]*A,d++,B+=S*S,S=Math.abs(h.xr[d])-y[E[d]]*A,d++,B+=S*S}return k.s=d,B},this.calc_noise=function(h,k,C,A,B){var d=0,E=0,S,_,x=0,b=0,g=0,M=-20,w=0,j=h.scalefac,X=0;for(A.over_SSD=0,S=0;S<h.psymax;S++){var F=h.global_gain-(j[X++]+(h.preflag!=0?m[S]:0)<<h.scalefac_scale+1)-h.subblock_gain[h.window[S]]*8,V=0;if(B!=null&&B.step[S]==F)V=B.noise[S],w+=h.width[S],C[d++]=V/k[E++],V=B.noise_log[S];else{var f=a(F);if(_=h.width[S]>>1,w+h.width[S]>h.max_nonzero_coeff){var T;T=h.max_nonzero_coeff-w+1,T>0?_=T>>1:_=0}var W=new N(w);V=this.calc_noise_core(h,W,_,f),w=W.s,B!=null&&(B.step[S]=F,B.noise[S]=V),V=C[d++]=V/k[E++],V=Ml.FAST_LOG10(Math.max(V,1e-20)),B!=null&&(B.noise_log[S]=V)}if(B!=null&&(B.global_gain=h.global_gain),g+=V,V>0){var Z;Z=Math.max(0|V*10+.5,1),A.over_SSD+=Z*Z,x++,b+=V}M=Math.max(M,V)}return A.over_count=x,A.tot_noise=g,A.over_noise=b,A.max_noise=M,x},this.set_pinfo=function(h,k,C,A,B){var d=h.internal_flags,E,S,_,x,b,g=k.scalefac_scale==0?.5:1,M=k.scalefac,w=Za(L3Side.SFBMAX),j=Za(L3Side.SFBMAX),X=new CalcNoiseResult;calc_xmin(h,C,k,w),calc_noise(k,w,j,X,null);var F=0;for(S=k.sfb_lmax,k.block_type!=O.SHORT_TYPE&&k.mixed_block_flag==0&&(S=22),E=0;E<S;E++){var V=d.scalefac_band.l[E],f=d.scalefac_band.l[E+1],T=f-V;for(x=0;F<f;F++)x+=k.xr[F]*k.xr[F];x/=T,b=1e15,d.pinfo.en[A][B][E]=b*x,d.pinfo.xfsf[A][B][E]=b*w[E]*j[E]/T,C.en.l[E]>0&&!h.ATHonly?x=x/C.en.l[E]:x=0,d.pinfo.thr[A][B][E]=b*Math.max(x*C.thm.l[E],d.ATH.l[E]),d.pinfo.LAMEsfb[A][B][E]=0,k.preflag!=0&&E>=11&&(d.pinfo.LAMEsfb[A][B][E]=-g*m[E]),E<O.SBPSY_l&&(pn(M[E]>=0),d.pinfo.LAMEsfb[A][B][E]-=g*M[E])}if(k.block_type==O.SHORT_TYPE)for(S=E,E=k.sfb_smin;E<O.SBMAX_s;E++)for(var V=d.scalefac_band.s[E],f=d.scalefac_band.s[E+1],T=f-V,W=0;W<3;W++){for(x=0,_=V;_<f;_++)x+=k.xr[F]*k.xr[F],F++;x=Math.max(x/T,1e-20),b=1e15,d.pinfo.en_s[A][B][3*E+W]=b*x,d.pinfo.xfsf_s[A][B][3*E+W]=b*w[S]*j[S]/T,C.en.s[E][W]>0?x=x/C.en.s[E][W]:x=0,(h.ATHonly||h.ATHshort)&&(x=0),d.pinfo.thr_s[A][B][3*E+W]=b*Math.max(x*C.thm.s[E][W],d.ATH.s[E]),d.pinfo.LAMEsfb_s[A][B][3*E+W]=-2*k.subblock_gain[W],E<O.SBPSY_s&&(d.pinfo.LAMEsfb_s[A][B][3*E+W]-=g*M[S]),S++}d.pinfo.LAMEqss[A][B]=k.global_gain,d.pinfo.LAMEmainbits[A][B]=k.part2_3_length+k.part2_length,d.pinfo.LAMEsfbits[A][B]=k.part2_length,d.pinfo.over[A][B]=X.over_count,d.pinfo.max_noise[A][B]=X.max_noise*10,d.pinfo.over_noise[A][B]=X.over_noise*10,d.pinfo.tot_noise[A][B]=X.tot_noise*10,d.pinfo.over_SSD[A][B]=X.over_SSD}}var dg=ke.System,fg=ke.Arrays,gn=ke.new_int,Tl=ke.assert;function bn(){var e=null;this.qupvt=null,this.setModules=function(_){this.qupvt=_,e=_};function t(_){this.bits=0|_}var s=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]];function a(_,x,b,g,M,w){var j=.5946/x;for(_=_>>1;_--!=0;)M[w++]=j>b[g++]?0:1,M[w++]=j>b[g++]?0:1}function n(_,x,b,g,M,w){_=_>>1;var j=_%2;for(_=_>>1;_--!=0;){var X,F,V,f,T,W,Z,de;X=b[g++]*x,F=b[g++]*x,T=0|X,V=b[g++]*x,W=0|F,f=b[g++]*x,Z=0|V,X+=e.adj43[T],de=0|f,F+=e.adj43[W],M[w++]=0|X,V+=e.adj43[Z],M[w++]=0|F,f+=e.adj43[de],M[w++]=0|V,M[w++]=0|f}if(j!=0){var X,F,T,W;X=b[g++]*x,F=b[g++]*x,T=0|X,W=0|F,X+=e.adj43[T],F+=e.adj43[W],M[w++]=0|X,M[w++]=0|F}}function r(_,x,b,g,M){var w,j,X=0,F,V=0,f=0,T=0,W=x,Z=0,de=W,Me=0,Te=_,ve=0;for(F=M!=null&&g.global_gain==M.global_gain,g.block_type==O.SHORT_TYPE?j=38:j=21,w=0;w<=j;w++){var De=-1;if((F||g.block_type==O.NORM_TYPE)&&(De=g.global_gain-(g.scalefac[w]+(g.preflag!=0?e.pretab[w]:0)<<g.scalefac_scale+1)-g.subblock_gain[g.window[w]]*8),Tl(g.width[w]>=0),F&&M.step[w]==De)V!=0&&(n(V,b,Te,ve,de,Me),V=0),f!=0&&(a(f,b,Te,ve,de,Me),f=0);else{var Le=g.width[w];if(X+g.width[w]>g.max_nonzero_coeff){var me;me=g.max_nonzero_coeff-X+1,fg.fill(x,g.max_nonzero_coeff,576,0),Le=me,Le<0&&(Le=0),w=j+1}if(V==0&&f==0&&(de=W,Me=Z,Te=_,ve=T),M!=null&&M.sfb_count1>0&&w>=M.sfb_count1&&M.step[w]>0&&De>=M.step[w]?(V!=0&&(n(V,b,Te,ve,de,Me),V=0,de=W,Me=Z,Te=_,ve=T),f+=Le):(f!=0&&(a(f,b,Te,ve,de,Me),f=0,de=W,Me=Z,Te=_,ve=T),V+=Le),Le<=0){f!=0&&(a(f,b,Te,ve,de,Me),f=0),V!=0&&(n(V,b,Te,ve,de,Me),V=0);break}}w<=j&&(Z+=g.width[w],T+=g.width[w],X+=g.width[w])}V!=0&&(n(V,b,Te,ve,de,Me),V=0),f!=0&&(a(f,b,Te,ve,de,Me),f=0)}function o(_,x,b){var g=0,M=0;do{var w=_[x++],j=_[x++];g<w&&(g=w),M<j&&(M=j)}while(x<b);return g<M&&(g=M),g}function l(_,x,b,g,M,w){var j=re.ht[g].xlen*65536+re.ht[M].xlen,X=0,F;do{var V=_[x++],f=_[x++];V!=0&&(V>14&&(V=15,X+=j),V*=16),f!=0&&(f>14&&(f=15,X+=j),V+=f),X+=re.largetbl[V]}while(x<b);return F=X&65535,X>>=16,X>F&&(X=F,g=M),w.bits+=X,g}function v(_,x,b,g){var M=0,w=re.ht[1].hlen;do{var j=_[x+0]*2+_[x+1];x+=2,M+=w[j]}while(x<b);return g.bits+=M,1}function c(_,x,b,g,M){var w=0,j,X=re.ht[g].xlen,F;g==2?F=re.table23:F=re.table56;do{var V=_[x+0]*X+_[x+1];x+=2,w+=F[V]}while(x<b);return j=w&65535,w>>=16,w>j&&(w=j,g++),M.bits+=w,g}function m(_,x,b,g,M){var w=0,j=0,X=0,F=re.ht[g].xlen,V=re.ht[g].hlen,f=re.ht[g+1].hlen,T=re.ht[g+2].hlen;do{var W=_[x+0]*F+_[x+1];x+=2,w+=V[W],j+=f[W],X+=T[W]}while(x<b);var Z=g;return w>j&&(w=j,Z++),w>X&&(w=X,Z=g+2),M.bits+=w,Z}var u=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];function p(_,x,b,g){var M=o(_,x,b);switch(M){case 0:return M;case 1:return v(_,x,b,g);case 2:case 3:return c(_,x,b,u[M-1],g);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return m(_,x,b,u[M-1],g);default:if(M>Zt.IXMAX_VAL)return g.bits=Zt.LARGE_BITS,-1;M-=15;var w;for(w=24;w<32&&!(re.ht[w].linmax>=M);w++);var j;for(j=w-8;j<24&&!(re.ht[j].linmax>=M);j++);return l(_,x,b,j,w,g)}}this.noquant_count_bits=function(_,x,b){var g=x.l3_enc,M=Math.min(576,x.max_nonzero_coeff+2>>1<<1);for(b!=null&&(b.sfb_count1=0);M>1&&(g[M-1]|g[M-2])==0;M-=2);x.count1=M;for(var w=0,j=0;M>3;M-=4){var X;if(((g[M-1]|g[M-2]|g[M-3]|g[M-4])&2147483647)>1)break;X=((g[M-4]*2+g[M-3])*2+g[M-2])*2+g[M-1],w+=re.t32l[X],j+=re.t33l[X]}var F=w;if(x.count1table_select=0,w>j&&(F=j,x.count1table_select=1),x.count1bits=F,x.big_values=M,M==0)return F;if(x.block_type==O.SHORT_TYPE)w=3*_.scalefac_band.s[3],w>x.big_values&&(w=x.big_values),j=x.big_values;else if(x.block_type==O.NORM_TYPE){if(w=x.region0_count=_.bv_scf[M-2],j=x.region1_count=_.bv_scf[M-1],j=_.scalefac_band.l[w+j+2],w=_.scalefac_band.l[w+1],j<M){var V=new t(F);x.table_select[2]=p(g,j,M,V),F=V.bits}}else x.region0_count=7,x.region1_count=O.SBMAX_l-1-7-1,w=_.scalefac_band.l[7+1],j=M,w>j&&(w=j);if(w=Math.min(w,M),j=Math.min(j,M),w>0){var V=new t(F);x.table_select[0]=p(g,0,w,V),F=V.bits}if(w<j){var V=new t(F);x.table_select[1]=p(g,w,j,V),F=V.bits}if(_.use_best_huffman==2&&(x.part2_3_length=F,best_huffman_divide(_,x),F=x.part2_3_length),b!=null&&x.block_type==O.NORM_TYPE){for(var f=0;_.scalefac_band.l[f]<x.big_values;)f++;b.sfb_count1=f}return F},this.count_bits=function(_,x,b,g){var M=b.l3_enc,w=Zt.IXMAX_VAL/e.IPOW20(b.global_gain);if(b.xrpow_max>w)return Zt.LARGE_BITS;if(r(x,M,e.IPOW20(b.global_gain),b,g),(_.substep_shaping&2)!=0)for(var j=0,X=b.global_gain+b.scalefac_scale,F=.634521682242439/e.IPOW20(X),V=0;V<b.sfbmax;V++){var f=b.width[V];if(_.pseudohalf[V]==0)j+=f;else{var T;for(T=j,j+=f;T<j;++T)M[T]=x[T]>=F?M[T]:0}}return this.noquant_count_bits(_,b,g)};function y(_,x,b,g,M,w,j){for(var X=x.big_values,F=0;F<=7+15;F++)g[F]=Zt.LARGE_BITS;for(var F=0;F<16;F++){var V=_.scalefac_band.l[F+1];if(V>=X)break;var f=0,T=new t(f),W=p(b,0,V,T);f=T.bits;for(var Z=0;Z<8;Z++){var de=_.scalefac_band.l[F+Z+2];if(de>=X)break;var Me=f;T=new t(Me);var Te=p(b,V,de,T);Me=T.bits,g[F+Z]>Me&&(g[F+Z]=Me,M[F+Z]=F,w[F+Z]=W,j[F+Z]=Te)}}}function i(_,x,b,g,M,w,j,X){for(var F=x.big_values,V=2;V<O.SBMAX_l+1;V++){var f=_.scalefac_band.l[V];if(f>=F)break;var T=M[V-2]+x.count1bits;if(b.part2_3_length<=T)break;var W=new t(T),Z=p(g,f,F,W);T=W.bits,!(b.part2_3_length<=T)&&(b.assign(x),b.part2_3_length=T,b.region0_count=w[V-2],b.region1_count=V-2-w[V-2],b.table_select[0]=j[V-2],b.table_select[1]=X[V-2],b.table_select[2]=Z)}}this.best_huffman_divide=function(_,x){var b=new Ci,g=x.l3_enc,M=gn(7+15+1),w=gn(7+15+1),j=gn(7+15+1),X=gn(7+15+1);if(!(x.block_type==O.SHORT_TYPE&&_.mode_gr==1)){b.assign(x),x.block_type==O.NORM_TYPE&&(y(_,x,g,M,w,j,X),i(_,b,x,g,M,w,j,X));var F=b.big_values;if(!(F==0||(g[F-2]|g[F-1])>1)&&(F=x.count1+2,!(F>576))){b.assign(x),b.count1=F;for(var V=0,f=0;F>b.big_values;F-=4){var T=((g[F-4]*2+g[F-3])*2+g[F-2])*2+g[F-1];V+=re.t32l[T],f+=re.t33l[T]}if(b.big_values=F,b.count1table_select=0,V>f&&(V=f,b.count1table_select=1),b.count1bits=V,b.block_type==O.NORM_TYPE)i(_,b,x,g,M,w,j,X);else{if(b.part2_3_length=V,V=_.scalefac_band.l[7+1],V>F&&(V=F),V>0){var W=new t(b.part2_3_length);b.table_select[0]=p(g,0,V,W),b.part2_3_length=W.bits}if(F>V){var W=new t(b.part2_3_length);b.table_select[1]=p(g,V,F,W),b.part2_3_length=W.bits}x.part2_3_length>b.part2_3_length&&x.assign(b)}}}};var H=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],L=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],N=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],h=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];bn.slen1_tab=N,bn.slen2_tab=h;function k(_,x){for(var b,g=x.tt[1][_],M=x.tt[0][_],w=0;w<re.scfsi_band.length-1;w++){for(b=re.scfsi_band[w];b<re.scfsi_band[w+1]&&!(M.scalefac[b]!=g.scalefac[b]&&g.scalefac[b]>=0);b++);if(b==re.scfsi_band[w+1]){for(b=re.scfsi_band[w];b<re.scfsi_band[w+1];b++)g.scalefac[b]=-1;x.scfsi[_][w]=1}}var j=0,X=0;for(b=0;b<11;b++)g.scalefac[b]!=-1&&(X++,j<g.scalefac[b]&&(j=g.scalefac[b]));for(var F=0,V=0;b<O.SBPSY_l;b++)g.scalefac[b]!=-1&&(V++,F<g.scalefac[b]&&(F=g.scalefac[b]));for(var w=0;w<16;w++)if(j<H[w]&&F<L[w]){var f=N[w]*X+h[w]*V;g.part2_length>f&&(g.part2_length=f,g.scalefac_compress=w)}}this.best_scalefac_store=function(_,x,b,g){var M=g.tt[x][b],w,j,X,F,V=0;for(X=0,w=0;w<M.sfbmax;w++){var f=M.width[w];for(X+=f,F=-f;F<0&&M.l3_enc[F+X]==0;F++);F==0&&(M.scalefac[w]=V=-2)}if(M.scalefac_scale==0&&M.preflag==0){var T=0;for(w=0;w<M.sfbmax;w++)M.scalefac[w]>0&&(T|=M.scalefac[w]);if((T&1)==0&&T!=0){for(w=0;w<M.sfbmax;w++)M.scalefac[w]>0&&(M.scalefac[w]>>=1);M.scalefac_scale=V=1}}if(M.preflag==0&&M.block_type!=O.SHORT_TYPE&&_.mode_gr==2){for(w=11;w<O.SBPSY_l&&!(M.scalefac[w]<e.pretab[w]&&M.scalefac[w]!=-2);w++);if(w==O.SBPSY_l){for(w=11;w<O.SBPSY_l;w++)M.scalefac[w]>0&&(M.scalefac[w]-=e.pretab[w]);M.preflag=V=1}}for(j=0;j<4;j++)g.scfsi[b][j]=0;for(_.mode_gr==2&&x==1&&g.tt[0][b].block_type!=O.SHORT_TYPE&&g.tt[1][b].block_type!=O.SHORT_TYPE&&(k(b,g),V=0),w=0;w<M.sfbmax;w++)M.scalefac[w]==-2&&(M.scalefac[w]=0);V!=0&&(_.mode_gr==2?this.scale_bitcount(M):this.scale_bitcount_lsf(_,M))};function C(_,x){for(var b=0;b<x;++b)if(_[b]<0)return!1;return!0}var A=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],B=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],d=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(_){var x,b,g=0,M=0,w,j=_.scalefac;if(Tl(C(j,_.sfbmax)),_.block_type==O.SHORT_TYPE)w=A,_.mixed_block_flag!=0&&(w=B);else if(w=d,_.preflag==0){for(b=11;b<O.SBPSY_l&&!(j[b]<e.pretab[b]);b++);if(b==O.SBPSY_l)for(_.preflag=1,b=11;b<O.SBPSY_l;b++)j[b]-=e.pretab[b]}for(b=0;b<_.sfbdivide;b++)g<j[b]&&(g=j[b]);for(;b<_.sfbmax;b++)M<j[b]&&(M=j[b]);for(_.part2_length=Zt.LARGE_BITS,x=0;x<16;x++)g<H[x]&&M<L[x]&&_.part2_length>w[x]&&(_.part2_length=w[x],_.scalefac_compress=x);return _.part2_length==Zt.LARGE_BITS};var E=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(_,x){var b,g,M,w,j,X,F,V,f=gn(4),T=x.scalefac;for(x.preflag!=0?b=2:b=0,F=0;F<4;F++)f[F]=0;if(x.block_type==O.SHORT_TYPE){g=1;var W=e.nr_of_sfb_block[b][g];for(V=0,M=0;M<4;M++)for(w=W[M]/3,F=0;F<w;F++,V++)for(j=0;j<3;j++)T[V*3+j]>f[M]&&(f[M]=T[V*3+j])}else{g=0;var W=e.nr_of_sfb_block[b][g];for(V=0,M=0;M<4;M++)for(w=W[M],F=0;F<w;F++,V++)T[V]>f[M]&&(f[M]=T[V])}for(X=!1,M=0;M<4;M++)f[M]>E[b][M]&&(X=!0);if(!X){var Z,de,Me,Te;for(x.sfb_partition_table=e.nr_of_sfb_block[b][g],M=0;M<4;M++)x.slen[M]=S[f[M]];switch(Z=x.slen[0],de=x.slen[1],Me=x.slen[2],Te=x.slen[3],b){case 0:x.scalefac_compress=(Z*5+de<<4)+(Me<<2)+Te;break;case 1:x.scalefac_compress=400+(Z*5+de<<2)+Me;break;case 2:x.scalefac_compress=500+Z*3+de;break;default:dg.err.printf(`intensity stereo not implemented yet
`);break}}if(!X)for(Tl(x.sfb_partition_table!=null),x.part2_length=0,M=0;M<4;M++)x.part2_length+=x.slen[M]*x.sfb_partition_table[M];return X};var S=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(_){for(var x=2;x<=576;x+=2){for(var b=0,g;_.scalefac_band.l[++b]<x;);for(g=s[b][0];_.scalefac_band.l[g+1]>x;)g--;for(g<0&&(g=s[b][0]),_.bv_scf[x-2]=g,g=s[b][1];_.scalefac_band.l[g+_.bv_scf[x-2]+2]>x;)g--;g<0&&(g=s[b][1]),_.bv_scf[x-1]=g}}}var Ks=ke.System,mg=ke.Arrays,hg=ke.new_byte,vg=ke.new_float_n,_g=ke.new_int,Ft=ke.assert;As.EQ=function(e,t){return Math.abs(e)>Math.abs(t)?Math.abs(e-t)<=Math.abs(e)*1e-6:Math.abs(e-t)<=Math.abs(t)*1e-6},As.NEQ=function(e,t){return!As.EQ(e,t)};function As(){var e=this,t=32773,s=null,a=null,n=null,r=null;this.setModules=function(E,S,_,x){s=E,a=S,n=_,r=x};var o=null,l=0,v=0,c=0;this.getframebits=function(E){var S=E.internal_flags,_;S.bitrate_index!=0?_=re.bitrate_table[E.version][S.bitrate_index]:_=E.brate;var x=0|(E.version+1)*72e3*_/E.out_samplerate+S.padding;return 8*x};function m(E){Ks.arraycopy(E.header[E.w_ptr].buf,0,o,v,E.sideinfo_len),v+=E.sideinfo_len,l+=E.sideinfo_len*8,E.w_ptr=E.w_ptr+1&ft.MAX_HEADER_BUF-1}function u(E,S,_){for(;_>0;){var x;c==0&&(c=8,v++,Ft(E.header[E.w_ptr].write_timing>=l),E.header[E.w_ptr].write_timing==l&&m(E),o[v]=0),x=Math.min(_,c),_-=x,c-=x,o[v]|=S>>_<<c,l+=x}}function p(E,S,_){for(;_>0;){var x;c==0&&(c=8,v++,o[v]=0),x=Math.min(_,c),_-=x,c-=x,o[v]|=S>>_<<c,l+=x}}function y(E,S){var _=E.internal_flags,x;if(S>=8&&(u(_,76,8),S-=8),S>=8&&(u(_,65,8),S-=8),S>=8&&(u(_,77,8),S-=8),S>=8&&(u(_,69,8),S-=8),S>=32){var b=n.getLameShortVersion();if(S>=32)for(x=0;x<b.length&&S>=8;++x)S-=8,u(_,b.charAt(x),8)}for(;S>=1;S-=1)u(_,_.ancillary_flag,1),_.ancillary_flag^=E.disable_reservoir?0:1}function i(E,S,_){for(var x=E.header[E.h_ptr].ptr;_>0;){var b=Math.min(_,8-(x&7));_-=b,E.header[E.h_ptr].buf[x>>3]|=S>>_<<8-(x&7)-b,x+=b}E.header[E.h_ptr].ptr=x}function H(E,S){E<<=8;for(var _=0;_<8;_++)E<<=1,S<<=1,((S^E)&65536)!=0&&(S^=t);return S}this.CRC_writeheader=function(E,S){var _=65535;_=H(S[2]&255,_),_=H(S[3]&255,_);for(var x=6;x<E.sideinfo_len;x++)_=H(S[x]&255,_);S[4]=byte(_>>8),S[5]=byte(_&255)};function L(E,S){var _=E.internal_flags,x,b,g;if(x=_.l3_side,_.header[_.h_ptr].ptr=0,mg.fill(_.header[_.h_ptr].buf,0,_.sideinfo_len,0),E.out_samplerate<16e3?i(_,4094,12):i(_,4095,12),i(_,E.version,1),i(_,4-3,2),i(_,E.error_protection?0:1,1),i(_,_.bitrate_index,4),i(_,_.samplerate_index,2),i(_,_.padding,1),i(_,E.extension,1),i(_,E.mode.ordinal(),2),i(_,_.mode_ext,2),i(_,E.copyright,1),i(_,E.original,1),i(_,E.emphasis,2),E.error_protection&&i(_,0,16),E.version==1){for(Ft(x.main_data_begin>=0),i(_,x.main_data_begin,9),_.channels_out==2?i(_,x.private_bits,3):i(_,x.private_bits,5),g=0;g<_.channels_out;g++){var M;for(M=0;M<4;M++)i(_,x.scfsi[g][M],1)}for(b=0;b<2;b++)for(g=0;g<_.channels_out;g++){var w=x.tt[b][g];i(_,w.part2_3_length+w.part2_length,12),i(_,w.big_values/2,9),i(_,w.global_gain,8),i(_,w.scalefac_compress,4),w.block_type!=O.NORM_TYPE?(i(_,1,1),i(_,w.block_type,2),i(_,w.mixed_block_flag,1),w.table_select[0]==14&&(w.table_select[0]=16),i(_,w.table_select[0],5),w.table_select[1]==14&&(w.table_select[1]=16),i(_,w.table_select[1],5),i(_,w.subblock_gain[0],3),i(_,w.subblock_gain[1],3),i(_,w.subblock_gain[2],3)):(i(_,0,1),w.table_select[0]==14&&(w.table_select[0]=16),i(_,w.table_select[0],5),w.table_select[1]==14&&(w.table_select[1]=16),i(_,w.table_select[1],5),w.table_select[2]==14&&(w.table_select[2]=16),i(_,w.table_select[2],5),Ft(w.region0_count>=0&&w.region0_count<16),Ft(w.region1_count>=0&&w.region1_count<8),i(_,w.region0_count,4),i(_,w.region1_count,3)),i(_,w.preflag,1),i(_,w.scalefac_scale,1),i(_,w.count1table_select,1)}}else for(Ft(x.main_data_begin>=0),i(_,x.main_data_begin,8),i(_,x.private_bits,_.channels_out),b=0,g=0;g<_.channels_out;g++){var w=x.tt[b][g];i(_,w.part2_3_length+w.part2_length,12),i(_,w.big_values/2,9),i(_,w.global_gain,8),i(_,w.scalefac_compress,9),w.block_type!=O.NORM_TYPE?(i(_,1,1),i(_,w.block_type,2),i(_,w.mixed_block_flag,1),w.table_select[0]==14&&(w.table_select[0]=16),i(_,w.table_select[0],5),w.table_select[1]==14&&(w.table_select[1]=16),i(_,w.table_select[1],5),i(_,w.subblock_gain[0],3),i(_,w.subblock_gain[1],3),i(_,w.subblock_gain[2],3)):(i(_,0,1),w.table_select[0]==14&&(w.table_select[0]=16),i(_,w.table_select[0],5),w.table_select[1]==14&&(w.table_select[1]=16),i(_,w.table_select[1],5),w.table_select[2]==14&&(w.table_select[2]=16),i(_,w.table_select[2],5),Ft(w.region0_count>=0&&w.region0_count<16),Ft(w.region1_count>=0&&w.region1_count<8),i(_,w.region0_count,4),i(_,w.region1_count,3)),i(_,w.scalefac_scale,1),i(_,w.count1table_select,1)}E.error_protection&&CRC_writeheader(_,_.header[_.h_ptr].buf);{var j=_.h_ptr;Ft(_.header[j].ptr==_.sideinfo_len*8),_.h_ptr=j+1&ft.MAX_HEADER_BUF-1,_.header[_.h_ptr].write_timing=_.header[j].write_timing+S,_.h_ptr==_.w_ptr&&Ks.err.println(`Error: MAX_HEADER_BUF too small in bitstream.c 
`)}}function N(E,S){var _=re.ht[S.count1table_select+32],x,b=0,g=S.big_values,M=S.big_values;for(Ft(S.count1table_select<2),x=(S.count1-S.big_values)/4;x>0;--x){var w=0,j=0,X;X=S.l3_enc[g+0],X!=0&&(j+=8,S.xr[M+0]<0&&w++),X=S.l3_enc[g+1],X!=0&&(j+=4,w*=2,S.xr[M+1]<0&&w++),X=S.l3_enc[g+2],X!=0&&(j+=2,w*=2,S.xr[M+2]<0&&w++),X=S.l3_enc[g+3],X!=0&&(j++,w*=2,S.xr[M+3]<0&&w++),g+=4,M+=4,u(E,w+_.table[j],_.hlen[j]),b+=_.hlen[j]}return b}function h(E,S,_,x,b){var g=re.ht[S],M=0;if(S==0)return M;for(var w=_;w<x;w+=2){var j=0,X=0,F=g.xlen,V=g.xlen,f=0,T=b.l3_enc[w],W=b.l3_enc[w+1];if(T!=0&&(b.xr[w]<0&&f++,j--),S>15){if(T>14){var Z=T-15;Ft(Z<=g.linmax),f|=Z<<1,X=F,T=15}if(W>14){var de=W-15;Ft(de<=g.linmax),f<<=F,f|=de,X+=F,W=15}V=16}W!=0&&(f<<=1,b.xr[w+1]<0&&f++,j--),T=T*V+W,X-=j,j+=g.hlen[T],u(E,g.table[T],j),u(E,f,X),M+=j+X}return M}function k(E,S){var _=3*E.scalefac_band.s[3];_>S.big_values&&(_=S.big_values);var x=h(E,S.table_select[0],0,_,S);return x+=h(E,S.table_select[1],_,S.big_values,S),x}function C(E,S){var _,x,b,g;_=S.big_values;var M=S.region0_count+1;return Ft(M<E.scalefac_band.l.length),b=E.scalefac_band.l[M],M+=S.region1_count+1,Ft(M<E.scalefac_band.l.length),g=E.scalefac_band.l[M],b>_&&(b=_),g>_&&(g=_),x=h(E,S.table_select[0],0,b,S),x+=h(E,S.table_select[1],b,g,S),x+=h(E,S.table_select[2],g,_,S),x}function A(E){var S,_,x,b,g=0,M=E.internal_flags,w=M.l3_side;if(E.version==1)for(S=0;S<2;S++)for(_=0;_<M.channels_out;_++){var j=w.tt[S][_],X=bn.slen1_tab[j.scalefac_compress],F=bn.slen2_tab[j.scalefac_compress];for(b=0,x=0;x<j.sfbdivide;x++)j.scalefac[x]!=-1&&(u(M,j.scalefac[x],X),b+=X);for(;x<j.sfbmax;x++)j.scalefac[x]!=-1&&(u(M,j.scalefac[x],F),b+=F);Ft(b==j.part2_length),j.block_type==O.SHORT_TYPE?b+=k(M,j):b+=C(M,j),b+=N(M,j),Ft(b==j.part2_3_length+j.part2_length),g+=b}else for(S=0,_=0;_<M.channels_out;_++){var j=w.tt[S][_],V,f,T=0;if(Ft(j.sfb_partition_table!=null),b=0,x=0,f=0,j.block_type==O.SHORT_TYPE){for(;f<4;f++){var W=j.sfb_partition_table[f]/3,Z=j.slen[f];for(V=0;V<W;V++,x++)u(M,Math.max(j.scalefac[x*3+0],0),Z),u(M,Math.max(j.scalefac[x*3+1],0),Z),u(M,Math.max(j.scalefac[x*3+2],0),Z),T+=3*Z}b+=k(M,j)}else{for(;f<4;f++){var W=j.sfb_partition_table[f],Z=j.slen[f];for(V=0;V<W;V++,x++)u(M,Math.max(j.scalefac[x],0),Z),T+=Z}b+=C(M,j)}b+=N(M,j),Ft(b==j.part2_3_length),Ft(T==j.part2_length),g+=T+b}return g}function B(){this.total=0}function d(E,S){var _=E.internal_flags,x,b,g,M,w;return w=_.w_ptr,M=_.h_ptr-1,M==-1&&(M=ft.MAX_HEADER_BUF-1),x=_.header[M].write_timing-l,S.total=x,x>=0&&(b=1+M-w,M<w&&(b=1+M-w+ft.MAX_HEADER_BUF),x-=b*8*_.sideinfo_len),g=e.getframebits(E),x+=g,S.total+=g,S.total%8!=0?S.total=1+S.total/8:S.total=S.total/8,S.total+=v+1,x<0&&Ks.err.println(`strange error flushing buffer ... 
`),x}this.flush_bitstream=function(E){var S=E.internal_flags,_,x,b=S.h_ptr-1;if(b==-1&&(b=ft.MAX_HEADER_BUF-1),_=S.l3_side,!((x=d(E,new B))<0)){if(y(E,x),Ft(S.header[b].write_timing+this.getframebits(E)==l),S.ResvSize=0,_.main_data_begin=0,S.findReplayGain){var g=s.GetTitleGain(S.rgdata);Ft(NEQ(g,GainAnalysis.GAIN_NOT_ENOUGH_SAMPLES)),S.RadioGain=Math.floor(g*10+.5)|0}S.findPeakSample&&(S.noclipGainChange=Math.ceil(Math.log10(S.PeakSample/32767)*20*10)|0,S.noclipGainChange>0&&(EQ(E.scale,1)||EQ(E.scale,0))?S.noclipScale=Math.floor(32767/S.PeakSample*100)/100:S.noclipScale=-1)}},this.add_dummy_byte=function(E,S,_){for(var x=E.internal_flags,b;_-- >0;)for(p(x,S,8),b=0;b<ft.MAX_HEADER_BUF;++b)x.header[b].write_timing+=8},this.format_bitstream=function(E){var S=E.internal_flags,_;_=S.l3_side;var x=this.getframebits(E);y(E,_.resvDrain_pre),L(E,x);var b=8*S.sideinfo_len;if(b+=A(E),y(E,_.resvDrain_post),b+=_.resvDrain_post,_.main_data_begin+=(x-b)/8,d(E,new B)!=S.ResvSize&&Ks.err.println("Internal buffer inconsistency. flushbits <> ResvSize"),_.main_data_begin*8!=S.ResvSize&&(Ks.err.printf(`bit reservoir error: 
l3_side.main_data_begin: %d 
Resvoir size:             %d 
resv drain (post)         %d 
resv drain (pre)          %d 
header and sideinfo:      %d 
data bits:                %d 
total bits:               %d (remainder: %d) 
bitsperframe:             %d 
`,8*_.main_data_begin,S.ResvSize,_.resvDrain_post,_.resvDrain_pre,8*S.sideinfo_len,b-_.resvDrain_post-8*S.sideinfo_len,b,b%8,x),Ks.err.println("This is a fatal error.  It has several possible causes:"),Ks.err.println("90%%  LAME compiled with buggy version of gcc using advanced optimizations"),Ks.err.println(" 9%%  Your system is overclocked"),Ks.err.println(" 1%%  bug in LAME encoding library"),S.ResvSize=_.main_data_begin*8),l>1e9){var g;for(g=0;g<ft.MAX_HEADER_BUF;++g)S.header[g].write_timing-=l;l=0}return 0},this.copy_buffer=function(E,S,_,x,b){var g=v+1;if(g<=0)return 0;if(x!=0&&g>x)return-1;if(Ks.arraycopy(o,0,S,_,g),v=-1,c=0,b!=0){var M=_g(1);if(M[0]=E.nMusicCRC,r.updateMusicCRC(M,S,_,g),E.nMusicCRC=M[0],g>0&&(E.VBR_seek_table.nBytesWritten+=g),E.decode_on_the_fly){for(var w=vg([2,1152]),j=g,X=-1,F;X!=0;)if(X=a.hip_decode1_unclipped(E.hip,S,_,j,w[0],w[1]),j=0,X==-1&&(X=0),X>0){if(E.findPeakSample){for(F=0;F<X;F++)w[0][F]>E.PeakSample?E.PeakSample=w[0][F]:-w[0][F]>E.PeakSample&&(E.PeakSample=-w[0][F]);if(E.channels_out>1)for(F=0;F<X;F++)w[1][F]>E.PeakSample?E.PeakSample=w[1][F]:-w[1][F]>E.PeakSample&&(E.PeakSample=-w[1][F])}if(E.findReplayGain&&s.AnalyzeSamples(E.rgdata,w[0],0,w[1],0,X,E.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6}}}return g},this.init_bit_stream_w=function(E){o=hg(Je.LAME_MAXMP3BUFFER),E.h_ptr=E.w_ptr=0,E.header[E.h_ptr].write_timing=0,v=-1,c=0,l=0}}var pg=ke.System,Et=ke.VbrMode,El=ke.ShortBlock,Qa=ke.new_float,Gu=ke.new_int_n,gg=ke.new_short_n,ya=ke.assert;function Je(){var e=this,t=128*1024;Je.V9=410,Je.V8=420,Je.V7=430,Je.V6=440,Je.V5=450,Je.V4=460,Je.V3=470,Je.V2=480,Je.V1=490,Je.V0=500,Je.R3MIX=1e3,Je.STANDARD=1001,Je.EXTREME=1002,Je.INSANE=1003,Je.STANDARD_FAST=1004,Je.EXTREME_FAST=1005,Je.MEDIUM=1006,Je.MEDIUM_FAST=1007;var s=16384+t;Je.LAME_MAXMP3BUFFER=s;var a,n,r,o,l,v=new wl,c,m,u;this.enc=new O,this.setModules=function(f,T,W,Z,de,Me,Te,ve,De){a=f,n=T,r=W,o=Z,l=de,c=Me,m=ve,u=De,this.enc.setModules(n,v,o,c)};function p(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=Qa(O.SBMAX_l),this.bo_s_weight=Qa(O.SBMAX_s)}function y(){this.lowerlimit=0}function i(f,T){this.lowpass=T}var H=4294479419;function L(f){var T;return f.class_id=H,T=f.internal_flags=new ft,f.mode=vt.NOT_SET,f.original=1,f.in_samplerate=44100,f.num_channels=2,f.num_samples=-1,f.bWriteVbrTag=!0,f.quality=-1,f.short_blocks=null,T.subblock_gain=-1,f.lowpassfreq=0,f.highpassfreq=0,f.lowpasswidth=-1,f.highpasswidth=-1,f.VBR=Et.vbr_off,f.VBR_q=4,f.ATHcurve=-1,f.VBR_mean_bitrate_kbps=128,f.VBR_min_bitrate_kbps=0,f.VBR_max_bitrate_kbps=0,f.VBR_hard_min=0,T.VBR_min_bitrate=1,T.VBR_max_bitrate=13,f.quant_comp=-1,f.quant_comp_short=-1,f.msfix=-1,T.resample_ratio=1,T.OldValue[0]=180,T.OldValue[1]=180,T.CurrentStep[0]=4,T.CurrentStep[1]=4,T.masking_lower=1,T.nsPsy.attackthre=-1,T.nsPsy.attackthre_s=-1,f.scale=-1,f.athaa_type=-1,f.ATHtype=-1,f.athaa_loudapprox=-1,f.athaa_sensitivity=0,f.useTemporal=null,f.interChRatio=-1,T.mf_samples_to_encode=O.ENCDELAY+O.POSTDELAY,f.encoder_padding=0,T.mf_size=O.ENCDELAY-O.MDCTDELAY,f.findReplayGain=!1,f.decode_on_the_fly=!1,T.decode_on_the_fly=!1,T.findReplayGain=!1,T.findPeakSample=!1,T.RadioGain=0,T.AudiophileGain=0,T.noclipGainChange=0,T.noclipScale=-1,f.preset=0,f.write_id3tag_automatic=!0,0}this.lame_init=function(){var f=new Q3;return L(f),f.lame_allocated_gfp=1,f};function N(f){return f>1?0:f<=0?1:Math.cos(Math.PI/2*f)}this.nearestBitrateFullIndex=function(f){var T=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],W=0,Z=0,de=0,Me=0;Me=T[16],de=16,Z=T[16],W=16;for(var Te=0;Te<16;Te++)if(Math.max(f,T[Te+1])!=f){Me=T[Te+1],de=Te+1,Z=T[Te],W=Te;break}return Me-f>f-Z?W:de};function h(f,T){var W=44100;return T>=48e3?W=48e3:T>=44100?W=44100:T>=32e3?W=32e3:T>=24e3?W=24e3:T>=22050?W=22050:T>=16e3?W=16e3:T>=12e3?W=12e3:T>=11025?W=11025:T>=8e3&&(W=8e3),f==-1?W:(f<=15960&&(W=44100),f<=15250&&(W=32e3),f<=11220&&(W=24e3),f<=9970&&(W=22050),f<=7230&&(W=16e3),f<=5420&&(W=12e3),f<=4510&&(W=11025),f<=3970&&(W=8e3),T<W?T>44100?48e3:T>32e3?44100:T>24e3?32e3:T>22050?24e3:T>16e3?22050:T>12e3?16e3:T>11025?12e3:T>8e3?11025:8e3:W)}function k(f,T){switch(f){case 44100:return T.version=1,0;case 48e3:return T.version=1,1;case 32e3:return T.version=1,2;case 22050:return T.version=0,0;case 24e3:return T.version=0,1;case 16e3:return T.version=0,2;case 11025:return T.version=0,0;case 12e3:return T.version=0,1;case 8e3:return T.version=0,2;default:return T.version=0,-1}}function C(f,T,W){W<16e3&&(T=2);for(var Z=re.bitrate_table[T][1],de=2;de<=14;de++)re.bitrate_table[T][de]>0&&Math.abs(re.bitrate_table[T][de]-f)<Math.abs(Z-f)&&(Z=re.bitrate_table[T][de]);return Z}function A(f,T,W){W<16e3&&(T=2);for(var Z=0;Z<=14;Z++)if(re.bitrate_table[T][Z]>0&&re.bitrate_table[T][Z]==f)return Z;return-1}function B(f,T){var W=[new i(8,2e3),new i(16,3700),new i(24,3900),new i(32,5500),new i(40,7e3),new i(48,7500),new i(56,1e4),new i(64,11e3),new i(80,13500),new i(96,15100),new i(112,15600),new i(128,17e3),new i(160,17500),new i(192,18600),new i(224,19400),new i(256,19700),new i(320,20500)],Z=e.nearestBitrateFullIndex(T);f.lowerlimit=W[Z].lowpass}function d(f){var T=f.internal_flags,W=32,Z=-1;if(T.lowpass1>0){for(var de=999,Me=0;Me<=31;Me++){var Te=Me/31;Te>=T.lowpass2&&(W=Math.min(W,Me)),T.lowpass1<Te&&Te<T.lowpass2&&(de=Math.min(de,Me))}de==999?T.lowpass1=(W-.75)/31:T.lowpass1=(de-.75)/31,T.lowpass2=W/31}if(T.highpass2>0&&T.highpass2<.9*(.75/31)&&(T.highpass1=0,T.highpass2=0,pg.err.println(`Warning: highpass filter disabled.  highpass frequency too small
`)),T.highpass2>0){for(var ve=-1,Me=0;Me<=31;Me++){var Te=Me/31;Te<=T.highpass1&&(Z=Math.max(Z,Me)),T.highpass1<Te&&Te<T.highpass2&&(ve=Math.max(ve,Me))}T.highpass1=Z/31,ve==-1?T.highpass2=(Z+.75)/31:T.highpass2=(ve+.75)/31}for(var Me=0;Me<32;Me++){var De,Le,Te=Me/31;T.highpass2>T.highpass1?De=N((T.highpass2-Te)/(T.highpass2-T.highpass1+1e-20)):De=1,T.lowpass2>T.lowpass1?Le=N((Te-T.lowpass1)/(T.lowpass2-T.lowpass1+1e-20)):Le=1,T.amp_filter[Me]=De*Le}}function E(f){var T=f.internal_flags;switch(f.quality){default:case 9:T.psymodel=0,T.noise_shaping=0,T.noise_shaping_amp=0,T.noise_shaping_stop=0,T.use_best_huffman=0,T.full_outer_loop=0;break;case 8:f.quality=7;case 7:T.psymodel=1,T.noise_shaping=0,T.noise_shaping_amp=0,T.noise_shaping_stop=0,T.use_best_huffman=0,T.full_outer_loop=0;break;case 6:T.psymodel=1,T.noise_shaping==0&&(T.noise_shaping=1),T.noise_shaping_amp=0,T.noise_shaping_stop=0,T.subblock_gain==-1&&(T.subblock_gain=1),T.use_best_huffman=0,T.full_outer_loop=0;break;case 5:T.psymodel=1,T.noise_shaping==0&&(T.noise_shaping=1),T.noise_shaping_amp=0,T.noise_shaping_stop=0,T.subblock_gain==-1&&(T.subblock_gain=1),T.use_best_huffman=0,T.full_outer_loop=0;break;case 4:T.psymodel=1,T.noise_shaping==0&&(T.noise_shaping=1),T.noise_shaping_amp=0,T.noise_shaping_stop=0,T.subblock_gain==-1&&(T.subblock_gain=1),T.use_best_huffman=1,T.full_outer_loop=0;break;case 3:T.psymodel=1,T.noise_shaping==0&&(T.noise_shaping=1),T.noise_shaping_amp=1,T.noise_shaping_stop=1,T.subblock_gain==-1&&(T.subblock_gain=1),T.use_best_huffman=1,T.full_outer_loop=0;break;case 2:T.psymodel=1,T.noise_shaping==0&&(T.noise_shaping=1),T.substep_shaping==0&&(T.substep_shaping=2),T.noise_shaping_amp=1,T.noise_shaping_stop=1,T.subblock_gain==-1&&(T.subblock_gain=1),T.use_best_huffman=1,T.full_outer_loop=0;break;case 1:T.psymodel=1,T.noise_shaping==0&&(T.noise_shaping=1),T.substep_shaping==0&&(T.substep_shaping=2),T.noise_shaping_amp=2,T.noise_shaping_stop=1,T.subblock_gain==-1&&(T.subblock_gain=1),T.use_best_huffman=1,T.full_outer_loop=0;break;case 0:T.psymodel=1,T.noise_shaping==0&&(T.noise_shaping=1),T.substep_shaping==0&&(T.substep_shaping=2),T.noise_shaping_amp=2,T.noise_shaping_stop=1,T.subblock_gain==-1&&(T.subblock_gain=1),T.use_best_huffman=1,T.full_outer_loop=0;break}}function S(f){var T=f.internal_flags;f.frameNum=0,f.write_id3tag_automatic&&m.id3tag_write_v2(f),T.bitrate_stereoMode_Hist=Gu([16,4+1]),T.bitrate_blockType_Hist=Gu([16,4+1+1]),T.PeakSample=0,f.bWriteVbrTag&&c.InitVbrTag(f)}this.lame_init_params=function(f){var T=f.internal_flags;if(T.Class_ID=0,T.ATH==null&&(T.ATH=new ig),T.PSY==null&&(T.PSY=new p),T.rgdata==null&&(T.rgdata=new og),T.channels_in=f.num_channels,T.channels_in==1&&(f.mode=vt.MONO),T.channels_out=f.mode==vt.MONO?1:2,T.mode_ext=O.MPG_MD_MS_LR,f.mode==vt.MONO&&(f.force_ms=!1),f.VBR==Et.vbr_off&&f.VBR_mean_bitrate_kbps!=128&&f.brate==0&&(f.brate=f.VBR_mean_bitrate_kbps),f.VBR==Et.vbr_off||f.VBR==Et.vbr_mtrh||f.VBR==Et.vbr_mt||(f.free_format=!1),f.VBR==Et.vbr_off&&f.brate==0&&As.EQ(f.compression_ratio,0)&&(f.compression_ratio=11.025),f.VBR==Et.vbr_off&&f.compression_ratio>0&&(f.out_samplerate==0&&(f.out_samplerate=map2MP3Frequency(int(.97*f.in_samplerate))),f.brate=0|f.out_samplerate*16*T.channels_out/(1e3*f.compression_ratio),T.samplerate_index=k(f.out_samplerate,f),f.free_format||(f.brate=C(f.brate,f.version,f.out_samplerate))),f.out_samplerate!=0&&(f.out_samplerate<16e3?(f.VBR_mean_bitrate_kbps=Math.max(f.VBR_mean_bitrate_kbps,8),f.VBR_mean_bitrate_kbps=Math.min(f.VBR_mean_bitrate_kbps,64)):f.out_samplerate<32e3?(f.VBR_mean_bitrate_kbps=Math.max(f.VBR_mean_bitrate_kbps,8),f.VBR_mean_bitrate_kbps=Math.min(f.VBR_mean_bitrate_kbps,160)):(f.VBR_mean_bitrate_kbps=Math.max(f.VBR_mean_bitrate_kbps,32),f.VBR_mean_bitrate_kbps=Math.min(f.VBR_mean_bitrate_kbps,320))),f.lowpassfreq==0){var W=16e3;switch(f.VBR){case Et.vbr_off:{var Z=new y;B(Z,f.brate),W=Z.lowerlimit;break}case Et.vbr_abr:{var Z=new y;B(Z,f.VBR_mean_bitrate_kbps),W=Z.lowerlimit;break}case Et.vbr_rh:{var de=[19500,19e3,18600,18e3,17500,16e3,15600,14900,12500,1e4,3950];if(f.VBR_q>=0&&f.VBR_q<=9){var Me=de[f.VBR_q],Te=de[f.VBR_q+1],ve=f.VBR_q_frac;W=linear_int(Me,Te,ve)}else W=19500;break}default:{var de=[19500,19e3,18500,18e3,17500,16500,15500,14500,12500,9500,3950];if(f.VBR_q>=0&&f.VBR_q<=9){var Me=de[f.VBR_q],Te=de[f.VBR_q+1],ve=f.VBR_q_frac;W=linear_int(Me,Te,ve)}else W=19500}}f.mode==vt.MONO&&(f.VBR==Et.vbr_off||f.VBR==Et.vbr_abr)&&(W*=1.5),f.lowpassfreq=W|0}if(f.out_samplerate==0&&(2*f.lowpassfreq>f.in_samplerate&&(f.lowpassfreq=f.in_samplerate/2),f.out_samplerate=h(f.lowpassfreq|0,f.in_samplerate)),f.lowpassfreq=Math.min(20500,f.lowpassfreq),f.lowpassfreq=Math.min(f.out_samplerate/2,f.lowpassfreq),f.VBR==Et.vbr_off&&(f.compression_ratio=f.out_samplerate*16*T.channels_out/(1e3*f.brate)),f.VBR==Et.vbr_abr&&(f.compression_ratio=f.out_samplerate*16*T.channels_out/(1e3*f.VBR_mean_bitrate_kbps)),f.bWriteVbrTag||(f.findReplayGain=!1,f.decode_on_the_fly=!1,T.findPeakSample=!1),T.findReplayGain=f.findReplayGain,T.decode_on_the_fly=f.decode_on_the_fly,T.decode_on_the_fly&&(T.findPeakSample=!0),T.findReplayGain&&a.InitGainAnalysis(T.rgdata,f.out_samplerate)==GainAnalysis.INIT_GAIN_ANALYSIS_ERROR)return f.internal_flags=null,-6;switch(T.decode_on_the_fly&&!f.decode_only&&(T.hip!=null&&u.hip_decode_exit(T.hip),T.hip=u.hip_decode_init()),T.mode_gr=f.out_samplerate<=24e3?1:2,f.framesize=576*T.mode_gr,f.encoder_delay=O.ENCDELAY,T.resample_ratio=f.in_samplerate/f.out_samplerate,f.VBR){case Et.vbr_mt:case Et.vbr_rh:case Et.vbr_mtrh:{var De=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5];f.compression_ratio=De[f.VBR_q]}break;case Et.vbr_abr:f.compression_ratio=f.out_samplerate*16*T.channels_out/(1e3*f.VBR_mean_bitrate_kbps);break;default:f.compression_ratio=f.out_samplerate*16*T.channels_out/(1e3*f.brate);break}if(f.mode==vt.NOT_SET&&(f.mode=vt.JOINT_STEREO),f.highpassfreq>0?(T.highpass1=2*f.highpassfreq,f.highpasswidth>=0?T.highpass2=2*(f.highpassfreq+f.highpasswidth):T.highpass2=(1+0)*2*f.highpassfreq,T.highpass1/=f.out_samplerate,T.highpass2/=f.out_samplerate):(T.highpass1=0,T.highpass2=0),f.lowpassfreq>0?(T.lowpass2=2*f.lowpassfreq,f.lowpasswidth>=0?(T.lowpass1=2*(f.lowpassfreq-f.lowpasswidth),T.lowpass1<0&&(T.lowpass1=0)):T.lowpass1=(1-0)*2*f.lowpassfreq,T.lowpass1/=f.out_samplerate,T.lowpass2/=f.out_samplerate):(T.lowpass1=0,T.lowpass2=0),d(f),T.samplerate_index=k(f.out_samplerate,f),T.samplerate_index<0)return f.internal_flags=null,-1;if(f.VBR==Et.vbr_off){if(f.free_format)T.bitrate_index=0;else if(f.brate=C(f.brate,f.version,f.out_samplerate),T.bitrate_index=A(f.brate,f.version,f.out_samplerate),T.bitrate_index<=0)return f.internal_flags=null,-1}else T.bitrate_index=1;f.analysis&&(f.bWriteVbrTag=!1),T.pinfo!=null&&(f.bWriteVbrTag=!1),n.init_bit_stream_w(T);for(var Le=T.samplerate_index+3*f.version+6*(f.out_samplerate<16e3?1:0),me=0;me<O.SBMAX_l+1;me++)T.scalefac_band.l[me]=o.sfBandIndex[Le].l[me];for(var me=0;me<O.PSFB21+1;me++){var Ge=(T.scalefac_band.l[22]-T.scalefac_band.l[21])/O.PSFB21,ot=T.scalefac_band.l[21]+me*Ge;T.scalefac_band.psfb21[me]=ot}T.scalefac_band.psfb21[O.PSFB21]=576;for(var me=0;me<O.SBMAX_s+1;me++)T.scalefac_band.s[me]=o.sfBandIndex[Le].s[me];for(var me=0;me<O.PSFB12+1;me++){var Ge=(T.scalefac_band.s[13]-T.scalefac_band.s[12])/O.PSFB12,ot=T.scalefac_band.s[12]+me*Ge;T.scalefac_band.psfb12[me]=ot}T.scalefac_band.psfb12[O.PSFB12]=192,f.version==1?T.sideinfo_len=T.channels_out==1?4+17:4+32:T.sideinfo_len=T.channels_out==1?4+9:4+17,f.error_protection&&(T.sideinfo_len+=2),S(f),T.Class_ID=H;{var D;for(D=0;D<19;D++)T.nsPsy.pefirbuf[D]=700*T.mode_gr*T.channels_out;f.ATHtype==-1&&(f.ATHtype=4)}switch(ya(f.VBR_q<=9),ya(f.VBR_q>=0),f.VBR){case Et.vbr_mt:f.VBR=Et.vbr_mtrh;case Et.vbr_mtrh:{f.useTemporal==null&&(f.useTemporal=!1),r.apply_preset(f,500-f.VBR_q*10,0),f.quality<0&&(f.quality=LAME_DEFAULT_QUALITY),f.quality<5&&(f.quality=0),f.quality>5&&(f.quality=5),T.PSY.mask_adjust=f.maskingadjust,T.PSY.mask_adjust_short=f.maskingadjust_short,f.experimentalY?T.sfb21_extra=!1:T.sfb21_extra=f.out_samplerate>44e3,T.iteration_loop=new VBRNewIterationLoop(l);break}case Et.vbr_rh:{r.apply_preset(f,500-f.VBR_q*10,0),T.PSY.mask_adjust=f.maskingadjust,T.PSY.mask_adjust_short=f.maskingadjust_short,f.experimentalY?T.sfb21_extra=!1:T.sfb21_extra=f.out_samplerate>44e3,f.quality>6&&(f.quality=6),f.quality<0&&(f.quality=LAME_DEFAULT_QUALITY),T.iteration_loop=new VBROldIterationLoop(l);break}default:{var z;T.sfb21_extra=!1,f.quality<0&&(f.quality=LAME_DEFAULT_QUALITY),z=f.VBR,z==Et.vbr_off&&(f.VBR_mean_bitrate_kbps=f.brate),r.apply_preset(f,f.VBR_mean_bitrate_kbps,0),f.VBR=z,T.PSY.mask_adjust=f.maskingadjust,T.PSY.mask_adjust_short=f.maskingadjust_short,z==Et.vbr_off?T.iteration_loop=new cg(l):T.iteration_loop=new ABRIterationLoop(l);break}}if(ya(f.scale>=0),f.VBR!=Et.vbr_off){if(T.VBR_min_bitrate=1,T.VBR_max_bitrate=14,f.out_samplerate<16e3&&(T.VBR_max_bitrate=8),f.VBR_min_bitrate_kbps!=0&&(f.VBR_min_bitrate_kbps=C(f.VBR_min_bitrate_kbps,f.version,f.out_samplerate),T.VBR_min_bitrate=A(f.VBR_min_bitrate_kbps,f.version,f.out_samplerate),T.VBR_min_bitrate<0)||f.VBR_max_bitrate_kbps!=0&&(f.VBR_max_bitrate_kbps=C(f.VBR_max_bitrate_kbps,f.version,f.out_samplerate),T.VBR_max_bitrate=A(f.VBR_max_bitrate_kbps,f.version,f.out_samplerate),T.VBR_max_bitrate<0))return-1;f.VBR_min_bitrate_kbps=re.bitrate_table[f.version][T.VBR_min_bitrate],f.VBR_max_bitrate_kbps=re.bitrate_table[f.version][T.VBR_max_bitrate],f.VBR_mean_bitrate_kbps=Math.min(re.bitrate_table[f.version][T.VBR_max_bitrate],f.VBR_mean_bitrate_kbps),f.VBR_mean_bitrate_kbps=Math.max(re.bitrate_table[f.version][T.VBR_min_bitrate],f.VBR_mean_bitrate_kbps)}return f.tune&&(T.PSY.mask_adjust+=f.tune_value_a,T.PSY.mask_adjust_short+=f.tune_value_a),E(f),ya(f.scale>=0),f.athaa_type<0?T.ATH.useAdjust=3:T.ATH.useAdjust=f.athaa_type,T.ATH.aaSensitivityP=Math.pow(10,f.athaa_sensitivity/-10),f.short_blocks==null&&(f.short_blocks=El.short_block_allowed),f.short_blocks==El.short_block_allowed&&(f.mode==vt.JOINT_STEREO||f.mode==vt.STEREO)&&(f.short_blocks=El.short_block_coupled),f.quant_comp<0&&(f.quant_comp=1),f.quant_comp_short<0&&(f.quant_comp_short=0),f.msfix<0&&(f.msfix=0),f.exp_nspsytune=f.exp_nspsytune|1,f.internal_flags.nsPsy.attackthre<0&&(f.internal_flags.nsPsy.attackthre=wl.NSATTACKTHRE),f.internal_flags.nsPsy.attackthre_s<0&&(f.internal_flags.nsPsy.attackthre_s=wl.NSATTACKTHRE_S),ya(f.scale>=0),f.scale<0&&(f.scale=1),f.ATHtype<0&&(f.ATHtype=4),f.ATHcurve<0&&(f.ATHcurve=4),f.athaa_loudapprox<0&&(f.athaa_loudapprox=2),f.interChRatio<0&&(f.interChRatio=0),f.useTemporal==null&&(f.useTemporal=!0),T.slot_lag=T.frac_SpF=0,f.VBR==Et.vbr_off&&(T.slot_lag=T.frac_SpF=(f.version+1)*72e3*f.brate%f.out_samplerate|0),o.iteration_init(f),v.psymodel_init(f),ya(f.scale>=0),0};function _(f,T){(f.in_buffer_0==null||f.in_buffer_nsamples<T)&&(f.in_buffer_0=Qa(T),f.in_buffer_1=Qa(T),f.in_buffer_nsamples=T)}this.lame_encode_flush=function(f,T,W,Z){var de=f.internal_flags,Me=gg([2,1152]),Te=0,ve,De,Le,me,Ge=de.mf_samples_to_encode-O.POSTDELAY,ot=x(f);if(de.mf_samples_to_encode<1)return 0;for(ve=0,f.in_samplerate!=f.out_samplerate&&(Ge+=16*f.out_samplerate/f.in_samplerate),Le=f.framesize-Ge%f.framesize,Le<576&&(Le+=f.framesize),f.encoder_padding=Le,me=(Ge+Le)/f.framesize;me>0&&Te>=0;){var D=ot-de.mf_size,z=f.frameNum;D*=f.in_samplerate,D/=f.out_samplerate,D>1152&&(D=1152),D<1&&(D=1),De=Z-ve,Z==0&&(De=0),Te=this.lame_encode_buffer(f,Me[0],Me[1],D,T,W,De),W+=Te,ve+=Te,me-=z!=f.frameNum?1:0}if(de.mf_samples_to_encode=0,Te<0||(De=Z-ve,Z==0&&(De=0),n.flush_bitstream(f),Te=n.copy_buffer(de,T,W,De,1),Te<0))return Te;if(W+=Te,ve+=Te,De=Z-ve,Z==0&&(De=0),f.write_id3tag_automatic){if(m.id3tag_write_v1(f),Te=n.copy_buffer(de,T,W,De,0),Te<0)return Te;ve+=Te}return ve},this.lame_encode_buffer=function(f,T,W,Z,de,Me,Te){var ve=f.internal_flags,De=[null,null];if(ve.Class_ID!=H)return-3;if(Z==0)return 0;_(ve,Z),De[0]=ve.in_buffer_0,De[1]=ve.in_buffer_1;for(var Le=0;Le<Z;Le++)De[0][Le]=T[Le],ve.channels_in>1&&(De[1][Le]=W[Le]);return b(f,De[0],De[1],Z,de,Me,Te)};function x(f){var T=O.BLKSIZE+f.framesize-O.FFTOFFSET;return T=Math.max(T,512+f.framesize-32),T}function b(f,T,W,Z,de,Me,Te){var ve=f.internal_flags,De=0,Le,me,Ge,ot,D,z=[null,null],te=[null,null];if(ve.Class_ID!=H)return-3;if(Z==0)return 0;if(D=n.copy_buffer(ve,de,Me,Te,0),D<0)return D;if(Me+=D,De+=D,te[0]=T,te[1]=W,As.NEQ(f.scale,0)&&As.NEQ(f.scale,1))for(me=0;me<Z;++me)te[0][me]*=f.scale,ve.channels_out==2&&(te[1][me]*=f.scale);if(As.NEQ(f.scale_left,0)&&As.NEQ(f.scale_left,1))for(me=0;me<Z;++me)te[0][me]*=f.scale_left;if(As.NEQ(f.scale_right,0)&&As.NEQ(f.scale_right,1))for(me=0;me<Z;++me)te[1][me]*=f.scale_right;if(f.num_channels==2&&ve.channels_out==1)for(me=0;me<Z;++me)te[0][me]=.5*(te[0][me]+te[1][me]),te[1][me]=0;ot=x(f),z[0]=ve.mfbuf[0],z[1]=ve.mfbuf[1];for(var le=0;Z>0;){var ue=[null,null],xe=0,Ee=0;ue[0]=te[0],ue[1]=te[1];var be=new M;if(V(f,z,ue,le,Z,be),xe=be.n_in,Ee=be.n_out,ve.findReplayGain&&!ve.decode_on_the_fly&&a.AnalyzeSamples(ve.rgdata,z[0],ve.mf_size,z[1],ve.mf_size,Ee,ve.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6;if(Z-=xe,le+=xe,ve.channels_out==2,ve.mf_size+=Ee,ya(ve.mf_size<=ft.MFSIZE),ve.mf_samples_to_encode<1&&(ve.mf_samples_to_encode=O.ENCDELAY+O.POSTDELAY),ve.mf_samples_to_encode+=Ee,ve.mf_size>=ot){var Se=Te-De;if(Te==0&&(Se=0),Le=g(f,z[0],z[1],de,Me,Se),Le<0)return Le;for(Me+=Le,De+=Le,ve.mf_size-=f.framesize,ve.mf_samples_to_encode-=f.framesize,Ge=0;Ge<ve.channels_out;Ge++)for(me=0;me<ve.mf_size;me++)z[Ge][me]=z[Ge][me+f.framesize]}}return De}function g(f,T,W,Z,de,Me){var Te=e.enc.lame_encode_mp3_frame(f,T,W,Z,de,Me);return f.frameNum++,Te}function M(){this.n_in=0,this.n_out=0}function w(){this.num_used=0}function j(f,T){return T!=0?j(T,f%T):f}function X(f,T,W){var Z=Math.PI*T;f/=W,f<0&&(f=0),f>1&&(f=1);var de=f-.5,Me=.42-.5*Math.cos(2*f*Math.PI)+.08*Math.cos(4*f*Math.PI);return Math.abs(de)<1e-9?Z/Math.PI:Me*Math.sin(W*Z*de)/(Math.PI*W*de)}function F(f,T,W,Z,de,Me,Te,ve,De){var Le=f.internal_flags,me,Ge=0,ot,D=f.out_samplerate/j(f.out_samplerate,f.in_samplerate);D>ft.BPC&&(D=ft.BPC);var z=Math.abs(Le.resample_ratio-Math.floor(.5+Le.resample_ratio))<1e-4?1:0,te=1/Le.resample_ratio;te>1&&(te=1);var le=31;le%2==0&&--le,le+=z;var ue=le+1;if(Le.fill_buffer_resample_init==0){for(Le.inbuf_old[0]=Qa(ue),Le.inbuf_old[1]=Qa(ue),me=0;me<=2*D;++me)Le.blackfilt[me]=Qa(ue);for(Le.itime[0]=0,Le.itime[1]=0,Ge=0;Ge<=2*D;Ge++){var xe=0,Ee=(Ge-D)/(2*D);for(me=0;me<=le;me++)xe+=Le.blackfilt[Ge][me]=X(me-Ee,te,le);for(me=0;me<=le;me++)Le.blackfilt[Ge][me]/=xe}Le.fill_buffer_resample_init=1}var be=Le.inbuf_old[De];for(ot=0;ot<Z;ot++){var Se,he;if(Se=ot*Le.resample_ratio,Ge=0|Math.floor(Se-Le.itime[De]),le+Ge-le/2>=Te)break;var Ee=Se-Le.itime[De]-(Ge+.5*(le%2));he=0|Math.floor(Ee*2*D+D+.5);var Pe=0;for(me=0;me<=le;++me){var Ne=0|me+Ge-le/2,Fe;Fe=Ne<0?be[ue+Ne]:de[Me+Ne],Pe+=Fe*Le.blackfilt[he][me]}T[W+ot]=Pe}if(ve.num_used=Math.min(Te,le+Ge-le/2),Le.itime[De]+=ve.num_used-ot*Le.resample_ratio,ve.num_used>=ue)for(me=0;me<ue;me++)be[me]=de[Me+ve.num_used+me-ue];else{var Ue=ue-ve.num_used;for(me=0;me<Ue;++me)be[me]=be[me+ve.num_used];for(Ge=0;me<ue;++me,++Ge)be[me]=de[Me+Ge];ya(Ge==ve.num_used)}return ot}function V(f,T,W,Z,de,Me){var Te=f.internal_flags;if(Te.resample_ratio<.9999||Te.resample_ratio>1.0001)for(var ve=0;ve<Te.channels_out;ve++){var De=new w;Me.n_out=F(f,T[ve],Te.mf_size,f.framesize,W[ve],Z,de,De,ve),Me.n_in=De.num_used}else{Me.n_out=Math.min(f.framesize,de),Me.n_in=Me.n_out;for(var Le=0;Le<Me.n_out;++Le)T[0][Te.mf_size+Le]=W[0][Z+Le],Te.channels_out==2&&(T[1][Te.mf_size+Le]=W[1][Z+Le])}}}var Gs=ke.VbrMode;function bg(){function e(c,m,u,p,y,i,H,L,N,h,k,C,A,B,d){this.vbr_q=c,this.quant_comp=m,this.quant_comp_s=u,this.expY=p,this.st_lrm=y,this.st_s=i,this.masking_adj=H,this.masking_adj_short=L,this.ath_lower=N,this.ath_curve=h,this.ath_sensitivity=k,this.interch=C,this.safejoint=A,this.sfb21mod=B,this.msfix=d}function t(c,m,u,p,y,i,H,L,N,h,k,C,A,B){this.quant_comp=m,this.quant_comp_s=u,this.safejoint=p,this.nsmsfix=y,this.st_lrm=i,this.st_s=H,this.nsbass=L,this.scale=N,this.masking_adj=h,this.ath_lower=k,this.ath_curve=C,this.interch=A,this.sfscale=B}var s;this.setModules=function(c){s=c};var a=[new e(0,9,9,0,5.2,125,-4.2,-6.3,4.8,1,0,0,2,21,.97),new e(1,9,9,0,5.3,125,-3.6,-5.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,5.6,125,-2.2,-3.5,2.8,2,0,0,2,21,1.49),new e(3,9,9,1,5.8,130,-1.8,-2.8,2.6,3,-4,0,2,20,1.64),new e(4,9,9,1,6,135,-.7,-1.1,1.1,3.5,-8,0,2,0,1.79),new e(5,9,9,1,6.4,140,.5,.4,-7.5,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,6.6,145,.67,.65,-14.7,6.5,-19,4e-4,0,0,2.3),new e(7,9,9,1,6.6,145,.8,.75,-19.7,8,-22,6e-4,0,0,2.7),new e(8,9,9,1,6.6,145,1.2,1.15,-27.5,10,-23,7e-4,0,0,0),new e(9,9,9,1,6.6,145,1.6,1.6,-36,11,-25,8e-4,0,0,0),new e(10,9,9,1,6.6,145,2,2,-36,12,-25,8e-4,0,0,0)],n=[new e(0,9,9,0,4.2,25,-7,-4,7.5,1,0,0,2,26,.97),new e(1,9,9,0,4.2,25,-5.6,-3.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,4.2,25,-4.4,-1.8,2,2,0,0,2,18,1.49),new e(3,9,9,1,4.2,25,-3.4,-1.25,1.1,3,-4,0,2,15,1.64),new e(4,9,9,1,4.2,25,-2.2,.1,0,3.5,-8,0,2,0,1.79),new e(5,9,9,1,4.2,25,-1,1.65,-7.7,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,4.2,25,-0,2.47,-7.7,6.5,-19,4e-4,0,0,2),new e(7,9,9,1,4.2,25,.5,2,-14.5,8,-22,6e-4,0,0,2),new e(8,9,9,1,4.2,25,1,2.4,-22,10,-23,7e-4,0,0,2),new e(9,9,9,1,4.2,25,1.5,2.95,-30,11,-25,8e-4,0,0,2),new e(10,9,9,1,4.2,25,2,2.95,-36,12,-30,8e-4,0,0,2)];function r(c,m,u){var p=c.VBR==Gs.vbr_rh?a:n,y=c.VBR_q_frac,i=p[m],H=p[m+1],L=i;i.st_lrm=i.st_lrm+y*(H.st_lrm-i.st_lrm),i.st_s=i.st_s+y*(H.st_s-i.st_s),i.masking_adj=i.masking_adj+y*(H.masking_adj-i.masking_adj),i.masking_adj_short=i.masking_adj_short+y*(H.masking_adj_short-i.masking_adj_short),i.ath_lower=i.ath_lower+y*(H.ath_lower-i.ath_lower),i.ath_curve=i.ath_curve+y*(H.ath_curve-i.ath_curve),i.ath_sensitivity=i.ath_sensitivity+y*(H.ath_sensitivity-i.ath_sensitivity),i.interch=i.interch+y*(H.interch-i.interch),i.msfix=i.msfix+y*(H.msfix-i.msfix),v(c,L.vbr_q),u!=0?c.quant_comp=L.quant_comp:Math.abs(c.quant_comp- -1)>0||(c.quant_comp=L.quant_comp),u!=0?c.quant_comp_short=L.quant_comp_s:Math.abs(c.quant_comp_short- -1)>0||(c.quant_comp_short=L.quant_comp_s),L.expY!=0&&(c.experimentalY=L.expY!=0),u!=0?c.internal_flags.nsPsy.attackthre=L.st_lrm:Math.abs(c.internal_flags.nsPsy.attackthre- -1)>0||(c.internal_flags.nsPsy.attackthre=L.st_lrm),u!=0?c.internal_flags.nsPsy.attackthre_s=L.st_s:Math.abs(c.internal_flags.nsPsy.attackthre_s- -1)>0||(c.internal_flags.nsPsy.attackthre_s=L.st_s),u!=0?c.maskingadjust=L.masking_adj:Math.abs(c.maskingadjust-0)>0||(c.maskingadjust=L.masking_adj),u!=0?c.maskingadjust_short=L.masking_adj_short:Math.abs(c.maskingadjust_short-0)>0||(c.maskingadjust_short=L.masking_adj_short),u!=0?c.ATHlower=-L.ath_lower/10:Math.abs(-c.ATHlower*10-0)>0||(c.ATHlower=-L.ath_lower/10),u!=0?c.ATHcurve=L.ath_curve:Math.abs(c.ATHcurve- -1)>0||(c.ATHcurve=L.ath_curve),u!=0?c.athaa_sensitivity=L.ath_sensitivity:Math.abs(c.athaa_sensitivity- -1)>0||(c.athaa_sensitivity=L.ath_sensitivity),L.interch>0&&(u!=0?c.interChRatio=L.interch:Math.abs(c.interChRatio- -1)>0||(c.interChRatio=L.interch)),L.safejoint>0&&(c.exp_nspsytune=c.exp_nspsytune|L.safejoint),L.sfb21mod>0&&(c.exp_nspsytune=c.exp_nspsytune|L.sfb21mod<<20),u!=0?c.msfix=L.msfix:Math.abs(c.msfix- -1)>0||(c.msfix=L.msfix),u==0&&(c.VBR_q=m,c.VBR_q_frac=y)}var o=[new t(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new t(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new t(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new t(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new t(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new t(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new t(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new t(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new t(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new t(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new t(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new t(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new t(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new t(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new t(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];function l(c,m,u){var p=m,y=s.nearestBitrateFullIndex(m);if(c.VBR=Gs.vbr_abr,c.VBR_mean_bitrate_kbps=p,c.VBR_mean_bitrate_kbps=Math.min(c.VBR_mean_bitrate_kbps,320),c.VBR_mean_bitrate_kbps=Math.max(c.VBR_mean_bitrate_kbps,8),c.brate=c.VBR_mean_bitrate_kbps,c.VBR_mean_bitrate_kbps>320&&(c.disable_reservoir=!0),o[y].safejoint>0&&(c.exp_nspsytune=c.exp_nspsytune|2),o[y].sfscale>0&&(c.internal_flags.noise_shaping=2),Math.abs(o[y].nsbass)>0){var i=int(o[y].nsbass*4);i<0&&(i+=64),c.exp_nspsytune=c.exp_nspsytune|i<<2}return u!=0?c.quant_comp=o[y].quant_comp:Math.abs(c.quant_comp- -1)>0||(c.quant_comp=o[y].quant_comp),u!=0?c.quant_comp_short=o[y].quant_comp_s:Math.abs(c.quant_comp_short- -1)>0||(c.quant_comp_short=o[y].quant_comp_s),u!=0?c.msfix=o[y].nsmsfix:Math.abs(c.msfix- -1)>0||(c.msfix=o[y].nsmsfix),u!=0?c.internal_flags.nsPsy.attackthre=o[y].st_lrm:Math.abs(c.internal_flags.nsPsy.attackthre- -1)>0||(c.internal_flags.nsPsy.attackthre=o[y].st_lrm),u!=0?c.internal_flags.nsPsy.attackthre_s=o[y].st_s:Math.abs(c.internal_flags.nsPsy.attackthre_s- -1)>0||(c.internal_flags.nsPsy.attackthre_s=o[y].st_s),u!=0?c.scale=o[y].scale:Math.abs(c.scale- -1)>0||(c.scale=o[y].scale),u!=0?c.maskingadjust=o[y].masking_adj:Math.abs(c.maskingadjust-0)>0||(c.maskingadjust=o[y].masking_adj),o[y].masking_adj>0?u!=0?c.maskingadjust_short=o[y].masking_adj*.9:Math.abs(c.maskingadjust_short-0)>0||(c.maskingadjust_short=o[y].masking_adj*.9):u!=0?c.maskingadjust_short=o[y].masking_adj*1.1:Math.abs(c.maskingadjust_short-0)>0||(c.maskingadjust_short=o[y].masking_adj*1.1),u!=0?c.ATHlower=-o[y].ath_lower/10:Math.abs(-c.ATHlower*10-0)>0||(c.ATHlower=-o[y].ath_lower/10),u!=0?c.ATHcurve=o[y].ath_curve:Math.abs(c.ATHcurve- -1)>0||(c.ATHcurve=o[y].ath_curve),u!=0?c.interChRatio=o[y].interch:Math.abs(c.interChRatio- -1)>0||(c.interChRatio=o[y].interch),m}this.apply_preset=function(c,m,u){switch(m){case Je.R3MIX:{m=Je.V3,c.VBR=Gs.vbr_mtrh;break}case Je.MEDIUM:{m=Je.V4,c.VBR=Gs.vbr_rh;break}case Je.MEDIUM_FAST:{m=Je.V4,c.VBR=Gs.vbr_mtrh;break}case Je.STANDARD:{m=Je.V2,c.VBR=Gs.vbr_rh;break}case Je.STANDARD_FAST:{m=Je.V2,c.VBR=Gs.vbr_mtrh;break}case Je.EXTREME:{m=Je.V0,c.VBR=Gs.vbr_rh;break}case Je.EXTREME_FAST:{m=Je.V0,c.VBR=Gs.vbr_mtrh;break}case Je.INSANE:return m=320,c.preset=m,l(c,m,u),c.VBR=Gs.vbr_off,m}switch(c.preset=m,m){case Je.V9:return r(c,9,u),m;case Je.V8:return r(c,8,u),m;case Je.V7:return r(c,7,u),m;case Je.V6:return r(c,6,u),m;case Je.V5:return r(c,5,u),m;case Je.V4:return r(c,4,u),m;case Je.V3:return r(c,3,u),m;case Je.V2:return r(c,2,u),m;case Je.V1:return r(c,1,u),m;case Je.V0:return r(c,0,u),m}return m>=8&&m<=320?l(c,m,u):(c.preset=0,m)};function v(c,m){var u=0;return m<0&&(u=-1,m=0),m>9&&(u=-1,m=9),c.VBR_q=m,c.VBR_q_frac=0,u}}function yg(){this.setModules=function(e,t){}}function Al(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}var Wu=ke.new_float,xg=ke.new_int;function wg(){this.global_gain=0,this.sfb_count1=0,this.step=xg(39),this.noise=Wu(39),this.noise_log=Wu(39)}var xa=ke.System,Zu=ke.VbrMode,kl=ke.Util,wr=ke.Arrays,yn=ke.new_float,xn=ke.assert;function Sg(){var e;this.rv=null;var t;this.qupvt=null;var s,a=new yg,n;this.setModules=function(N,h,k,C){e=N,t=h,this.rv=h,s=k,this.qupvt=k,n=C,a.setModules(s,n)},this.ms_convert=function(N,h){for(var k=0;k<576;++k){var C=N.tt[h][0].xr[k],A=N.tt[h][1].xr[k];N.tt[h][0].xr[k]=(C+A)*(kl.SQRT2*.5),N.tt[h][1].xr[k]=(C-A)*(kl.SQRT2*.5)}};function r(N,h,k,C){C=0;for(var A=0;A<=k;++A){var B=Math.abs(N.xr[A]);C+=B,h[A]=Math.sqrt(B*Math.sqrt(B)),h[A]>N.xrpow_max&&(N.xrpow_max=h[A])}return C}this.init_xrpow=function(N,h,k){var C=0,A=0|h.max_nonzero_coeff;if(h.xrpow_max=0,wr.fill(k,A,576,0),C=r(h,k,A,C),C>1e-20){var B=0;(N.substep_shaping&2)!=0&&(B=1);for(var d=0;d<h.psymax;d++)N.pseudohalf[d]=B;return!0}return wr.fill(h.l3_enc,0,576,0),!1};function o(N,h){var k=N.ATH,C=h.xr;if(h.block_type!=O.SHORT_TYPE)for(var A=!1,B=O.PSFB21-1;B>=0&&!A;B--){var d=N.scalefac_band.psfb21[B],E=N.scalefac_band.psfb21[B+1],S=s.athAdjust(k.adjust,k.psfb21[B],k.floor);N.nsPsy.longfact[21]>1e-12&&(S*=N.nsPsy.longfact[21]);for(var _=E-1;_>=d;_--)if(Math.abs(C[_])<S)C[_]=0;else{A=!0;break}}else for(var x=0;x<3;x++)for(var A=!1,B=O.PSFB12-1;B>=0&&!A;B--){var d=N.scalefac_band.s[12]*3+(N.scalefac_band.s[13]-N.scalefac_band.s[12])*x+(N.scalefac_band.psfb12[B]-N.scalefac_band.psfb12[0]),E=d+(N.scalefac_band.psfb12[B+1]-N.scalefac_band.psfb12[B]),b=s.athAdjust(k.adjust,k.psfb12[B],k.floor);N.nsPsy.shortfact[12]>1e-12&&(b*=N.nsPsy.shortfact[12]);for(var _=E-1;_>=d;_--)if(Math.abs(C[_])<b)C[_]=0;else{A=!0;break}}}this.init_outer_loop=function(N,h){h.part2_3_length=0,h.big_values=0,h.count1=0,h.global_gain=210,h.scalefac_compress=0,h.table_select[0]=0,h.table_select[1]=0,h.table_select[2]=0,h.subblock_gain[0]=0,h.subblock_gain[1]=0,h.subblock_gain[2]=0,h.subblock_gain[3]=0,h.region0_count=0,h.region1_count=0,h.preflag=0,h.scalefac_scale=0,h.count1table_select=0,h.part2_length=0,h.sfb_lmax=O.SBPSY_l,h.sfb_smin=O.SBPSY_s,h.psy_lmax=N.sfb21_extra?O.SBMAX_l:O.SBPSY_l,h.psymax=h.psy_lmax,h.sfbmax=h.sfb_lmax,h.sfbdivide=11;for(var k=0;k<O.SBMAX_l;k++)h.width[k]=N.scalefac_band.l[k+1]-N.scalefac_band.l[k],h.window[k]=3;if(h.block_type==O.SHORT_TYPE){var C=yn(576);h.sfb_smin=0,h.sfb_lmax=0,h.mixed_block_flag!=0&&(h.sfb_smin=3,h.sfb_lmax=N.mode_gr*2+4),h.psymax=h.sfb_lmax+3*((N.sfb21_extra?O.SBMAX_s:O.SBPSY_s)-h.sfb_smin),h.sfbmax=h.sfb_lmax+3*(O.SBPSY_s-h.sfb_smin),h.sfbdivide=h.sfbmax-18,h.psy_lmax=h.sfb_lmax;var A=N.scalefac_band.l[h.sfb_lmax];xa.arraycopy(h.xr,0,C,0,576);for(var k=h.sfb_smin;k<O.SBMAX_s;k++)for(var B=N.scalefac_band.s[k],d=N.scalefac_band.s[k+1],E=0;E<3;E++)for(var S=B;S<d;S++)h.xr[A++]=C[3*S+E];for(var _=h.sfb_lmax,k=h.sfb_smin;k<O.SBMAX_s;k++)h.width[_]=h.width[_+1]=h.width[_+2]=N.scalefac_band.s[k+1]-N.scalefac_band.s[k],h.window[_]=0,h.window[_+1]=1,h.window[_+2]=2,_+=3}h.count1bits=0,h.sfb_partition_table=s.nr_of_sfb_block[0][0],h.slen[0]=0,h.slen[1]=0,h.slen[2]=0,h.slen[3]=0,h.max_nonzero_coeff=575,wr.fill(h.scalefac,0),o(N,h)};function l(N){this.ordinal=N}l.BINSEARCH_NONE=new l(0),l.BINSEARCH_UP=new l(1),l.BINSEARCH_DOWN=new l(2);function v(N,h,k,C,A){var B,d=N.CurrentStep[C],E=!1,S=N.OldValue[C],_=l.BINSEARCH_NONE;for(h.global_gain=S,k-=h.part2_length;;){var x;if(B=n.count_bits(N,A,h,null),d==1||B==k)break;B>k?(_==l.BINSEARCH_DOWN&&(E=!0),E&&(d/=2),_=l.BINSEARCH_UP,x=d):(_==l.BINSEARCH_UP&&(E=!0),E&&(d/=2),_=l.BINSEARCH_DOWN,x=-d),h.global_gain+=x,h.global_gain<0&&(h.global_gain=0,E=!0),h.global_gain>255&&(h.global_gain=255,E=!0)}for(xn(h.global_gain>=0),xn(h.global_gain<256);B>k&&h.global_gain<255;)h.global_gain++,B=n.count_bits(N,A,h,null);return N.CurrentStep[C]=S-h.global_gain>=4?4:2,N.OldValue[C]=h.global_gain,h.part2_3_length=B,B}this.trancate_smallspectrums=function(N,h,k,C){var A=yn(ba.SFBMAX);if(!((N.substep_shaping&4)==0&&h.block_type==O.SHORT_TYPE||(N.substep_shaping&128)!=0)){s.calc_noise(h,k,A,new Al,null);for(var d=0;d<576;d++){var B=0;h.l3_enc[d]!=0&&(B=Math.abs(h.xr[d])),C[d]=B}var d=0,E=8;h.block_type==O.SHORT_TYPE&&(E=6);do{var S,_,x,b,g=h.width[E];if(d+=g,!(A[E]>=1)&&(wr.sort(C,d-g,g),!BitStream.EQ(C[d-1],0))){S=(1-A[E])*k[E],_=0,b=0;do{var M;for(x=1;b+x<g&&!BitStream.NEQ(C[b+d-g],C[b+d+x-g]);x++);if(M=C[b+d-g]*C[b+d-g]*x,S<M){b!=0&&(_=C[b+d-g-1]);break}S-=M,b+=x}while(b<g);if(!BitStream.EQ(_,0))do Math.abs(h.xr[d-g])<=_&&(h.l3_enc[d-g]=0);while(--g>0)}}while(++E<h.psymax);h.part2_3_length=n.noquant_count_bits(N,h,null)}};function c(N){for(var h=0;h<N.sfbmax;h++)if(N.scalefac[h]+N.subblock_gain[N.window[h]]==0)return!1;return!0}function m(N){return kl.FAST_LOG10(.368+.632*N*N*N)}function u(N,h){for(var k=1e-37,C=0;C<h.psymax;C++)k+=m(N[C]);return Math.max(1e-20,k)}function p(N,h,k,C,A){var B;switch(N){default:case 9:{h.over_count>0?(B=k.over_SSD<=h.over_SSD,k.over_SSD==h.over_SSD&&(B=k.bits<h.bits)):B=k.max_noise<0&&k.max_noise*10+k.bits<=h.max_noise*10+h.bits;break}case 0:B=k.over_count<h.over_count||k.over_count==h.over_count&&k.over_noise<h.over_noise||k.over_count==h.over_count&&BitStream.EQ(k.over_noise,h.over_noise)&&k.tot_noise<h.tot_noise;break;case 8:k.max_noise=u(A,C);case 1:B=k.max_noise<h.max_noise;break;case 2:B=k.tot_noise<h.tot_noise;break;case 3:B=k.tot_noise<h.tot_noise&&k.max_noise<h.max_noise;break;case 4:B=k.max_noise<=0&&h.max_noise>.2||k.max_noise<=0&&h.max_noise<0&&h.max_noise>k.max_noise-.2&&k.tot_noise<h.tot_noise||k.max_noise<=0&&h.max_noise>0&&h.max_noise>k.max_noise-.2&&k.tot_noise<h.tot_noise+h.over_noise||k.max_noise>0&&h.max_noise>-.05&&h.max_noise>k.max_noise-.1&&k.tot_noise+k.over_noise<h.tot_noise+h.over_noise||k.max_noise>0&&h.max_noise>-.1&&h.max_noise>k.max_noise-.15&&k.tot_noise+k.over_noise+k.over_noise<h.tot_noise+h.over_noise+h.over_noise;break;case 5:B=k.over_noise<h.over_noise||BitStream.EQ(k.over_noise,h.over_noise)&&k.tot_noise<h.tot_noise;break;case 6:B=k.over_noise<h.over_noise||BitStream.EQ(k.over_noise,h.over_noise)&&(k.max_noise<h.max_noise||BitStream.EQ(k.max_noise,h.max_noise)&&k.tot_noise<=h.tot_noise);break;case 7:B=k.over_count<h.over_count||k.over_noise<h.over_noise;break}return h.over_count==0&&(B=B&&k.bits<h.bits),B}function y(N,h,k,C,A){var B=N.internal_flags,d;h.scalefac_scale==0?d=1.2968395546510096:d=1.6817928305074292;for(var E=0,S=0;S<h.sfbmax;S++)E<k[S]&&(E=k[S]);var _=B.noise_shaping_amp;switch(_==3&&(A?_=2:_=1),_){case 2:break;case 1:E>1?E=Math.pow(E,.5):E*=.95;break;case 0:default:E>1?E=1:E*=.95;break}for(var x=0,S=0;S<h.sfbmax;S++){var b=h.width[S],g;if(x+=b,!(k[S]<E)){if((B.substep_shaping&2)!=0&&(B.pseudohalf[S]=B.pseudohalf[S]==0?1:0,B.pseudohalf[S]==0&&B.noise_shaping_amp==2))return;for(h.scalefac[S]++,g=-b;g<0;g++)C[x+g]*=d,C[x+g]>h.xrpow_max&&(h.xrpow_max=C[x+g]);if(B.noise_shaping_amp==2)return}}}function i(N,h){for(var k=1.2968395546510096,C=0,A=0;A<N.sfbmax;A++){var B=N.width[A],d=N.scalefac[A];if(N.preflag!=0&&(d+=s.pretab[A]),C+=B,(d&1)!=0){d++;for(var E=-B;E<0;E++)h[C+E]*=k,h[C+E]>N.xrpow_max&&(N.xrpow_max=h[C+E])}N.scalefac[A]=d>>1}N.preflag=0,N.scalefac_scale=1}function H(N,h,k){var C,A=h.scalefac;for(C=0;C<h.sfb_lmax;C++)if(A[C]>=16)return!0;for(var B=0;B<3;B++){var d=0,E=0;for(C=h.sfb_lmax+B;C<h.sfbdivide;C+=3)d<A[C]&&(d=A[C]);for(;C<h.sfbmax;C+=3)E<A[C]&&(E=A[C]);if(!(d<16&&E<8)){if(h.subblock_gain[B]>=7)return!0;h.subblock_gain[B]++;var S=N.scalefac_band.l[h.sfb_lmax];for(C=h.sfb_lmax+B;C<h.sfbmax;C+=3){var _,x=h.width[C],b=A[C];if(b=b-(4>>h.scalefac_scale),b>=0){A[C]=b,S+=x*3;continue}A[C]=0;{var g=210+(b<<h.scalefac_scale+1);_=s.IPOW20(g)}S+=x*(B+1);for(var M=-x;M<0;M++)k[S+M]*=_,k[S+M]>h.xrpow_max&&(h.xrpow_max=k[S+M]);S+=x*(3-B-1)}{var _=s.IPOW20(202);S+=h.width[C]*(B+1);for(var M=-h.width[C];M<0;M++)k[S+M]*=_,k[S+M]>h.xrpow_max&&(h.xrpow_max=k[S+M])}}}return!1}function L(N,h,k,C,A){var B=N.internal_flags;y(N,h,k,C,A);var d=c(h);return d?!1:(B.mode_gr==2?d=n.scale_bitcount(h):d=n.scale_bitcount_lsf(B,h),d?(B.noise_shaping>1&&(wr.fill(B.pseudohalf,0),h.scalefac_scale==0?(i(h,C),d=!1):h.block_type==O.SHORT_TYPE&&B.subblock_gain>0&&(d=H(B,h,C)||c(h))),d||(B.mode_gr==2?d=n.scale_bitcount(h):d=n.scale_bitcount_lsf(B,h)),!d):!0)}this.outer_loop=function(N,h,k,C,A,B){var d=N.internal_flags,E=new Ci,S=yn(576),_=yn(ba.SFBMAX),x=new Al,b,g=new wg,M=9999999,w=!1,j=!1,X=0;if(v(d,h,B,A,C),d.noise_shaping==0)return 100;s.calc_noise(h,k,_,x,g),x.bits=h.part2_3_length,E.assign(h);var F=0;for(xa.arraycopy(C,0,S,0,576);!w;){do{var V=new Al,f,T=255;if((d.substep_shaping&2)!=0?f=20:f=3,d.sfb21_extra&&(_[E.sfbmax]>1||E.block_type==O.SHORT_TYPE&&(_[E.sfbmax+1]>1||_[E.sfbmax+2]>1))||!L(N,E,_,C,j))break;E.scalefac_scale!=0&&(T=254);var W=B-E.part2_length;if(W<=0)break;for(;(E.part2_3_length=n.count_bits(d,C,E,g))>W&&E.global_gain<=T;)E.global_gain++;if(E.global_gain>T)break;if(x.over_count==0){for(;(E.part2_3_length=n.count_bits(d,C,E,g))>M&&E.global_gain<=T;)E.global_gain++;if(E.global_gain>T)break}if(s.calc_noise(E,k,_,V,g),V.bits=E.part2_3_length,h.block_type!=O.SHORT_TYPE?b=N.quant_comp:b=N.quant_comp_short,b=p(b,x,V,E,_)?1:0,b!=0)M=h.part2_3_length,x=V,h.assign(E),F=0,xa.arraycopy(C,0,S,0,576);else if(d.full_outer_loop==0&&(++F>f&&x.over_count==0||d.noise_shaping_amp==3&&j&&F>30||d.noise_shaping_amp==3&&j&&E.global_gain-X>15))break}while(E.global_gain+E.scalefac_scale<255);d.noise_shaping_amp==3?j?w=!0:(E.assign(h),xa.arraycopy(S,0,C,0,576),F=0,X=E.global_gain,j=!0):w=!0}return xn(h.global_gain+h.scalefac_scale<=255),N.VBR==Zu.vbr_rh||N.VBR==Zu.vbr_mtrh?xa.arraycopy(S,0,C,0,576):(d.substep_shaping&1)!=0&&trancate_smallspectrums(d,h,k,C),x.over_count},this.iteration_finish_one=function(N,h,k){var C=N.l3_side,A=C.tt[h][k];n.best_scalefac_store(N,h,k,C),N.use_best_huffman==1&&n.best_huffman_divide(N,A),t.ResvAdjust(N,A)},this.VBR_encode_granule=function(N,h,k,C,A,B,d){var E=N.internal_flags,S=new Ci,_=yn(576),x=d,b=d+1,g=(d+B)/2,M,w,j=0,X=E.sfb21_extra;xn(x<=LameInternalFlags.MAX_BITS_PER_CHANNEL),wr.fill(S.l3_enc,0);do g>x-42?E.sfb21_extra=!1:E.sfb21_extra=X,w=outer_loop(N,h,k,C,A,g),w<=0?(j=1,b=h.part2_3_length,S.assign(h),xa.arraycopy(C,0,_,0,576),d=b-32,M=d-B,g=(d+B)/2):(B=g+32,M=d-B,g=(d+B)/2,j!=0&&(j=2,h.assign(S),xa.arraycopy(_,0,C,0,576)));while(M>12);E.sfb21_extra=X,j==2&&xa.arraycopy(S.l3_enc,0,h.l3_enc,0,576),xn(h.part2_3_length<=x)},this.get_framebits=function(N,h){var k=N.internal_flags;k.bitrate_index=k.VBR_min_bitrate;var C=e.getframebits(N);k.bitrate_index=1,C=e.getframebits(N);for(var A=1;A<=k.VBR_max_bitrate;A++){k.bitrate_index=A;var B=new MeanBits(C);h[A]=t.ResvFrameBegin(N,B),C=B.bits}},this.VBR_old_prepare=function(N,h,k,C,A,B,d,E,S){var _=N.internal_flags,x,b=0,g=1,M=0;_.bitrate_index=_.VBR_max_bitrate;var w=t.ResvFrameBegin(N,new MeanBits(0))/_.mode_gr;get_framebits(N,B);for(var j=0;j<_.mode_gr;j++){var X=s.on_pe(N,h,E[j],w,j,0);_.mode_ext==O.MPG_MD_MS_LR&&(ms_convert(_.l3_side,j),s.reduce_side(E[j],k[j],w,X));for(var F=0;F<_.channels_out;++F){var V=_.l3_side.tt[j][F];V.block_type!=O.SHORT_TYPE?(b=1.28/(1+Math.exp(3.5-h[j][F]/300))-.05,x=_.PSY.mask_adjust-b):(b=2.56/(1+Math.exp(3.5-h[j][F]/300))-.14,x=_.PSY.mask_adjust_short-b),_.masking_lower=Math.pow(10,x*.1),init_outer_loop(_,V),S[j][F]=s.calc_xmin(N,C[j][F],V,A[j][F]),S[j][F]!=0&&(g=0),d[j][F]=126,M+=E[j][F]}}for(var j=0;j<_.mode_gr;j++)for(var F=0;F<_.channels_out;F++)M>B[_.VBR_max_bitrate]&&(E[j][F]*=B[_.VBR_max_bitrate],E[j][F]/=M),d[j][F]>E[j][F]&&(d[j][F]=E[j][F]);return g},this.bitpressure_strategy=function(N,h,k,C){for(var A=0;A<N.mode_gr;A++)for(var B=0;B<N.channels_out;B++){for(var d=N.l3_side.tt[A][B],E=h[A][B],S=0,_=0;_<d.psy_lmax;_++)E[S++]*=1+.029*_*_/O.SBMAX_l/O.SBMAX_l;if(d.block_type==O.SHORT_TYPE)for(var _=d.sfb_smin;_<O.SBMAX_s;_++)E[S++]*=1+.029*_*_/O.SBMAX_s/O.SBMAX_s,E[S++]*=1+.029*_*_/O.SBMAX_s/O.SBMAX_s,E[S++]*=1+.029*_*_/O.SBMAX_s/O.SBMAX_s;C[A][B]=0|Math.max(k[A][B],.9*C[A][B])}},this.VBR_new_prepare=function(N,h,k,C,A,B){var d=N.internal_flags,E=1,S=0,_=0,x;if(N.free_format){d.bitrate_index=0;var b=new MeanBits(S);x=t.ResvFrameBegin(N,b),S=b.bits,A[0]=x}else{d.bitrate_index=d.VBR_max_bitrate;var b=new MeanBits(S);t.ResvFrameBegin(N,b),S=b.bits,get_framebits(N,A),x=A[d.VBR_max_bitrate]}for(var g=0;g<d.mode_gr;g++){s.on_pe(N,h,B[g],S,g,0),d.mode_ext==O.MPG_MD_MS_LR&&ms_convert(d.l3_side,g);for(var M=0;M<d.channels_out;++M){var w=d.l3_side.tt[g][M];d.masking_lower=Math.pow(10,d.PSY.mask_adjust*.1),init_outer_loop(d,w),s.calc_xmin(N,k[g][M],w,C[g][M])!=0&&(E=0),_+=B[g][M]}}for(var g=0;g<d.mode_gr;g++)for(var M=0;M<d.channels_out;M++)_>x&&(B[g][M]*=x,B[g][M]/=_);return E},this.calc_target_bits=function(N,h,k,C,A,B){var d=N.internal_flags,E=d.l3_side,S,_,x,b,g=0;d.bitrate_index=d.VBR_max_bitrate;var M=new MeanBits(g);for(B[0]=t.ResvFrameBegin(N,M),g=M.bits,d.bitrate_index=1,g=e.getframebits(N)-d.sideinfo_len*8,A[0]=g/(d.mode_gr*d.channels_out),g=N.VBR_mean_bitrate_kbps*N.framesize*1e3,(d.substep_shaping&1)!=0&&(g*=1.09),g/=N.out_samplerate,g-=d.sideinfo_len*8,g/=d.mode_gr*d.channels_out,S=.93+.07*(11-N.compression_ratio)/(11-5.5),S<.9&&(S=.9),S>1&&(S=1),_=0;_<d.mode_gr;_++){var w=0;for(x=0;x<d.channels_out;x++){if(C[_][x]=int(S*g),h[_][x]>700){var j=int((h[_][x]-700)/1.4),X=E.tt[_][x];C[_][x]=int(S*g),X.block_type==O.SHORT_TYPE&&j<g/2&&(j=g/2),j>g*3/2?j=g*3/2:j<0&&(j=0),C[_][x]+=j}C[_][x]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(C[_][x]=LameInternalFlags.MAX_BITS_PER_CHANNEL),w+=C[_][x]}if(w>LameInternalFlags.MAX_BITS_PER_GRANULE)for(x=0;x<d.channels_out;++x)C[_][x]*=LameInternalFlags.MAX_BITS_PER_GRANULE,C[_][x]/=w}if(d.mode_ext==O.MPG_MD_MS_LR)for(_=0;_<d.mode_gr;_++)s.reduce_side(C[_],k[_],g*d.channels_out,LameInternalFlags.MAX_BITS_PER_GRANULE);for(b=0,_=0;_<d.mode_gr;_++)for(x=0;x<d.channels_out;x++)C[_][x]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(C[_][x]=LameInternalFlags.MAX_BITS_PER_CHANNEL),b+=C[_][x];if(b>B[0])for(_=0;_<d.mode_gr;_++)for(x=0;x<d.channels_out;x++)C[_][x]*=B[0],C[_][x]/=b}}var Qu=ke.assert;function Mg(){var e;this.setModules=function(t){e=t},this.ResvFrameBegin=function(t,s){var a=t.internal_flags,n,r=a.l3_side,o=e.getframebits(t);s.bits=(o-a.sideinfo_len*8)/a.mode_gr;var l=8*256*a.mode_gr-8;t.brate>320?n=8*int(t.brate*1e3/(t.out_samplerate/1152)/8+.5):(n=8*1440,t.strict_ISO&&(n=8*int(32e4/(t.out_samplerate/1152)/8+.5))),a.ResvMax=n-o,a.ResvMax>l&&(a.ResvMax=l),(a.ResvMax<0||t.disable_reservoir)&&(a.ResvMax=0);var v=s.bits*a.mode_gr+Math.min(a.ResvSize,a.ResvMax);return v>n&&(v=n),Qu(a.ResvMax%8==0),Qu(a.ResvMax>=0),r.resvDrain_pre=0,a.pinfo!=null&&(a.pinfo.mean_bits=s.bits/2,a.pinfo.resvsize=a.ResvSize),v},this.ResvMaxBits=function(t,s,a,n){var r=t.internal_flags,o,l=r.ResvSize,v=r.ResvMax;n!=0&&(l+=s),(r.substep_shaping&1)!=0&&(v*=.9),a.bits=s,l*10>v*9?(o=l-v*9/10,a.bits+=o,r.substep_shaping|=128):(o=0,r.substep_shaping&=127,!t.disable_reservoir&&(r.substep_shaping&1)==0&&(a.bits-=.1*s));var c=l<r.ResvMax*6/10?l:r.ResvMax*6/10;return c-=o,c<0&&(c=0),c},this.ResvAdjust=function(t,s){t.ResvSize-=s.part2_3_length+s.part2_length},this.ResvFrameEnd=function(t,s){var a,n=t.l3_side;t.ResvSize+=s*t.mode_gr;var r=0;n.resvDrain_post=0,n.resvDrain_pre=0,(a=t.ResvSize%8)!=0&&(r+=a),a=t.ResvSize-r-t.ResvMax,a>0&&(r+=a);{var o=Math.min(n.main_data_begin*8,r)/8;n.resvDrain_pre+=8*o,r-=8*o,t.ResvSize-=8*o,n.main_data_begin-=o}n.resvDrain_post+=r,t.ResvSize-=r}}function Tg(){var e="http://www.mp3dev.org/",t=3,s=98,a=4,n=0,r=93;this.getLameVersion=function(){return t+"."+s+"."+a},this.getLameShortVersion=function(){return t+"."+s+"."+a},this.getLameVeryShortVersion=function(){return"LAME"+t+"."+s+"r"},this.getPsyVersion=function(){return n+"."+r},this.getLameUrl=function(){return e},this.getLameOsBitness=function(){return"32bits"}}var Eg=ke.System,Rl=ke.VbrMode,Ju=ke.ShortBlock,Ag=ke.Arrays,Hi=ke.new_byte,kg=ke.assert;wn.NUMTOCENTRIES=100,wn.MAXFRAMESIZE=2880;function wn(){var e,t,s;this.setModules=function(g,M,w){e=g,t=M,s=w};var a=1,n=2,r=4,o=8,l=wn.NUMTOCENTRIES,v=wn.MAXFRAMESIZE,c=l+4+4+4+4+4,m=c+9+1+1+8+1+1+3+1+1+2+4+2+2,u=128,p=64,y=32,i=null,H="Xing",L="Info",N=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];function h(g,M){if(g.nVbrNumFrames++,g.sum+=M,g.seen++,!(g.seen<g.want)&&(g.pos<g.size&&(g.bag[g.pos]=g.sum,g.pos++,g.seen=0),g.pos==g.size)){for(var w=1;w<g.size;w+=2)g.bag[w/2]=g.bag[w];g.want*=2,g.pos/=2}}function k(g,M){if(!(g.pos<=0))for(var w=1;w<l;++w){var j=w/l,X,F,V=0|Math.floor(j*g.pos);V>g.pos-1&&(V=g.pos-1),X=g.bag[V],F=g.sum;var f=0|256*X/F;f>255&&(f=255),M[w]=255&f}}this.addVbrFrame=function(g){var M=g.internal_flags,w=Tables.bitrate_table[g.version][M.bitrate_index];kg(M.VBR_seek_table.bag!=null),h(M.VBR_seek_table,w)};function C(g,M){var w=g[M+0]&255;return w<<=8,w|=g[M+1]&255,w<<=8,w|=g[M+2]&255,w<<=8,w|=g[M+3]&255,w}function A(g,M,w){g[M+0]=255&(w>>24&255),g[M+1]=255&(w>>16&255),g[M+2]=255&(w>>8&255),g[M+3]=255&(w&255)}function B(g,M,w){g[M+0]=255&(w>>8&255),g[M+1]=255&(w&255)}function d(g,M){return new String(g,M,H.length(),i).equals(H)||new String(g,M,L.length(),i).equals(L)}function E(g,M,w){return 255&(g<<M|w&~(-1<<M))}function S(g,M){var w=g.internal_flags;M[0]=E(M[0],8,255),M[1]=E(M[1],3,7),M[1]=E(M[1],1,g.out_samplerate<16e3?0:1),M[1]=E(M[1],1,g.version),M[1]=E(M[1],2,4-3),M[1]=E(M[1],1,g.error_protection?0:1),M[2]=E(M[2],4,w.bitrate_index),M[2]=E(M[2],2,w.samplerate_index),M[2]=E(M[2],1,0),M[2]=E(M[2],1,g.extension),M[3]=E(M[3],2,g.mode.ordinal()),M[3]=E(M[3],2,w.mode_ext),M[3]=E(M[3],1,g.copyright),M[3]=E(M[3],1,g.original),M[3]=E(M[3],2,g.emphasis),M[0]=255;var j=255&(M[1]&241),X;g.version==1?X=u:g.out_samplerate<16e3?X=y:X=p,g.VBR==Rl.vbr_off&&(X=g.brate);var F;g.free_format?F=0:F=255&16*e.BitrateIndex(X,g.version,g.out_samplerate),g.version==1?(M[1]=255&(j|10),j=255&(M[2]&13),M[2]=255&(F|j)):(M[1]=255&(j|2),j=255&(M[2]&13),M[2]=255&(F|j))}this.getVbrTag=function(g){var M=new VBRTagData,w=0;M.flags=0;var j=g[w+1]>>3&1,X=g[w+2]>>2&3,F=g[w+3]>>6&3,V=g[w+2]>>4&15;if(V=Tables.bitrate_table[j][V],g[w+1]>>4==14?M.samprate=Tables.samplerate_table[2][X]:M.samprate=Tables.samplerate_table[j][X],j!=0?F!=3?w+=32+4:w+=17+4:F!=3?w+=17+4:w+=9+4,!d(g,w))return null;w+=4,M.hId=j;var f=M.flags=C(g,w);if(w+=4,(f&a)!=0&&(M.frames=C(g,w),w+=4),(f&n)!=0&&(M.bytes=C(g,w),w+=4),(f&r)!=0){if(M.toc!=null)for(var T=0;T<l;T++)M.toc[T]=g[w+T];w+=l}M.vbrScale=-1,(f&o)!=0&&(M.vbrScale=C(g,w),w+=4),M.headersize=(j+1)*72e3*V/M.samprate,w+=21;var W=g[w+0]<<4;W+=g[w+1]>>4;var Z=(g[w+1]&15)<<8;return Z+=g[w+2]&255,(W<0||W>3e3)&&(W=-1),(Z<0||Z>3e3)&&(Z=-1),M.encDelay=W,M.encPadding=Z,M},this.InitVbrTag=function(g){var M=g.internal_flags,w;g.version==1?w=u:g.out_samplerate<16e3?w=y:w=p,g.VBR==Rl.vbr_off&&(w=g.brate);var j=(g.version+1)*72e3*w/g.out_samplerate,X=M.sideinfo_len+m;if(M.VBR_seek_table.TotalFrameSize=j,j<X||j>v){g.bWriteVbrTag=!1;return}M.VBR_seek_table.nVbrNumFrames=0,M.VBR_seek_table.nBytesWritten=0,M.VBR_seek_table.sum=0,M.VBR_seek_table.seen=0,M.VBR_seek_table.want=1,M.VBR_seek_table.pos=0,M.VBR_seek_table.bag==null&&(M.VBR_seek_table.bag=new int[400],M.VBR_seek_table.size=400);var F=Hi(v);S(g,F);for(var V=M.VBR_seek_table.TotalFrameSize,f=0;f<V;++f)t.add_dummy_byte(g,F[f]&255,1)};function _(g,M){var w=M^g;return M=M>>8^N[w&255],M}this.updateMusicCRC=function(g,M,w,j){for(var X=0;X<j;++X)g[0]=_(M[w+X],g[0])};function x(g,M,w,j,X){var F=g.internal_flags,V=0,f=g.encoder_delay,T=g.encoder_padding,W=100-10*g.VBR_q-g.quality,Z=s.getLameVeryShortVersion(),de,Me=0,Te,ve=[1,5,3,2,4,0,3],De=0|(g.lowpassfreq/100+.5>255?255:g.lowpassfreq/100+.5),Le=0,me=0,Ge=0,ot=g.internal_flags.noise_shaping,D=0,z=0,te=0,le=0,ue=0,xe=(g.exp_nspsytune&1)!=0,Ee=(g.exp_nspsytune&2)!=0,be=!1,Se=!1,he=g.internal_flags.nogap_total,Pe=g.internal_flags.nogap_current,Ne=g.ATHtype,Fe=0,Ue;switch(g.VBR){case vbr_abr:Ue=g.VBR_mean_bitrate_kbps;break;case vbr_off:Ue=g.brate;break;default:Ue=g.VBR_min_bitrate_kbps}switch(g.VBR.ordinal()<ve.length?de=ve[g.VBR.ordinal()]:de=0,Te=16*Me+de,F.findReplayGain&&(F.RadioGain>510&&(F.RadioGain=510),F.RadioGain<-510&&(F.RadioGain=-510),me=8192,me|=3072,F.RadioGain>=0?me|=F.RadioGain:(me|=512,me|=-F.RadioGain)),F.findPeakSample&&(Le=Math.abs(0|F.PeakSample/32767*Math.pow(2,23)+.5)),he!=-1&&(Pe>0&&(Se=!0),Pe<he-1&&(be=!0)),Fe=Ne+((xe?1:0)<<4)+((Ee?1:0)<<5)+((be?1:0)<<6)+((Se?1:0)<<7),W<0&&(W=0),g.mode){case MONO:D=0;break;case STEREO:D=1;break;case DUAL_CHANNEL:D=2;break;case JOINT_STEREO:g.force_ms?D=4:D=3;break;case NOT_SET:default:D=7;break}g.in_samplerate<=32e3?te=0:g.in_samplerate==48e3?te=2:g.in_samplerate>48e3?te=3:te=1,(g.short_blocks==Ju.short_block_forced||g.short_blocks==Ju.short_block_dispensed||g.lowpassfreq==-1&&g.highpassfreq==-1||g.scale_left<g.scale_right||g.scale_left>g.scale_right||g.disable_reservoir&&g.brate<320||g.noATH||g.ATHonly||Ne==0||g.in_samplerate<=32e3)&&(z=1),le=ot+(D<<2)+(z<<5)+(te<<6),ue=F.nMusicCRC,A(w,j+V,W),V+=4;for(var We=0;We<9;We++)w[j+V+We]=255&Z.charAt(We);V+=9,w[j+V]=255&Te,V++,w[j+V]=255&De,V++,A(w,j+V,Le),V+=4,B(w,j+V,me),V+=2,B(w,j+V,Ge),V+=2,w[j+V]=255&Fe,V++,Ue>=255?w[j+V]=255:w[j+V]=255&Ue,V++,w[j+V]=255&f>>4,w[j+V+1]=255&(f<<4)+(T>>8),w[j+V+2]=255&T,V+=3,w[j+V]=255&le,V++,w[j+V++]=0,B(w,j+V,g.preset),V+=2,A(w,j+V,M),V+=4,B(w,j+V,ue),V+=2;for(var ce=0;ce<V;ce++)X=_(w[j+ce],X);return B(w,j+V,X),V+=2,V}function b(g){g.seek(0);var M=Hi(10);g.readFully(M);var w;return new String(M,"ISO-8859-1").startsWith("ID3")?w=0:w=((M[6]&127)<<21|(M[7]&127)<<14|(M[8]&127)<<7|M[9]&127)+M.length,w}this.getLameTagFrame=function(g,M){var w=g.internal_flags;if(!g.bWriteVbrTag||w.Class_ID!=Lame.LAME_ID||w.VBR_seek_table.pos<=0)return 0;if(M.length<w.VBR_seek_table.TotalFrameSize)return w.VBR_seek_table.TotalFrameSize;Ag.fill(M,0,w.VBR_seek_table.TotalFrameSize,0),S(g,M);var j=Hi(l);if(g.free_format)for(var X=1;X<l;++X)j[X]=255&255*X/100;else k(w.VBR_seek_table,j);var F=w.sideinfo_len;g.error_protection&&(F-=2),g.VBR==Rl.vbr_off?(M[F++]=255&L.charAt(0),M[F++]=255&L.charAt(1),M[F++]=255&L.charAt(2),M[F++]=255&L.charAt(3)):(M[F++]=255&H.charAt(0),M[F++]=255&H.charAt(1),M[F++]=255&H.charAt(2),M[F++]=255&H.charAt(3)),A(M,F,a+n+r+o),F+=4,A(M,F,w.VBR_seek_table.nVbrNumFrames),F+=4;var V=w.VBR_seek_table.nBytesWritten+w.VBR_seek_table.TotalFrameSize;A(M,F,0|V),F+=4,Eg.arraycopy(j,0,M,F,j.length),F+=j.length,g.error_protection&&t.CRC_writeheader(w,M);for(var f=0,X=0;X<F;X++)f=_(M[X],f);return F+=x(g,V,M,F,f),w.VBR_seek_table.TotalFrameSize},this.putVbrTag=function(g,M){var w=g.internal_flags;if(w.VBR_seek_table.pos<=0||(M.seek(M.length()),M.length()==0))return-1;var j=b(M);M.seek(j);var X=Hi(v),F=getLameTagFrame(g,X);return F>X.length?-1:(F<1||M.write(X,0,F),0)}}var $u=ke.new_byte,Rg=ke.assert;function Og(){this.setModules=function(e,t){}}function Ig(){this.setModules=function(e,t,s){}}function Cg(){}function Bg(){this.setModules=function(e,t){}}function Lg(e,t,s){arguments.length!=3&&(console.error("WARN: Mp3Encoder(channels, samplerate, kbps) not specified"),e=1,t=44100,s=128);var a=new Je,n=new Og,r=new Lt,o=new As,l=new bg,v=new Zt,c=new Sg,m=new wn,u=new Tg,p=new Bg,y=new Mg,i=new bn,H=new Ig,L=new Cg;a.setModules(r,o,l,v,c,m,u,p,L),o.setModules(r,L,u,m),p.setModules(o,u),l.setModules(a),c.setModules(o,y,v,i),v.setModules(i,y,a.enc.psy),y.setModules(o),i.setModules(v),m.setModules(a,o,u),n.setModules(H,L),H.setModules(u,p,l);var N=a.lame_init();N.num_channels=e,N.in_samplerate=t,N.brate=s,N.mode=vt.STEREO,N.quality=3,N.bWriteVbrTag=!1,N.disable_reservoir=!0,N.write_id3tag_automatic=!1,a.lame_init_params(N);var h=1152,k=0|1.25*h+7200,C=$u(k);this.encodeBuffer=function(A,B){e==1&&(B=A),Rg(A.length==B.length),A.length>h&&(h=A.length,k=0|1.25*h+7200,C=$u(k));var d=a.lame_encode_buffer(N,A,B,A.length,C,0,k);return new Int8Array(C.subarray(0,d))},this.flush=function(){var A=a.lame_encode_flush(N,C,0,k);return new Int8Array(C.subarray(0,A))}}function Pi(e){return e.charCodeAt(0)<<24|e.charCodeAt(1)<<16|e.charCodeAt(2)<<8|e.charCodeAt(3)}Pi("RIFF"),Pi("WAVE"),Pi("fmt "),Pi("data");class ed{constructor(t){this.bitRate=t.bitRate,this.sampleRate=t.sampleRate,this.dataBuffer=[],this.encoder=new Lg(1,this.sampleRate,this.bitRate)}encode(t){const a=this._convertBuffer(t);let n=a.length;for(let r=0;n>=0;r+=1152){const o=a.subarray(r,r+1152),l=this.encoder.encodeBuffer(o);this.dataBuffer.push(new Int8Array(l)),n-=1152}}finish(){this.dataBuffer.push(this.encoder.flush());const t=new Blob(this.dataBuffer,{type:"audio/mp3"});return this.dataBuffer=[],{id:Date.now(),blob:t,url:URL.createObjectURL(t)}}_floatTo16BitPCM(t,s){for(let a=0;a<t.length;a++){const n=Math.max(-1,Math.min(1,t[a]));s[a]=n<0?n*32768:n*32767}}_convertBuffer(t){const s=new Float32Array(t),a=new Int16Array(t.length);return this._floatTo16BitPCM(s,a),a}}class Ng{constructor(t={}){this.beforeRecording=t.beforeRecording,this.pauseRecording=t.pauseRecording,this.afterRecording=t.afterRecording,this.micFailed=t.micFailed,this.encoderOptions={bitRate:t.bitRate,sampleRate:t.sampleRate},this.bufferSize=4096,this.records=[],this.isPause=!1,this.isRecording=!1,this.duration=0,this.volume=0,this._duration=0}start(){const t={video:!1,audio:{channelCount:1,echoCancellation:!1}};this.beforeRecording&&this.beforeRecording("start recording"),navigator.mediaDevices.getUserMedia(t).then(this._micCaptured.bind(this)).catch(this._micError.bind(this)),this.isPause=!1,this.isRecording=!0}stop(){this.stream.getTracks().forEach(s=>s.stop()),this.input.disconnect(),this.processor.disconnect(),this.context.close();let t=null;t=this.lameEncoder.finish(),t.duration=this.duration,this.records.push(t),this._duration=0,this.duration=0,this.isPause=!1,this.isRecording=!1,this.afterRecording&&this.afterRecording(t)}pause(){this.stream.getTracks().forEach(t=>t.stop()),this.input.disconnect(),this.processor.disconnect(),this._duration=this.duration,this.isPause=!0,this.pauseRecording&&this.pauseRecording("pause recording")}_micCaptured(t){this.context=new(window.AudioContext||window.webkitAudioContext),this.duration=this._duration,this.input=this.context.createMediaStreamSource(t),this.processor=this.context.createScriptProcessor(this.bufferSize,1,1),this.stream=t,t.getAudioTracks()[0].getSettings().sampleRate!==this.encoderOptions.sampleRate&&(this.encoderOptions.sampleRate=t.getAudioTracks()[0].getSettings().sampleRate,this.lameEncoder=new ed(this.encoderOptions)),this.lameEncoder||(this.lameEncoder=new ed(this.encoderOptions)),this.processor.onaudioprocess=a=>{const n=a.inputBuffer.getChannelData(0);let r=0;this.lameEncoder&&this.lameEncoder.encode(n);for(let o=0;o<n.length;++o)r+=n[o]*n[o];this.duration=parseFloat(this._duration)+parseFloat(this.context.currentTime.toFixed(2)),this.volume=Math.sqrt(r/n.length).toFixed(2)},this.input.connect(this.processor),this.processor.connect(this.context.destination)}_micError(t){this.micFailed&&this.micFailed(t)}}var td=window.chrome,Ol=window.navigator,jg=Ol.vendor,Hg=typeof window.opr!="undefined",Pg=Ol.userAgent.indexOf("Edg")>-1,Fg=Ol.userAgent.match("CriOS");function Dg(){return Fg?!0:td!==null&&typeof td!="undefined"&&jg==="Google Inc."&&Hg===!1&&Pg===!1}function sd(){var e=Ug(),t=e.substr(0,4);return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw(n|u)|c55\/|capi|ccwa|cdm|cell|chtm|cldc|cmd|co(mp|nd)|craw|da(it|ll|ng)|dbte|dcs|devi|dica|dmob|do(c|p)o|ds(12|d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(|_)|g1 u|g560|gene|gf5|gmo|go(\.w|od)|gr(ad|un)|haie|hcit|hd(m|p|t)|hei|hi(pt|ta)|hp( i|ip)|hsc|ht(c(| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i(20|go|ma)|i230|iac( ||\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|[a-w])|libw|lynx|m1w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|mcr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|([1-8]|c))|phil|pire|pl(ay|uc)|pn2|po(ck|rt|se)|prox|psio|ptg|qaa|qc(07|12|21|32|60|[2-7]|i)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h|oo|p)|sdk\/|se(c(|0|1)|47|mc|nd|ri)|sgh|shar|sie(|m)|sk0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h|v|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl|tdg|tel(i|m)|tim|tmo|to(pl|sh)|ts(70|m|m3|m5)|tx9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas|your|zeto|zte/i.test(t)}function Ug(){var e=navigator.userAgent||navigator.vendor||window.opera||null;if(!e)throw new Error("Failed to look for user agent information.");return e}const qg={name:"RoomFooter",components:{SvgIcon:Vt,EmojiPickerContainer:Eu,RoomFiles:Xp,RoomMessageReply:_3,RoomUsersTag:S3,RoomEmojis:k3,RoomTemplatesText:j3},directives:{clickOutside:mi},props:{room:{type:Object,required:!0},roomId:{type:[String,Number],required:!0},roomMessage:{type:String,default:null},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},textMessages:{type:Object,required:!0},showSendIcon:{type:Boolean,required:!0},showFiles:{type:Boolean,required:!0},showAudio:{type:Boolean,required:!0},showEmojis:{type:Boolean,required:!0},showFooter:{type:Boolean,required:!0},acceptedFiles:{type:String,required:!0},captureFiles:{type:String,required:!0},textareaActionEnabled:{type:Boolean,required:!0},textareaAutoFocus:{type:Boolean,required:!0},userTagsEnabled:{type:Boolean,required:!0},emojisSuggestionEnabled:{type:Boolean,required:!0},templatesText:{type:Array,default:null},audioBitRate:{type:Number,required:!0},audioSampleRate:{type:Number,required:!0},initReplyMessage:{type:Object,default:null},initEditMessage:{type:Object,default:null},droppedFiles:{type:Array,default:null},emojiDataSource:{type:String,default:void 0}},emits:["edit-message","send-message","update-edited-message-id","textarea-action-handler","typing-message"],data(){return{message:"",editedMessage:{},messageReply:null,cursorRangePosition:null,files:[],fileDialog:!1,selectUsersTagItem:null,selectEmojiItem:null,selectTemplatesTextItem:null,format:"mp3",activeUpOrDownEmojis:null,activeUpOrDownUsersTag:null,activeUpOrDownTemplatesText:null,emojisDB:new S1({dataSource:this.emojiDataSource}),emojiOpened:!1,keepKeyboardOpen:!1,filteredEmojis:[],filteredUsersTag:[],selectedUsersTag:[],filteredTemplatesText:[],recorder:this.initRecorder(),isRecording:!1}},computed:{isMessageEmpty(){return!this.files.length&&!this.message.trim()},isFileLoading(){return this.files.some(e=>e.loading)},recordedTime(){return new Date(this.recorder.duration*1e3).toISOString().substr(14,5)},shadowFooter(){return!!this.filteredEmojis.length||!!this.filteredUsersTag.length||!!this.filteredTemplatesText.length||!!this.files.length||!!this.messageReply}},watch:{roomId(){this.resetMessage(!0,!0),this.roomMessage&&(this.message=this.roomMessage,setTimeout(()=>this.onChangeInput()))},message(e){this.getTextareaRef().value=e},roomMessage:{immediate:!0,handler(e){e&&(this.message=this.roomMessage)}},editedMessage(e){this.$emit("update-edited-message-id",e._id)},initReplyMessage(e){e&&this.replyMessage(e)},initEditMessage(e){e&&this.editMessage(e)},droppedFiles(e){e&&this.onFileChange(e)}},mounted(){const e=sd();let t=!0;this.getTextareaRef().addEventListener("keyup",s=>{s.key==="Enter"&&!s.shiftKey&&!this.fileDialog&&(e?(this.message=this.message+`
`,setTimeout(()=>this.onChangeInput())):t&&!this.filteredEmojis.length&&!this.filteredUsersTag.length&&!this.filteredTemplatesText.length&&this.sendMessage()),t=!s.isComposing,setTimeout(()=>{this.updateFooterLists()},60)}),this.getTextareaRef().addEventListener("click",()=>{e&&(this.keepKeyboardOpen=!0),this.updateFooterLists()}),this.getTextareaRef().addEventListener("blur",()=>{setTimeout(()=>{this.resetFooterList()},100),e&&setTimeout(()=>this.keepKeyboardOpen=!1)})},beforeUnmount(){this.stopRecorder()},methods:{getTextareaRef(){return this.$refs.roomTextarea},focusTextarea(e){sd()&&e||!this.getTextareaRef()||(this.getTextareaRef().focus(),this.cursorRangePosition&&setTimeout(()=>{const t=Dg()?0:1;this.getTextareaRef().setSelectionRange(this.cursorRangePosition+t,this.cursorRangePosition+t),this.cursorRangePosition=null}))},onChangeInput(){var e,t,s;(((e=this.getTextareaRef())==null?void 0:e.value)||((t=this.getTextareaRef())==null?void 0:t.value)==="")&&(this.message=(s=this.getTextareaRef())==null?void 0:s.value),this.keepKeyboardOpen=!0,this.resizeTextarea(),this.$emit("typing-message",this.message)},resizeTextarea(){const e=this.getTextareaRef();if(!e)return;const t=window.getComputedStyle(e,null).getPropertyValue("padding-top").replace("px","");e.style.height=0,e.style.height=e.scrollHeight-t*2+"px"},escapeTextarea(){this.filteredEmojis.length?this.filteredEmojis=[]:this.filteredUsersTag.length?this.filteredUsersTag=[]:this.filteredTemplatesText.length?this.filteredTemplatesText=[]:this.resetMessage()},onPasteImage(e){var s;const t=(s=e.clipboardData)==null?void 0:s.items;t&&Array.from(t).forEach(a=>{if(a.type.includes("image")){const n=a.getAsFile();this.onFileChange([n])}})},updateActiveUpOrDown(e,t){this.filteredEmojis.length?(this.activeUpOrDownEmojis=t,e.preventDefault()):this.filteredUsersTag.length?(this.activeUpOrDownUsersTag=t,e.preventDefault()):this.filteredTemplatesText.length&&(this.activeUpOrDownTemplatesText=t,e.preventDefault())},selectItem(){this.filteredEmojis.length?this.selectEmojiItem=!0:this.filteredUsersTag.length?this.selectUsersTagItem=!0:this.filteredTemplatesText.length&&(this.selectTemplatesTextItem=!0)},selectEmoji(e){if(this.selectEmojiItem=!1,!e)return;const{position:t,endPosition:s}=this.getCharPosition(":");this.message=this.message.substr(0,t-1)+e+this.message.substr(s,this.message.length-1),this.cursorRangePosition=t,this.focusTextarea()},selectTemplateText(e){if(this.selectTemplatesTextItem=!1,!e)return;const{position:t,endPosition:s}=this.getCharPosition("/"),a=this.message.substr(s,s).length?"":" ";this.message=this.message.substr(0,t-1)+e.text+a+this.message.substr(s,this.message.length-1),this.cursorRangePosition=t+e.text.length+a.length+1,this.focusTextarea()},addEmoji(e){this.message+=e.unicode,this.focusTextarea(!0)},launchFilePicker(){this.$refs.file.value="",this.$refs.file.click()},async onFileChange(e){this.fileDialog=!0,this.focusTextarea(),Array.from(e).forEach(async t=>{const s=URL.createObjectURL(t),a=t.name.lastIndexOf(".");this.files.push({loading:!0,name:t.name.substring(0,a),size:t.size,type:t.type,extension:t.name.substring(a+1),localUrl:s});const n=await fetch(s).then(o=>o.blob());let r=this.files.find(o=>o.localUrl===s);r&&(r.blob=n,r.loading=!1,delete r.loading)}),setTimeout(()=>this.fileDialog=!1,500)},removeFile(e){this.files.splice(e,1),this.focusTextarea()},toggleRecorder(e){if(this.isRecording=e,!this.recorder.isRecording)setTimeout(()=>this.recorder.start(),200);else try{this.recorder.stop();const t=this.recorder.records[0];this.files.push({blob:t.blob,name:`audio.${this.format}`,size:t.blob.size,duration:t.duration,type:t.blob.type,audio:!0,localUrl:URL.createObjectURL(t.blob)}),this.recorder=this.initRecorder(),this.sendMessage()}catch{setTimeout(()=>this.stopRecorder(),100)}},stopRecorder(){if(this.recorder.isRecording)try{this.recorder.stop(),this.recorder=this.initRecorder()}catch{setTimeout(()=>this.stopRecorder(),100)}},textareaActionHandler(){this.$emit("textarea-action-handler",this.message)},sendMessage(){var s;let e=this.message.trim();if(!this.files.length&&!e||this.isFileLoading)return;this.selectedUsersTag.forEach(a=>{e=e.replace(`@${a.username}`,`<usertag>${a._id}</usertag>`)});const t=this.files.length?this.files:null;this.editedMessage._id?(this.editedMessage.content!==e||((s=this.editedMessage.files)==null?void 0:s.length)||this.files.length)&&this.$emit("edit-message",{messageId:this.editedMessage._id,newContent:e,files:t,replyMessage:this.messageReply,usersTag:this.selectedUsersTag}):this.$emit("send-message",{content:e,files:t,replyMessage:this.messageReply,usersTag:this.selectedUsersTag}),this.resetMessage(!0)},editMessage(e){this.resetMessage(),this.editedMessage={...e};let t=e.content;const s=t,a="<usertag>",n="</usertag>";[...t.matchAll(new RegExp(a,"gi"))].map(o=>o.index).forEach(o=>{const l=s.substring(o+a.length,s.indexOf(n,o)),v=this.room.users.find(c=>c._id===l);t=t.replace(`${a}${l}${n}`,`@${(v==null?void 0:v.username)||"unknown"}`),this.selectUserTag(v,!0)}),this.message=t,e.files&&(this.files=[...e.files]),setTimeout(()=>this.resizeTextarea())},replyMessage(e){this.editedMessage={},this.messageReply=e,this.focusTextarea()},updateFooterLists(){this.updateFooterList("@"),this.updateFooterList(":"),this.updateFooterList("/")},updateFooterList(e){if(!this.getTextareaRef()||e===":"&&!this.emojisSuggestionEnabled||e==="@"&&(!this.userTagsEnabled||!this.room.users)||e==="/"&&!this.templatesText)return;const t=this.getTextareaRef().selectionStart;let s=t;for(;s>0&&this.message.charAt(s-1)!==e&&(this.message.charAt(s-1)!==" "||e!==":");)s--;const a=this.message.charAt(s-2),n=!a.match(/^[0-9a-zA-Z]+$/);if(this.message.charAt(s-1)===e&&(!a||a===" "||n)){const r=this.message.substring(s,t);e===":"?this.updateEmojis(r):e==="@"?this.updateShowUsersTag(r):e==="/"&&this.updateShowTemplatesText(r)}else this.resetFooterList(e)},updateShowUsersTag(e){this.filteredUsersTag=Zo(this.room.users,"username",e,!0).filter(t=>t._id!==this.currentUserId)},selectUserTag(e,t=!1){if(this.selectUsersTagItem=!1,!e)return;const{position:s,endPosition:a}=this.getCharPosition("@"),n=this.message.substr(a,a).length?"":" ";this.message=this.message.substr(0,s)+e.username+n+this.message.substr(a,this.message.length-1),this.selectedUsersTag=[...this.selectedUsersTag,{...e}],t||(this.cursorRangePosition=s+e.username.length+n.length+1),this.focusTextarea()},updateShowTemplatesText(e){this.filteredTemplatesText=Zo(this.templatesText,"tag",e,!0)},getCharPosition(e){let s=this.getTextareaRef().selectionStart;for(;s>0&&this.message.charAt(s-1)!==e;)s--;const a=this.getTextareaRef().selectionEnd;return{position:s,endPosition:a}},async updateEmojis(e){if(!e)return;const t=await this.emojisDB.getEmojiBySearchQuery(e);this.filteredEmojis=t.map(s=>s.unicode)},resetFooterList(e=null){e===":"?this.filteredEmojis=[]:e==="@"?this.filteredUsersTag=[]:e==="/"?this.filteredTemplatesText=[]:(this.filteredEmojis=[],this.filteredUsersTag=[],this.filteredTemplatesText=[])},resetMessage(e=!1,t=!1){t||this.$emit("typing-message",null),this.selectedUsersTag=[],this.resetFooterList(),this.resetTextareaSize(),this.message="",this.editedMessage={},this.messageReply=null,this.files=[],this.emojiOpened=!1,this.preventKeyboardFromClosing(),(this.textareaAutoFocus||!t)&&setTimeout(()=>this.focusTextarea(e))},resetTextareaSize(){this.getTextareaRef()&&(this.getTextareaRef().style.height="20px")},preventKeyboardFromClosing(){this.keepKeyboardOpen&&this.getTextareaRef().focus()},initRecorder(){return this.isRecording=!1,new Ng({bitRate:Number(this.audioBitRate),sampleRate:Number(this.audioSampleRate),beforeRecording:null,afterRecording:null,pauseRecording:null,micFailed:this.micFailed})},micFailed(){this.isRecording=!1,this.recorder=this.initRecorder()}}},Vg={key:0,class:"vac-icon-textarea-left"},zg=fe("div",{class:"vac-dot-audio-record"},null,-1),Yg={class:"vac-dot-audio-record-time"},Xg=["placeholder"],Kg={class:"vac-icon-textarea"},Gg={key:1},Wg=["accept","capture"];function Zg(e,t,s,a,n,r){const o=Ke("room-emojis"),l=Ke("room-users-tag"),v=Ke("room-templates-text"),c=Ke("room-message-reply"),m=Ke("room-files"),u=Ke("svg-icon"),p=Ke("emoji-picker-container"),y=Gn("click-outside");return la((Q(),ne("div",{id:"room-footer",class:st(["vac-room-footer",{"vac-app-box-shadow":r.shadowFooter}])},[Re(o,{"filtered-emojis":n.filteredEmojis,"select-item":n.selectEmojiItem,"active-up-or-down":n.activeUpOrDownEmojis,onSelectEmoji:t[0]||(t[0]=i=>r.selectEmoji(i)),onActivateItem:t[1]||(t[1]=i=>n.activeUpOrDownEmojis=0)},null,8,["filtered-emojis","select-item","active-up-or-down"]),Re(l,{"filtered-users-tag":n.filteredUsersTag,"select-item":n.selectUsersTagItem,"active-up-or-down":n.activeUpOrDownUsersTag,onSelectUserTag:t[2]||(t[2]=i=>r.selectUserTag(i)),onActivateItem:t[3]||(t[3]=i=>n.activeUpOrDownUsersTag=0)},null,8,["filtered-users-tag","select-item","active-up-or-down"]),Re(v,{"filtered-templates-text":n.filteredTemplatesText,"select-item":n.selectTemplatesTextItem,"active-up-or-down":n.activeUpOrDownTemplatesText,onSelectTemplateText:t[4]||(t[4]=i=>r.selectTemplateText(i)),onActivateItem:t[5]||(t[5]=i=>n.activeUpOrDownTemplatesText=0)},null,8,["filtered-templates-text","select-item","active-up-or-down"]),Re(c,{room:s.room,"message-reply":n.messageReply,"text-formatting":s.textFormatting,"link-options":s.linkOptions,onResetMessage:r.resetMessage},gt({_:2},[at(e.$slots,(i,H)=>({name:H,fn:Xe(L=>[Oe(e.$slots,H,pt(_t(L)))])}))]),1032,["room","message-reply","text-formatting","link-options","onResetMessage"]),Re(m,{files:n.files,onRemoveFile:r.removeFile,onResetMessage:r.resetMessage},gt({_:2},[at(e.$slots,(i,H)=>({name:H,fn:Xe(L=>[Oe(e.$slots,H,pt(_t(L)))])}))]),1032,["files","onRemoveFile","onResetMessage"]),fe("div",{class:st(["vac-box-footer",{"vac-box-footer-border":!n.files.length}])},[s.showAudio&&!n.files.length?(Q(),ne("div",Vg,[n.isRecording?(Q(),ne(ut,{key:0},[fe("div",{class:"vac-svg-button vac-icon-audio-stop",onClick:t[6]||(t[6]=(...i)=>r.stopRecorder&&r.stopRecorder(...i))},[Oe(e.$slots,"audio-stop-icon",{},()=>[Re(u,{name:"close-outline"})])]),zg,fe("div",Yg,$e(r.recordedTime),1),fe("div",{class:"vac-svg-button vac-icon-audio-confirm",onClick:t[7]||(t[7]=i=>r.toggleRecorder(!1))},[Oe(e.$slots,"audio-check-icon",{},()=>[Re(u,{name:"checkmark"})])])],64)):(Q(),ne("div",{key:1,class:"vac-svg-button",onClick:t[8]||(t[8]=i=>r.toggleRecorder(!0))},[Oe(e.$slots,"microphone-icon",{},()=>[Re(u,{name:"microphone",class:"vac-icon-microphone"})])]))])):Ae("",!0),fe("textarea",{id:"roomTextarea",ref:"roomTextarea",placeholder:s.textMessages.TYPE_MESSAGE,class:st(["vac-textarea",{"vac-textarea-outline":n.editedMessage._id}]),style:{"min-height":"20px","padding-left":"12px"},onInput:t[9]||(t[9]=(...i)=>r.onChangeInput&&r.onChangeInput(...i)),onKeydown:[t[10]||(t[10]=La((...i)=>r.escapeTextarea&&r.escapeTextarea(...i),["esc"])),t[11]||(t[11]=La(Ds((...i)=>r.selectItem&&r.selectItem(...i),["exact","prevent"]),["enter"])),t[13]||(t[13]=La(Ds(()=>{},["exact","prevent"]),["tab"])),t[14]||(t[14]=La((...i)=>r.selectItem&&r.selectItem(...i),["tab"])),t[15]||(t[15]=La(i=>r.updateActiveUpOrDown(i,-1),["up"])),t[16]||(t[16]=La(i=>r.updateActiveUpOrDown(i,1),["down"]))],onPaste:t[12]||(t[12]=(...i)=>r.onPasteImage&&r.onPasteImage(...i))},null,42,Xg),fe("div",Kg,[n.editedMessage._id?(Q(),ne("div",{key:0,class:"vac-svg-button",onClick:t[17]||(t[17]=(...i)=>r.resetMessage&&r.resetMessage(...i))},[Oe(e.$slots,"edit-close-icon",{},()=>[Re(u,{name:"close-outline"})])])):Ae("",!0),s.showEmojis?la((Q(),ne("div",Gg,[Oe(e.$slots,"emoji-picker",Ao({emojiOpened:n.emojiOpened},{addEmoji:r.addEmoji}),()=>[Re(p,{"emoji-opened":n.emojiOpened,"position-top":!0,"emoji-data-source":s.emojiDataSource,onAddEmoji:r.addEmoji,onOpenEmoji:t[18]||(t[18]=i=>n.emojiOpened=i)},{"emoji-picker-icon":Xe(()=>[Oe(e.$slots,"emoji-picker-icon")]),_:3},8,["emoji-opened","emoji-data-source","onAddEmoji"])])])),[[y,()=>n.emojiOpened=!1]]):Ae("",!0),s.showFiles?(Q(),ne("div",{key:2,class:"vac-svg-button",onClick:t[19]||(t[19]=(...i)=>r.launchFilePicker&&r.launchFilePicker(...i))},[Oe(e.$slots,"paperclip-icon",{},()=>[Re(u,{name:"paperclip"})])])):Ae("",!0),s.textareaActionEnabled?(Q(),ne("div",{key:3,class:"vac-svg-button",onClick:t[20]||(t[20]=(...i)=>r.textareaActionHandler&&r.textareaActionHandler(...i))},[Oe(e.$slots,"custom-action-icon",{},()=>[Re(u,{name:"deleted"})])])):Ae("",!0),s.showFiles?(Q(),ne("input",{key:4,ref:"file",type:"file",multiple:"",accept:s.acceptedFiles,capture:s.captureFiles,style:{display:"none"},onChange:t[21]||(t[21]=i=>r.onFileChange(i.target.files))},null,40,Wg)):Ae("",!0),s.showSendIcon?(Q(),ne("div",{key:5,class:st(["vac-svg-button",{"vac-send-disabled":r.isMessageEmpty}]),onClick:t[22]||(t[22]=(...i)=>r.sendMessage&&r.sendMessage(...i))},[Oe(e.$slots,"send-icon",{},()=>[Re(u,{name:"send",param:r.isMessageEmpty||r.isFileLoading?"disabled":""},null,8,["param"])])],2)):Ae("",!0)])],2)],2)),[[si,Object.keys(s.room).length&&s.showFooter]])}var Qg=St(qg,[["render",Zg]]);const Jg={name:"MessageReply",components:{AudioPlayer:xl,SvgIcon:Vt,FormatMessage:sn},props:{message:{type:Object,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},roomUsers:{type:Array,required:!0}},computed:{replyUsername(){const{senderId:e}=this.message.replyMessage,t=this.roomUsers.find(s=>s._id===e);return t?t.username:""},firstFile(){var e,t;return(t=(e=this.message.replyMessage)==null?void 0:e.files)!=null&&t.length?this.message.replyMessage.files[0]:{}},isAudio(){return hi(this.firstFile)},isImage(){return hr(this.firstFile)},isVideo(){return rn(this.firstFile)},isOtherFile(){var e;return((e=this.message.replyMessage.files)==null?void 0:e.length)&&!this.isAudio&&!this.isVideo&&!this.isImage}}},$g={class:"vac-reply-message"},e4={class:"vac-reply-username"},t4={key:0,class:"vac-image-reply-container"},s4={key:1,class:"vac-video-reply-container"},a4={controls:""},r4=["src"],n4={key:3,class:"vac-file-container"},i4={class:"vac-text-ellipsis"},o4={key:0,class:"vac-text-ellipsis vac-text-extension"},l4={class:"vac-reply-content"};function c4(e,t,s,a,n,r){const o=Ke("audio-player"),l=Ke("svg-icon"),v=Ke("format-message");return Q(),ne("div",$g,[fe("div",e4,$e(r.replyUsername),1),r.isImage?(Q(),ne("div",t4,[fe("div",{class:"vac-message-image vac-message-image-reply",style:xt({"background-image":`url('${r.firstFile.url}')`})},null,4)])):r.isVideo?(Q(),ne("div",s4,[fe("video",a4,[fe("source",{src:r.firstFile.url},null,8,r4)])])):r.isAudio?(Q(),ht(o,{key:2,src:r.firstFile.url,"message-selection-enabled":!1,onUpdateProgressTime:t[0]||(t[0]=c=>e.progressTime=c),onHoverAudioProgress:t[1]||(t[1]=c=>e.hoverAudioProgress=c)},gt({_:2},[at(e.$slots,(c,m)=>({name:m,fn:Xe(u=>[Oe(e.$slots,m,pt(_t(u)))])}))]),1032,["src"])):r.isOtherFile?(Q(),ne("div",n4,[fe("div",null,[Oe(e.$slots,"file-icon",{},()=>[Re(l,{name:"file"})])]),fe("div",i4,$e(r.firstFile.name),1),r.firstFile.extension?(Q(),ne("div",o4,$e(r.firstFile.extension),1)):Ae("",!0)])):Ae("",!0),fe("div",l4,[Re(v,{"message-id":s.message.replyMessage._id,content:s.message.replyMessage.content,users:s.roomUsers,"text-formatting":s.textFormatting,"link-options":s.linkOptions,reply:!0},null,8,["message-id","content","users","text-formatting","link-options"])])])}var u4=St(Jg,[["render",c4]]);const d4={name:"ProgressBar",props:{progress:{type:Number,default:0}},data(){const a=54*Math.PI;return{radius:35,stroke:4,normalizedRadius:27,circumference:a}},computed:{strokeDashoffset(){return this.circumference-this.progress/100*this.circumference}}},f4={ref:"progress",class:"vac-progress-wrapper"},m4=["height","width"],h4=["stroke-dasharray","stroke-width","r","cx","cy"],v4={class:"vac-progress-text"},_4=fe("span",{class:"vac-progress-pourcent"},"%",-1);function p4(e,t,s,a,n,r){return Q(),ht(Ct,{name:"vac-fade-spinner",appear:""},{default:Xe(()=>[fe("div",f4,[(Q(),ne("svg",{height:n.radius*2,width:n.radius*2},[fe("circle",{stroke:"rgba(255, 255, 255, 0.7)","stroke-dasharray":n.circumference+" "+n.circumference,style:xt({strokeDashoffset:r.strokeDashoffset,strokeLinecap:"round"}),"stroke-width":n.stroke,fill:"transparent",r:n.normalizedRadius,cx:n.radius,cy:n.radius},null,12,h4)],8,m4)),fe("div",{class:"vac-progress-content",style:xt({height:n.radius*2-19+"px",width:n.radius*2-19+"px"})},[fe("div",v4,[ua($e(s.progress),1),_4])],4)],512)]),_:1})}var ad=St(d4,[["render",p4]]);const g4={name:"MessageFile",components:{SvgIcon:Vt,Loader:ai,ProgressBar:ad},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},file:{type:Object,required:!0},index:{type:Number,required:!0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["open-file"],data(){return{imageResponsive:"",imageLoading:!1,imageHover:!1}},computed:{isImageLoading(){return this.file.url.indexOf("blob:http")!==-1||this.imageLoading},isImage(){return hr(this.file)},isVideo(){return rn(this.file)}},watch:{file:{immediate:!0,handler(){this.checkImgLoad()}}},mounted(){const e=this.$refs["imageRef"+this.index];e&&(this.imageResponsive={maxHeight:e.clientWidth-18,loaderTop:e.clientHeight/2-9})},methods:{checkImgLoad(){if(!hr(this.file))return;this.imageLoading=!0;const e=new Image;e.src=this.file.url,e.addEventListener("load",()=>this.imageLoading=!1)},openFile(e,t){this.messageSelectionEnabled||(e.stopPropagation(),this.$emit("open-file",{file:this.file,action:t}))}}},b4={class:"vac-message-file-container"},y4={key:0,class:"vac-image-buttons"},x4={controls:""},w4=["src"];function S4(e,t,s,a,n,r){const o=Ke("progress-bar"),l=Ke("loader"),v=Ke("svg-icon");return Q(),ne("div",b4,[r.isImage?(Q(),ne("div",{key:0,ref:"imageRef"+s.index,class:"vac-message-image-container",onMouseover:t[2]||(t[2]=c=>n.imageHover=!0),onMouseleave:t[3]||(t[3]=c=>n.imageHover=!1),onClick:t[4]||(t[4]=c=>r.openFile(c,"preview"))},[s.file.progress>=0?(Q(),ht(o,{key:0,progress:s.file.progress,style:xt({top:`${n.imageResponsive.loaderTop}px`})},null,8,["progress","style"])):(Q(),ht(l,{key:1,show:r.isImageLoading,type:"message-file","message-id":s.message._id,style:xt({top:`${n.imageResponsive.loaderTop}px`})},gt({_:2},[at(e.$slots,(c,m)=>({name:m,fn:Xe(u=>[Oe(e.$slots,m,pt(_t(u)))])}))]),1032,["show","message-id","style"])),fe("div",{class:st(["vac-message-image",{"vac-blur-loading":r.isImageLoading&&s.message.senderId===s.currentUserId}]),style:xt({"background-image":`url('${r.isImageLoading&&s.file.preview||s.file.url}')`,"max-height":`${n.imageResponsive.maxHeight}px`})},[Re(Ct,{name:"vac-fade-image"},{default:Xe(()=>[!s.messageSelectionEnabled&&n.imageHover&&!r.isImageLoading?(Q(),ne("div",y4,[fe("div",{class:"vac-svg-button vac-button-view",onClick:t[0]||(t[0]=c=>r.openFile(c,"preview"))},[Oe(e.$slots,"eye-icon_"+s.message._id,{},()=>[Re(v,{name:"eye"})])]),fe("div",{class:"vac-svg-button vac-button-download",onClick:t[1]||(t[1]=c=>r.openFile(c,"download"))},[Oe(e.$slots,"document-icon_"+s.message._id,{},()=>[Re(v,{name:"document"})])])])):Ae("",!0)]),_:3})],6)],544)):r.isVideo?(Q(),ne("div",{key:1,class:"vac-video-container",onClick:t[5]||(t[5]=Ds(c=>r.openFile(c,"preview"),["prevent"]))},[s.file.progress>=0?(Q(),ht(o,{key:0,progress:s.file.progress},null,8,["progress"])):Ae("",!0),fe("video",x4,[fe("source",{src:s.file.url},null,8,w4)])])):Ae("",!0)])}var M4=St(g4,[["render",S4]]);const T4={name:"MessageFiles",components:{SvgIcon:Vt,FormatMessage:sn,ProgressBar:ad,MessageFile:M4},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},roomUsers:{type:Array,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0}},emits:["open-file","open-user-tag"],computed:{imageVideoFiles(){return this.message.files.filter(e=>n1(e))},otherFiles(){return this.message.files.filter(e=>!n1(e))}},methods:{openFile(e,t,s){this.messageSelectionEnabled||(e.stopPropagation(),this.$emit("open-file",{file:t,action:s}))}}},E4={class:"vac-message-files-container"},A4=["onClick"],k4={class:"vac-svg-button"},R4={class:"vac-text-ellipsis"},O4={key:0,class:"vac-text-ellipsis vac-text-extension"};function I4(e,t,s,a,n,r){const o=Ke("message-file"),l=Ke("progress-bar"),v=Ke("svg-icon"),c=Ke("format-message");return Q(),ne("div",E4,[(Q(!0),ne(ut,null,at(r.imageVideoFiles,(m,u)=>(Q(),ne("div",{key:u+"iv"},[Re(o,{file:m,"current-user-id":s.currentUserId,message:s.message,index:u,"message-selection-enabled":s.messageSelectionEnabled,onOpenFile:t[0]||(t[0]=p=>e.$emit("open-file",p))},gt({_:2},[at(e.$slots,(p,y)=>({name:y,fn:Xe(i=>[Oe(e.$slots,y,pt(_t(i)))])}))]),1032,["file","current-user-id","message","index","message-selection-enabled"])]))),128)),(Q(!0),ne(ut,null,at(r.otherFiles,(m,u)=>(Q(),ne("div",{key:u+"a",class:"vac-file-wrapper"},[m.progress>=0?(Q(),ht(l,{key:0,progress:m.progress,style:{top:"44px"}},null,8,["progress"])):Ae("",!0),fe("div",{class:st(["vac-file-container",{"vac-file-container-progress":m.progress>=0}]),onClick:p=>r.openFile(p,m,"download")},[fe("div",k4,[Oe(e.$slots,"document-icon",{},()=>[Re(v,{name:"document"})])]),fe("div",R4,$e(m.name),1),m.extension?(Q(),ne("div",O4,$e(m.extension),1)):Ae("",!0)],10,A4)]))),128)),Re(c,{"message-id":s.message._id,content:s.message.content,users:s.roomUsers,"text-formatting":s.textFormatting,"link-options":s.linkOptions,onOpenUserTag:t[1]||(t[1]=m=>e.$emit("open-user-tag",m))},null,8,["message-id","content","users","text-formatting","link-options"])])}var C4=St(T4,[["render",I4]]);const B4={name:"MessageActions",components:{SvgIcon:Vt,EmojiPickerContainer:Eu},directives:{clickOutside:mi},props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0},messageActions:{type:Array,required:!0},showReactionEmojis:{type:Boolean,required:!0},messageHover:{type:Boolean,required:!0},hoverMessageId:{type:[String,Number],default:null},hoverAudioProgress:{type:Boolean,required:!0},emojiDataSource:{type:String,default:void 0},teleportTarget:{type:Object,default:void 0}},emits:["update-emoji-opened","update-options-opened","update-message-hover","message-action-handler","send-message-reaction"],data(){return{menuOptionsTop:0,optionsOpened:!1,optionsClosing:!1,emojiOpened:!1}},computed:{isMessageActions(){return this.filteredMessageActions.length&&this.messageHover&&!this.message.deleted&&!this.message.disableActions&&!this.hoverAudioProgress},isMessageReactions(){return this.showReactionEmojis&&this.messageHover&&!this.message.deleted&&!this.message.disableReactions&&!this.hoverAudioProgress},filteredMessageActions(){return this.message.senderId===this.currentUserId?this.messageActions:this.messageActions.filter(e=>!e.onlyMe)}},watch:{emojiOpened(e){this.$emit("update-emoji-opened",e),e&&(this.optionsOpened=!1)},optionsOpened(e){this.$emit("update-options-opened",e)}},methods:{openOptions(){this.optionsClosing||(this.optionsOpened=!this.optionsOpened,this.optionsOpened&&setTimeout(()=>{const e=$1(this.$el,"#room-footer");if(!e||!this.$refs.menuOptions||!this.$refs.actionIcon)return;const t=this.$refs.menuOptions.getBoundingClientRect().height,s=this.$refs.actionIcon.getBoundingClientRect().top;e.getBoundingClientRect().top-s>t+50?this.menuOptionsTop=30:this.menuOptionsTop=-t}))},closeOptions(){this.optionsOpened=!1,this.optionsClosing=!0,this.updateMessageHover(),setTimeout(()=>this.optionsClosing=!1,100)},openEmoji(){this.emojiOpened=!this.emojiOpened},closeEmoji(){this.emojiOpened=!1,this.updateMessageHover()},updateMessageHover(){this.hoverMessageId!==this.message._id&&this.$emit("update-message-hover",!1)},messageActionHandler(e){this.closeOptions(),this.$emit("message-action-handler",e)},sendMessageReaction(e,t){this.$emit("send-message-reaction",{emoji:e,reaction:t}),this.closeEmoji()}}},L4={class:"vac-message-actions-wrapper"},N4={key:"3"},j4={class:"vac-menu-list"},H4=["onClick"];function P4(e,t,s,a,n,r){const o=Ke("svg-icon"),l=Ke("emoji-picker-container"),v=Gn("click-outside");return Q(),ne("div",L4,[fe("div",{class:"vac-options-container",style:xt({display:s.hoverAudioProgress?"none":"initial",width:r.filteredMessageActions.length&&s.showReactionEmojis?"70px":"45px"})},[Re(Lo,{name:"vac-slide-left",tag:"span"},{default:Xe(()=>[r.isMessageActions||r.isMessageReactions?(Q(),ne("div",{key:"1",class:st(["vac-blur-container",{"vac-options-me":s.message.senderId===s.currentUserId}])},null,2)):Ae("",!0),r.isMessageActions?(Q(),ne("div",{ref:"actionIcon",key:"2",class:"vac-svg-button vac-message-options",onClick:t[0]||(t[0]=(...c)=>r.openOptions&&r.openOptions(...c))},[Oe(e.$slots,"dropdown-icon_"+s.message._id,{},()=>[Re(o,{name:"dropdown",param:"message"})])],512)):Ae("",!0),r.isMessageReactions?(Q(),ne("div",N4,[Oe(e.$slots,"emoji-picker",Ao({emojiOpened:n.emojiOpened},{addEmoji:r.sendMessageReaction}),()=>[Re(l,{class:"vac-message-emojis","emoji-opened":n.emojiOpened,style:xt({right:r.isMessageActions?"30px":"5px"}),"emoji-reaction":!0,"position-right":s.message.senderId===s.currentUserId,"message-id":s.message._id,"emoji-data-source":s.emojiDataSource,"teleport-target":s.teleportTarget,onAddEmoji:r.sendMessageReaction,onOpenEmoji:r.openEmoji},gt({_:2},[at(e.$slots,(c,m)=>({name:m,fn:Xe(u=>[Oe(e.$slots,m,pt(_t(u)))])}))]),1032,["emoji-opened","style","position-right","message-id","emoji-data-source","teleport-target","onAddEmoji","onOpenEmoji"])])])):Ae("",!0)]),_:3})],4),r.filteredMessageActions.length?(Q(),ht(Ct,{key:0,name:s.message.senderId===s.currentUserId?"vac-slide-left":"vac-slide-right"},{default:Xe(()=>[n.optionsOpened?la((Q(),ne("div",{key:0,ref:"menuOptions",class:st(["vac-menu-options",{"vac-menu-left":s.message.senderId!==s.currentUserId}]),style:xt({top:`${n.menuOptionsTop}px`})},[fe("div",j4,[(Q(!0),ne(ut,null,at(r.filteredMessageActions,c=>(Q(),ne("div",{key:c.name},[fe("div",{class:"vac-menu-item",onClick:m=>r.messageActionHandler(c)},$e(c.title),9,H4)]))),128))])],6)),[[v,r.closeOptions]]):Ae("",!0)]),_:1},8,["name"])):Ae("",!0)])}var F4=St(B4,[["render",P4]]);const D4={name:"MessageReactions",props:{currentUserId:{type:[String,Number],required:!0},message:{type:Object,required:!0}},emits:["send-message-reaction"],methods:{sendMessageReaction(e,t){this.$emit("send-message-reaction",{emoji:e,reaction:t})}}},U4=["onClick"];function q4(e,t,s,a,n,r){return s.message.deleted?Ae("",!0):(Q(),ht(Lo,{key:0,name:"vac-slide-left",tag:"span"},{default:Xe(()=>[(Q(!0),ne(ut,null,at(s.message.reactions,(o,l)=>la((Q(),ne("button",{key:l+0,class:st(["vac-button-reaction",{"vac-reaction-me":o.indexOf(s.currentUserId)!==-1}]),style:xt({float:s.message.senderId===s.currentUserId?"right":"left"}),onClick:v=>r.sendMessageReaction({unicode:l},o)},[ua($e(l),1),fe("span",null,$e(o.length),1)],14,U4)),[[si,o.length]])),128))]),_:1}))}var V4=St(D4,[["render",q4]]);function z4(e){if(!((a,n)=>n.every(r=>{let o=!1;return(r.type[0]==="array"&&Array.isArray(a[r.key])||r.type.find(l=>l===typeof a[r.key]))&&(o=!0),o&&Il(a,r.key)}))(e,[{key:"roomId",type:["string","number"]},{key:"roomName",type:["string"]},{key:"users",type:["array"]}]))throw new Error("Rooms object is not valid! Must contain at least roomId[String, Number], roomName[String] and users[Array]")}function Y4(e){if(!((a,n)=>n.every(r=>r.type.find(l=>l===typeof a[r.key])&&Il(a,r.key)))(e,[{key:"_id",type:["string","number"]},{key:"username",type:["string"]}]))throw new Error("Participants object is not valid! Must contain at least _id[String, Number] and username[String]")}function X4(e){if(!((a,n)=>n.every(r=>r.type.find(l=>l===typeof a[r.key])&&Il(a,r.key)))(e,[{key:"_id",type:["string","number"]},{key:"senderId",type:["string","number"]}]))throw new Error("Messages object is not valid! Must contain at least _id[String, Number] and senderId[String, Number]")}function Il(e,t){return Object.prototype.hasOwnProperty.call(e,t)&&e[t]!==null&&e[t]!==void 0}const K4={name:"RoomMessage",components:{SvgIcon:Vt,FormatMessage:sn,AudioPlayer:xl,MessageReply:u4,MessageFiles:C4,MessageActions:F4,MessageReactions:V4},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},index:{type:Number,required:!0},message:{type:Object,required:!0},messages:{type:Array,required:!0},editedMessageId:{type:[String,Number],default:null},roomUsers:{type:Array,default:()=>[]},messageActions:{type:Array,required:!0},newMessages:{type:Array,default:()=>[]},showReactionEmojis:{type:Boolean,required:!0},showNewMessagesDivider:{type:Boolean,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},usernameOptions:{type:Object,required:!0},messageSelectionEnabled:{type:Boolean,required:!0},selectedMessages:{type:Array,default:()=>[]},emojiDataSource:{type:String,default:void 0}},emits:["message-added","open-file","open-user-tag","open-failed-message","message-action-handler","send-message-reaction","select-message","unselect-message"],data(){return{hoverMessageId:null,messageHover:!1,optionsOpened:!1,emojiOpened:!1,newMessage:{},progressTime:"- : -",hoverAudioProgress:!1}},computed:{showUsername(){return!this.usernameOptions.currentUser&&this.message.senderId===this.currentUserId?!1:this.roomUsers.length>=this.usernameOptions.minUsers},showDate(){return this.index>0&&this.message.date!==this.messages[this.index-1].date},messageOffset(){return this.index>0&&this.message.senderId!==this.messages[this.index-1].senderId},isMessageHover(){return this.editedMessageId===this.message._id||this.hoverMessageId===this.message._id},isAudio(){var e;return(e=this.message.files)==null?void 0:e.some(t=>hi(t))},isCheckmarkVisible(){return this.message.senderId===this.currentUserId&&!this.message.deleted&&(this.message.saved||this.message.distributed||this.message.seen)},hasCurrentUserAvatar(){return this.messages.some(e=>e.senderId===this.currentUserId&&e.avatar)},hasSenderUserAvatar(){return this.messages.some(e=>e.senderId!==this.currentUserId&&e.avatar)},isMessageSelected(){return this.messageSelectionEnabled&&!!this.selectedMessages.find(e=>e._id===this.message._id)}},watch:{newMessages:{immediate:!0,deep:!0,handler(e){if(!e.length||!this.showNewMessagesDivider){this.newMessage={};return}this.newMessage=e.reduce((t,s)=>s.index<t.index?s:t)}},messageSelectionEnabled(){this.resetMessageHover()}},mounted(){X4(this.message),this.$emit("message-added",{message:this.message,index:this.index,ref:this.$refs.message})},methods:{onHoverMessage(){this.messageSelectionEnabled||(this.messageHover=!0,this.canEditMessage()&&(this.hoverMessageId=this.message._id))},canEditMessage(){return!this.message.deleted},onLeaveMessage(){this.messageSelectionEnabled||(!this.optionsOpened&&!this.emojiOpened&&(this.messageHover=!1),this.hoverMessageId=null)},resetMessageHover(){this.messageHover=!1,this.hoverMessageId=null},openFile(e){this.$emit("open-file",{message:this.message,file:e})},openUserTag(e){this.$emit("open-user-tag",{user:e})},messageActionHandler(e){this.resetMessageHover(),setTimeout(()=>{this.$emit("message-action-handler",{action:e,message:this.message})},300)},sendMessageReaction({emoji:e,reaction:t}){this.$emit("send-message-reaction",{messageId:this.message._id,reaction:e,remove:t&&t.indexOf(this.currentUserId)!==-1}),this.messageHover=!1},selectMessage(){this.messageSelectionEnabled&&(this.isMessageSelected?this.$emit("unselect-message",this.message._id):this.$emit("select-message",this.message))}}},G4=["id"],W4={key:0,class:"vac-card-info vac-card-date"},Z4={key:1,class:"vac-line-new"},Q4={key:2,class:"vac-card-info vac-card-system"},J4={key:1,class:"vac-avatar-offset"},$4={ref:"emojiTarget",class:"vac-emoji-wrapper vac-emoji-teleported"},eb={key:0,class:"vac-progress-time"},tb={class:"vac-text-timestamp"},sb={key:0,class:"vac-icon-edited"},ab={key:1},rb=[fe("div",{class:"vac-failure-text"},"!",-1)],nb={key:3,class:"vac-avatar-current-offset"};function ib(e,t,s,a,n,r){const o=Ke("format-message"),l=Ke("message-reply"),v=Ke("message-files"),c=Ke("audio-player"),m=Ke("svg-icon"),u=Ke("message-actions"),p=Ke("message-reactions");return Q(),ne("div",{id:s.message._id,ref:"message",class:"vac-message-wrapper"},[r.showDate?(Q(),ne("div",W4,$e(s.message.date),1)):Ae("",!0),n.newMessage._id===s.message._id?(Q(),ne("div",Z4,$e(s.textMessages.NEW_MESSAGES),1)):Ae("",!0),s.message.system?(Q(),ne("div",Q4,[Oe(e.$slots,"message_"+s.message._id,{},()=>[Re(o,{"message-id":s.message._id,content:s.message.content,deleted:!!s.message.deleted,users:s.roomUsers,"text-messages":s.textMessages,"text-formatting":s.textFormatting,"link-options":s.linkOptions,onOpenUserTag:r.openUserTag},gt({_:2},[at(e.$slots,(y,i)=>({name:i,fn:Xe(H=>[Oe(e.$slots,i,pt(_t(H)))])}))]),1032,["message-id","content","deleted","users","text-messages","text-formatting","link-options","onOpenUserTag"])])])):(Q(),ne("div",{key:3,class:st(["vac-message-box",{"vac-offset-current":s.message.senderId===s.currentUserId}]),onClick:t[8]||(t[8]=(...y)=>r.selectMessage&&r.selectMessage(...y))},[Oe(e.$slots,"message_"+s.message._id,{},()=>[s.message.senderId!==s.currentUserId?Oe(e.$slots,"message-avatar_"+s.message._id,{key:0},()=>[s.message.avatar?(Q(),ne("div",{key:0,class:"vac-avatar",style:xt({"background-image":`url('${s.message.avatar}')`})},null,4)):Ae("",!0)]):Ae("",!0),r.hasSenderUserAvatar&&!s.message.avatar?(Q(),ne("div",J4)):Ae("",!0),fe("div",{class:st(["vac-message-container",{"vac-message-container-offset":r.messageOffset}])},[fe("div",{class:st(["vac-message-card",{"vac-message-highlight":r.isMessageHover,"vac-message-current":s.message.senderId===s.currentUserId,"vac-message-deleted":s.message.deleted,"vac-item-clickable":s.messageSelectionEnabled,"vac-message-selected":r.isMessageSelected}]),onMouseover:t[5]||(t[5]=(...y)=>r.onHoverMessage&&r.onHoverMessage(...y)),onMouseleave:t[6]||(t[6]=(...y)=>r.onLeaveMessage&&r.onLeaveMessage(...y))},[fe("div",$4,null,512),r.showUsername?(Q(),ne("div",{key:0,class:st(["vac-text-username",{"vac-username-reply":!s.message.deleted&&s.message.replyMessage}])},[fe("span",null,$e(s.message.username),1)],2)):Ae("",!0),!s.message.deleted&&s.message.replyMessage?(Q(),ht(l,{key:1,message:s.message,"room-users":s.roomUsers,"text-formatting":s.textFormatting,"link-options":s.linkOptions},gt({_:2},[at(e.$slots,(y,i)=>({name:i,fn:Xe(H=>[Oe(e.$slots,i,pt(_t(H)))])}))]),1032,["message","room-users","text-formatting","link-options"])):Ae("",!0),!!s.message.deleted||!s.message.files||!s.message.files.length?(Q(),ht(o,{key:2,"message-id":s.message._id,content:s.message.content,deleted:!!s.message.deleted,users:s.roomUsers,"text-formatting":s.textFormatting,"text-messages":s.textMessages,"link-options":s.linkOptions,onOpenUserTag:r.openUserTag},gt({_:2},[at(e.$slots,(y,i)=>({name:i,fn:Xe(H=>[Oe(e.$slots,i,pt(_t(H)))])}))]),1032,["message-id","content","deleted","users","text-formatting","text-messages","link-options","onOpenUserTag"])):!r.isAudio||s.message.files.length>1?(Q(),ht(v,{key:3,"current-user-id":s.currentUserId,message:s.message,"room-users":s.roomUsers,"text-formatting":s.textFormatting,"link-options":s.linkOptions,"message-selection-enabled":s.messageSelectionEnabled,onOpenFile:r.openFile,onOpenUserTag:r.openUserTag},gt({_:2},[at(e.$slots,(y,i)=>({name:i,fn:Xe(H=>[Oe(e.$slots,i,pt(_t(H)))])}))]),1032,["current-user-id","message","room-users","text-formatting","link-options","message-selection-enabled","onOpenFile","onOpenUserTag"])):(Q(),ne(ut,{key:4},[Re(c,{"message-id":s.message._id,src:s.message.files[0].url,"message-selection-enabled":s.messageSelectionEnabled,onUpdateProgressTime:t[0]||(t[0]=y=>n.progressTime=y),onHoverAudioProgress:t[1]||(t[1]=y=>n.hoverAudioProgress=y)},gt({_:2},[at(e.$slots,(y,i)=>({name:i,fn:Xe(H=>[Oe(e.$slots,i,pt(_t(H)))])}))]),1032,["message-id","src","message-selection-enabled"]),s.message.deleted?Ae("",!0):(Q(),ne("div",eb,$e(n.progressTime),1))],64)),fe("div",tb,[s.message.edited&&!s.message.deleted?(Q(),ne("div",sb,[Oe(e.$slots,"pencil-icon_"+s.message._id,{},()=>[Re(m,{name:"pencil"})])])):Ae("",!0),fe("span",null,$e(s.message.timestamp),1),r.isCheckmarkVisible?(Q(),ne("span",ab,[Oe(e.$slots,"checkmark-icon_"+s.message._id,{},()=>[Re(m,{name:s.message.distributed?"double-checkmark":"checkmark",param:s.message.seen?"seen":"",class:"vac-icon-check"},null,8,["name","param"])])])):Ae("",!0)]),Re(u,{"current-user-id":s.currentUserId,message:s.message,"message-actions":s.messageActions,"show-reaction-emojis":s.showReactionEmojis,"message-hover":n.messageHover,"hover-message-id":n.hoverMessageId,"hover-audio-progress":n.hoverAudioProgress,"emoji-data-source":s.emojiDataSource,"teleport-target":e.$refs.emojiTarget,onUpdateMessageHover:t[2]||(t[2]=y=>n.messageHover=y),onUpdateOptionsOpened:t[3]||(t[3]=y=>n.optionsOpened=y),onUpdateEmojiOpened:t[4]||(t[4]=y=>n.emojiOpened=y),onMessageActionHandler:r.messageActionHandler,onSendMessageReaction:r.sendMessageReaction},gt({_:2},[at(e.$slots,(y,i)=>({name:i,fn:Xe(H=>[Oe(e.$slots,i,pt(_t(H)))])}))]),1032,["current-user-id","message","message-actions","show-reaction-emojis","message-hover","hover-message-id","hover-audio-progress","emoji-data-source","teleport-target","onMessageActionHandler","onSendMessageReaction"])],34),Re(p,{"current-user-id":s.currentUserId,message:s.message,onSendMessageReaction:r.sendMessageReaction},null,8,["current-user-id","message","onSendMessageReaction"])],2),Oe(e.$slots,"message-failure_"+s.message._id,{},()=>[s.message.failure&&s.message.senderId===s.currentUserId?(Q(),ne("div",{key:0,class:st(["vac-failure-container vac-svg-button",{"vac-failure-container-avatar":s.message.avatar&&s.message.senderId===s.currentUserId}]),onClick:t[7]||(t[7]=y=>e.$emit("open-failed-message",{message:s.message}))},rb,2)):Ae("",!0)]),s.message.senderId===s.currentUserId?Oe(e.$slots,"message-avatar_"+s.message._id,{key:2},()=>[s.message.avatar?(Q(),ne("div",{key:0,class:"vac-avatar vac-avatar-current",style:xt({"background-image":`url('${s.message.avatar}')`})},null,4)):Ae("",!0)]):Ae("",!0),r.hasCurrentUserAvatar&&!s.message.avatar?(Q(),ne("div",nb)):Ae("",!0)])],2))],8,G4)}var ob=St(K4,[["render",ib]]);const lb={name:"ChatRoom",components:{Loader:ai,SvgIcon:Vt,RoomHeader:vv,RoomFooter:Qg,RoomMessage:ob},props:{currentUserId:{type:[String,Number],required:!0},textMessages:{type:Object,required:!0},singleRoom:{type:Boolean,required:!0},showRoomsList:{type:Boolean,required:!0},isMobile:{type:Boolean,required:!0},rooms:{type:Array,required:!0},roomId:{type:[String,Number],required:!0},loadFirstRoom:{type:Boolean,required:!0},messages:{type:Array,required:!0},roomMessage:{type:String,default:null},messagesLoaded:{type:Boolean,required:!0},menuActions:{type:Array,required:!0},messageActions:{type:Array,required:!0},messageSelectionActions:{type:Array,required:!0},autoScroll:{type:Object,required:!0},showSendIcon:{type:Boolean,required:!0},showFiles:{type:Boolean,required:!0},showAudio:{type:Boolean,required:!0},showRoomHeader:{type:Boolean,default:!0},audioBitRate:{type:Number,required:!0},audioSampleRate:{type:Number,required:!0},showEmojis:{type:Boolean,required:!0},showReactionEmojis:{type:Boolean,required:!0},showNewMessagesDivider:{type:Boolean,required:!0},showFooter:{type:Boolean,required:!0},acceptedFiles:{type:String,required:!0},captureFiles:{type:String,required:!0},textFormatting:{type:Object,required:!0},linkOptions:{type:Object,required:!0},loadingRooms:{type:Boolean,required:!0},roomInfoEnabled:{type:Boolean,required:!0},textareaActionEnabled:{type:Boolean,required:!0},textareaAutoFocus:{type:Boolean,required:!0},userTagsEnabled:{type:Boolean,required:!0},emojisSuggestionEnabled:{type:Boolean,required:!0},scrollDistance:{type:Number,required:!0},templatesText:{type:Array,default:null},usernameOptions:{type:Object,required:!0},emojiDataSource:{type:String,default:void 0},showMessagesStartedText:{type:Boolean,default:!0}},emits:["toggle-rooms-list","room-info","menu-action-handler","message-selection-action-handler","edit-message","send-message","delete-message","message-action-handler","fetch-messages","send-message-reaction","typing-message","open-file","open-user-tag","open-failed-message","textarea-action-handler"],data(){return{editedMessageId:null,initReplyMessage:null,initEditMessage:null,loadingMessages:!1,observer:null,showLoader:!0,loadingMoreMessages:!1,scrollIcon:!1,scrollMessagesCount:0,newMessages:[],messageSelectionEnabled:!1,selectedMessages:[],droppedFiles:[]}},computed:{room(){return this.rooms.find(e=>e.roomId===this.roomId)||{}},showNoMessages(){return this.roomId&&!this.messages.length&&!this.loadingMessages&&!this.loadingRooms},showNoRoom(){const e=!this.rooms.length&&!this.loadingRooms||!this.roomId&&!this.loadFirstRoom;return e&&this.updateLoadingMessages(!1),e},showMessagesStarted(){return this.messages.length&&this.messagesLoaded&&this.showMessagesStartedText}},watch:{roomId:{immediate:!0,handler(){this.onRoomChanged()}},messages:{deep:!0,handler(e,t){e.forEach((s,a)=>{this.showNewMessagesDivider&&!s.seen&&s.senderId!==this.currentUserId&&this.newMessages.push({_id:s._id,index:a})}),(t==null?void 0:t.length)===(e==null?void 0:e.length)-1&&(this.newMessages=[]),setTimeout(()=>this.loadingMoreMessages=!1)}},messagesLoaded(e){e&&this.updateLoadingMessages(!1)}},mounted(){this.newMessages=[]},methods:{updateLoadingMessages(e){this.loadingMessages=e,e||setTimeout(()=>this.initIntersectionObserver())},initIntersectionObserver(){this.observer&&(this.showLoader=!0,this.observer.disconnect());const e=this.$el.querySelector("#infinite-loader-messages");if(e){const t={root:this.$el.querySelector("#messages-list"),rootMargin:`${this.scrollDistance}px`,threshold:0};this.observer=new IntersectionObserver(s=>{s[0].isIntersecting&&this.loadMoreMessages()},t),this.observer.observe(e)}},preventTopScroll(){const e=this.$refs.scrollContainer,t=e.scrollHeight,s=new ResizeObserver(n=>{e.scrollHeight!==t&&this.$refs.scrollContainer&&(this.$refs.scrollContainer.scrollTo({top:e.scrollHeight-t}),s.disconnect())});for(var a=0;a<e.children.length;a++)s.observe(e.children[a])},touchStart(e){if(!this.singleRoom&&e.changedTouches.length===1){const t=e.changedTouches[0].clientX,s=e.changedTouches[0].clientY;addEventListener("touchend",a=>this.touchEnd(a,t,s),{once:!0})}},touchEnd(e,t,s){if(e.changedTouches.length===1){const a=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY,r=a-t>100,o=Math.abs(n-s)>50;r&&!o&&this.$emit("toggle-rooms-list")}},onRoomChanged(){this.updateLoadingMessages(!0),this.scrollIcon=!1,this.scrollMessagesCount=0,this.resetMessageSelection();const e=this.$watch(()=>this.messages,t=>{if(!t||!t.length)return;const s=this.$refs.scrollContainer;!s||(e(),setTimeout(()=>{s.scrollTo({top:s.scrollHeight}),this.updateLoadingMessages(!1)}))})},resetMessageSelection(){this.messageSelectionEnabled=!1,this.selectedMessages=[]},selectMessage(e){this.selectedMessages.push(e)},unselectMessage(e){this.selectedMessages=this.selectedMessages.filter(t=>t._id!==e)},onMessageAdded({message:e,index:t,ref:s}){if(t!==this.messages.length-1)return;const a=s.offsetHeight+60;setTimeout(()=>{const n=this.getBottomScroll(this.$refs.scrollContainer)>a;e.senderId===this.currentUserId?n?this.autoScroll.send.newAfterScrollUp&&this.scrollToBottom():this.autoScroll.send.new&&this.scrollToBottom():n?this.autoScroll.receive.newAfterScrollUp?this.scrollToBottom():(this.scrollIcon=!0,this.scrollMessagesCount++):this.autoScroll.receive.new?this.scrollToBottom():(this.scrollIcon=!0,this.scrollMessagesCount++)})},onContainerScroll(e){if(!e.target)return;const t=this.getBottomScroll(e.target);t<60&&(this.scrollMessagesCount=0),this.scrollIcon=t>500||this.scrollMessagesCount},loadMoreMessages(){this.loadingMessages||setTimeout(()=>{if(!this.loadingMoreMessages){if(this.messagesLoaded||!this.roomId){this.loadingMoreMessages=!1,this.showLoader=!1;return}this.preventTopScroll(),this.$emit("fetch-messages"),this.loadingMoreMessages=!0}},500)},messageActionHandler({action:e,message:t}){switch(e.name){case"replyMessage":this.initReplyMessage=t,setTimeout(()=>{this.initReplyMessage=null});return;case"editMessage":this.initEditMessage=t,setTimeout(()=>{this.initEditMessage=null});return;case"deleteMessage":return this.$emit("delete-message",t);case"selectMessages":this.selectedMessages=[t],this.messageSelectionEnabled=!0;return;default:return this.$emit("message-action-handler",{action:e,message:t})}},messageSelectionActionHandler(e){this.$emit("message-selection-action-handler",{action:e,messages:this.selectedMessages}),this.resetMessageSelection()},sendMessageReaction(e){this.$emit("send-message-reaction",e)},getBottomScroll(e){const{scrollHeight:t,clientHeight:s,scrollTop:a}=e;return t-s-a},scrollToBottom(){setTimeout(()=>{const e=this.$refs.scrollContainer;e.classList.add("vac-scroll-smooth"),e.scrollTo({top:e.scrollHeight,behavior:"smooth"}),setTimeout(()=>e.classList.remove("vac-scroll-smooth"))},50)},openFile({message:e,file:t}){this.$emit("open-file",{message:e,file:t})},openUserTag(e){this.$emit("open-user-tag",e)},onDropFiles(e){this.showFiles&&(this.droppedFiles=e.dataTransfer.files)}}},cb={class:"vac-container-center vac-room-empty"},ub={class:"vac-messages-container"},db={key:0,class:"vac-text-started"},fb={key:1,class:"vac-text-started"},mb={key:0,id:"infinite-loader-messages"},hb={key:2},vb={key:0,class:"vac-badge-counter vac-messages-count"};function _b(e,t,s,a,n,r){const o=Ke("room-header"),l=Ke("loader"),v=Ke("room-message"),c=Ke("svg-icon"),m=Ke("room-footer");return la((Q(),ne("div",{class:"vac-col-messages",onDrop:t[12]||(t[12]=Ds((...u)=>r.onDropFiles&&r.onDropFiles(...u),["prevent"])),onDragenter:t[13]||(t[13]=Ds(()=>{},["prevent"])),onDragover:t[14]||(t[14]=Ds(()=>{},["prevent"])),onDragleave:t[15]||(t[15]=Ds(()=>{},["prevent"])),onTouchstart:t[16]||(t[16]=(...u)=>r.touchStart&&r.touchStart(...u))},[r.showNoRoom?Oe(e.$slots,"no-room-selected",{key:0},()=>[fe("div",cb,[fe("div",null,$e(s.textMessages.ROOM_EMPTY),1)])]):s.showRoomHeader?(Q(),ht(o,{key:1,"current-user-id":s.currentUserId,"text-messages":s.textMessages,"single-room":s.singleRoom,"show-rooms-list":s.showRoomsList,"is-mobile":s.isMobile,"room-info-enabled":s.roomInfoEnabled,"menu-actions":s.menuActions,room:r.room,"message-selection-enabled":n.messageSelectionEnabled,"message-selection-actions":s.messageSelectionActions,"selected-messages-total":n.selectedMessages.length,onToggleRoomsList:t[0]||(t[0]=u=>e.$emit("toggle-rooms-list")),onRoomInfo:t[1]||(t[1]=u=>e.$emit("room-info")),onMenuActionHandler:t[2]||(t[2]=u=>e.$emit("menu-action-handler",u)),onMessageSelectionActionHandler:r.messageSelectionActionHandler,onCancelMessageSelection:t[3]||(t[3]=u=>n.messageSelectionEnabled=!1)},gt({_:2},[at(e.$slots,(u,p)=>({name:p,fn:Xe(y=>[Oe(e.$slots,p,pt(_t(y)))])}))]),1032,["current-user-id","text-messages","single-room","show-rooms-list","is-mobile","room-info-enabled","menu-actions","room","message-selection-enabled","message-selection-actions","selected-messages-total","onMessageSelectionActionHandler"])):Ae("",!0),fe("div",{id:"messages-list",ref:"scrollContainer",class:st(["vac-container-scroll",{"vac-no-room-header":!s.showRoomHeader}]),onScroll:t[5]||(t[5]=(...u)=>r.onContainerScroll&&r.onContainerScroll(...u))},[Re(l,{show:n.loadingMessages,type:"messages"},gt({_:2},[at(e.$slots,(u,p)=>({name:p,fn:Xe(y=>[Oe(e.$slots,p,pt(_t(y)))])}))]),1032,["show"]),fe("div",ub,[fe("div",{class:st({"vac-messages-hidden":n.loadingMessages})},[Re(Ct,{name:"vac-fade-message"},{default:Xe(()=>[fe("div",null,[r.showNoMessages?(Q(),ne("div",db,[Oe(e.$slots,"messages-empty",{},()=>[ua($e(s.textMessages.MESSAGES_EMPTY),1)])])):Ae("",!0),r.showMessagesStarted?(Q(),ne("div",fb,$e(s.textMessages.CONVERSATION_STARTED)+" "+$e(s.messages[0].date),1)):Ae("",!0)])]),_:3}),s.messages.length&&!s.messagesLoaded?(Q(),ne("div",mb,[Re(l,{show:!0,infinite:!0,type:"infinite-messages"},gt({_:2},[at(e.$slots,(u,p)=>({name:p,fn:Xe(y=>[Oe(e.$slots,p,pt(_t(y)))])}))]),1024)])):Ae("",!0),(Q(),ht(Lo,{key:s.roomId,name:"vac-fade-message",tag:"span"},{default:Xe(()=>[(Q(!0),ne(ut,null,at(s.messages,(u,p)=>(Q(),ne("div",{key:u.indexId||u._id},[Re(v,{"current-user-id":s.currentUserId,message:u,index:p,messages:s.messages,"edited-message-id":n.editedMessageId,"message-actions":s.messageActions,"room-users":r.room.users,"text-messages":s.textMessages,"new-messages":n.newMessages,"show-reaction-emojis":s.showReactionEmojis,"show-new-messages-divider":s.showNewMessagesDivider,"text-formatting":s.textFormatting,"link-options":s.linkOptions,"username-options":s.usernameOptions,"message-selection-enabled":n.messageSelectionEnabled,"selected-messages":n.selectedMessages,"emoji-data-source":s.emojiDataSource,onMessageAdded:r.onMessageAdded,onMessageActionHandler:r.messageActionHandler,onOpenFile:r.openFile,onOpenUserTag:r.openUserTag,onOpenFailedMessage:t[4]||(t[4]=y=>e.$emit("open-failed-message",y)),onSendMessageReaction:r.sendMessageReaction,onSelectMessage:r.selectMessage,onUnselectMessage:r.unselectMessage},gt({_:2},[at(e.$slots,(y,i)=>({name:i,fn:Xe(H=>[Oe(e.$slots,i,pt(_t(H)))])}))]),1032,["current-user-id","message","index","messages","edited-message-id","message-actions","room-users","text-messages","new-messages","show-reaction-emojis","show-new-messages-divider","text-formatting","link-options","username-options","message-selection-enabled","selected-messages","emoji-data-source","onMessageAdded","onMessageActionHandler","onOpenFile","onOpenUserTag","onSendMessageReaction","onSelectMessage","onUnselectMessage"])]))),128))]),_:3}))],2)])],34),n.loadingMessages?Ae("",!0):(Q(),ne("div",hb,[Re(Ct,{name:"vac-bounce"},{default:Xe(()=>[n.scrollIcon?(Q(),ne("div",{key:0,class:"vac-icon-scroll",onClick:t[6]||(t[6]=(...u)=>r.scrollToBottom&&r.scrollToBottom(...u))},[Re(Ct,{name:"vac-bounce"},{default:Xe(()=>[n.scrollMessagesCount?(Q(),ne("div",vb,$e(n.scrollMessagesCount),1)):Ae("",!0)]),_:1}),Oe(e.$slots,"scroll-icon",{},()=>[Re(c,{name:"dropdown",param:"scroll"})])])):Ae("",!0)]),_:3})])),Re(m,{room:r.room,"room-id":s.roomId,"room-message":s.roomMessage,"text-messages":s.textMessages,"show-send-icon":s.showSendIcon,"show-files":s.showFiles,"show-audio":s.showAudio,"show-emojis":s.showEmojis,"show-footer":s.showFooter,"accepted-files":s.acceptedFiles,"capture-files":s.captureFiles,"textarea-action-enabled":s.textareaActionEnabled,"textarea-auto-focus":s.textareaAutoFocus,"user-tags-enabled":s.userTagsEnabled,"emojis-suggestion-enabled":s.emojisSuggestionEnabled,"templates-text":s.templatesText,"text-formatting":s.textFormatting,"link-options":s.linkOptions,"audio-bit-rate":s.audioBitRate,"audio-sample-rate":s.audioSampleRate,"init-reply-message":n.initReplyMessage,"init-edit-message":n.initEditMessage,"dropped-files":n.droppedFiles,"emoji-data-source":s.emojiDataSource,onUpdateEditedMessageId:t[7]||(t[7]=u=>n.editedMessageId=u),onEditMessage:t[8]||(t[8]=u=>e.$emit("edit-message",u)),onSendMessage:t[9]||(t[9]=u=>e.$emit("send-message",u)),onTypingMessage:t[10]||(t[10]=u=>e.$emit("typing-message",u)),onTextareaActionHandler:t[11]||(t[11]=u=>e.$emit("textarea-action-handler",u))},gt({_:2},[at(e.$slots,(u,p)=>({name:p,fn:Xe(y=>[Oe(e.$slots,p,pt(_t(y)))])}))]),1032,["room","room-id","room-message","text-messages","show-send-icon","show-files","show-audio","show-emojis","show-footer","accepted-files","capture-files","textarea-action-enabled","textarea-auto-focus","user-tags-enabled","emojis-suggestion-enabled","templates-text","text-formatting","link-options","audio-bit-rate","audio-sample-rate","init-reply-message","init-edit-message","dropped-files","emoji-data-source"])],544)),[[si,s.isMobile&&!s.showRoomsList||!s.isMobile||s.singleRoom]])}var pb=St(lb,[["render",_b]]);const gb={name:"MediaPreview",components:{SvgIcon:Vt},props:{file:{type:Object,required:!0}},emits:["close-media-preview"],computed:{isImage(){return hr(this.file)},isVideo(){return rn(this.file)}},mounted(){this.$refs.modal.focus()},methods:{closeModal(){this.$emit("close-media-preview")}}},bb={key:0,class:"vac-media-preview-container"},yb={key:1,class:"vac-media-preview-container"},xb={controls:"",autoplay:""},wb=["src"],Sb={class:"vac-svg-button"};function Mb(e,t,s,a,n,r){const o=Ke("svg-icon");return Q(),ne("div",{ref:"modal",tabindex:"0",class:"vac-media-preview",onClick:t[0]||(t[0]=Ds((...l)=>r.closeModal&&r.closeModal(...l),["stop"])),onKeydown:t[1]||(t[1]=La((...l)=>r.closeModal&&r.closeModal(...l),["esc"]))},[Re(Ct,{name:"vac-bounce-preview",appear:""},{default:Xe(()=>[r.isImage?(Q(),ne("div",bb,[fe("div",{class:"vac-image-preview",style:xt({"background-image":`url('${s.file.url}')`})},null,4)])):r.isVideo?(Q(),ne("div",yb,[fe("video",xb,[fe("source",{src:s.file.url},null,8,wb)])])):Ae("",!0)]),_:1}),fe("div",Sb,[Oe(e.$slots,"preview-close-icon",{},()=>[Re(o,{name:"close-outline",param:"preview"})])])],544)}var Tb=St(gb,[["render",Mb]]),Eb={ROOMS_EMPTY:"No rooms",ROOM_EMPTY:"No room selected",NEW_MESSAGES:"New Messages",MESSAGE_DELETED:"This message was deleted",MESSAGES_EMPTY:"No messages",CONVERSATION_STARTED:"Conversation started on:",TYPE_MESSAGE:"Type message",SEARCH:"Search",IS_ONLINE:"is online",LAST_SEEN:"last seen ",IS_TYPING:"is writing...",CANCEL_SELECT_MESSAGE:"Cancel"};const Ab={light:{general:{color:"#0a0a0a",colorButtonClear:"#1976d2",colorButton:"#fff",backgroundColorButton:"#1976d2",backgroundInput:"#fff",colorPlaceholder:"#9ca6af",colorCaret:"#1976d2",colorSpinner:"#333",borderStyle:"1px solid #e1e4e8",backgroundScrollIcon:"#fff"},container:{border:"none",borderRadius:"4px",boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)"},header:{background:"#fff",colorRoomName:"#0a0a0a",colorRoomInfo:"#9ca6af"},footer:{background:"#f8f9fa",borderStyleInput:"1px solid #e1e4e8",borderInputSelected:"#1976d2",backgroundReply:"#e5e5e6",backgroundTagActive:"#e5e5e6",backgroundTag:"#f8f9fa"},content:{background:"#f8f9fa"},sidemenu:{background:"#fff",backgroundHover:"#f6f6f6",backgroundActive:"#e5effa",colorActive:"#1976d2",borderColorSearch:"#e1e5e8"},dropdown:{background:"#fff",backgroundHover:"#f6f6f6"},message:{background:"#fff",backgroundMe:"#ccf2cf",color:"#0a0a0a",colorStarted:"#9ca6af",backgroundDeleted:"#dadfe2",backgroundSelected:"#c2dcf2",colorDeleted:"#757e85",colorUsername:"#9ca6af",colorTimestamp:"#828c94",backgroundDate:"#e5effa",colorDate:"#505a62",backgroundSystem:"#e5effa",colorSystem:"#505a62",backgroundMedia:"rgba(0, 0, 0, 0.15)",backgroundReply:"rgba(0, 0, 0, 0.08)",colorReplyUsername:"#0a0a0a",colorReply:"#6e6e6e",colorTag:"#0d579c",backgroundImage:"#ddd",colorNewMessages:"#1976d2",backgroundScrollCounter:"#0696c7",colorScrollCounter:"#fff",backgroundReaction:"#eee",borderStyleReaction:"1px solid #eee",backgroundReactionHover:"#fff",borderStyleReactionHover:"1px solid #ddd",colorReactionCounter:"#0a0a0a",backgroundReactionMe:"#cfecf5",borderStyleReactionMe:"1px solid #3b98b8",backgroundReactionHoverMe:"#cfecf5",borderStyleReactionHoverMe:"1px solid #3b98b8",colorReactionCounterMe:"#0b59b3",backgroundAudioRecord:"#eb4034",backgroundAudioLine:"rgba(0, 0, 0, 0.15)",backgroundAudioProgress:"#455247",backgroundAudioProgressSelector:"#455247",colorFileExtension:"#757e85"},markdown:{background:"rgba(239, 239, 239, 0.7)",border:"rgba(212, 212, 212, 0.9)",color:"#e01e5a",colorMulti:"#0a0a0a"},room:{colorUsername:"#0a0a0a",colorMessage:"#67717a",colorTimestamp:"#a2aeb8",colorStateOnline:"#4caf50",colorStateOffline:"#9ca6af",backgroundCounterBadge:"#0696c7",colorCounterBadge:"#fff"},emoji:{background:"#fff"},icons:{search:"#9ca6af",add:"#1976d2",toggle:"#0a0a0a",menu:"#0a0a0a",close:"#9ca6af",closeImage:"#fff",file:"#1976d2",paperclip:"#1976d2",closeOutline:"#000",closePreview:"#fff",send:"#1976d2",sendDisabled:"#9ca6af",emoji:"#1976d2",emojiReaction:"rgba(0, 0, 0, 0.3)",document:"#1976d2",pencil:"#9e9e9e",checkmark:"#9e9e9e",checkmarkSeen:"#0696c7",eye:"#fff",dropdownMessage:"#fff",dropdownMessageBackground:"rgba(0, 0, 0, 0.25)",dropdownRoom:"#9e9e9e",dropdownScroll:"#0a0a0a",microphone:"#1976d2",audioPlay:"#455247",audioPause:"#455247",audioCancel:"#eb4034",audioConfirm:"#1ba65b"}},dark:{general:{color:"#fff",colorButtonClear:"#fff",colorButton:"#fff",backgroundColorButton:"#1976d2",backgroundInput:"#202223",colorPlaceholder:"#596269",colorCaret:"#fff",colorSpinner:"#fff",borderStyle:"none",backgroundScrollIcon:"#fff"},container:{border:"none",borderRadius:"4px",boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)"},header:{background:"#181a1b",colorRoomName:"#fff",colorRoomInfo:"#9ca6af"},footer:{background:"#131415",borderStyleInput:"none",borderInputSelected:"#1976d2",backgroundReply:"#1b1c1c",backgroundTagActive:"#1b1c1c",backgroundTag:"#131415"},content:{background:"#131415"},sidemenu:{background:"#181a1b",backgroundHover:"#202224",backgroundActive:"#151617",colorActive:"#fff",borderColorSearch:"#181a1b"},dropdown:{background:"#2a2c33",backgroundHover:"#26282e"},message:{background:"#22242a",backgroundMe:"#1f7e80",color:"#fff",colorStarted:"#9ca6af",backgroundDeleted:"#1b1c21",backgroundSelected:"#c2dcf2",colorDeleted:"#a2a5a8",colorUsername:"#b3bac9",colorTimestamp:"#ebedf2",backgroundDate:"rgba(0, 0, 0, 0.3)",colorDate:"#bec5cc",backgroundSystem:"rgba(0, 0, 0, 0.3)",colorSystem:"#bec5cc",backgroundMedia:"rgba(0, 0, 0, 0.18)",backgroundReply:"rgba(0, 0, 0, 0.18)",colorReplyUsername:"#fff",colorReply:"#d6d6d6",colorTag:"#f0c60a",backgroundImage:"#ddd",colorNewMessages:"#fff",backgroundScrollCounter:"#1976d2",colorScrollCounter:"#fff",backgroundReaction:"none",borderStyleReaction:"none",backgroundReactionHover:"#202223",borderStyleReactionHover:"none",colorReactionCounter:"#fff",backgroundReactionMe:"#4e9ad1",borderStyleReactionMe:"none",backgroundReactionHoverMe:"#4e9ad1",borderStyleReactionHoverMe:"none",colorReactionCounterMe:"#fff",backgroundAudioRecord:"#eb4034",backgroundAudioLine:"rgba(255, 255, 255, 0.15)",backgroundAudioProgress:"#b7d4d3",backgroundAudioProgressSelector:"#b7d4d3",colorFileExtension:"#a2a5a8"},markdown:{background:"rgba(239, 239, 239, 0.7)",border:"rgba(212, 212, 212, 0.9)",color:"#e01e5a",colorMulti:"#0a0a0a"},room:{colorUsername:"#fff",colorMessage:"#6c7278",colorTimestamp:"#6c7278",colorStateOnline:"#4caf50",colorStateOffline:"#596269",backgroundCounterBadge:"#1976d2",colorCounterBadge:"#fff"},emoji:{background:"#343740"},icons:{search:"#596269",add:"#fff",toggle:"#fff",menu:"#fff",close:"#9ca6af",closeImage:"#fff",file:"#1976d2",paperclip:"#fff",closeOutline:"#fff",closePreview:"#fff",send:"#fff",sendDisabled:"#646a70",emoji:"#fff",emojiReaction:"#fff",document:"#1976d2",pencil:"#ebedf2",checkmark:"#ebedf2",checkmarkSeen:"#f0d90a",eye:"#fff",dropdownMessage:"#fff",dropdownMessageBackground:"rgba(0, 0, 0, 0.25)",dropdownRoom:"#fff",dropdownScroll:"#0a0a0a",microphone:"#fff",audioPlay:"#b7d4d3",audioPause:"#b7d4d3",audioCancel:"#eb4034",audioConfirm:"#1ba65b"}}},kb=({general:e,container:t,header:s,footer:a,sidemenu:n,content:r,dropdown:o,message:l,markdown:v,room:c,emoji:m,icons:u})=>({"--chat-color":e.color,"--chat-color-button-clear":e.colorButtonClear,"--chat-color-button":e.colorButton,"--chat-bg-color-button":e.backgroundColorButton,"--chat-bg-color-input":e.backgroundInput,"--chat-color-spinner":e.colorSpinner,"--chat-color-placeholder":e.colorPlaceholder,"--chat-color-caret":e.colorCaret,"--chat-border-style":e.borderStyle,"--chat-bg-scroll-icon":e.backgroundScrollIcon,"--chat-container-border":t.border,"--chat-container-border-radius":t.borderRadius,"--chat-container-box-shadow":t.boxShadow,"--chat-header-bg-color":s.background,"--chat-header-color-name":s.colorRoomName,"--chat-header-color-info":s.colorRoomInfo,"--chat-footer-bg-color":a.background,"--chat-border-style-input":a.borderStyleInput,"--chat-border-color-input-selected":a.borderInputSelected,"--chat-footer-bg-color-reply":a.backgroundReply,"--chat-footer-bg-color-tag-active":a.backgroundTagActive,"--chat-footer-bg-color-tag":a.backgroundTag,"--chat-content-bg-color":r.background,"--chat-sidemenu-bg-color":n.background,"--chat-sidemenu-bg-color-hover":n.backgroundHover,"--chat-sidemenu-bg-color-active":n.backgroundActive,"--chat-sidemenu-color-active":n.colorActive,"--chat-sidemenu-border-color-search":n.borderColorSearch,"--chat-dropdown-bg-color":o.background,"--chat-dropdown-bg-color-hover":o.backgroundHover,"--chat-message-bg-color":l.background,"--chat-message-bg-color-me":l.backgroundMe,"--chat-message-color-started":l.colorStarted,"--chat-message-bg-color-deleted":l.backgroundDeleted,"--chat-message-bg-color-selected":l.backgroundSelected,"--chat-message-color-deleted":l.colorDeleted,"--chat-message-color-username":l.colorUsername,"--chat-message-color-timestamp":l.colorTimestamp,"--chat-message-bg-color-date":l.backgroundDate,"--chat-message-color-date":l.colorDate,"--chat-message-bg-color-system":l.backgroundSystem,"--chat-message-color-system":l.colorSystem,"--chat-message-color":l.color,"--chat-message-bg-color-media":l.backgroundMedia,"--chat-message-bg-color-reply":l.backgroundReply,"--chat-message-color-reply-username":l.colorReplyUsername,"--chat-message-color-reply-content":l.colorReply,"--chat-message-color-tag":l.colorTag,"--chat-message-bg-color-image":l.backgroundImage,"--chat-message-color-new-messages":l.colorNewMessages,"--chat-message-bg-color-scroll-counter":l.backgroundScrollCounter,"--chat-message-color-scroll-counter":l.colorScrollCounter,"--chat-message-bg-color-reaction":l.backgroundReaction,"--chat-message-border-style-reaction":l.borderStyleReaction,"--chat-message-bg-color-reaction-hover":l.backgroundReactionHover,"--chat-message-border-style-reaction-hover":l.borderStyleReactionHover,"--chat-message-color-reaction-counter":l.colorReactionCounter,"--chat-message-bg-color-reaction-me":l.backgroundReactionMe,"--chat-message-border-style-reaction-me":l.borderStyleReactionMe,"--chat-message-bg-color-reaction-hover-me":l.backgroundReactionHoverMe,"--chat-message-border-style-reaction-hover-me":l.borderStyleReactionHoverMe,"--chat-message-color-reaction-counter-me":l.colorReactionCounterMe,"--chat-message-bg-color-audio-record":l.backgroundAudioRecord,"--chat-message-bg-color-audio-line":l.backgroundAudioLine,"--chat-message-bg-color-audio-progress":l.backgroundAudioProgress,"--chat-message-bg-color-audio-progress-selector":l.backgroundAudioProgressSelector,"--chat-message-color-file-extension":l.colorFileExtension,"--chat-markdown-bg":v.background,"--chat-markdown-border":v.border,"--chat-markdown-color":v.color,"--chat-markdown-color-multi":v.colorMulti,"--chat-room-color-username":c.colorUsername,"--chat-room-color-message":c.colorMessage,"--chat-room-color-timestamp":c.colorTimestamp,"--chat-room-color-online":c.colorStateOnline,"--chat-room-color-offline":c.colorStateOffline,"--chat-room-bg-color-badge":c.backgroundCounterBadge,"--chat-room-color-badge":c.colorCounterBadge,"--chat-emoji-bg-color":m.background,"--chat-icon-color-search":u.search,"--chat-icon-color-add":u.add,"--chat-icon-color-toggle":u.toggle,"--chat-icon-color-menu":u.menu,"--chat-icon-color-close":u.close,"--chat-icon-color-close-image":u.closeImage,"--chat-icon-color-file":u.file,"--chat-icon-color-paperclip":u.paperclip,"--chat-icon-color-close-outline":u.closeOutline,"--chat-icon-color-close-preview":u.closePreview,"--chat-icon-color-send":u.send,"--chat-icon-color-send-disabled":u.sendDisabled,"--chat-icon-color-emoji":u.emoji,"--chat-icon-color-emoji-reaction":u.emojiReaction,"--chat-icon-color-document":u.document,"--chat-icon-color-pencil":u.pencil,"--chat-icon-color-checkmark":u.checkmark,"--chat-icon-color-checkmark-seen":u.checkmarkSeen,"--chat-icon-color-eye":u.eye,"--chat-icon-color-dropdown-message":u.dropdownMessage,"--chat-icon-bg-dropdown-message":u.dropdownMessageBackground,"--chat-icon-color-dropdown-room":u.dropdownRoom,"--chat-icon-color-dropdown-scroll":u.dropdownScroll,"--chat-icon-color-microphone":u.microphone,"--chat-icon-color-audio-play":u.audioPlay,"--chat-icon-color-audio-pause":u.audioPause,"--chat-icon-color-audio-cancel":u.audioCancel,"--chat-icon-color-audio-confirm":u.audioConfirm});var Rb=`.vac-fade-spinner-enter-from{opacity:0}.vac-fade-spinner-enter-active{transition:opacity .8s}.vac-fade-spinner-leave-active{transition:opacity .2s;opacity:0}.vac-fade-image-enter-from{opacity:0}.vac-fade-image-enter-active{transition:opacity 1s}.vac-fade-image-leave-active{transition:opacity .5s;opacity:0}.vac-fade-message-enter-from{opacity:0}.vac-fade-message-enter-active{transition:opacity .5s}.vac-fade-message-leave-active{transition:opacity .2s;opacity:0}.vac-slide-left-enter-active,.vac-slide-right-enter-active{transition:all .3s ease;transition-property:transform,opacity}.vac-slide-left-leave-active,.vac-slide-right-leave-active{transition:all .2s cubic-bezier(1,.5,.8,1)!important;transition-property:transform,opacity}.vac-slide-left-enter-from,.vac-slide-left-leave-to{transform:translate(10px);opacity:0}.vac-slide-right-enter-from,.vac-slide-right-leave-to{transform:translate(-10px);opacity:0}.vac-slide-up-enter-active{transition:all .3s ease}.vac-slide-up-leave-active{transition:all .2s cubic-bezier(1,.5,.8,1)}.vac-slide-up-enter-from,.vac-slide-up-leave-to{transform:translateY(10px);opacity:0}.vac-bounce-enter-active{animation:vac-bounce-in .5s}.vac-bounce-leave-active{animation:vac-bounce-in .3s reverse}@keyframes vac-bounce-in{0%{transform:scale(0)}50%{transform:scale(1.05)}to{transform:scale(1)}}.vac-fade-preview-enter{opacity:0}.vac-fade-preview-enter-active{transition:opacity .1s}.vac-fade-preview-leave-active{transition:opacity .2s;opacity:0}.vac-bounce-preview-enter-active{animation:vac-bounce-image-in .4s}.vac-bounce-preview-leave-active{animation:vac-bounce-image-in .3s reverse}@keyframes vac-bounce-image-in{0%{transform:scale(.6)}to{transform:scale(1)}}.vac-menu-list{border-radius:4px;display:block;cursor:pointer;background:var(--chat-dropdown-bg-color);padding:6px 0}.vac-menu-list :hover{background:var(--chat-dropdown-bg-color-hover);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-menu-list :not(:hover){transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-menu-item{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:1 1 100%;flex:1 1 100%;min-height:30px;padding:5px 16px;position:relative;white-space:nowrap;line-height:30px}.vac-menu-options{position:absolute;right:10px;top:20px;z-index:9999;min-width:150px;display:inline-block;border-radius:4px;font-size:14px;color:var(--chat-color);overflow-y:auto;overflow-x:hidden;contain:content;box-shadow:0 2px 2px -4px #0000001a,0 2px 2px 1px #0000001f,0 1px 8px 1px #0000001f}.vac-app-border{border:var(--chat-border-style)}.vac-app-border-t{border-top:var(--chat-border-style)}.vac-app-border-r{border-right:var(--chat-border-style)}.vac-app-border-b{border-bottom:var(--chat-border-style)}.vac-app-box-shadow{transition:all .5s;box-shadow:0 2px 2px -4px #0000001a,0 2px 2px 1px #0000001f,0 1px 8px 1px #0000001f}.vac-item-clickable{cursor:pointer}.vac-vertical-center{display:flex;align-items:center;height:100%}.vac-vertical-center .vac-vertical-container{width:100%;text-align:center}.vac-svg-button{max-height:30px;display:flex;cursor:pointer;transition:all .2s}.vac-svg-button:hover{transform:scale(1.1);opacity:.7}.vac-avatar{background-size:cover;background-position:center center;background-repeat:no-repeat;background-color:#ddd;height:42px;width:42px;min-height:42px;min-width:42px;margin-right:15px;border-radius:50%}.vac-blur-loading{filter:blur(3px)}.vac-badge-counter{height:13px;width:auto;min-width:13px;border-radius:50%;display:flex;align-items:center;justify-content:center;padding:3px;font-size:11px;font-weight:500}.vac-text-ellipsis{width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.vac-text-bold{font-weight:700}.vac-text-italic{font-style:italic}.vac-text-strike{text-decoration:line-through}.vac-text-underline{text-decoration:underline}.vac-text-inline-code{display:inline-block;font-size:12px;color:var(--chat-markdown-color);background:var(--chat-markdown-bg);border:1px solid var(--chat-markdown-border);border-radius:3px;margin:2px 0;padding:2px 3px}.vac-text-multiline-code{display:block;font-size:12px;color:var(--chat-markdown-color-multi);background:var(--chat-markdown-bg);border:1px solid var(--chat-markdown-border);border-radius:3px;margin:4px 0;padding:7px}.vac-text-tag{color:var(--chat-message-color-tag);cursor:pointer}.vac-file-container{display:flex;align-content:center;justify-content:center;flex-wrap:wrap;text-align:center;background:var(--chat-bg-color-input);border:var(--chat-border-style-input);border-radius:4px;padding:10px}.vac-file-container svg{height:28px;width:28px}.vac-file-container .vac-text-extension{font-size:12px;color:var(--chat-message-color-file-extension);margin-top:-2px}.vac-card-window{width:100%;display:block;max-width:100%;background:var(--chat-content-bg-color);color:var(--chat-color);overflow-wrap:break-word;white-space:normal;border:var(--chat-container-border);border-radius:var(--chat-container-border-radius);box-shadow:var(--chat-container-box-shadow);-webkit-tap-highlight-color:transparent}.vac-card-window *{font-family:inherit}.vac-card-window a{color:#0d579c;font-weight:500}.vac-card-window .vac-chat-container{height:100%;display:flex}.vac-card-window .vac-chat-container input{min-width:10px}.vac-card-window .vac-chat-container textarea,.vac-card-window .vac-chat-container input[type=text],.vac-card-window .vac-chat-container input[type=search]{-webkit-appearance:none}.vac-media-preview{position:fixed;top:0;left:0;z-index:10000000;width:100vw;height:100vh;display:flex;align-items:center;background-color:#000c;outline:none}.vac-media-preview .vac-media-preview-container{height:calc(100% - 140px);width:calc(100% - 80px);padding:70px 40px;margin:0 auto}.vac-media-preview .vac-image-preview{width:100%;height:100%;background-size:contain;background-repeat:no-repeat;background-position:center}.vac-media-preview video{width:100%;height:100%}.vac-media-preview .vac-svg-button{position:absolute;top:30px;right:30px;transform:scale(1.4)}@media only screen and (max-width: 768px){.vac-media-preview .vac-svg-button{top:20px;right:20px;transform:scale(1.2)}.vac-media-preview .vac-media-preview-container{width:calc(100% - 40px);padding:70px 20px}}.vac-col-messages{position:relative;height:100%;flex:1;overflow:hidden;display:flex;flex-flow:column}.vac-col-messages .vac-container-center{height:100%;width:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center}.vac-col-messages .vac-room-empty{font-size:14px;color:#9ca6af;font-style:italic;line-height:20px;white-space:pre-line}.vac-col-messages .vac-room-empty div{padding:0 10%}.vac-col-messages .vac-container-scroll{background:var(--chat-content-bg-color);flex:1;overflow-y:auto;margin-right:1px;margin-top:65px;-webkit-overflow-scrolling:touch}.vac-col-messages .vac-container-scroll.vac-scroll-smooth{scroll-behavior:smooth}.vac-col-messages .vac-container-scroll.vac-no-room-header{margin-top:0}.vac-col-messages .vac-messages-container{padding:0 5px 5px}.vac-col-messages .vac-text-started{font-size:14px;color:var(--chat-message-color-started);font-style:italic;text-align:center;margin-top:25px;margin-bottom:20px}.vac-col-messages .vac-icon-scroll{position:absolute;bottom:80px;right:20px;padding:8px;background:var(--chat-bg-scroll-icon);border-radius:50%;box-shadow:0 1px 1px -1px #0003,0 1px 1px #00000024,0 1px 2px #0000001f;display:flex;cursor:pointer;z-index:10}.vac-col-messages .vac-icon-scroll svg{height:25px;width:25px}.vac-col-messages .vac-messages-count{position:absolute;top:-8px;left:11px;background-color:var(--chat-message-bg-color-scroll-counter);color:var(--chat-message-color-scroll-counter)}.vac-col-messages .vac-messages-hidden{opacity:0}@media only screen and (max-width: 768px){.vac-col-messages .vac-container-scroll{margin-top:50px}.vac-col-messages .vac-text-started{margin-top:20px}.vac-col-messages .vac-icon-scroll{bottom:70px}}.vac-room-header{position:absolute;display:flex;align-items:center;height:64px;width:100%;z-index:10;margin-right:1px;background:var(--chat-header-bg-color);border-top-right-radius:var(--chat-container-border-radius)}.vac-room-header .vac-room-wrapper{display:flex;align-items:center;min-width:0;height:100%;width:100%;padding:0 16px}.vac-room-header .vac-toggle-button{margin-right:15px}.vac-room-header .vac-toggle-button svg{height:26px;width:26px}.vac-room-header .vac-rotate-icon{transform:rotate(180deg)!important}.vac-room-header .vac-rotate-icon-init{transform:rotate(360deg)}.vac-room-header .vac-info-wrapper,.vac-room-header .vac-room-selection{display:flex;align-items:center;min-width:0;width:100%;height:100%}.vac-room-header .vac-room-selection .vac-selection-button{padding:8px 16px;color:var(--chat-color-button);background-color:var(--chat-bg-color-button);border-radius:4px;margin-right:10px;cursor:pointer;transition:all .2s}.vac-room-header .vac-room-selection .vac-selection-button:hover{opacity:.7}.vac-room-header .vac-room-selection .vac-selection-button:active{opacity:.9}.vac-room-header .vac-room-selection .vac-selection-button .vac-selection-button-count{margin-left:6px;opacity:.9}.vac-room-header .vac-room-selection .vac-selection-cancel{display:flex;align-items:center;margin-left:auto;white-space:nowrap;color:var(--chat-color-button-clear);transition:all .2s}.vac-room-header .vac-room-selection .vac-selection-cancel:hover{opacity:.7}.vac-room-header .vac-room-name{font-size:17px;font-weight:500;line-height:22px;color:var(--chat-header-color-name)}.vac-room-header .vac-room-info{font-size:13px;line-height:18px;color:var(--chat-header-color-info)}.vac-room-header .vac-room-options{margin-left:auto}@media only screen and (max-width: 768px){.vac-room-header{height:50px}.vac-room-header .vac-room-wrapper{padding:0 10px}.vac-room-header .vac-room-name{font-size:16px;line-height:22px}.vac-room-header .vac-room-info{font-size:12px;line-height:16px}.vac-room-header .vac-avatar{height:37px;width:37px;min-height:37px;min-width:37px}}.vac-room-footer{width:100%;border-bottom-right-radius:4px;z-index:10}.vac-box-footer{display:flex;position:relative;background:var(--chat-footer-bg-color);padding:10px 8px}.vac-textarea{max-height:300px;overflow-y:auto;height:20px;width:100%;line-height:20px;outline:0;resize:none;border-radius:20px;padding:12px 16px;box-sizing:content-box;font-size:16px;background:var(--chat-bg-color-input);color:var(--chat-color);caret-color:var(--chat-color-caret);border:var(--chat-border-style-input)}.vac-textarea::placeholder{color:var(--chat-color-placeholder);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.vac-textarea-outline{border:1px solid var(--chat-border-color-input-selected);box-shadow:inset 0 0 0 1px var(--chat-border-color-input-selected)}.vac-icon-textarea,.vac-icon-textarea-left{display:flex;align-items:center}.vac-icon-textarea svg,.vac-icon-textarea .vac-wrapper,.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 7px}.vac-icon-textarea{margin-left:5px}.vac-icon-textarea-left{display:flex;align-items:center;margin-right:5px}.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 7px}.vac-icon-textarea-left .vac-icon-microphone{fill:var(--chat-icon-color-microphone);margin:0 7px}.vac-icon-textarea-left .vac-dot-audio-record{height:15px;width:15px;border-radius:50%;background-color:var(--chat-message-bg-color-audio-record);animation:vac-scaling .8s ease-in-out infinite alternate}@keyframes vac-scaling{0%{transform:scale(1);opacity:.4}to{transform:scale(1.1);opacity:1}}.vac-icon-textarea-left .vac-dot-audio-record-time{font-size:16px;color:var(--chat-color);margin-left:8px;width:45px}.vac-icon-textarea-left .vac-icon-audio-stop,.vac-icon-textarea-left .vac-icon-audio-confirm{min-height:28px;min-width:28px}.vac-icon-textarea-left .vac-icon-audio-stop svg,.vac-icon-textarea-left .vac-icon-audio-confirm svg{min-height:28px;min-width:28px}.vac-icon-textarea-left .vac-icon-audio-stop{margin-right:20px}.vac-icon-textarea-left .vac-icon-audio-stop #vac-icon-close-outline{fill:var(--chat-icon-color-audio-cancel)}.vac-icon-textarea-left .vac-icon-audio-confirm{margin-right:3px;margin-left:12px}.vac-icon-textarea-left .vac-icon-audio-confirm #vac-icon-checkmark{fill:var(--chat-icon-color-audio-confirm)}.vac-send-disabled,.vac-send-disabled svg{cursor:none!important;pointer-events:none!important;transform:none!important}@media only screen and (max-width: 768px){.vac-room-footer{width:100%}.vac-box-footer{padding:7px 2px 7px 7px}.vac-box-footer.vac-box-footer-border{border-top:var(--chat-border-style-input)}.vac-textarea{padding:7px;line-height:18px}.vac-textarea::placeholder{color:transparent}.vac-icon-textarea svg,.vac-icon-textarea .vac-wrapper,.vac-icon-textarea-left svg,.vac-icon-textarea-left .vac-wrapper{margin:0 5px!important}}@media only screen and (max-height: 768px){.vac-textarea{max-height:120px}}.vac-emojis-container{width:calc(100% - 16px);padding:10px 8px;background:var(--chat-footer-bg-color);display:flex;align-items:center;overflow:auto}.vac-emojis-container .vac-emoji-element{padding:0 8px;font-size:30px;border-radius:4px;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-emojis-container .vac-emoji-element-active{background:var(--chat-footer-bg-color-tag-active)}@media only screen and (max-width: 768px){.vac-emojis-container{width:calc(100% - 10px);padding:7px 5px}.vac-emojis-container .vac-emoji-element{padding:0 7px;font-size:26px}}.vac-reply-container{display:flex;padding:10px 10px 0;background:var(--chat-footer-bg-color);align-items:center;width:calc(100% - 20px)}.vac-reply-container .vac-reply-box{width:100%;overflow:hidden;background:var(--chat-footer-bg-color-reply);border-radius:4px;padding:8px 10px}.vac-reply-container .vac-reply-info{overflow:hidden}.vac-reply-container .vac-reply-username{color:var(--chat-message-color-reply-username);font-size:12px;line-height:15px;margin-bottom:2px}.vac-reply-container .vac-reply-content{font-size:12px;color:var(--chat-message-color-reply-content);white-space:pre-line}.vac-reply-container .vac-icon-reply{margin-left:10px}.vac-reply-container .vac-icon-reply svg{height:20px;width:20px}.vac-reply-container .vac-image-reply{max-height:100px;max-width:200px;margin:4px 10px 0 0;border-radius:4px}.vac-reply-container .vac-audio-reply{margin-right:10px}.vac-reply-container .vac-file-container{max-width:80px}@media only screen and (max-width: 768px){.vac-reply-container{padding:5px 8px;width:calc(100% - 16px)}}.vac-room-files-container{display:flex;align-items:center;padding:10px 6px 0;background:var(--chat-footer-bg-color)}.vac-room-files-container .vac-files-box{display:flex;overflow:auto;flex:1 1 0;width:0}.vac-room-files-container video{height:100px;border:var(--chat-border-style-input);border-radius:4px}.vac-room-files-container .vac-icon-close{flex:none;margin-left:5px}.vac-room-files-container .vac-icon-close svg{height:20px;width:20px}@media only screen and (max-width: 768px){.vac-files-container{padding:6px 4px 4px 2px}}.vac-room-file-container{display:flex;position:relative;margin:0 4px}.vac-room-file-container .vac-message-image{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:cover!important;background-position:center center!important;background-repeat:no-repeat!important;height:100px;width:100px;border:var(--chat-border-style-input);border-radius:4px}.vac-room-file-container .vac-file-container{height:80px;width:80px}.vac-room-file-container .vac-icon-remove{position:absolute;top:6px;left:6px;z-index:10}.vac-room-file-container .vac-icon-remove svg{height:20px;width:20px;border-radius:50%}.vac-room-file-container .vac-icon-remove:before{content:" ";position:absolute;width:100%;height:100%;background:rgba(0,0,0,.5);border-radius:50%;z-index:-1}.vac-tags-container{display:flex;flex-direction:column;align-items:center;width:100%}.vac-tags-container .vac-tags-box{display:flex;width:100%;height:54px;overflow:hidden;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-tags-container .vac-tags-box-active{background:var(--chat-footer-bg-color-tag-active)}.vac-tags-container .vac-tags-info{display:flex;overflow:hidden;padding:0 20px;align-items:center}.vac-tags-container .vac-tags-avatar{height:34px;width:34px;min-height:34px;min-width:34px}.vac-tags-container .vac-tags-username{font-size:14px}@media only screen and (max-width: 768px){.vac-tags-container .vac-tags-box{height:50px}.vac-tags-container .vac-tags-info{padding:0 12px}}.vac-template-container{display:flex;flex-direction:column;align-items:center;width:100%}.vac-template-container .vac-template-box{display:flex;width:100%;height:54px;overflow:hidden;cursor:pointer;background:var(--chat-footer-bg-color-tag);transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-template-container .vac-template-active{background:var(--chat-footer-bg-color-tag-active)}.vac-template-container .vac-template-info{display:flex;overflow:hidden;padding:0 20px;align-items:center}.vac-template-container .vac-template-tag{font-size:14px;font-weight:700;margin-right:10px}.vac-template-container .vac-template-text{font-size:14px}@media only screen and (max-width: 768px){.vac-template-container .vac-template-box{height:50px}.vac-template-container .vac-template-info{padding:0 12px}}.vac-rooms-container{display:flex;flex-flow:column;flex:0 0 25%;min-width:260px;max-width:500px;position:relative;background:var(--chat-sidemenu-bg-color);height:100%;border-top-left-radius:var(--chat-container-border-radius);border-bottom-left-radius:var(--chat-container-border-radius)}.vac-rooms-container.vac-rooms-container-full{flex:0 0 100%;max-width:100%}.vac-rooms-container .vac-rooms-empty{font-size:14px;color:#9ca6af;font-style:italic;text-align:center;margin:40px 0;line-height:20px;white-space:pre-line}.vac-rooms-container .vac-room-list{flex:1;position:relative;max-width:100%;cursor:pointer;padding:0 10px 5px;overflow-y:auto}.vac-rooms-container .vac-room-item{border-radius:8px;align-items:center;display:flex;flex:1 1 100%;margin-bottom:5px;padding:0 14px;position:relative;min-height:71px;transition:background-color .3s cubic-bezier(.25,.8,.5,1)}.vac-rooms-container .vac-room-item:hover{background:var(--chat-sidemenu-bg-color-hover)}.vac-rooms-container .vac-room-selected{color:var(--chat-sidemenu-color-active)!important;background:var(--chat-sidemenu-bg-color-active)!important}.vac-rooms-container .vac-room-selected:hover{background:var(--chat-sidemenu-bg-color-active)!important}@media only screen and (max-width: 768px){.vac-rooms-container .vac-room-list{padding:0 7px 5px}.vac-rooms-container .vac-room-item{min-height:60px;padding:0 8px}}.vac-room-container{display:flex;flex:1;align-items:center;width:100%}.vac-room-container .vac-name-container{flex:1}.vac-room-container .vac-title-container{display:flex;align-items:center;line-height:25px}.vac-room-container .vac-state-circle{width:9px;height:9px;border-radius:50%;background-color:var(--chat-room-color-offline);margin-right:6px;transition:.3s}.vac-room-container .vac-state-online{background-color:var(--chat-room-color-online)}.vac-room-container .vac-room-name{flex:1;color:var(--chat-room-color-username);font-weight:500}.vac-room-container .vac-text-date{margin-left:5px;font-size:11px;color:var(--chat-room-color-timestamp)}.vac-room-container .vac-text-last{display:flex;align-items:center;font-size:12px;line-height:19px;color:var(--chat-room-color-message)}.vac-room-container .vac-message-new{color:var(--chat-room-color-username);font-weight:500}.vac-room-container .vac-icon-check{display:flex;vertical-align:middle;height:14px;width:14px;margin-top:-2px;margin-right:2px}.vac-room-container .vac-icon-microphone{height:15px;width:15px;vertical-align:middle;margin:-3px 1px 0 -2px;fill:var(--chat-room-color-message)}.vac-room-container .vac-room-options-container{display:flex;margin-left:auto}.vac-room-container .vac-room-badge{background-color:var(--chat-room-bg-color-badge);color:var(--chat-room-color-badge);margin-left:5px}.vac-room-container .vac-list-room-options{height:19px;width:19px;align-items:center;margin-left:5px}.vac-box-empty{margin-top:10px}@media only screen and (max-width: 768px){.vac-box-empty{margin-top:7px}}.vac-box-search{position:sticky;display:flex;align-items:center;height:64px;padding:0 15px}.vac-box-search .vac-icon-search{display:flex;position:absolute;left:30px}.vac-box-search .vac-icon-search svg{width:18px;height:18px}.vac-box-search .vac-input{height:38px;width:100%;background:var(--chat-bg-color-input);color:var(--chat-color);font-size:15px;outline:0;caret-color:var(--chat-color-caret);padding:10px 10px 10px 40px;border:1px solid var(--chat-sidemenu-border-color-search);border-radius:20px}.vac-box-search .vac-input::placeholder{color:var(--chat-color-placeholder)}.vac-box-search .vac-add-icon{margin-left:auto;padding-left:10px}@media only screen and (max-width: 768px){.vac-box-search{height:58px}}.vac-message-wrapper .vac-card-info{border-radius:4px;text-align:center;margin:10px auto;font-size:12px;padding:4px;display:block;overflow-wrap:break-word;position:relative;white-space:normal;box-shadow:0 1px 1px -1px #0000001a,0 1px 1px -1px #0000001c,0 1px 2px -1px #0000001c}.vac-message-wrapper .vac-card-date{max-width:150px;font-weight:500;text-transform:uppercase;color:var(--chat-message-color-date);background-color:var(--chat-message-bg-color-date)}.vac-message-wrapper .vac-card-system{max-width:250px;padding:8px 4px;color:var(--chat-message-color-system);background-color:var(--chat-message-bg-color-system)}.vac-message-wrapper .vac-line-new{color:var(--chat-message-color-new-messages);position:relative;text-align:center;font-size:13px;padding:10px 0}.vac-message-wrapper .vac-line-new:after,.vac-message-wrapper .vac-line-new:before{border-top:1px solid var(--chat-message-color-new-messages);content:"";left:0;position:absolute;top:50%;width:calc(50% - 60px)}.vac-message-wrapper .vac-line-new:before{left:auto;right:0}.vac-message-wrapper .vac-message-box{display:flex;flex:0 0 50%;justify-content:flex-start;line-height:1.4}.vac-message-wrapper .vac-avatar{height:28px;width:28px;min-height:28px;min-width:28px;margin:0 0 2px;align-self:flex-end}.vac-message-wrapper .vac-avatar-current-offset{margin-right:28px}.vac-message-wrapper .vac-avatar-offset{margin-left:28px}.vac-message-wrapper .vac-failure-container{position:relative;align-self:flex-end;height:20px;width:20px;margin:0 0 2px -4px;border-radius:50%;background-color:#f44336}.vac-message-wrapper .vac-failure-container.vac-failure-container-avatar{margin-right:6px}.vac-message-wrapper .vac-failure-container .vac-failure-text{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;font-size:15px;font-weight:700}.vac-message-wrapper .vac-message-container{position:relative;padding:2px 10px;align-items:end;min-width:116px;box-sizing:content-box;width:80%;max-width:260px;flex-grow:1}.vac-message-wrapper .vac-message-container-offset{margin-top:10px}.vac-message-wrapper .vac-offset-current{justify-content:flex-end}.vac-message-wrapper .vac-message-card{background-color:var(--chat-message-bg-color);color:var(--chat-message-color);border-radius:8px;font-size:14px;padding:6px 9px 3px;white-space:pre-line;max-width:100%;-webkit-transition-property:box-shadow,opacity;transition-property:box-shadow,opacity;transition:box-shadow .28s cubic-bezier(.4,0,.2,1);will-change:box-shadow;box-shadow:0 1px 1px -1px #0000001a,0 1px 1px -1px #0000001c,0 1px 2px -1px #0000001c}.vac-message-wrapper .vac-message-highlight{box-shadow:0 1px 2px -1px #0000001a,0 1px 2px -1px #0000001c,0 1px 5px -1px #0000001c}.vac-message-wrapper .vac-message-current{background-color:var(--chat-message-bg-color-me)!important}.vac-message-wrapper .vac-message-deleted{color:var(--chat-message-color-deleted)!important;font-size:13px!important;font-style:italic!important;background-color:var(--chat-message-bg-color-deleted)!important}.vac-message-wrapper .vac-message-selected{background-color:var(--chat-message-bg-color-selected)!important;transition:background-color .2s}.vac-message-wrapper .vac-message-image{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:cover!important;background-position:center center!important;background-repeat:no-repeat!important;height:250px;width:250px;max-width:100%;border-radius:4px;margin:4px auto 5px;transition:.4s filter linear}.vac-message-wrapper .vac-text-username{font-size:13px;color:var(--chat-message-color-username);margin-bottom:2px}.vac-message-wrapper .vac-username-reply{margin-bottom:5px}.vac-message-wrapper .vac-text-timestamp{font-size:10px;color:var(--chat-message-color-timestamp);text-align:right}.vac-message-wrapper .vac-progress-time{float:left;margin:-2px 0 0 40px;color:var(--chat-color);font-size:12px}.vac-message-wrapper .vac-icon-edited{-webkit-box-align:center;align-items:center;display:-webkit-inline-box;display:inline-flex;justify-content:center;letter-spacing:normal;line-height:1;text-indent:0;vertical-align:middle;margin:0 4px 2px}.vac-message-wrapper .vac-icon-edited svg{height:12px;width:12px}.vac-message-wrapper .vac-icon-check{height:14px;width:14px;vertical-align:middle;margin:-3px -3px 0 3px}@media only screen and (max-width: 768px){.vac-message-wrapper .vac-message-container{padding:2px 3px 1px}.vac-message-wrapper .vac-message-container-offset{margin-top:10px}.vac-message-wrapper .vac-message-box{flex:0 0 80%}.vac-message-wrapper .vac-avatar{height:25px;width:25px;min-height:25px;min-width:25px;margin:0 6px 1px 0}.vac-message-wrapper .vac-avatar.vac-avatar-current{margin:0 0 1px 6px}.vac-message-wrapper .vac-avatar-current-offset{margin-right:31px}.vac-message-wrapper .vac-avatar-offset{margin-left:31px}.vac-message-wrapper .vac-failure-container{margin-left:2px}.vac-message-wrapper .vac-failure-container.vac-failure-container-avatar{margin-right:0}.vac-message-wrapper .vac-progress-time{margin-left:37px}}.vac-audio-player{display:flex;margin:8px 0 5px}.vac-audio-player .vac-svg-button{max-width:18px;margin-left:7px}@media only screen and (max-width: 768px){.vac-audio-player{margin:4px 0 0}.vac-audio-player .vac-svg-button{max-width:16px;margin-left:5px;flex-grow:0;flex-shrink:0}.vac-audio-player .vac-audio-progress-container{flex-grow:1;flex-shrink:0}}.vac-player-bar{display:flex;align-items:center;max-width:calc(100% - 18px);margin-right:7px;margin-left:20px;width:100%}.vac-player-bar .vac-player-progress{width:100%}.vac-player-bar .vac-player-progress .vac-line-container{position:relative;height:4px;border-radius:5px;background-color:var(--chat-message-bg-color-audio-line);width:100%;display:flex;max-width:190px}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-progress{position:absolute;height:inherit;background-color:var(--chat-message-bg-color-audio-progress);border-radius:inherit}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot{position:absolute;top:-5px;margin-left:-7px;height:14px;width:14px;border-radius:50%;background-color:var(--chat-message-bg-color-audio-progress-selector);transition:transform .25s}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot__active{transform:scale(1.2)}@media only screen and (max-width: 768px){.vac-player-bar{margin-right:5px}.vac-player-bar .vac-player-progress .vac-line-container{height:3px}.vac-player-bar .vac-player-progress .vac-line-container .vac-line-dot{height:12px;width:12px;top:-5px;margin-left:-5px}}.vac-message-actions-wrapper .vac-options-container{position:absolute;top:2px;right:10px;height:40px;width:70px;overflow:hidden;border-top-right-radius:8px}.vac-message-actions-wrapper .vac-blur-container{position:absolute;height:100%;width:100%;left:8px;bottom:10px;background:var(--chat-message-bg-color);filter:blur(3px);border-bottom-left-radius:8px}.vac-message-actions-wrapper .vac-options-me{background:var(--chat-message-bg-color-me)}.vac-message-actions-wrapper .vac-message-options{background:var(--chat-icon-bg-dropdown-message);border-radius:50%;position:absolute;top:7px;right:7px}.vac-message-actions-wrapper .vac-message-options svg{height:17px;width:17px;padding:5px;margin:-5px}.vac-message-actions-wrapper .vac-message-emojis{position:absolute;top:6px;right:30px}.vac-message-actions-wrapper .vac-menu-options{right:15px}.vac-message-actions-wrapper .vac-menu-left{right:-118px}@media only screen and (max-width: 768px){.vac-message-actions-wrapper .vac-options-container{right:3px}.vac-message-actions-wrapper .vac-menu-left{right:-50px}}.vac-message-files-container .vac-file-wrapper{position:relative;width:fit-content}.vac-message-files-container .vac-file-wrapper .vac-file-container{height:60px;width:60px;margin:3px 0 5px;cursor:pointer;transition:all .6s}.vac-message-files-container .vac-file-wrapper .vac-file-container:hover{opacity:.85}.vac-message-files-container .vac-file-wrapper .vac-file-container svg{height:30px;width:30px}.vac-message-files-container .vac-file-wrapper .vac-file-container.vac-file-container-progress{background-color:#0000004d}.vac-message-file-container{position:relative;z-index:0}.vac-message-file-container .vac-message-image-container{cursor:pointer}.vac-message-file-container .vac-image-buttons{position:absolute;width:100%;height:100%;border-radius:4px;background:linear-gradient(to bottom,rgba(0,0,0,0) 55%,rgba(0,0,0,.02) 60%,rgba(0,0,0,.05) 65%,rgba(0,0,0,.1) 70%,rgba(0,0,0,.2) 75%,rgba(0,0,0,.3) 80%,rgba(0,0,0,.5) 85%,rgba(0,0,0,.6) 90%,rgba(0,0,0,.7) 95%,rgba(0,0,0,.8) 100%)}.vac-message-file-container .vac-image-buttons svg{height:26px;width:26px}.vac-message-file-container .vac-image-buttons .vac-button-view,.vac-message-file-container .vac-image-buttons .vac-button-download{position:absolute;bottom:6px;left:7px}.vac-message-file-container .vac-image-buttons :first-child{left:40px}.vac-message-file-container .vac-image-buttons .vac-button-view{max-width:18px;bottom:8px}.vac-message-file-container .vac-video-container{width:350px;max-width:100%;margin:4px auto 5px;cursor:pointer}.vac-message-file-container .vac-video-container video{width:100%;height:100%;border-radius:4px}.vac-button-reaction{display:inline-flex;align-items:center;border:var(--chat-message-border-style-reaction);outline:none;background:var(--chat-message-bg-color-reaction);border-radius:4px;margin:4px 2px 0;transition:.3s;padding:0 5px;font-size:18px;line-height:23px}.vac-button-reaction span{font-size:11px;font-weight:500;min-width:7px;color:var(--chat-message-color-reaction-counter)}.vac-button-reaction:hover{border:var(--chat-message-border-style-reaction-hover);background:var(--chat-message-bg-color-reaction-hover);cursor:pointer}.vac-button-reaction.vac-reaction-me{border:var(--chat-message-border-style-reaction-me);background:var(--chat-message-bg-color-reaction-me)}.vac-button-reaction.vac-reaction-me span{color:var(--chat-message-color-reaction-counter-me)}.vac-button-reaction.vac-reaction-me:hover{border:var(--chat-message-border-style-reaction-hover-me);background:var(--chat-message-bg-color-reaction-hover-me)}.vac-reply-message{background:var(--chat-message-bg-color-reply);border-radius:4px;margin:-1px -5px 8px;padding:8px 10px}.vac-reply-message .vac-reply-username{color:var(--chat-message-color-reply-username);font-size:12px;line-height:15px;margin-bottom:2px}.vac-reply-message .vac-image-reply-container{width:70px}.vac-reply-message .vac-image-reply-container .vac-message-image-reply{height:70px;width:70px;margin:4px auto 3px}.vac-reply-message .vac-video-reply-container{width:200px;max-width:100%}.vac-reply-message .vac-video-reply-container video{width:100%;height:100%;border-radius:4px}.vac-reply-message .vac-reply-content{font-size:12px;color:var(--chat-message-color-reply-content)}.vac-reply-message .vac-file-container{height:60px;width:60px}.vac-emoji-wrapper{position:relative;display:flex}.vac-emoji-wrapper .vac-emoji-reaction svg{height:19px;width:19px}.vac-emoji-wrapper .vac-emoji-picker{position:absolute;z-index:9999;bottom:32px;right:10px;width:300px;padding-top:4px;overflow:scroll;box-sizing:border-box;border-radius:.5rem;background:var(--chat-emoji-bg-color);box-shadow:0 1px 2px -2px #0000001a,0 1px 2px -1px #0000001a,0 1px 2px 1px #0000001a;scrollbar-width:none}.vac-emoji-wrapper .vac-emoji-picker::-webkit-scrollbar{display:none}.vac-emoji-wrapper .vac-emoji-picker.vac-picker-reaction{position:fixed;top:initial;right:initial}.vac-emoji-wrapper .vac-emoji-picker emoji-picker{height:100%;width:100%;--emoji-size: 1.2rem;--background: var(--chat-emoji-bg-color);--emoji-padding: .4rem;--border-color: var(--chat-sidemenu-border-color-search);--button-hover-background: var(--chat-sidemenu-bg-color-hover);--button-active-background: var(--chat-sidemenu-bg-color-hover)}.vac-emoji-teleported .vac-emoji-picker{top:0!important;right:0!important;position:absolute!important;max-height:320px!important}.vac-format-message-wrapper .vac-format-container{display:inline}.vac-format-message-wrapper .vac-icon-deleted{height:14px;width:14px;vertical-align:middle;margin:-2px 2px 0 0;fill:var(--chat-message-color-deleted)}.vac-format-message-wrapper .vac-icon-deleted.vac-icon-deleted-room{margin:-3px 1px 0 0;fill:var(--chat-room-color-message)}.vac-format-message-wrapper .vac-image-link-container{background-color:var(--chat-message-bg-color-media);padding:8px;margin:2px auto;border-radius:4px}.vac-format-message-wrapper .vac-image-link{position:relative;background-color:var(--chat-message-bg-color-image)!important;background-size:contain;background-position:center center!important;background-repeat:no-repeat!important;height:150px;width:150px;max-width:100%;border-radius:4px;margin:0 auto}.vac-format-message-wrapper .vac-image-link-message{max-width:166px;font-size:12px}.vac-loader-wrapper.vac-container-center{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:9}.vac-loader-wrapper.vac-container-top{padding:21px}.vac-loader-wrapper.vac-container-top #vac-circle{height:20px;width:20px}.vac-loader-wrapper #vac-circle{margin:auto;height:28px;width:28px;border:3px rgba(0,0,0,.25) solid;border-top:3px var(--chat-color-spinner) solid;border-right:3px var(--chat-color-spinner) solid;border-bottom:3px var(--chat-color-spinner) solid;border-radius:50%;-webkit-animation:vac-spin 1s infinite linear;animation:vac-spin 1s infinite linear}@media only screen and (max-width: 768px){.vac-loader-wrapper #vac-circle{height:24px;width:24px}.vac-loader-wrapper.vac-container-top{padding:18px}.vac-loader-wrapper.vac-container-top #vac-circle{height:16px;width:16px}}@-webkit-keyframes vac-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}@keyframes vac-spin{0%{-webkit-transform:rotate(0deg);transform:rotate(0)}to{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}#vac-icon-search{fill:var(--chat-icon-color-search)}#vac-icon-add{fill:var(--chat-icon-color-add)}#vac-icon-toggle{fill:var(--chat-icon-color-toggle)}#vac-icon-menu{fill:var(--chat-icon-color-menu)}#vac-icon-close{fill:var(--chat-icon-color-close)}#vac-icon-close-image{fill:var(--chat-icon-color-close-image)}#vac-icon-file{fill:var(--chat-icon-color-file)}#vac-icon-paperclip{fill:var(--chat-icon-color-paperclip)}#vac-icon-close-outline{fill:var(--chat-icon-color-close-outline)}#vac-icon-close-outline-preview{fill:var(--chat-icon-color-close-preview)}#vac-icon-send{fill:var(--chat-icon-color-send)}#vac-icon-send-disabled{fill:var(--chat-icon-color-send-disabled)}#vac-icon-emoji{fill:var(--chat-icon-color-emoji)}#vac-icon-emoji-reaction{fill:var(--chat-icon-color-emoji-reaction)}#vac-icon-document{fill:var(--chat-icon-color-document)}#vac-icon-pencil{fill:var(--chat-icon-color-pencil)}#vac-icon-checkmark,#vac-icon-double-checkmark{fill:var(--chat-icon-color-checkmark)}#vac-icon-checkmark-seen,#vac-icon-double-checkmark-seen{fill:var(--chat-icon-color-checkmark-seen)}#vac-icon-eye{fill:var(--chat-icon-color-eye)}#vac-icon-dropdown-message{fill:var(--chat-icon-color-dropdown-message)}#vac-icon-dropdown-room{fill:var(--chat-icon-color-dropdown-room)}#vac-icon-dropdown-scroll{fill:var(--chat-icon-color-dropdown-scroll)}#vac-icon-audio-play{fill:var(--chat-icon-color-audio-play)}#vac-icon-audio-pause{fill:var(--chat-icon-color-audio-pause)}.vac-progress-wrapper{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:9}.vac-progress-wrapper circle{transition:stroke-dashoffset .35s;transform:rotate(-90deg);transform-origin:50% 50%}.vac-progress-wrapper .vac-progress-content{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:-1;margin-top:-2px;background-color:#000000b3;border-radius:50%}.vac-progress-wrapper .vac-progress-content .vac-progress-text{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);font-weight:700;color:#fff}.vac-progress-wrapper .vac-progress-content .vac-progress-text .vac-progress-pourcent{font-size:9px;font-weight:400}
`;const Ob={name:"ChatContainer",components:{RoomsList:$2,Room:pb,MediaPreview:Tb},props:{height:{type:String,default:"600px"},theme:{type:String,default:"light"},styles:{type:[Object,String],default:()=>({})},responsiveBreakpoint:{type:Number,default:900},singleRoom:{type:[Boolean,String],default:!1},roomsListOpened:{type:[Boolean,String],default:!0},textMessages:{type:[Object,String],default:()=>({})},currentUserId:{type:String,default:""},rooms:{type:[Array,String],default:()=>[]},roomsOrder:{type:String,default:"desc"},loadingRooms:{type:[Boolean,String],default:!1},roomsLoaded:{type:[Boolean,String],default:!1},roomId:{type:String,default:null},loadFirstRoom:{type:[Boolean,String],default:!0},messages:{type:[Array,String],default:()=>[]},messagesLoaded:{type:[Boolean,String],default:!1},roomActions:{type:[Array,String],default:()=>[]},menuActions:{type:[Array,String],default:()=>[]},messageActions:{type:[Array,String],default:()=>[{name:"replyMessage",title:"Reply"},{name:"editMessage",title:"Edit Message",onlyMe:!0},{name:"deleteMessage",title:"Delete Message",onlyMe:!0},{name:"selectMessages",title:"Select"}]},messageSelectionActions:{type:[Array,String],default:()=>[]},autoScroll:{type:[Object,String],default:()=>({send:{new:!0,newAfterScrollUp:!0},receive:{new:!0,newAfterScrollUp:!1}})},customSearchRoomEnabled:{type:[Boolean,String],default:!1},showSearch:{type:[Boolean,String],default:!0},showAddRoom:{type:[Boolean,String],default:!0},showSendIcon:{type:[Boolean,String],default:!0},showFiles:{type:[Boolean,String],default:!0},showAudio:{type:[Boolean,String],default:!0},audioBitRate:{type:Number,default:128},audioSampleRate:{type:Number,default:44100},showEmojis:{type:[Boolean,String],default:!0},showReactionEmojis:{type:[Boolean,String],default:!0},showNewMessagesDivider:{type:[Boolean,String],default:!0},showFooter:{type:[Boolean,String],default:!0},showRoomHeader:{type:Boolean,default:!0},textFormatting:{type:[Object,String],default:()=>({disabled:!1,italic:"_",bold:"*",strike:"~",underline:"\xB0",multilineCode:"```",inlineCode:"`"})},linkOptions:{type:[Object,String],default:()=>({disabled:!1,target:"_blank",rel:null})},roomInfoEnabled:{type:[Boolean,String],default:!1},textareaActionEnabled:{type:[Boolean,String],default:!1},textareaAutoFocus:{type:[Boolean,String],default:!0},userTagsEnabled:{type:[Boolean,String],default:!0},emojisSuggestionEnabled:{type:[Boolean,String],default:!0},roomMessage:{type:String,default:""},scrollDistance:{type:Number,default:60},acceptedFiles:{type:String,default:"*"},captureFiles:{type:String,default:void 0},templatesText:{type:[Array,String],default:()=>[]},mediaPreviewEnabled:{type:[Boolean,String],default:!0},usernameOptions:{type:[Object,String],default:()=>({minUsers:3,currentUser:!1})},emojiDataSource:{type:String,default:void 0},handleCustomOpenFiles:{type:Boolean,default:!1},showMessagesStarted:{type:Boolean,default:!0}},emits:["toggle-rooms-list","room-info","fetch-messages","send-message","edit-message","delete-message","open-file","open-user-tag","open-failed-message","menu-action-handler","message-action-handler","send-message-reaction","typing-message","textarea-action-handler","fetch-more-rooms","add-room","search-room","room-action-handler","message-selection-action-handler"],data(){return{slots:[],room:{},loadingMoreRooms:!1,showRoomsList:!0,isMobile:!1,showMediaPreview:!1,previewFile:{}}},computed:{t(){return{...Eb,...this.textMessagesCasted}},cssVars(){const e=Ab[this.theme],t={};return Object.keys(e).map(s=>{t[s]={...e[s],...this.stylesCasted[s]||{}}}),kb(t)},orderedRooms(){return this.roomsCasted.slice().sort((e,t)=>{const s=e.index||0,a=t.index||0;return this.roomsOrder==="asc"?s<a?-1:a<s?1:0:s>a?-1:a>s?1:0})},singleRoomCasted(){return this.castBoolean(this.singleRoom)},roomsListOpenedCasted(){return this.castBoolean(this.roomsListOpened)},loadingRoomsCasted(){return this.castBoolean(this.loadingRooms)},roomsLoadedCasted(){return this.castBoolean(this.roomsLoaded)},loadFirstRoomCasted(){return this.castBoolean(this.loadFirstRoom)},messagesLoadedCasted(){return this.castBoolean(this.messagesLoaded)},showSearchCasted(){return this.castBoolean(this.showSearch)},showAddRoomCasted(){return this.castBoolean(this.showAddRoom)},showSendIconCasted(){return this.castBoolean(this.showSendIcon)},showFilesCasted(){return this.castBoolean(this.showFiles)},showAudioCasted(){return this.castBoolean(this.showAudio)},showEmojisCasted(){return this.castBoolean(this.showEmojis)},showReactionEmojisCasted(){return this.castBoolean(this.showReactionEmojis)},showNewMessagesDividerCasted(){return this.castBoolean(this.showNewMessagesDivider)},showFooterCasted(){return this.castBoolean(this.showFooter)},roomInfoEnabledCasted(){return this.castBoolean(this.roomInfoEnabled)},textareaActionEnabledCasted(){return this.castBoolean(this.textareaActionEnabled)},textareaAutoFocusCasted(){return this.castBoolean(this.textareaAutoFocus)},userTagsEnabledCasted(){return this.castBoolean(this.userTagsEnabled)},emojisSuggestionEnabledCasted(){return this.castBoolean(this.emojisSuggestionEnabled)},mediaPreviewEnabledCasted(){return this.castBoolean(this.mediaPreviewEnabled)},roomsCasted(){return this.castArray(this.rooms)},messagesCasted(){return this.castArray(this.messages)},roomActionsCasted(){return this.castArray(this.roomActions)},menuActionsCasted(){return this.castArray(this.menuActions)},messageActionsCasted(){return this.castArray(this.messageActions)},messageSelectionActionsCasted(){return this.castArray(this.messageSelectionActions)},templatesTextCasted(){return this.castArray(this.templatesText)},stylesCasted(){return this.castObject(this.styles)},textMessagesCasted(){return this.castObject(this.textMessages)},autoScrollCasted(){return this.castObject(this.autoScroll)},textFormattingCasted(){return this.castObject(this.textFormatting)},linkOptionsCasted(){return this.castObject(this.linkOptions)},usernameOptionsCasted(){return this.castObject(this.usernameOptions)},handleCustomOpenFilesCasted(){return this.castBoolean(this.handleCustomOpenFiles)}},watch:{roomsCasted:{immediate:!0,deep:!0,handler(e,t){if((!e[0]||!e.find(s=>s.roomId===this.room.roomId))&&(this.showRoomsList=!0),!this.loadingMoreRooms&&this.loadFirstRoomCasted&&e[0]&&(!t||e.length!==t.length))if(this.roomId){const s=e.find(a=>a.roomId===this.roomId)||{};this.fetchRoom({room:s})}else!this.isMobile||this.singleRoomCasted?this.fetchRoom({room:this.orderedRooms[0]}):this.showRoomsList=!0}},loadingRoomsCasted(e){e&&(this.room={})},roomId:{immediate:!0,handler(e,t){if(e&&!this.loadingRoomsCasted&&this.roomsCasted.length){const s=this.roomsCasted.find(a=>a.roomId===e);this.fetchRoom({room:s})}else t&&!e&&(this.room={})}},room(e){!e||Object.entries(e).length===0||(z4(e),e.users.forEach(t=>{Y4(t)}))},roomsListOpenedCasted:{immediate:!0,handler(e){this.showRoomsList=e}}},created(){this.updateResponsive(),window.addEventListener("resize",e=>{e.isTrusted&&this.updateResponsive()})},updated(){const e=document.querySelectorAll("[slot]");this.slots.length!==e.length&&(this.slots=e)},methods:{castBoolean(e){return e==="true"||e===!0},castArray(e){return e?Array.isArray(e)?e:JSON.parse(e):[]},castObject(e){return e?typeof e=="object"?e:JSON.parse(e):{}},updateResponsive(){this.isMobile=window.innerWidth<Number(this.responsiveBreakpoint)},toggleRoomsList(){this.showRoomsList=!this.showRoomsList,this.isMobile&&(this.room={}),this.$emit("toggle-rooms-list",{opened:this.showRoomsList})},fetchRoom({room:e}){this.room=e,this.fetchMessages({reset:!0}),this.isMobile&&(this.showRoomsList=!1)},fetchMoreRooms(){this.$emit("fetch-more-rooms")},roomInfo(){this.$emit("room-info",this.room)},addRoom(){this.$emit("add-room")},searchRoom(e){this.$emit("search-room",{value:e,roomId:this.room.roomId})},fetchMessages(e){this.$emit("fetch-messages",{room:this.room,options:e})},sendMessage(e){this.$emit("send-message",{...e,roomId:this.room.roomId})},editMessage(e){this.$emit("edit-message",{...e,roomId:this.room.roomId})},deleteMessage(e){this.$emit("delete-message",{message:e,roomId:this.room.roomId})},openFile({message:e,file:t}){this.handleCustomOpenFilesCasted?this.$emit("open-file",{message:e,file:t,defaultHandle:()=>{this._openFile({message:e,file:t})}}):this._openFile({message:e,file:t})},_openFile({message:e,file:t}){this.mediaPreviewEnabledCasted&&t.action==="preview"?(this.previewFile=t.file,this.showMediaPreview=!0):this.$emit("open-file",{message:e,file:t})},openUserTag({user:e}){this.$emit("open-user-tag",{user:e})},openFailedMessage({message:e}){this.$emit("open-failed-message",{message:e,roomId:this.room.roomId})},menuActionHandler(e){this.$emit("menu-action-handler",{action:e,roomId:this.room.roomId})},roomActionHandler({action:e,roomId:t}){this.$emit("room-action-handler",{action:e,roomId:t})},messageActionHandler(e){this.$emit("message-action-handler",{...e,roomId:this.room.roomId})},messageSelectionActionHandler(e){this.$emit("message-selection-action-handler",{...e,roomId:this.room.roomId})},sendMessageReaction(e){this.$emit("send-message-reaction",{...e,roomId:this.room.roomId})},typingMessage(e){this.$emit("typing-message",{message:e,roomId:this.room.roomId})},textareaActionHandler(e){this.$emit("textarea-action-handler",{message:e,roomId:this.room.roomId})}}},Ib={class:"vac-chat-container"};function Cb(e,t,s,a,n,r){const o=Ke("rooms-list"),l=Ke("room"),v=Ke("media-preview");return Q(),ne("div",{class:"vac-card-window",style:xt([{height:s.height},r.cssVars])},[fe("div",Ib,[r.singleRoomCasted?Ae("",!0):(Q(),ht(o,{key:0,"current-user-id":s.currentUserId,rooms:r.orderedRooms,"loading-rooms":r.loadingRoomsCasted,"rooms-loaded":r.roomsLoadedCasted,room:n.room,"room-actions":r.roomActionsCasted,"custom-search-room-enabled":s.customSearchRoomEnabled,"text-messages":r.t,"show-search":r.showSearchCasted,"show-add-room":r.showAddRoomCasted,"show-rooms-list":n.showRoomsList&&r.roomsListOpenedCasted,"text-formatting":r.textFormattingCasted,"link-options":r.linkOptionsCasted,"is-mobile":n.isMobile,"scroll-distance":s.scrollDistance,onFetchRoom:r.fetchRoom,onFetchMoreRooms:r.fetchMoreRooms,onLoadingMoreRooms:t[0]||(t[0]=c=>n.loadingMoreRooms=c),onAddRoom:r.addRoom,onSearchRoom:r.searchRoom,onRoomActionHandler:r.roomActionHandler},gt({_:2},[at(n.slots,c=>({name:c.slot,fn:Xe(m=>[Oe(e.$slots,c.slot,pt(_t(m)))])}))]),1032,["current-user-id","rooms","loading-rooms","rooms-loaded","room","room-actions","custom-search-room-enabled","text-messages","show-search","show-add-room","show-rooms-list","text-formatting","link-options","is-mobile","scroll-distance","onFetchRoom","onFetchMoreRooms","onAddRoom","onSearchRoom","onRoomActionHandler"])),Re(l,{"current-user-id":s.currentUserId,rooms:r.roomsCasted,"room-id":n.room.roomId||"","load-first-room":r.loadFirstRoomCasted,messages:r.messagesCasted,"room-message":s.roomMessage,"messages-loaded":r.messagesLoadedCasted,"menu-actions":r.menuActionsCasted,"message-actions":r.messageActionsCasted,"message-selection-actions":r.messageSelectionActionsCasted,"auto-scroll":r.autoScrollCasted,"show-send-icon":r.showSendIconCasted,"show-files":r.showFilesCasted,"show-audio":r.showAudioCasted,"audio-bit-rate":s.audioBitRate,"audio-sample-rate":s.audioSampleRate,"show-emojis":r.showEmojisCasted,"show-reaction-emojis":r.showReactionEmojisCasted,"show-new-messages-divider":r.showNewMessagesDividerCasted,"show-footer":r.showFooterCasted,"show-room-header":s.showRoomHeader,"text-messages":r.t,"single-room":r.singleRoomCasted,"show-rooms-list":n.showRoomsList&&r.roomsListOpenedCasted,"text-formatting":r.textFormattingCasted,"link-options":r.linkOptionsCasted,"is-mobile":n.isMobile,"loading-rooms":r.loadingRoomsCasted,"room-info-enabled":r.roomInfoEnabledCasted,"textarea-action-enabled":r.textareaActionEnabledCasted,"textarea-auto-focus":r.textareaAutoFocusCasted,"user-tags-enabled":r.userTagsEnabledCasted,"emojis-suggestion-enabled":r.emojisSuggestionEnabledCasted,"scroll-distance":s.scrollDistance,"accepted-files":s.acceptedFiles,"capture-files":s.captureFiles,"templates-text":r.templatesTextCasted,"username-options":r.usernameOptionsCasted,"emoji-data-source":s.emojiDataSource,"show-messages-started-text":s.showMessagesStarted,onToggleRoomsList:r.toggleRoomsList,onRoomInfo:r.roomInfo,onFetchMessages:r.fetchMessages,onSendMessage:r.sendMessage,onEditMessage:r.editMessage,onDeleteMessage:r.deleteMessage,onOpenFile:r.openFile,onOpenUserTag:r.openUserTag,onOpenFailedMessage:r.openFailedMessage,onMenuActionHandler:r.menuActionHandler,onMessageActionHandler:r.messageActionHandler,onMessageSelectionActionHandler:r.messageSelectionActionHandler,onSendMessageReaction:r.sendMessageReaction,onTypingMessage:r.typingMessage,onTextareaActionHandler:r.textareaActionHandler},gt({_:2},[at(n.slots,c=>({name:c.slot,fn:Xe(m=>[Oe(e.$slots,c.slot,pt(_t(m)))])}))]),1032,["current-user-id","rooms","room-id","load-first-room","messages","room-message","messages-loaded","menu-actions","message-actions","message-selection-actions","auto-scroll","show-send-icon","show-files","show-audio","audio-bit-rate","audio-sample-rate","show-emojis","show-reaction-emojis","show-new-messages-divider","show-footer","show-room-header","text-messages","single-room","show-rooms-list","text-formatting","link-options","is-mobile","loading-rooms","room-info-enabled","textarea-action-enabled","textarea-auto-focus","user-tags-enabled","emojis-suggestion-enabled","scroll-distance","accepted-files","capture-files","templates-text","username-options","emoji-data-source","show-messages-started-text","onToggleRoomsList","onRoomInfo","onFetchMessages","onSendMessage","onEditMessage","onDeleteMessage","onOpenFile","onOpenUserTag","onOpenFailedMessage","onMenuActionHandler","onMessageActionHandler","onMessageSelectionActionHandler","onSendMessageReaction","onTypingMessage","onTextareaActionHandler"])]),Re(Ct,{name:"vac-fade-preview",appear:""},{default:Xe(()=>[n.showMediaPreview?(Q(),ht(v,{key:0,file:n.previewFile,onCloseMediaPreview:t[1]||(t[1]=c=>n.showMediaPreview=!1)},gt({_:2},[at(n.slots,c=>({name:c.slot,fn:Xe(m=>[Oe(e.$slots,c.slot,pt(_t(m)))])}))]),1032,["file"])):Ae("",!0)]),_:3})],4)}var Bb=St(Ob,[["render",Cb],["styles",[Rb]]]);const rd=Am(Bb),nd="vue-advanced-chat";function Lb(){customElements.get(nd)||customElements.define(nd,rd)}wa.VueAdvancedChat=rd,wa.register=Lb,Object.defineProperties(wa,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
